{"createdAt":"2023-10-18T03:32:35.795Z","updatedAt":"2023-10-19T11:35:12.000Z","id":"562","name":"PRS API Order","active":true,"nodes":[{"parameters":{},"id":"7a3f11b1-c2e1-420c-866e-ba6c8dc95ab5","name":"When clicking \"Execute Workflow\"","type":"n8n-nodes-base.manualTrigger","typeVersion":1,"position":[1460,580]},{"parameters":{"values":{"string":[{"name":"api","value":"https://dstt.postmart.vn/api/prs/v2/"},{"name":"token","value":"7a51b166dfe235dfec2901a24ed2f671"},{"name":"modules[0]","value":"salesOrder"},{"name":"modules[1]","value":"purchasesOrder"},{"name":"modules[2]","value":"goodsReceipt"},{"name":"apiCom","value":"https://dstt.postmart.com.vn/api/prs/v2/"}],"number":[{"name":"limit","value":100}]},"options":{}},"id":"eff68f36-d875-42fc-843a-19a57d93a6ae","name":"meta","type":"n8n-nodes-base.set","typeVersion":2,"position":[1680,580]},{"parameters":{"batchSize":1,"options":{"reset":"={{ $('Split In Batches').context[\"noItemsLeft\"] }}"}},"id":"23a14141-115f-419c-897e-07871bbb5db3","name":"Split In Batches","type":"n8n-nodes-base.splitInBatches","typeVersion":2,"position":[3560,620]},{"parameters":{"method":"POST","url":"={{ $('meta').item.json.apiCom }}contents/{{ $('Set').item.json._module }}","sendHeaders":true,"headerParameters":{"parameters":[{"name":"token","value":"={{ $('meta').item.json.token }}"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={{ $json.data }}","options":{}},"id":"4cf131e4-5780-426d-aa57-21d6a034b85c","name":"UpdateData","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[3840,600],"retryOnFail":true},{"parameters":{"url":"={{ $('meta').item.json.api }}contents/{{ $('Set').item.json._module }}","sendQuery":true,"queryParameters":{"parameters":[{"name":"limit","value":"={{ $('meta').item.json.limit }}"},{"name":"last_updated","value":"={{ $json.data.last_updated }}"}]},"sendHeaders":true,"headerParameters":{"parameters":[{"name":"token","value":"={{ $('meta').item.json.token }}"}]},"options":{"response":{"response":{"fullResponse":true}}}},"id":"715be169-6bef-48d7-b370-94d03788ba13","name":"getDataApi","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[2860,560],"retryOnFail":true},{"parameters":{"fieldToSplitOut":"body.data.data","options":{"destinationFieldName":"data"}},"id":"9a592396-158a-4a8a-947b-f74c8da5faa0","name":"ItemLists","type":"n8n-nodes-base.itemLists","typeVersion":2.1,"position":[3120,560]},{"parameters":{"batchSize":1,"options":{}},"id":"9b2b4a94-8ed3-41e5-9a5f-b52a8097872f","name":"Split.Batches","type":"n8n-nodes-base.splitInBatches","typeVersion":2,"position":[2160,580]},{"parameters":{"fieldToSplitOut":"modules","options":{"destinationFieldName":"module"}},"id":"aaa01eaa-0cfe-436b-ac4e-c1f6c328ad3f","name":"ModuleLists","type":"n8n-nodes-base.itemLists","typeVersion":2.1,"position":[1900,580]},{"parameters":{"rule":{"interval":[{"field":"minutes"}]}},"id":"7169156f-88ae-4ec6-96fa-388386e27592","name":"Schedule Trigger","type":"n8n-nodes-base.scheduleTrigger","typeVersion":1.1,"position":[1460,840]},{"parameters":{"url":"={{ $('meta').item.json.apiCom }}last-updated/{{ $json._module }}","options":{}},"id":"cb7f8f08-a846-44d1-8715-eb1990b3e11a","name":"LastUpdateTime","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[2600,480],"retryOnFail":true},{"parameters":{"keepOnlySet":true,"values":{"string":[{"name":"_module","value":"={{ $json.module }}"}]},"options":{}},"id":"d9a9706d-8d58-420c-b050-f7e68777dfb1","name":"Set","type":"n8n-nodes-base.set","typeVersion":2,"position":[2380,480]},{"parameters":{"conditions":{"boolean":[{"value1":true,"value2":"={{ $('Split In Batches').context[\"noItemsLeft\"] }}"}]}},"id":"e97bf300-f0c3-4f8b-b89b-396666c27ab7","name":"IFDone","type":"n8n-nodes-base.if","typeVersion":1,"position":[4040,600]}],"connections":{"When clicking \"Execute Workflow\"":{"main":[[{"node":"meta","type":"main","index":0}]]},"meta":{"main":[[{"node":"ModuleLists","type":"main","index":0}]]},"Split In Batches":{"main":[[{"node":"UpdateData","type":"main","index":0}]]},"getDataApi":{"main":[[{"node":"ItemLists","type":"main","index":0}]]},"Split.Batches":{"main":[[{"node":"Set","type":"main","index":0}]]},"ModuleLists":{"main":[[{"node":"Split.Batches","type":"main","index":0}]]},"UpdateData":{"main":[[{"node":"IFDone","type":"main","index":0}]]},"Schedule Trigger":{"main":[[{"node":"meta","type":"main","index":0}]]},"LastUpdateTime":{"main":[[{"node":"getDataApi","type":"main","index":0}]]},"Set":{"main":[[{"node":"LastUpdateTime","type":"main","index":0}]]},"ItemLists":{"main":[[{"node":"Split In Batches","type":"main","index":0}]]},"IFDone":{"main":[[{"node":"Split.Batches","type":"main","index":0}],[{"node":"Split In Batches","type":"main","index":0}]]}},"settings":{},"staticData":{"node:Schedule Trigger":{"recurrencyRules":[]}},"pinData":{},"versionId":"f9710e33-4c68-4bcb-b6f0-2e9b9750e684","triggerCount":1,"tags":[]}