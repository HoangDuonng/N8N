{"createdAt":"2023-06-28T02:14:04.578Z","updatedAt":"2023-07-01T05:39:31.000Z","id":"151","name":"My workflow 14 copy","active":false,"nodes":[{"parameters":{"rule":{"interval":[{"field":"minutes","minutesInterval":15}]}},"id":"f18dbfa7-9368-4e00-9b03-71b026676e6d","name":"Schedule Trigger","type":"n8n-nodes-base.scheduleTrigger","typeVersion":1.1,"position":[640,640]},{"parameters":{"collection":"messages","options":{}},"id":"70951740-1333-4dce-879f-c8dfbbd1697b","name":"MongoDB","type":"n8n-nodes-base.mongoDb","typeVersion":1,"position":[900,640],"credentials":{"mongoDb":{"id":"64","name":"MongoDB account"}}},{"parameters":{"authentication":"serviceAccount","projectId":{"__rl":true,"value":"med247-353607","mode":"list","cachedResultName":"med247","cachedResultUrl":"https://console.cloud.google.com/bigquery?project=med247-353607"},"sqlQuery":"=#standardSQL\nINSERT INTO test.messages VALUES (  '{{ $json._id }}', '{{ $json.status }}', '{{ $json.phone }}', '''{{ $json.content }}''', PARSE_JSON('{{JSON.stringify($json.context) }}'), '{{ $json.template }}', '{{ $json.sender }}', PARSE_JSON('{{JSON.stringify( $json.provider)}}'), '{{ $json.createdAt }}', '{{ $json.updatedAt }}', '{{ $json.__v }}' )","options":{"location":"asia-southeast1"}},"id":"08c84bf2-ccf5-4798-8748-5c4007e237fc","name":"Google BigQuery2","type":"n8n-nodes-base.googleBigQuery","typeVersion":2,"position":[1640,200],"executeOnce":false,"credentials":{"googleApi":{"id":"65","name":"Google BigQuery account"}}},{"parameters":{"authentication":"serviceAccount","projectId":{"__rl":true,"value":"med247-353607","mode":"list","cachedResultName":"med247","cachedResultUrl":"https://console.cloud.google.com/bigquery?project=med247-353607"},"sqlQuery":"#standardSQL\nCREATE OR REPLACE TABLE test.messages (\n  _id STRING,\n  status STRING,\n  phone STRING,\n  content STRING,\n  context JSON,\n  template STRING,\n  sender STRING,\n  provider JSON,\n  createdAt STRING,\n  updateAt STRING,\n  __v STRING\n);\n","options":{"location":"asia-southeast1"}},"id":"72ad518a-8776-4ca1-bfd6-adf0645f8ac2","name":"Google BigQuery3","type":"n8n-nodes-base.googleBigQuery","typeVersion":2,"position":[1820,320],"executeOnce":false,"credentials":{"googleApi":{"id":"65","name":"Google BigQuery account"}}},{"parameters":{"amount":15,"unit":"seconds"},"id":"fafed1b5-adfd-4c54-89a0-4cb627f3d2d2","name":"Wait1","type":"n8n-nodes-base.wait","typeVersion":1,"position":[1980,320],"webhookId":"91096d18-619f-4db9-a525-8b3b417d993f"},{"parameters":{"mode":"combine","mergeByFields":{"values":[{"field1":"={{ $('MongoDB').item.json[\"_id\"] }}","field2":"=SELECT _id from {{ $('Google BigQuery1') }}"}]},"joinMode":"keepNonMatches","outputDataFrom":"=both","options":{}},"id":"b4d455ce-d709-4073-b4b2-434b8af07a3f","name":"Merge","type":"n8n-nodes-base.merge","typeVersion":2.1,"position":[1180,660],"alwaysOutputData":true},{"parameters":{"authentication":"serviceAccount","operation":"insert","projectId":{"__rl":true,"value":"med247-353607","mode":"list","cachedResultName":"med247","cachedResultUrl":"https://console.cloud.google.com/bigquery?project=med247-353607"},"datasetId":{"__rl":true,"value":"test","mode":"list","cachedResultName":"test"},"tableId":{"__rl":true,"value":"messages","mode":"list","cachedResultName":"messages"},"options":{}},"id":"c802ebd6-6f76-4cf8-b072-1843911f8c93","name":"Google BigQuery","type":"n8n-nodes-base.googleBigQuery","typeVersion":2,"position":[1420,440],"executeOnce":false,"credentials":{"googleApi":{"id":"65","name":"Google BigQuery account"}}},{"parameters":{"mode":"combine","combinationMode":"multiplex","options":{}},"id":"9f48ffea-ab52-49fc-8106-d7b8b1294482","name":"Merge1","type":"n8n-nodes-base.merge","typeVersion":2.1,"position":[1180,420],"alwaysOutputData":true},{"parameters":{"authentication":"serviceAccount","projectId":{"__rl":true,"value":"med247-353607","mode":"list","cachedResultName":"med247","cachedResultUrl":"https://console.cloud.google.com/bigquery?project=med247-353607"},"sqlQuery":"=UPDATE test.messages  SET\n  status    = '{{ $json.status    }}',\n  phone     = '{{ $json.phone     }}',\n  content   = '''{{ $json.content   }}''',\n  context   = PARSE_JSON('{{JSON.stringify($json.context) }}'),\n  template  = '{{ $json.template  }}',\n  sender    = '{{ $json.sender    }}',\n  provider  = PARSE_JSON('{{JSON.stringify( $json.provider)}}'),\n  createdAt = '{{ $json.createdAt }}',\n  updateAt  = '{{ $json.updateAt  }}',\n  __v       = '{{ $json.__v       }}'\n  WHERE \n  _id = '{{ $json._id       }}'","options":{}},"id":"8be0658c-4c61-4b27-ab44-0e4d1955e008","name":"Google BigQuery4","type":"n8n-nodes-base.googleBigQuery","typeVersion":2,"position":[1420,660],"credentials":{"googleApi":{"id":"65","name":"Google BigQuery account"}}},{"parameters":{"collection":"messages","options":{}},"id":"363b9b9b-63ee-45f4-a122-2dc65abc485c","name":"MongoDB1","type":"n8n-nodes-base.mongoDb","typeVersion":1,"position":[700,200],"credentials":{"mongoDb":{"id":"64","name":"MongoDB account"}},"disabled":true},{"parameters":{"authentication":"serviceAccount","operation":"insert","projectId":{"__rl":true,"value":"med247-353607","mode":"list","cachedResultName":"med247","cachedResultUrl":"https://console.cloud.google.com/bigquery?project=med247-353607"},"datasetId":{"__rl":true,"value":"test","mode":"list","cachedResultName":"test"},"tableId":{"__rl":true,"value":"messages_copy","mode":"list","cachedResultName":"messages_copy"},"options":{}},"id":"4a00f66b-7fc3-40c5-b033-1a93b768d92b","name":"Google BigQuery5","type":"n8n-nodes-base.googleBigQuery","typeVersion":2,"position":[1180,200],"executeOnce":false,"credentials":{"googleApi":{"id":"65","name":"Google BigQuery account"}},"disabled":true},{"parameters":{"rule":{"interval":[{"field":"minutes","minutesInterval":15}]}},"id":"5a656073-3a1a-4122-a77a-99ee81de0704","name":"Schedule Trigger1","type":"n8n-nodes-base.scheduleTrigger","typeVersion":1.1,"position":[460,200]},{"parameters":{"conditions":{"string":[{"value1":"={{ $('MongoDB1').item.json[\"_id\"] }}","value2":"639be5661a1228001c7ee819"}]}},"id":"004621a4-d232-44e6-ae62-56f86fd1b3af","name":"Filter","type":"n8n-nodes-base.filter","typeVersion":1,"position":[880,200],"disabled":true},{"parameters":{"authentication":"serviceAccount","projectId":{"__rl":true,"value":"med247-353607","mode":"list","cachedResultName":"med247","cachedResultUrl":"https://console.cloud.google.com/bigquery?project=med247-353607"},"sqlQuery":"#standardSQL\nSELECT * FROM test.messages","options":{"location":"asia-southeast1"}},"id":"c80c22f4-25e6-41d8-b023-e730b2b3bb84","name":"Google BigQuery1","type":"n8n-nodes-base.googleBigQuery","typeVersion":2,"position":[900,420],"executeOnce":false,"credentials":{"googleApi":{"id":"65","name":"Google BigQuery account"}}}],"connections":{"Schedule Trigger":{"main":[[{"node":"MongoDB","type":"main","index":0}]]},"MongoDB":{"main":[[{"node":"Merge","type":"main","index":0},{"node":"Merge1","type":"main","index":0}]]},"Merge":{"main":[[{"node":"Google BigQuery","type":"main","index":0}]]},"Merge1":{"main":[[{"node":"Google BigQuery4","type":"main","index":0}]]},"MongoDB1":{"main":[[{"node":"Filter","type":"main","index":0}]]},"Schedule Trigger1":{"main":[[{"node":"MongoDB1","type":"main","index":0}]]},"Filter":{"main":[[{"node":"Google BigQuery5","type":"main","index":0}]]},"Google BigQuery1":{"main":[[{"node":"Merge","type":"main","index":1},{"node":"Merge1","type":"main","index":1}]]}},"settings":{},"staticData":{"node:Schedule Trigger":{"recurrencyRules":[]}},"pinData":{},"versionId":"e2899267-ad36-4982-9631-f8d7f083c552","triggerCount":1,"tags":[]}