{"createdAt":"2023-06-26T06:58:28.676Z","updatedAt":"2023-06-27T15:20:06.000Z","id":"148","name":"My workflow 14","active":false,"nodes":[{"parameters":{"rule":{"interval":[{"field":"minutes","minutesInterval":15}]}},"id":"6823f21a-4111-4dce-b8d8-a8753aaef76d","name":"Schedule Trigger","type":"n8n-nodes-base.scheduleTrigger","typeVersion":1.1,"position":[620,440]},{"parameters":{"collection":"messages","options":{}},"id":"ad7805ac-41c1-4855-8634-333ae1edcc82","name":"MongoDB","type":"n8n-nodes-base.mongoDb","typeVersion":1,"position":[900,640],"credentials":{"mongoDb":{"id":"64","name":"MongoDB account"}}},{"parameters":{"authentication":"serviceAccount","projectId":{"__rl":true,"value":"med247-353607","mode":"list","cachedResultName":"med247","cachedResultUrl":"https://console.cloud.google.com/bigquery?project=med247-353607"},"sqlQuery":"=#standardSQL\nSELECT * FROM test.messages","options":{"location":"asia-southeast1"}},"id":"a3f4bd96-7449-4fcb-bf47-8bdf41418de8","name":"Google BigQuery1","type":"n8n-nodes-base.googleBigQuery","typeVersion":2,"position":[900,440],"executeOnce":false,"credentials":{"googleApi":{"id":"65","name":"Google BigQuery account"}}},{"parameters":{"authentication":"serviceAccount","projectId":{"__rl":true,"value":"med247-353607","mode":"list","cachedResultName":"med247","cachedResultUrl":"https://console.cloud.google.com/bigquery?project=med247-353607"},"sqlQuery":"=#standardSQL\nINSERT INTO test.messages VALUES (  '{{ $json._id }}', '{{ $json.status }}', '{{ $json.phone }}', '''{{ $json.content }}''', PARSE_JSON('{{JSON.stringify($json.context) }}'), '{{ $json.template }}', '{{ $json.sender }}', PARSE_JSON('{{JSON.stringify( $json.provider)}}'), '{{ $json.createdAt }}', '{{ $json.updatedAt }}', '{{ $json.__v }}' )","options":{"location":"asia-southeast1"}},"id":"248ae5f1-7a29-4f9e-bbb4-f13617adf54a","name":"Google BigQuery2","type":"n8n-nodes-base.googleBigQuery","typeVersion":2,"position":[1640,200],"executeOnce":false,"credentials":{"googleApi":{"id":"65","name":"Google BigQuery account"}}},{"parameters":{"authentication":"serviceAccount","projectId":{"__rl":true,"value":"med247-353607","mode":"list","cachedResultName":"med247","cachedResultUrl":"https://console.cloud.google.com/bigquery?project=med247-353607"},"sqlQuery":"#standardSQL\nCREATE OR REPLACE TABLE test.messages (\n  _id STRING,\n  status STRING,\n  phone STRING,\n  content STRING,\n  context JSON,\n  template STRING,\n  sender STRING,\n  provider JSON,\n  createdAt STRING,\n  updateAt STRING,\n  __v STRING\n);\n","options":{"location":"asia-southeast1"}},"id":"e47b8763-7c3e-48f3-b8b6-216d782c0293","name":"Google BigQuery3","type":"n8n-nodes-base.googleBigQuery","typeVersion":2,"position":[1820,320],"executeOnce":false,"credentials":{"googleApi":{"id":"65","name":"Google BigQuery account"}}},{"parameters":{"amount":15,"unit":"seconds"},"id":"cd1bdf4f-c98e-42c6-8920-8156a6f6db93","name":"Wait1","type":"n8n-nodes-base.wait","typeVersion":1,"position":[1980,320],"webhookId":"249de388-7cfd-455f-b04d-92ca3d24a8c7"},{"parameters":{"mode":"combine","mergeByFields":{"values":[{"field1":"={{ $('MongoDB').item.json[\"_id\"] }}","field2":"={{ $('Google BigQuery1').item.json[\"_id\"] }}"}]},"options":{}},"id":"23968b7b-41dd-494c-a1a0-0b684a591d15","name":"Merge","type":"n8n-nodes-base.merge","typeVersion":2.1,"position":[1180,660],"alwaysOutputData":true},{"parameters":{"authentication":"serviceAccount","operation":"insert","projectId":{"__rl":true,"value":"med247-353607","mode":"list","cachedResultName":"med247","cachedResultUrl":"https://console.cloud.google.com/bigquery?project=med247-353607"},"datasetId":{"__rl":true,"value":"test","mode":"list","cachedResultName":"test"},"tableId":{"__rl":true,"value":"messages","mode":"list","cachedResultName":"messages"},"options":{}},"id":"f908d482-a4dc-4c6a-9eb3-6cc91129aecb","name":"Google BigQuery","type":"n8n-nodes-base.googleBigQuery","typeVersion":2,"position":[1420,440],"executeOnce":false,"credentials":{"googleApi":{"id":"65","name":"Google BigQuery account"}}},{"parameters":{"mode":"combine","mergeByFields":{"values":[{"field1":"={{ $('MongoDB').item.json[\"_id\"] }}","field2":"={{ $('Google BigQuery1').item.json[\"_id\"] }}"}]},"options":{}},"id":"1f6925e9-f84a-467e-a571-e44d0e3d5d81","name":"Merge1","type":"n8n-nodes-base.merge","typeVersion":2.1,"position":[1180,420],"alwaysOutputData":true},{"parameters":{"authentication":"serviceAccount","projectId":{"__rl":true,"value":"med247-353607","mode":"list","cachedResultName":"med247","cachedResultUrl":"https://console.cloud.google.com/bigquery?project=med247-353607"},"sqlQuery":"=UPDATE test.messages  SET\n  status    = '{{ $json.status    }}',\n  phone     = '{{ $json.phone     }}',\n  content   = '''{{ $json.content   }}''',\n  context   = PARSE_JSON('{{JSON.stringify($json.context) }}'),\n  template  = '{{ $json.template  }}',\n  sender    = '{{ $json.sender    }}',\n  provider  = PARSE_JSON('{{JSON.stringify( $json.provider)}}'),\n  createdAt = '{{ $json.createdAt }}',\n  updateAt  = '{{ $json.updateAt  }}',\n  __v       = '{{ $json.__v       }}'\n  WHERE \n  _id = '{{ $json._id       }}'","options":{}},"id":"b3875517-56c3-4685-a960-46702e42738f","name":"Google BigQuery4","type":"n8n-nodes-base.googleBigQuery","typeVersion":2,"position":[1420,660],"credentials":{"googleApi":{"id":"65","name":"Google BigQuery account"}}},{"parameters":{"collection":"messages","options":{}},"id":"db51314e-0af9-4f51-9357-e517216f0b6d","name":"MongoDB1","type":"n8n-nodes-base.mongoDb","typeVersion":1,"position":[700,200],"credentials":{"mongoDb":{"id":"64","name":"MongoDB account"}},"disabled":true},{"parameters":{"authentication":"serviceAccount","operation":"insert","projectId":{"__rl":true,"value":"med247-353607","mode":"list","cachedResultName":"med247","cachedResultUrl":"https://console.cloud.google.com/bigquery?project=med247-353607"},"datasetId":{"__rl":true,"value":"test","mode":"list","cachedResultName":"test"},"tableId":{"__rl":true,"value":"messages","mode":"list","cachedResultName":"messages"},"options":{}},"id":"f797809e-faa1-4959-be07-64688a9c9e71","name":"Google BigQuery5","type":"n8n-nodes-base.googleBigQuery","typeVersion":2,"position":[1180,200],"executeOnce":false,"credentials":{"googleApi":{"id":"65","name":"Google BigQuery account"}},"disabled":true},{"parameters":{"rule":{"interval":[{"field":"minutes","minutesInterval":15}]}},"id":"4ca9d070-19b5-46f2-9923-0f4c375b6477","name":"Schedule Trigger1","type":"n8n-nodes-base.scheduleTrigger","typeVersion":1.1,"position":[460,160]},{"parameters":{"conditions":{"string":[{"value1":"={{ $json._id }}","value2":"639be5661a1228001c7ee819"}]}},"id":"bce88543-fdf3-4560-b63b-62bd72fbb94f","name":"Filter","type":"n8n-nodes-base.filter","typeVersion":1,"position":[860,220],"disabled":true}],"connections":{"Schedule Trigger":{"main":[[{"node":"Google BigQuery1","type":"main","index":0},{"node":"MongoDB","type":"main","index":0}]]},"MongoDB":{"main":[[{"node":"Merge","type":"main","index":0},{"node":"Merge1","type":"main","index":0}]]},"Google BigQuery1":{"main":[[{"node":"Merge1","type":"main","index":1},{"node":"Merge","type":"main","index":1}]]},"Merge":{"main":[[{"node":"Google BigQuery","type":"main","index":0}]]},"Merge1":{"main":[[{"node":"Google BigQuery4","type":"main","index":0}]]},"MongoDB1":{"main":[[{"node":"Filter","type":"main","index":0}]]},"Schedule Trigger1":{"main":[[{"node":"MongoDB1","type":"main","index":0}]]},"Filter":{"main":[[{"node":"Google BigQuery5","type":"main","index":0}]]}},"settings":{},"staticData":{"node:Schedule Trigger":{"recurrencyRules":[]}},"pinData":{},"versionId":"e93a76cf-3dc4-4d03-af83-9c168f30c6af","triggerCount":1,"tags":[]}