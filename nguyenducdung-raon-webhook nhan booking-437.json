{"createdAt":"2023-07-28T02:05:49.855Z","updatedAt":"2023-08-22T11:19:20.000Z","id":"437","name":"NguyenDucDung.Raon:webhook nhan booking","active":true,"nodes":[{"parameters":{"httpMethod":"POST","path":"eac699d8-c955-411b-bd4a-cfd7bbf7af83","options":{"responseData":"success"}},"id":"046830f5-0dc6-4209-be3f-e066ff807ab6","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[560,440],"webhookId":"eac699d8-c955-411b-bd4a-cfd7bbf7af83"},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/auth/v3/app_access_token/internal","sendBody":true,"specifyBody":"json","jsonBody":"={\n    \"app_id\": \"cli_a45467a5a678d009\",\n    \"app_secret\": \"UZ84ksi92YWQ42ffDyJuVhOwRUKfAwj8\"\n}","options":{}},"id":"9bbc3f40-80be-47e6-bbc3-6fd881795a19","name":"HTTP Request","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[980,440]},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/bitable/v1/apps/HJogb3M1iaHZa8sjKeAuCcfMs3c/tables/tblkB3AwxUpZPkRW/records","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $json[\"app_access_token\"] }}"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\n  \"fields\": {\n\"BookedDate\":{{ $('Code').item.json[\"BookedDate\"] }},\n\"HotelId\":\"{{ $('Code').item.json[\"HotelId\"] }}\",\n\"BookingId\":\"{{ $('Code').item.json[\"BookingId\"] }}\",\n\"BookingCode\":\"{{ $('Code').item.json[\"BookingCode\"] }}\",\n\"Status\":\"{{ $('Code').item.json[\"Status\"] }}\",\n\"CheckedIn\":{{ $('Code').item.json[\"CheckedIn\"] }},\n\"CheckedOut\":{{ $('Code').item.json[\"CheckedOut\"] }},\n\"FirstName\":\"{{ $('Code').item.json[\"FirstName\"] }}\",\n\"LastName\":\"{{ $('Code').item.json[\"LastName\"] }}\",\n\"Email\":\"{{ $('Code').item.json[\"Email\"] }}\",\n\"Phone\":\"{{ $('Code').item.json[\"Phone\"] }}\",\n\"Country\":\"{{ $('Code').item.json[\"Country\"] }}\",\n\"RoomTypeId\":\"{{ $('Code').item.json[\"RoomTypeId\"] }}\",\n\"RoomTypeName\":\"{{ $('Code').item.json[\"RoomTypeName\"] }}\",\n\"RatePlanId\":\"{{ $('Code').item.json[\"RatePlanId\"] }}\",\n\"RoomRate\":{{ $('Code').item.json[\"RoomRate\"] }},\n\"Deposit\":{{ $('Code').item.json[\"Deposit\"] }},\n\"Currency\":\"{{ $('Code').item.json[\"Currency\"] }}\",\n\"Quantity\":{{ $('Code').item.json[\"Quantity\"] }},\n\"Adult\":{{ $('Code').item.json[\"Adult\"] }},\n\"Children\":{{ $('Code').item.json[\"Children\"] }},\n\"IsGroup\":{{ $('Code').item.json[\"IsGroup\"] }},\n\"ClientName\":\"{{ $('Code').item.json[\"ClientName\"] }}\",\n\"Breakfast\":{{ $('Code').item.json[\"Breakfast\"] }},\n\"Comments\":\"{{ $('Code').item.json[\"Comments\"] }}\"\n  }\n}","options":{}},"id":"162fdd3e-fed0-4bf3-b64b-f77a84c40599","name":"HTTP Request1","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[1200,440]},{"parameters":{"mode":"runOnceForEachItem","jsCode":"// Add a new field called 'myNewField' to the JSON of the item\n$input.item.json.data = JSON.parse($('Webhook').item.json.body)\n$input.item.json.BookedDate = $input.item.json.data.BookedDate;\n$input.item.json.HotelId = $input.item.json.data.HotelId;\n$input.item.json.BookingId = $input.item.json.data.BookingId;\n$input.item.json.BookingCode = $input.item.json.data.BookingCode;\n$input.item.json.Status = $input.item.json.data.Status;\n$input.item.json.CheckedIn = $input.item.json.data.CheckedIn;\n$input.item.json.CheckedOut = $input.item.json.data.CheckedOut;\n$input.item.json.FirstName = $input.item.json.data.FirstName;\n$input.item.json.LastName = $input.item.json.data.LastName;\n$input.item.json.Email = $input.item.json.data.Email;\n$input.item.json.Phone = $input.item.json.data.Phone;\n$input.item.json.Country = $input.item.json.data.Country;\n$input.item.json.RoomTypeId = $input.item.json.data.RoomTypeId;\n$input.item.json.RoomTypeName = $input.item.json.data.RoomTypeName;\n$input.item.json.RatePlanId = $input.item.json.data.RatePlanId;\n$input.item.json.RoomRate = $input.item.json.data.RoomRate;\n$input.item.json.Deposit = $input.item.json.data.Deposit;\n$input.item.json.Currency = $input.item.json.data.Currency;\n$input.item.json.Quantity = $input.item.json.data.Quantity;\n$input.item.json.Adult = $input.item.json.data.Adult;\n$input.item.json.Children = $input.item.json.data.Children;\n$input.item.json.IsGroup = $input.item.json.data.IsGroup;\n$input.item.json.ClientName = $input.item.json.data.ClientName;\n$input.item.json.Breakfast = $input.item.json.data.Breakfast;\n$input.item.json.Comments = $input.item.json.data.Comments;\n\n$input.item.json.BookedDate = $input.item.json.BookedDate.replaceAll(\"/Date(\",\"\")\n$input.item.json.BookedDate = $input.item.json.BookedDate.replaceAll(\")/\",\"\")\n\n\n$input.item.json.CheckedIn = $input.item.json.CheckedIn.replaceAll(\"/Date(\",\"\")\n$input.item.json.CheckedIn = $input.item.json.CheckedIn.replaceAll(\")/\",\"\")\n\n\n$input.item.json.CheckedOut = $input.item.json.CheckedOut.replaceAll(\"/Date(\",\"\")\n$input.item.json.CheckedOut = $input.item.json.CheckedOut.replaceAll(\")/\",\"\")\n\n$input.item.json.Comments = $input.item.json.Comments.replaceAll(\"\\n\", \" \")\n\n\n\nreturn $input.item;"},"id":"06ddf985-d0ef-446a-bf59-d87efd7727c4","name":"Code","type":"n8n-nodes-base.code","typeVersion":1,"position":[780,440]}],"connections":{"Webhook":{"main":[[{"node":"Code","type":"main","index":0}]]},"HTTP Request":{"main":[[{"node":"HTTP Request1","type":"main","index":0}]]},"Code":{"main":[[{"node":"HTTP Request","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{},"versionId":"34344b73-710c-4d84-8746-236df02b904e","triggerCount":1,"tags":[]}