{"createdAt":"2023-06-08T07:18:28.035Z","updatedAt":"2023-06-08T07:18:44.000Z","id":"116","name":"HR send payslip email","active":true,"nodes":[{"parameters":{"httpMethod":"POST","path":"medianet-send-payslip","options":{}},"id":"dcdd9720-2827-4345-ae8e-5375b1e5627f","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[460,460],"webhookId":"2630ad25-9d56-4f34-97c4-64b8098c64a8"},{"parameters":{"fromEmail":"=HR - Media Net <payslip@media.net.vn>","toEmail":"={{ $('Webhook').item.json[\"query\"][\"email\"] }}","subject":"= [Media Net]Bảng lương tháng {{ $('Webhook').item.json[\"query\"][\"month\"] }} - {{ $('Webhook').item.json[\"query\"][\"name\"] }}","html":"=<!DOCTYPE html>\n<html>\n  <head>\n    <title>Bảng lương</title>\n    <style>\n      body {\n        background-color: #f5f5f5;\n        font-family: Arial, sans-serif;\n      }\n      h1 {\n        text-align: center;\n        margin-top: 2rem;\n        margin-bottom: 2rem;\n        color: #333;\n        text-shadow: 0 0 10px rgba(0, 0, 0, 0.1);\n      }\n      table {\n        border-collapse: collapse;\n        width: 100%;\n        margin: 0 auto;\n        margin-bottom: 1rem;\n        box-shadow: 0 0 20px rgba(0, 0, 0, 0.15);\n        background: linear-gradient(to bottom, #f2f2f2, #fff);\n      }\n      th,\n      td {\n        padding: 1rem;\n        border: 1px solid #ddd;\n        text-align: center;\n        color: #333;\n      }\n      tr:nth-child(even) {\n        background-color: #e0e0e0;\n      }\n      tr:nth-child(odd) {\n        background-color: #f5f5f5;\n      }\n      .logo {\n        display: block;\n        margin: 0 auto;\n        max-width: 200px;\n      }\n      .container {\n        text-align: center;\n      }\n    </style>\n </head>\n  <body>\n    <div class=\"container\">\n      <img src=\"https://media.net.vn/logo-ngang.png\" alt=\"Logo công ty\" class=\"logo\">\n      <h1>Bảng lương của {{ $('Webhook').item.json[\"query\"][\"name\"] }}</h1>\n      <table>\n        <tbody>\n        {{ $('Code').item.json[\"htmlSalaryFix\"] }}\n        {{ $('Code').item.json[\"htmlSalaryBHXH\"] }}\n        {{ $('Code').item.json[\"htmlTraffic\"] }}\n        {{ $('Code').item.json[\"htmlMultiplier\"] }}\n        {{ $('Code').item.json[\"htmlSalaryKD\"] }}\n        {{ $('Code').item.json[\"htmlSalaryTN\"] }}\n        {{ $('Code').item.json[\"htmlOther\"] }}\n        {{ $('Code').item.json[\"htmlChuyenCan\"] }}\n        {{ $('Code').item.json[\"htmlNote\"] }}\n        {{ $('Code').item.json[\"htmlSalaryTotal\"] }}\n        </tbody>\n      </table>\n    </div>\n  </body>\n</html>","options":{}},"id":"1d3f2654-c475-40af-ba84-251f247c374d","name":"Send Email1","type":"n8n-nodes-base.emailSend","typeVersion":1,"position":[840,460],"credentials":{"smtp":{"id":"60","name":"Email HR"}}},{"parameters":{"mode":"runOnceForEachItem","jsCode":"// Add a new field called 'myNewField' to the JSON of the item\nconst config = { style: 'currency', currency: 'VND'}\n$input.item.json.htmlTraffic = \"\"\nif ($('Webhook').item.json.query.Traffic) {\n  $input.item.json.htmlTraffic = \"<tr><th>Traffic</th><td>\" + new Intl.NumberFormat('vi-VN').format($('Webhook').item.json.query.Traffic) + \"</td></tr>\"\n}\n$input.item.json.htmlMultiplier = \"\"\nif ($('Webhook').item.json.query.multiplier) {\n  $input.item.json.htmlMultiplier = \"<tr><th>Hệ số</th><td>\" + $('Webhook').item.json.query.multiplier + \"</td></tr>\"\n}\n$input.item.json.htmlOther = \"\"\nif ($('Webhook').item.json.query.other) {\n  $input.item.json.htmlOther = \"<tr><th>Khác</th><td>\" + new Intl.NumberFormat('vi-VN', config).format($('Webhook').item.json.query.other) + \"</td></tr>\"\n}\n$input.item.json.htmlSalaryKD = \"\"\nif ($('Webhook').item.json.query.salaryKD) {\n  $input.item.json.htmlSalaryKD = \"<tr><th>Lương Kinh Doanh</th><td>\" + new Intl.NumberFormat('vi-VN', config).format($('Webhook').item.json.query.salaryKD.replaceAll(\"[\",\"\").replaceAll(\"]\",\"\")) + \"</td></tr>\"\n}\n$input.item.json.htmlSalaryTN = \"\"\nif ($('Webhook').item.json.query.salaryTN) {\n  $input.item.json.htmlSalaryTN = \"<tr><th>Lương Trách Nhiệm</th><td>\" + new Intl.NumberFormat('vi-VN', config).format($('Webhook').item.json.query.salaryTN) + \"</td></tr>\"\n}\n$input.item.json.htmlSalaryBHXH = \"\"\nif ($('Webhook').item.json.query.BHXH) {\n  $input.item.json.htmlSalaryBHXH = \"<tr><th>BHXH</th><td>\" + new Intl.NumberFormat('vi-VN', config).format($('Webhook').item.json.query.BHXH) + \"</td></tr>\"\n}\n$input.item.json.htmlChuyenCan = \"\"\nif ($('Webhook').item.json.query.chuyencan) {\n  $input.item.json.htmlChuyenCan = \"<tr><th>Chuyên Cần</th><td>\" + new Intl.NumberFormat('vi-VN', config).format($('Webhook').item.json.query.chuyencan) + \"</td></tr>\"\n}\n$input.item.json.htmlNote = \"\"\nif ($('Webhook').item.json.query.chuyencan) {\n  $input.item.json.htmlNote = \"<tr><th>Ghi chú</th><td>\" + $('Webhook').item.json.query.note + \"</td></tr>\"\n}\n\n$input.item.json.htmlSalaryFix = \"<tr><th>Lương cơ bản</th><td>\" + new Intl.NumberFormat('vi-VN', config).format($('Webhook').item.json.query.salaryFix) + \"</td></tr>\"\n$input.item.json.htmlSalaryTotal = \"<tr><th>Tổng lương thực nhận</th><td>\" + new Intl.NumberFormat('vi-VN', config).format($('Webhook').item.json.query.salaryTotal.replaceAll(\"[\",\"\").replaceAll(\"]\",\"\")) + \"</td></tr>\"\n\n\n\nreturn $input.item;"},"id":"b879b4b0-c78b-4ab2-9043-e78d0b5e8602","name":"Code","type":"n8n-nodes-base.code","typeVersion":1,"position":[640,460]}],"connections":{"Webhook":{"main":[[{"node":"Code","type":"main","index":0}]]},"Code":{"main":[[{"node":"Send Email1","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{},"versionId":"2f5bb8b8-b1ea-4dab-a0c7-11dca4993c5b","triggerCount":1,"tags":[]}