{"createdAt":"2023-11-22T03:13:33.108Z","updatedAt":"2023-11-22T03:50:30.000Z","id":"580","name":"Gửi tin nhắn dữ liệu tồn kho vào Lark - Copy","active":false,"nodes":[{"parameters":{"rule":{"interval":[{"triggerAtHour":7}]}},"id":"48f70d76-57f2-4349-ac56-cb896dc1d0dc","name":"Schedule Trigger1","type":"n8n-nodes-base.scheduleTrigger","typeVersion":1.1,"position":[800,360]},{"parameters":{"documentId":{"__rl":true,"value":"1kfET9iXm7RaHANOdJeV8UfkG9oLrZ5_gfJhO0exQq6Q","mode":"id"},"sheetName":{"__rl":true,"value":"0","mode":"id"},"options":{}},"id":"a90f8fd9-0fa3-463b-8eae-82c34f9a9a53","name":"Google Sheets1","type":"n8n-nodes-base.googleSheets","typeVersion":4,"position":[1020,360],"credentials":{"googleSheetsOAuth2Api":{"id":"139","name":"Google Sheets account 3"}}},{"parameters":{"jsCode":"output = {\n  \"msg_type\": \"interactive\",\n  \"card\": {\n    \"config\": {\"wide_screen_mode\": True},\n    \"elements\": [\n      {\n        \"tag\": \"column_set\",\n        \"flex_mode\": \"none\",\n        \"background_style\": \"grey\",\n        \"columns\": [\n          {\n            \"tag\": \"column\",\n            \"width\": \"weighted\",\n            \"weight\": 1,\n            \"vertical_align\": \"top\",\n            \"elements\": [\n              {\n                \"tag\": \"markdown\",\n                \"content\": \"**Tên sản phẩm**\"\n              }\n            ]\n          },\n          {\n            \"tag\": \"column\",\n            \"width\": \"weighted\",\n            \"weight\": 1,\n            \"vertical_align\": \"top\",\n            \"elements\": [\n              {\n                \"tag\": \"markdown\",\n                \"content\": \"**Ngày tạo đơn**\"\n              }\n            ]\n          },\n          {\n            \"tag\": \"column\",\n            \"width\": \"weighted\",\n            \"weight\": 1,\n            \"vertical_align\": \"top\",\n            \"elements\": [\n              {\n                \"tag\": \"markdown\",\n                \"content\": \"**Số lượng**\"\n              }\n            ]\n          }\n        ]\n      }\n    ],\n    \"header\": {\n      \"template\": \"blue\",\n      \"title\": {\n        \"content\": \"Báo cáo đơn tồn\",\n        \"tag\": \"plain_text\"\n      }\n    }\n  }\n}\n\nfor items in _input.all():\n  format_item = {\n    \"tag\": \"column_set\",\n    \"flex_mode\": \"none\",\n    \"background_style\": \"grey\",\n    \"columns\": [\n      {\n        \"tag\": \"column\",\n        \"width\": \"weighted\",\n        \"weight\": 1,\n        \"vertical_align\": \"top\",\n        \"elements\": [\n          {\n            \"tag\": \"div\",\n            \"text\": {\n              \"content\": item['json']['Tên sản phẩm'],\n              \"tag\": \"plain_text\"\n            }\n          }\n        ]\n      },\n      {\n        \"tag\": \"column\",\n        \"width\": \"weighted\",\n        \"weight\": 1,\n        \"vertical_align\": \"top\",\n        \"elements\": [\n          {\n            \"tag\": \"div\",\n            \"text\": {\n              \"content\": item['json']['Ngày tạo đơn'],\n              \"tag\": \"plain_text\"\n            }\n          }\n        ]\n      },\n      {\n        \"tag\": \"column\",\n        \"width\": \"weighted\",\n        \"weight\": 1,\n        \"vertical_align\": \"top\",\n        \"elements\": [\n          {\n            \"tag\": \"div\",\n            \"text\": {\n              \"content\": \"{:,}\".format(item['json']['Số lượng']),\n              \"tag\": \"plain_text\"\n            }\n          }\n        ]\n      }\n    ]\n  }\n  output['card']['elements'].append(format_item)\n\n  # return {'a': output['elements']}\n  return {'card': output}"},"id":"4d594612-4ee1-476b-8aba-a7a831378833","name":"Code1","type":"n8n-nodes-base.code","typeVersion":1,"position":[1240,360]},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/bot/v2/hook/cb0e3c9c-13af-494e-8337-9753472f18d3","sendBody":true,"specifyBody":"json","jsonBody":"={{$json.card}}","options":{}},"id":"858cafec-feab-49d5-8c17-b0a8f92e6dbd","name":"HTTP Request1","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[1460,360]}],"connections":{"Schedule Trigger1":{"main":[[{"node":"Google Sheets1","type":"main","index":0}]]},"Google Sheets1":{"main":[[{"node":"Code1","type":"main","index":0}]]},"Code1":{"main":[[{"node":"HTTP Request1","type":"main","index":0}]]}},"settings":{},"staticData":{"node:Schedule Trigger1":{"recurrencyRules":[]}},"pinData":{},"versionId":"1bc522a7-f6de-4185-8dc0-9ac5249cda91","triggerCount":1,"tags":[]}