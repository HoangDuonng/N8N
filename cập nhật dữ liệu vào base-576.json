{"createdAt":"2023-11-21T13:23:29.036Z","updatedAt":"2023-11-21T14:12:17.000Z","id":"576","name":"Cập nhật dữ liệu vào Base","active":false,"nodes":[{"parameters":{"rule":{"interval":[{}]}},"id":"ebd2fbd2-ee3f-4c19-abf0-4a3ecd8ee4d4","name":"Schedule Trigger","type":"n8n-nodes-base.scheduleTrigger","typeVersion":1.1,"position":[460,460]},{"parameters":{"documentId":{"__rl":true,"value":"1d-ch9pub1iCvEzvdWBFa9NznBVRmnAfgeSXrp6Z8C5Y","mode":"id"},"sheetName":{"__rl":true,"value":"102874219","mode":"id"},"options":{}},"id":"cd5b674c-df02-43bd-9c7d-e1bf203b81b4","name":"Google Sheets","type":"n8n-nodes-base.googleSheets","typeVersion":4,"position":[680,460],"credentials":{"googleSheetsOAuth2Api":{"id":"139","name":"Google Sheets account 3"}}},{"parameters":{"jsCode":"// Loop over input items and add a new field called 'myNewField' to the JSON of each one\nconst input = $input.all();\nconst output = {records:[]};\nfor (const item of $input.all()){\n  const format_item = {\n    fields: {\n      \"Họ Tên\": item.json[\"Họ Tên\"],\n      \"Lương\": item.json[\"Lương\"] === '-' ? 0 : item.json[\"Lương\"],\n      \"Tiền thưởng\": item.json[\"Tiền thưởng\"] === '-' ? 0 : item.json[\"Tiền thưởng\"],\n      \"Chốt đơn\": item.json[\"Chốt đơn\"] === '-' ? 0 : item.json[\"Chốt đơn\"],\n      \"Tổng lương\": item.json[\"Tổng lương\"] === '-' ? 0 : item.json[\"Tổng lương\"],\n      \"Ghi chú\": item.json[\"Ghi chú\"] === '-' ? \"\" : item.json[\"Ghi chú\"]\n    }\n  }\n  output.records.push(format_item);\n}\nreturn {output: output};"},"id":"f7c8cf8f-3bda-4d48-9c73-fc5424be40fe","name":"Code","type":"n8n-nodes-base.code","typeVersion":1,"position":[900,460]},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/auth/v3/tenant_access_token/internal","sendBody":true,"bodyParameters":{"parameters":[{"name":"app_id","value":"cli_a5d60b468eb8d02f"},{"name":"app_secret","value":"iCJNwzHnaKNEbiS88ZFgcceujWO16Jpm"}]},"options":{}},"id":"bf7e0d62-a7ab-4ea1-a97d-9e3130c15b23","name":"tenant_access_token","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[1120,460]},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/bitable/v1/apps/H6jCbDdJDaHa4ssXeWxlhlKUgnc/tables/tblFmCEoTxUg5iuH/records/batch_create","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $json.tenant_access_token }}"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={{ $('Code').item.json.output }}","options":{}},"id":"e791683e-6889-4a32-af84-1030a95449dd","name":"HTTP Request","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[1340,460]}],"connections":{"Schedule Trigger":{"main":[[{"node":"Google Sheets","type":"main","index":0}]]},"Google Sheets":{"main":[[{"node":"Code","type":"main","index":0}]]},"Code":{"main":[[{"node":"tenant_access_token","type":"main","index":0}]]},"tenant_access_token":{"main":[[{"node":"HTTP Request","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{},"versionId":"a14ac1d3-eda9-4d76-994d-78d20f03c579","triggerCount":0,"tags":[]}