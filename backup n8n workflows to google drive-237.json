{"createdAt":"2023-07-27T15:11:20.963Z","updatedAt":"2023-07-27T16:06:03.000Z","id":"237","name":"Backup n8n workflows to Google Drive","active":true,"nodes":[{"parameters":{},"name":"On clicking 'execute'","type":"n8n-nodes-base.manualTrigger","position":[800,260],"typeVersion":1,"id":"2ae5c391-6d0d-4525-8987-55f83ebb0d1a"},{"parameters":{"mode":"jsonToBinary","destinationKey":"=data","options":{"useRawData":false}},"name":"Move Binary Data","type":"n8n-nodes-base.moveBinaryData","position":[1560,400],"typeVersion":1,"id":"09a174b3-d3f5-44b4-91d8-af64989308f2"},{"parameters":{"authentication":"oAuth2","binaryData":true,"name":"={{$node[\"n8n\"].data[\"name\"]}}.json","resolveData":true,"parents":["={{ $('Create Folder').item.json[\"id\"] }}"],"options":{}},"name":"Google Drive","type":"n8n-nodes-base.googleDrive","position":[1920,400],"typeVersion":1,"id":"c5ddfc0c-e8f5-4a68-aacb-30eccd648a84","credentials":{"googleDriveOAuth2Api":{"id":"94","name":"Google Drive: lekhoi456@gmail.com"}}},{"parameters":{"filters":{}},"id":"39b8c85c-dd41-46a3-987a-b988de636803","name":"n8n","type":"n8n-nodes-base.n8n","typeVersion":1,"position":[1340,400],"credentials":{"n8nApi":{"id":"98","name":"n8n khoi"}}},{"parameters":{"triggerTimes":{"item":[{"hour":5}]}},"name":"Run Daily at 5:00","type":"n8n-nodes-base.cron","position":[800,400],"typeVersion":1,"id":"1b2072c1-fda3-4699-9621-0ee0920f6c6a"},{"parameters":{"resource":"folder","name":"={{new Date().toISOString().slice(0, 10)}}","options":{"parents":["1Wt10Yl2bbk_P4UJRuv85p3DkBWe_s8CS"]}},"id":"7da78dba-7bc3-4350-9a40-bd5e4e428d70","name":"Create Folder","type":"n8n-nodes-base.googleDrive","typeVersion":2,"position":[1140,400],"credentials":{"googleDriveOAuth2Api":{"id":"94","name":"Google Drive: lekhoi456@gmail.com"}}},{"parameters":{},"id":"6a70a748-f6bf-43ad-86e7-5f40cbe3f765","name":"Start","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[960,400]}],"connections":{"Move Binary Data":{"main":[[{"node":"Google Drive","type":"main","index":0}]]},"On clicking 'execute'":{"main":[[{"node":"Start","type":"main","index":0}]]},"n8n":{"main":[[{"node":"Move Binary Data","type":"main","index":0}]]},"Run Daily at 5:00":{"main":[[{"node":"Start","type":"main","index":0}]]},"Create Folder":{"main":[[{"node":"n8n","type":"main","index":0}]]},"Google Drive":{"main":[[]]},"Start":{"main":[[{"node":"Create Folder","type":"main","index":0}]]}},"settings":{"saveManualExecutions":true,"callerPolicy":"workflowsFromSameOwner"},"staticData":null,"pinData":{"n8n":[{"json":{"createdAt":"2023-01-05T09:55:49.898Z","updatedAt":"2023-01-31T08:29:30.000Z","id":"1","name":"Lark - Get app access token","active":false,"nodes":[{"parameters":{},"id":"c5fa611a-be30-4b28-b9df-0c178cd46a3f","name":"When clicking \"Execute Workflow\"","type":"n8n-nodes-base.manualTrigger","typeVersion":1,"position":[1040,600]},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/auth/v3/app_access_token/internal","sendBody":true,"specifyBody":"json","jsonBody":"{ \"app_id\" : \"cli_a33cd37530b8900a\", \"app_secret\" : \"qNz8YxoCCZoGm9Nlm2bOrcUriJsJtHHD\"  }","options":{}},"id":"3765d478-22ed-4ed5-8bdc-c48e2b2a4537","name":"HTTP Request","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[1260,600]},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/authen/v1/access_token","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $json[\"app_access_token\"] }}"}]},"sendBody":true,"specifyBody":"json","jsonBody":"{     \"grant_type\": \"authorization_code\",     \"code\": \"141hfefa068a4ba7abdf99a1c98ad47v\" }","options":{}},"id":"beff0def-b48e-47cd-b11f-a078e6ed5551","name":"HTTP Request1","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[1480,600]},{"parameters":{"operation":"update","documentId":{"__rl":true,"value":"1RDBBTEXxrC07DE8hjVFYrhIzz5h9BHhojcFhgZDOBxU","mode":"list","cachedResultName":"Lark Connector Token","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1RDBBTEXxrC07DE8hjVFYrhIzz5h9BHhojcFhgZDOBxU/edit?usp=drivesdk"},"sheetName":{"__rl":true,"value":"gid=0","mode":"list","cachedResultName":"Trang t√≠nh1","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1RDBBTEXxrC07DE8hjVFYrhIzz5h9BHhojcFhgZDOBxU/edit#gid=0"},"columnToMatchOn":"key","valueToMatchOn":"lark_key","fieldsUi":{"values":[{"column":"access_token","fieldValue":"={{ $json[\"data\"][\"access_token\"] }}"},{"column":"expires_in","fieldValue":"={{ $json[\"data\"][\"expires_in\"] }}"},{"column":"refresh_token","fieldValue":"={{ $json[\"data\"][\"refresh_token\"] }}"},{"column":"refresh_expires_in","fieldValue":"={{ $json[\"data\"][\"refresh_expires_in\"] }}"}]},"options":{}},"id":"5fd84832-9a06-4738-8c8f-d35aa6657386","name":"Google Sheets","type":"n8n-nodes-base.googleSheets","typeVersion":3,"position":[1700,600],"credentials":{"googleSheetsOAuth2Api":{"id":"3","name":"Google Sheets lekhoi456@gmail.com"}}}],"connections":{"When clicking \"Execute Workflow\"":{"main":[[{"node":"HTTP Request","type":"main","index":0}]]},"HTTP Request":{"main":[[{"node":"HTTP Request1","type":"main","index":0}]]},"HTTP Request1":{"main":[[{"node":"Google Sheets","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{},"versionId":"074d899a-6887-4aa0-bf35-e5cbb0bec471","triggerCount":0,"tags":[{"createdAt":"2023-01-05T09:55:57.214Z","updatedAt":"2023-01-05T09:55:57.214Z","id":"1","name":"Lark"}]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-01-05T10:59:05.175Z","updatedAt":"2023-01-12T16:59:10.000Z","id":"3","name":"Get refresh token","active":true,"nodes":[{"parameters":{"rule":{"interval":[{"field":"minutes","minutesInterval":110}]}},"id":"1dedc236-d15c-481c-b655-13fa55327bb7","name":"110m","type":"n8n-nodes-base.scheduleTrigger","typeVersion":1,"position":[1100,580]},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/auth/v3/app_access_token/internal","sendBody":true,"specifyBody":"json","jsonBody":"{ \"app_id\" : \"cli_a33cd37530b8900a\", \"app_secret\" : \"qNz8YxoCCZoGm9Nlm2bOrcUriJsJtHHD\" }","options":{}},"id":"eadd1f62-ce8e-436f-b9cb-a97a151b1a32","name":"Get app_access_token","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[1320,580]},{"parameters":{"documentId":{"__rl":true,"value":"1RDBBTEXxrC07DE8hjVFYrhIzz5h9BHhojcFhgZDOBxU","mode":"list","cachedResultName":"Lark Connector Token","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1RDBBTEXxrC07DE8hjVFYrhIzz5h9BHhojcFhgZDOBxU/edit?usp=drivesdk"},"sheetName":{"__rl":true,"value":"gid=0","mode":"list","cachedResultName":"Kdigivn","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1RDBBTEXxrC07DE8hjVFYrhIzz5h9BHhojcFhgZDOBxU/edit#gid=0"},"filtersUI":{"values":[{"lookupColumn":"key","lookupValue":"lark_key"}]},"options":{}},"id":"402eec50-903b-473c-90a5-15a1b0380181","name":"Get refresh_token","type":"n8n-nodes-base.googleSheets","typeVersion":3,"position":[1540,580],"credentials":{"googleSheetsOAuth2Api":{"id":"3","name":"Google Sheets lekhoi456@gmail.com"}}},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/authen/v1/refresh_access_token","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $node[\"Get app_access_token\"].json[\"app_access_token\"] }}"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\n    \"grant_type\": \"refresh_token\",\n    \"refresh_token\": \"{{ $json[\"refresh_token\"] }}\"\n}","options":{}},"id":"f5c74047-dbbf-4553-a563-72c8dfa62581","name":"Get access_token, refresh_token","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[1760,580]},{"parameters":{"operation":"update","documentId":{"__rl":true,"value":"1RDBBTEXxrC07DE8hjVFYrhIzz5h9BHhojcFhgZDOBxU","mode":"list","cachedResultName":"Lark Connector Token","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1RDBBTEXxrC07DE8hjVFYrhIzz5h9BHhojcFhgZDOBxU/edit?usp=drivesdk"},"sheetName":{"__rl":true,"value":"gid=0","mode":"list","cachedResultName":"Kdigivn","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1RDBBTEXxrC07DE8hjVFYrhIzz5h9BHhojcFhgZDOBxU/edit#gid=0"},"columnToMatchOn":"key","valueToMatchOn":"lark_key","fieldsUi":{"values":[{"column":"access_token","fieldValue":"={{ $json[\"data\"][\"access_token\"] }}"},{"column":"expires_in","fieldValue":"={{ $json[\"data\"][\"expires_in\"] }}"},{"column":"refresh_token","fieldValue":"={{ $json[\"data\"][\"refresh_token\"] }}"},{"column":"refresh_expires_in","fieldValue":"={{ $json[\"data\"][\"refresh_expires_in\"] }}"}]},"options":{}},"id":"a8f4995e-4dd8-4e9d-8b24-51c545f488d6","name":"Update access token, refresh token","type":"n8n-nodes-base.googleSheets","typeVersion":3,"position":[1980,580],"credentials":{"googleSheetsOAuth2Api":{"id":"3","name":"Google Sheets lekhoi456@gmail.com"}}}],"connections":{"110m":{"main":[[{"node":"Get app_access_token","type":"main","index":0}]]},"Get app_access_token":{"main":[[{"node":"Get refresh_token","type":"main","index":0}]]},"Get refresh_token":{"main":[[{"node":"Get access_token, refresh_token","type":"main","index":0}]]},"Get access_token, refresh_token":{"main":[[{"node":"Update access token, refresh token","type":"main","index":0}]]}},"settings":{},"staticData":{"node:110m":{"recurrencyRules":[]}},"pinData":{},"versionId":"1db28fc1-fb29-44c6-b973-8943bf07442a","triggerCount":1,"tags":[{"createdAt":"2023-01-05T09:55:57.214Z","updatedAt":"2023-01-05T09:55:57.214Z","id":"1","name":"Lark"}]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-01-06T07:58:03.243Z","updatedAt":"2023-02-03T13:57:42.000Z","id":"4","name":"Email trigger","active":true,"nodes":[{"parameters":{"content":"## üëá Get started faster \nLightning tour of the key concepts [3 min] \n\n[![n8n quickstart video](/static/quickstart_thumbnail.png#full-width)](https://www.youtube.com/watch?v=RpjQTGKm-ok)","height":300,"width":380},"id":"721edcff-6ca3-4ab4-864f-7421e18678ee","name":"_QUICKSTART_NOTE_","type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[380,500]},{"parameters":{"options":{}},"id":"79dadf78-0a53-4b8d-bf3b-ce5974a6b7d9","name":"Email Trigger (IMAP)","type":"n8n-nodes-base.emailReadImap","typeVersion":2,"position":[860,580],"credentials":{"imap":{"id":"4","name":"IMAP automation@kdigi.app"}}}],"connections":{},"settings":{},"staticData":{"node:Email Trigger (IMAP)":{"lastMessageUid":43}},"pinData":{},"versionId":"55f857f1-33f4-430c-ac86-e98f88ae2898","triggerCount":1,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-01-06T08:52:08.232Z","updatedAt":"2023-01-06T08:52:08.232Z","id":"5","name":"My workflow 2","active":false,"nodes":[{"parameters":{},"id":"191e29d1-9045-4135-ae8f-d6fdecfbe82e","name":"When clicking \"Execute Workflow\"","type":"n8n-nodes-base.manualTrigger","typeVersion":1,"position":[1100,580]},{"parameters":{"content":"## üëá Get started faster \nLightning tour of the key concepts [3 min] \n\n[![n8n quickstart video](/static/quickstart_thumbnail.png#full-width)](https://www.youtube.com/watch?v=RpjQTGKm-ok)","height":300,"width":380},"id":"3b3c61f4-5fd2-4579-bc59-a49d5b91a178","name":"_QUICKSTART_NOTE_","type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[640,580]}],"connections":{},"settings":{},"staticData":null,"pinData":{},"versionId":"b10a8e82-6145-4123-a080-bd8ee94002f4","triggerCount":0,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-01-06T09:31:47.177Z","updatedAt":"2023-05-23T17:47:39.000Z","id":"6","name":"[Kdigi.vn] Contact Form","active":true,"nodes":[{"parameters":{"httpMethod":"POST","path":"kdigivn-to-automation","options":{}},"id":"a8bc0643-64db-42a7-9c15-bce29cce029c","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[800,620],"webhookId":"31ac83d4-357d-4be6-8e44-95999d1aa54a"},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/auth/v3/tenant_access_token/internal/","sendBody":true,"specifyBody":"json","jsonBody":"{ \"app_id\" : \"cli_a36a65082eb85009\", \"app_secret\" : \"n6EEtyICEiK2IoQGXLAFtedQTGY0Z5Sk\" }","options":{}},"id":"b1d660f6-7f77-4f18-b747-52572ecdd562","name":"Get tenant access token","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[1160,620]},{"parameters":{"jsCode":"const input = $('Webhook').first().json.body;\n\n// Get calls data\nlet records = [{\n   fields : {\n    name: input.name,\n    phone: {\n      text: input.phone,\n      link: input.phone\n    },\n    email: {\n      text: input.email,\n      link: input.email\n    },\n    files: input.files,\n    message: input.message,    \n  }\n}];\n\nlet result = { json: { records } };\nreturn result;\n"},"id":"c6aef471-fddf-447a-bfdc-2927d36dc5d9","name":"Convert to Lark format","type":"n8n-nodes-base.code","typeVersion":1,"position":[1360,620]},{"parameters":{"method":"POST","url":"=https://open.larksuite.com/open-apis/bitable/v1/apps/{{ $node[\"Set values\"].parameter[\"values\"][\"string\"][0][\"value\"] }}/tables/{{ $node[\"Set values\"].parameter[\"values\"][\"string\"][1][\"value\"] }}/records/batch_create","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $node[\"Get tenant access token\"].json.tenant_access_token }}"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\"records\":{{ JSON.stringify($('Convert to Lark format').first().json.records) }}}","options":{}},"id":"46942c1c-16c6-46b8-9fe2-97be35b31043","name":"Add records to Bitable","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[1580,620]},{"parameters":{"values":{"string":[{"name":"baseId","value":"basusJkexxPH4LURRo2mqnTVkkc"},{"name":"tableId","value":"tblod2o41EweKObC"}]},"options":{}},"id":"52782c6c-c4ad-4c8c-99eb-71f056ac9201","name":"Set values","type":"n8n-nodes-base.set","typeVersion":2,"position":[980,620]}],"connections":{"Webhook":{"main":[[{"node":"Set values","type":"main","index":0}]]},"Get tenant access token":{"main":[[{"node":"Convert to Lark format","type":"main","index":0}]]},"Convert to Lark format":{"main":[[{"node":"Add records to Bitable","type":"main","index":0}]]},"Set values":{"main":[[{"node":"Get tenant access token","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{"Webhook":[{"json":{"headers":{"host":"app.n8n.vn","user-agent":"node-fetch/1.0 (+https://github.com/bitinn/node-fetch)","content-length":"608","accept":"*/*","accept-encoding":"gzip,deflate","content-type":"multipart/form-data;boundary=--------------------------572707572506649573859843","x-forwarded-for":"125.235.236.54","x-forwarded-host":"app.n8n.vn","x-forwarded-port":"443","x-forwarded-proto":"https","x-forwarded-server":"ba8c3a24b3d5","x-real-ip":"125.235.236.54"},"params":{},"query":{},"body":{"name":"Thanh","phone":"0348204069","email":"thanhkh@kdigi.vn","message":"","files":""}}}]},"versionId":"603c3abb-7eca-44ee-b44f-970e6234258e","triggerCount":1,"tags":[{"createdAt":"2023-01-05T09:55:57.214Z","updatedAt":"2023-01-05T09:55:57.214Z","id":"1","name":"Lark"},{"createdAt":"2023-01-06T09:31:53.849Z","updatedAt":"2023-01-06T09:31:53.849Z","id":"2","name":"Kdigi.vn"}]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-01-11T05:39:47.839Z","updatedAt":"2023-01-11T05:39:47.839Z","id":"7","name":"My workflow 3","active":false,"nodes":[{"parameters":{"httpMethod":"POST","path":"add-domain-to-cloudflare","options":{}},"id":"27f1a08c-c18d-414c-a392-ad172704d35b","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[1100,580],"webhookId":"db51be90-ea1f-4024-951b-10d4ac435eea"},{"parameters":{"operation":"delete","zoneId":"="},"id":"fa80a8ba-1b62-4aaa-95de-dcfa8589d8e9","name":"Cloudflare","type":"n8n-nodes-base.cloudflare","typeVersion":1,"position":[1320,580],"credentials":{"cloudflareApi":{"id":"6","name":"Cloudflare: Edit Zone DNS"}}}],"connections":{"Webhook":{"main":[[{"node":"Cloudflare","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{},"versionId":"a034d97c-a30c-4027-8c1e-7b35c195d0a2","triggerCount":0,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-01-12T10:43:29.118Z","updatedAt":"2023-01-12T10:44:09.000Z","id":"8","name":"Create N8N Account","active":false,"nodes":[{"parameters":{"path":"28856bc0-019c-40a5-91cc-ece5c6f926a7","options":{}},"id":"053038ba-e6b1-4243-b8e7-2269c98494fa","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[840,500],"webhookId":"28856bc0-019c-40a5-91cc-ece5c6f926a7"},{"parameters":{"operation":"update","workflowId":{"__rl":true,"mode":"list","value":""}},"id":"935e2552-e866-449a-baae-a17b11e42987","name":"n8n","type":"n8n-nodes-base.n8n","typeVersion":1,"position":[1060,500]}],"connections":{"Webhook":{"main":[[{"node":"n8n","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{},"versionId":"04c209f9-da78-4482-92d2-979284c2ed8e","triggerCount":0,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-01-13T05:18:23.356Z","updatedAt":"2023-01-13T07:26:11.000Z","id":"9","name":"Send mail","active":true,"nodes":[{"parameters":{"httpMethod":"POST","path":"dang-ky-khoa-hoc","options":{"responseData":""}},"id":"a6e79e2a-f6c7-4847-b98d-bef11bd95bda","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[1100,580],"webhookId":"08bdd76a-2bce-4731-b19b-085574a8a047"},{"parameters":{"fromEmail":"no-reply@kdigi.app","toEmail":"={{ $json[\"body\"][\"email\"] }}","bccEmail":"khoilq@kdigi.vn","subject":"Ch√∫ng t√¥i ƒë√£ nh·∫≠n ƒë∆∞·ª£c y√™u c·∫ßu c·ªßa b·∫°n","html":"=Xin ch√†o {{ $json[\"body\"][\"name\"] }},\n<br>\n<br>\nCh√∫ng t√¥i v·ª´a nh·∫≠n ƒë∆∞·ª£c y√™u c·∫ßu ƒëƒÉng k√Ω kho√° h·ªçc <b>{{ $json[\"body\"][\"course\"] }}</b> c·ªßa b·∫°n.\n<br>\nCh√∫ng t√¥i s·∫Ω li√™n h·ªá v·ªõi b·∫°n qua s·ªë ƒëi·ªán tho·∫°i <b>{{ $json[\"body\"][\"phone\"] }}</b> trong v√≤ng 30 ph√∫t t·ªõi.\n<br>\n<br>\nRegards!","options":{}},"id":"cc12a5e7-07f5-4bfc-8dca-7a7cf022a125","name":"Send Email","type":"n8n-nodes-base.emailSend","typeVersion":1,"position":[1320,480],"credentials":{"smtp":{"id":"8","name":"SMTP account"}}},{"parameters":{"method":"POST","url":"https://hook.us1.make.com/dwjyo54isy34uha5ght48m5q23ey34bi","sendBody":true,"bodyParameters":{"parameters":[{"name":"name","value":"={{ $json[\"body\"][\"name\"] }}"},{"name":"phone","value":"={{ $json[\"body\"][\"phone\"] }}"},{"name":"course","value":"={{ $json[\"body\"][\"course\"] }}"}]},"options":{}},"id":"6944d72f-5c21-45dd-ae8d-175106822864","name":"Send SMS on Make","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[1320,680]}],"connections":{"Webhook":{"main":[[{"node":"Send Email","type":"main","index":0},{"node":"Send SMS on Make","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{},"versionId":"77ed5e29-087c-4d63-833c-21d6ab4c578a","triggerCount":1,"tags":[{"createdAt":"2023-01-13T06:02:40.778Z","updatedAt":"2023-01-13T06:02:40.778Z","id":"3","name":"Test Kho√° h·ªçc"}]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-01-13T06:02:50.170Z","updatedAt":"2023-01-13T06:37:22.000Z","id":"10","name":"Nh·∫≠n mail","active":false,"nodes":[{"parameters":{"options":{"customEmailConfig":"[\"UNSEEN\"]"}},"id":"e53ad97f-a062-443e-b692-001dfaec0b08","name":"Email Trigger (IMAP)","type":"n8n-nodes-base.emailReadImap","typeVersion":2,"position":[1100,580],"credentials":{"imap":{"id":"9","name":"IMAP account: no-reply@kdigi.app"}}},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/bitable/v1/apps/basusgEO8Qxw77dRoJyBvuPPh8e/tables/tbl8JGY8bvtfZFE6/records","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $json[\"access_token\"] }}"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\n  \"fields\": {\n     \"content\": \"Kh√¥i\",\n  }\n}","options":{}},"id":"62412b7f-fd8b-421d-b309-0ae8e8db0396","name":"HTTP Request","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[1540,580]},{"parameters":{"documentId":{"__rl":true,"value":"1RDBBTEXxrC07DE8hjVFYrhIzz5h9BHhojcFhgZDOBxU","mode":"list","cachedResultName":"Lark Connector Token","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1RDBBTEXxrC07DE8hjVFYrhIzz5h9BHhojcFhgZDOBxU/edit?usp=drivesdk"},"sheetName":{"__rl":true,"value":"gid=0","mode":"list","cachedResultName":"Kdigivn","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1RDBBTEXxrC07DE8hjVFYrhIzz5h9BHhojcFhgZDOBxU/edit#gid=0"},"filtersUI":{"values":[{"lookupColumn":"key","lookupValue":"lark_key"}]},"options":{}},"id":"15b07782-4553-47af-9ff0-47cfea3c79ee","name":"Google Sheets","type":"n8n-nodes-base.googleSheets","typeVersion":3,"position":[1320,580],"credentials":{"googleSheetsOAuth2Api":{"id":"3","name":"Google Sheets lekhoi456@gmail.com"}}}],"connections":{"Email Trigger (IMAP)":{"main":[[{"node":"Google Sheets","type":"main","index":0}]]},"Google Sheets":{"main":[[{"node":"HTTP Request","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{"Email Trigger (IMAP)":[{"json":{"textHtml":"<div id=\"editor_version_1.23.1_etm1E7TG\" style=\"word-break:break-word;\"><div data-zone-id=\"0\" data-line-index=\"0\" data-line=\"true\" style=\"margin-top: 4px; margin-bottom: 4px; line-height: 1.6;\"><div style=\"font-size: 14px;\">T√¥i l√† Kh√¥i\r\n</div></div></div>","textPlain":"T√¥i l√† Kh√¥i","metadata":{"authentication-results":"lms; spf=softfail (client-ip:209.127.231.40) smtp.mailfrom=khoilq@kdigi.vn; dkim=pass header.i=@kdigi-vn.20200929.dkim.larksuite.com; dmarc=none","delivered-to":"no-reply@kdigi.app","x-lms-client-ip":"209.127.231.40","x-lms-mail-from":"khoilq@kdigi.vn","received-spf":"softfail (lms verify) identity=mailfrom; client-ip=209.127.231.40; helo=t04.bc.larksuite.com; envelope-from=khoilq@kdigi.vn; receiver=<UNKNOWN>;","dkim-signature":"v=1; a=rsa-sha256; q=dns/txt; c=relaxed/relaxed; s=s1; d=kdigi-vn.20200929.dkim.larksuite.com; t=1673590047;  h=from:subject:mime-version:from:date:message-id:subject:to:cc: reply-to:content-type:mime-version:in-reply-to:message-id; bh=a2wwNwqv4Vtl24UhutzC+4vtthNWTA5Y6pH8rRjzfa8=; b=nvprF980lHkvaJOSjyabP44yteu1ovQsOI9D7emyC6udMYiveoxX08PdqLbPswaeJBp6NW fbVTEpnLdonIOuWZ+2YgzOPSsjnC4vhkg7ep4smwDmYYqO45o5tY08begcztAPExaL2edC lN/Bm9hdLOpOGDx1klLvMYpTMh07ZSKBz/hLC3ZBvQ0mX51G9GC0WtnVd0PBFIDHMRaORU Sx/Cp3Q1Rt9FoJxZM6DyHdS6EPcpSL7ireKtzp36LYSwLkTKn7mG/pdOeDBkc6V1OpttNf fKGGJVDSKo0fzuUJum0h41UtYoc5Vj58zPYCIpAty77voth7AYitbUqHpP5tXg==","mime-version":"1.0","x-lms-return-path":"<lba+163c0f515+4fd278+kdigi.app+khoilq@kdigi.vn>","message-id":"<02eacd2b4f9400228ed59f9395eb5c327d5b4452.73ea0f1e.18ea.4437.841a.6acce79b3357@larksuite.com>","content-type":"multipart/alternative; boundary=aef08b5c0f3fd30c0807fe34121074ae298affea065ac613085543d2ed76"},"subject":"Xin ch√†o","from":"\"Le Quoc Khoi\" <khoilq@kdigi.vn>","to":"\"No-Reply KDIGI.App\" <no-reply@kdigi.app>","date":"Fri, 13 Jan 2023 06:07:17 +0000"}}],"Google Sheets":[{"json":{"row_number":2,"key":"lark_key","access_token":"u-055Rl0VHN8iWbArKuTpEHRR1ibIhhhS9VOw055sw2I5A","expires_in":6900,"refresh_token":"ur-1xXIqOUyB9PEaqvWiua_YvR1gbehhhYxUyw0k4ow2I0w","refresh_expires_in":2591700}}]},"versionId":"ab37b2e9-ec5d-4389-b1d2-e02f02fc3fe3","triggerCount":0,"tags":[{"createdAt":"2023-01-13T06:02:40.778Z","updatedAt":"2023-01-13T06:02:40.778Z","id":"3","name":"Test Kho√° h·ªçc"}]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-01-15T07:54:50.213Z","updatedAt":"2023-01-15T07:54:50.213Z","id":"11","name":"My workflow 4","active":false,"nodes":[{"parameters":{"path":"73c1f93e-fabc-4e48-a7d0-7a4d4f1c5802","options":{}},"id":"b04381d0-1234-4d3d-9fb1-bc0060e38727","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[840,500],"webhookId":"73c1f93e-fabc-4e48-a7d0-7a4d4f1c5802"},{"parameters":{"command":"node -v"},"id":"724162cb-cfce-4594-b74a-56e97a1ad0c3","name":"SSH","type":"n8n-nodes-base.ssh","typeVersion":1,"position":[1060,500],"credentials":{"sshPassword":{"id":"10","name":"SSH: 103.195.238.68"}}}],"connections":{"Webhook":{"main":[[{"node":"SSH","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{},"versionId":"21299b98-5cfb-44f2-9924-36a04a7331f9","triggerCount":0,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-01-15T09:33:37.401Z","updatedAt":"2023-03-06T08:00:35.000Z","id":"12","name":"Th√¥ng b√°o email Tuy·ªÉn d·ª•ng","active":true,"nodes":[{"parameters":{"downloadAttachments":true,"options":{"customEmailConfig":"[\"UNSEEN\"]"}},"id":"fa3efd89-15e2-4e47-b55f-57b4d63530e1","name":"Email Trigger (IMAP)","type":"n8n-nodes-base.emailReadImap","typeVersion":2,"position":[840,500],"credentials":{"imap":{"id":"11","name":"IMAP: tuyendung@kdigi.vn"}}},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/bot/v2/hook/797fd581-415c-410d-9a59-bbab67d45456","sendBody":true,"specifyBody":"json","jsonBody":"={\n    \"msg_type\": \"interactive\",\n    \"card\": {\n        \"config\": {\n                \"wide_screen_mode\": true,\n                \"enable_forward\": true\n        },\n        \"elements\": [{\n                \"tag\": \"div\",\n                \"text\": {\n                        \"content\": \"T·ª´: **{{ $node[\"Email Trigger (IMAP)\"].json[\"from\"] }}**\\nTi√™u ƒë·ªÅ: **{{ $node[\"Email Trigger (IMAP)\"].json[\"subject\"] }}**\\n\" ,\n                        \"tag\": \"lark_md\"\n                }\n        }],\n        \"header\": {\n                \"title\": {\n                        \"content\": \"ƒê√£ nh·∫≠n ƒë∆∞·ª£c m·ªôt h·ªì s∆° ·ª©ng tuy·ªÉn m·ªõi\",\n                        \"tag\": \"plain_text\"\n                }\n        }\n    }\n}","options":{}},"id":"2c9c0eae-7666-49ef-ad0f-fb0594134eec","name":"HTTP Request","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[1300,480]},{"parameters":{"conditions":{"string":[{"value1":"={{ $json[\"subject\"] }}","operation":"contains","value2":"Apply"}]}},"id":"e67de8d2-227a-4923-8a34-71e77615043a","name":"Subject cointains \"Apply\"","type":"n8n-nodes-base.if","typeVersion":1,"position":[1060,500]}],"connections":{"Email Trigger (IMAP)":{"main":[[{"node":"Subject cointains \"Apply\"","type":"main","index":0}]]},"Subject cointains \"Apply\"":{"main":[[{"node":"HTTP Request","type":"main","index":0}]]}},"settings":{},"staticData":{"node:Email Trigger (IMAP)":{"lastMessageUid":5}},"pinData":{"Email Trigger (IMAP)":[{"json":{"textHtml":"<div dir=\"ltr\"><div class=\"gmail_default\" style=\"font-family:tahoma,sans-serif;font-size:small;color:#000000\">Dear Qu√Ω c√¥ng ty,</div><div class=\"gmail_default\" style=\"font-family:tahoma,sans-serif;font-size:small;color:#000000\"><br></div><div class=\"gmail_default\" style=\"font-family:tahoma,sans-serif;font-size:small;color:#000000\">[ƒê√¢y l√† ph·∫ßn n·ªôi dung m√† ·ª©ng vi√™n g·ª≠i]</div><div><br></div><div><div class=\"gmail_default\" style=\"font-family:tahoma,sans-serif;font-size:small;color:rgb(0,0,0)\">Regards!</div><br></div>-- <br><div dir=\"ltr\" class=\"gmail_signature\" data-smartmail=\"gmail_signature\"><div dir=\"ltr\"><div dir=\"ltr\"><div dir=\"ltr\"><div dir=\"ltr\"><div dir=\"ltr\"><div dir=\"ltr\"><div style=\"margin:0px;padding:0px;border:0px;font-stretch:inherit;line-height:inherit;vertical-align:baseline;color:rgb(0,0,0)\"><div style=\"margin:0px;padding:0px;border:0px;font-stretch:inherit;line-height:inherit;vertical-align:baseline\"><span style=\"color:inherit;font-style:inherit;font-family:arial,sans-serif\"><b><span style=\"font-size:x-small;font-family:tahoma,sans-serif\"></span>Le Quoc Khoi (Mr.)</b></span><br></div><div style=\"margin:0px;padding:0px;border:0px;font-stretch:inherit;line-height:inherit;vertical-align:baseline\"><div style=\"margin:0px;padding:0px;border:0px;font-style:inherit;font-variant:inherit;font-weight:inherit;font-stretch:inherit;line-height:inherit;vertical-align:baseline;color:inherit\"><font face=\"arial, sans-serif\">DevOps Engineer</font></div></div><div style=\"margin:0px;padding:0px;border:0px;font-stretch:inherit;line-height:inherit;vertical-align:baseline\"><font face=\"arial, sans-serif\"><span style=\"margin:0px;padding:0px;border:0px;font-style:inherit;font-variant:inherit;font-weight:inherit;font-stretch:inherit;line-height:inherit;vertical-align:baseline;color:inherit\"></span><span style=\"margin:0px;padding:0px;border:0px;font-style:inherit;font-variant:inherit;font-weight:inherit;font-stretch:inherit;line-height:inherit;vertical-align:baseline;color:inherit\">Tel: <a href=\"http://+84333111868\" target=\"_blank\">+84333111868</a></span><br></font></div><font face=\"arial, sans-serif\"><span style=\"margin:0px;padding:0px;border:0px;font-stretch:inherit;line-height:inherit;vertical-align:baseline;color:rgb(50,49,48)\"></span><span style=\"color:rgb(50,49,48)\"></span></font><div style=\"margin:0px;padding:0px;border:0px;font-stretch:inherit;line-height:inherit;vertical-align:baseline\"><font face=\"arial, sans-serif\"><span style=\"margin:0px;padding:0px;border:0px;font-style:inherit;font-variant:inherit;font-weight:inherit;font-stretch:inherit;line-height:inherit;vertical-align:baseline;color:inherit\">Website:¬†<span style=\"font-family:tahoma,sans-serif\"><a href=\"http://khoi.com.vn\" target=\"_blank\">khoi.com.vn</a></span></span></font></div></div><div style=\"margin:0px;padding:0px;border:0px;font-stretch:inherit;line-height:inherit;vertical-align:baseline;color:rgb(0,0,0)\"><p style=\"margin:0px;color:rgb(34,34,34)\"><font face=\"arial, sans-serif\" size=\"1\"><b><span style=\"margin:0px;padding:0px;border:0px;font-style:inherit;font-variant:inherit;font-weight:inherit;font-stretch:inherit;line-height:inherit;vertical-align:baseline;color:black;background-image:initial;background-position:initial;background-repeat:initial\">Disclaimer, limitation of liability, and copyright</span></b><span style=\"margin:0px;padding:0px;border:0px;font-style:inherit;font-variant:inherit;font-weight:inherit;font-stretch:inherit;line-height:inherit;vertical-align:baseline;color:rgb(31,73,125)\"><u></u><u></u></span></font></p><p style=\"margin:0px;color:rgb(34,34,34)\"><span style=\"margin:0px;padding:0px;border:0px;font-variant:inherit;font-weight:inherit;font-stretch:inherit;line-height:inherit;vertical-align:baseline;color:black;background-image:initial;background-position:initial;background-repeat:initial\"><font face=\"arial, sans-serif\" size=\"1\"><i>This message and any files transmitted with it are intended only for the persons to whom it is addressed and may be legally privileged and/or confidential. If you are not the addressee or have received this message in error, you may not disclose, copy, distribute, take action on, or omit action based on the contents thereof. If you are not the addressee or have received this message in error please destroy it and notify the sender immediately. Any unauthorized use or disclosure is prohibited and may be unlawful.</i></font></span></p></div></div><div dir=\"ltr\"><span></span><span></span></div></div></div></div></div></div></div></div>\r\n","textPlain":"Dear Qu√Ω c√¥ng ty,\r\n\r\n[ƒê√¢y l√† ph·∫ßn n·ªôi dung m√† ·ª©ng vi√™n g·ª≠i]\r\n\r\nRegards!\r\n\r\n-- \r\n*Le Quoc Khoi (Mr.)*\r\nDevOps Engineer\r\nTel: +84333111868\r\nWebsite: khoi.com.vn\r\n\r\n*Disclaimer, limitation of liability, and copyright*\r\n\r\n*This message and any files transmitted with it are intended only for the\r\npersons to whom it is addressed and may be legally privileged and/or\r\nconfidential. If you are not the addressee or have received this message in\r\nerror, you may not disclose, copy, distribute, take action on, or omit\r\naction based on the contents thereof. If you are not the addressee or have\r\nreceived this message in error please destroy it and notify the sender\r\nimmediately. Any unauthorized use or disclosure is prohibited and may be\r\nunlawful.*\r\n","metadata":{"authentication-results":"lms; spf=pass (client-ip:209.85.222.180) smtp.mailfrom=lekhoi456@gmail.com; dkim=pass header.i=@gmail.com; dmarc=pass (p=none sp=quarantine dis=none) header.from=gmail.com","x-fangmail-anti-spam-filtered":"true","x-fangmail-miltered":"at n100-022-169 with ID 63C3C469.000 by FangMail milter!","x-lms-egress-gw":"EgressFangMail","x-fangmail-gw-spam-type":"0","x-fangmail-envelope":"1673774185/4NvqK54KFSzRXcl0/63C3C469.000/209.85.222.180/mail-qk1-f180.google.com/localhost/<lekhoi456@gmail.com>","x-fangmail-mid-qid":"63C3C469.000/4NvqK54KFSzRXcl0","delivered-to":"tuyendung@kdigi.vn","x-lms-client-ip":"209.85.222.180","x-lms-mail-from":"lekhoi456@gmail.com","received-spf":"pass (lms verify) identity=mailfrom; client-ip=209.85.222.180; helo=mail-qk1-f180.google.com; envelope-from=lekhoi456@gmail.com; receiver=<UNKNOWN>;","received":"by mail-qk1-f180.google.com with SMTP id pe2so12927470qkn.1        for <tuyendung@kdigi.vn>; Sun, 15 Jan 2023 01:16:24 -0800 (PST)","dkim-signature":"v=1; a=rsa-sha256; c=relaxed/relaxed;        d=gmail.com; s=20210112;        h=to:subject:message-id:date:from:mime-version:from:to:cc:subject         :date:message-id:reply-to;        bh=sPAJeqSIhcw6qA1llvAsHoQYNvZYyunL5Sm33m4b5cs=;        b=QvLUibseOPATqt4jdycJvRXaQ+fiDSThWtOdV+W8jBuQpqUQEef+ixiIGOfVCbPIlA         rNy6CLa/wp1QHS/fYGRkeOdnDQL80+thBrQCGLQ1l+FguUXxASWQya18UMb92eGsakCt         cgkXN1x87L9kS3K61IjQ5cD1OW5v/9v40RWsAd6ZiGSlcQzoFJ3866GzwIncTpO124pD         M2lGI5Tgvy7TGfONSVVx0qLf+1LP7uISibmZbMp0Z/y6FIpLB5ZoZdJ6MvGUSzZnOhzZ         0Tf1ybU+Vl70ymAFRwbLhfEATdn2FtpvZQQSYYXN5fZjQUXWZcew7szElFrxoyIgFeca         PPdg==","x-google-dkim-signature":"v=1; a=rsa-sha256; c=relaxed/relaxed;        d=1e100.net; s=20210112;        h=to:subject:message-id:date:from:mime-version:x-gm-message-state         :from:to:cc:subject:date:message-id:reply-to;        bh=sPAJeqSIhcw6qA1llvAsHoQYNvZYyunL5Sm33m4b5cs=;        b=hK6n+NdsG2tQKlNEgVJOWDGdUE7Mo2BV9/rVUYyDxonUGNE0RGSGjG4724wDf1fxZP         xCOe6E1iY4iJ9RVlWdgPYyGFXm4E2lO13ZktgJQDVHUG73BNz2DH0W6LqhdJzJR+BuiM         ozEScQ5fUOO0kCzb2pPAGsrzx5Db12vqyC1KMHmVQo4sg2fm1Z18d1zBfEqH9qMpsY4w         N6ETwYAI3LK5BU2Hi+cDEgOj6EpSDeQD8SmCfGiKkF2C3YUriSgP5/JN35gQqpbg3GPU         28quyVS+f05sSQcmdonWXqm+wQJFw2FsaGssjtBsOCtoKaOnNgu05mNkhU0fNHTIKG73         hJMQ==","x-gm-message-state":"AFqh2krMtvNE2AhNFxLoFrYCmEsEXpUzMHi0Vswmui2DHUldsNCXlflf\tDNfawJ/cEZAfhQ1mzZTh4p4Y8MiL/hcx1YmVLBQUkPZC8m8BJ4QB","x-google-smtp-source":"AMrXdXvS2pDLMTotyfTqFT5HZ3K7abK3pSm+3qH3P23Iw89og/T5Rbfi3df7v3qeHhMRzNloAVWRh1ZelX9LD/OloU8=","x-received":"by 2002:a37:746:0:b0:706:4e95:1ecc with SMTP id 67-20020a370746000000b007064e951eccmr115992qkh.189.1673774183674; Sun, 15 Jan 2023 01:16:23 -0800 (PST)","mime-version":"1.0","message-id":"<CALsvCd0+YDzZs82w00dysVVUcGrrpF+rejAptoSjq9SbQ47FQg@mail.gmail.com>","content-type":"multipart/mixed; boundary=\"000000000000a73d2d05f249eb8f\"","x-lms-gw-filter":"true"},"subject":"[Apply] ·ª®ng tuy·ªÉn v·ªã tr√≠ Senior DevOps","from":"Le Khoi <lekhoi456@gmail.com>","to":"tuyendung@kdigi.vn","date":"Sun, 15 Jan 2023 16:16:12 +0700"}}]},"versionId":"2f459ba2-63bf-4e3a-85e5-da834ff7adf1","triggerCount":1,"tags":[{"createdAt":"2023-01-05T09:55:57.214Z","updatedAt":"2023-01-05T09:55:57.214Z","id":"1","name":"Lark"},{"createdAt":"2023-01-15T09:33:57.136Z","updatedAt":"2023-01-15T09:33:57.136Z","id":"4","name":"Demo Ms. Quy√™n"}]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-01-17T12:42:38.715Z","updatedAt":"2023-01-17T16:21:48.000Z","id":"13","name":"Send email s·ª± ki·ªán","active":true,"nodes":[{"parameters":{"fromEmail":"KDIGI <no-reply@kdigi.app>","toEmail":"={{ $json[\"body\"][\"email\"] }}","bccEmail":"automation@kdigi.app","subject":"=Ch√∫c m·ª´ng b·∫°n ƒë√£ ƒëƒÉng k√Ω tham gia th√†nh c√¥ng s·ª± ki·ªán {{ $json[\"body\"][\"event\"] }}","html":"=Xin ch√†o {{ $node[\"Nh·∫≠n data t·ª´ Bitable Form\"].json[\"body\"][\"name\"] }},\n<br><br>\nCh√∫ng t√¥i x√°c nh·∫≠n r·∫±ng b·∫°n ƒë√£ ƒëƒÉng k√Ω tham gia s·ª± ki·ªán {{ $node[\"Nh·∫≠n data t·ª´ Bitable Form\"].json[\"body\"][\"event\"] }} c·ªßa ch√∫ng t√¥i ƒë∆∞·ª£c t·ªï ch·ª©c v√†o {{ $node[\"Nh·∫≠n data t·ª´ Bitable Form\"].json[\"body\"][\"start_date\"] }} ƒë·∫øn {{ $node[\"Nh·∫≠n data t·ª´ Bitable Form\"].json[\"body\"][\"end_date\"] }}.\n<br><br>\nƒê√¢y l√† link check-in khi ƒë·∫øn s·ª± ki·ªán: <a href=\"http://{{ $node[\"Nh·∫≠n data t·ª´ Bitable Form\"].json[\"body\"][\"link_checkin\"] }}\">Check-in {{ $node[\"Nh·∫≠n data t·ª´ Bitable Form\"].json[\"body\"][\"event\"] }}</a>\n<br><br>\nKDIGI\nRegards!","options":{}},"id":"bd7baa30-1410-47c6-86e5-d3626d53488e","name":"G·ª≠i email cho kh√°ch","type":"n8n-nodes-base.emailSend","typeVersion":1,"position":[1060,500],"credentials":{"smtp":{"id":"8","name":"SMTP account: no-reply@kdigi.app"}}},{"parameters":{"httpMethod":"POST","path":"su-kien-tmdt","options":{}},"id":"27a8c91d-5f74-483f-b68a-aa4bd19272e1","name":"Nh·∫≠n data t·ª´ Bitable Form","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[840,500],"webhookId":"5a8216e4-a5ef-40d3-af5a-b2005e3909ae"},{"parameters":{"conditions":{"string":[{"value1":"={{ $json[\"response\"] }}","operation":"contains","value2":"250"}]}},"id":"6dda34de-7c31-4d7f-af08-d342cc9026da","name":"N·∫øu kh√¥ng c√≥ l·ªói g·ª≠i email","type":"n8n-nodes-base.if","typeVersion":1,"position":[1280,500]},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/bot/v2/hook/f41f1a16-10e7-4d9e-af0b-65b53376d37c","sendBody":true,"specifyBody":"json","jsonBody":"={\n    \"msg_type\": \"interactive\",\n    \"card\": {\n        \"config\": {\n                \"wide_screen_mode\": true,\n                \"enable_forward\": true\n        },\n        \"elements\": [{\n                \"tag\": \"div\",\n                \"text\": {\n                        \"content\": \"Email: **{{ $node[\"Nh·∫≠n data t·ª´ Bitable Form\"].json[\"body\"][\"email\"] }}**\\n\" ,\n                        \"tag\": \"lark_md\"\n                }\n        }],\n        \"header\": {\n                \"title\": {\n                        \"content\": \"Kh√¥ng th·ªÉ g·ª≠i email ƒë·∫øn kh√°ch\",\n                        \"tag\": \"plain_text\"\n                }\n        }\n    }\n}","options":{}},"id":"568438c8-45c9-4767-80d4-b2deb1f2b8cf","name":"G·ª≠i l·ªói v·ªÅ Lark Bot","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[1480,660]},{"parameters":{"method":"POST","url":"https://hook.us1.make.com/tojkhh2brg2phuru8qwslo9r5bwasx3y","sendBody":true,"contentType":"multipart-form-data","bodyParameters":{"parameters":[{"name":"event","value":"={{ $json[\"body\"][\"event\"] }}"},{"name":"=name","value":"={{ $json[\"body\"][\"name\"] }}"},{"name":"phone","value":"={{ $json[\"body\"][\"phone\"] }}"},{"name":"email","value":"={{ $json[\"body\"][\"email\"] }}"},{"name":"start_date","value":"={{ $json[\"body\"][\"start_date\"] }}"},{"name":"end_date","value":"={{ $json[\"body\"][\"end_date\"] }}"},{"name":"link_checkin","value":"={{ $json[\"body\"][\"link_checkin\"] }}"},{"name":"event_id","value":"={{ $json[\"body\"][\"event_id\"] }}"}]},"options":{}},"id":"1f8add79-8316-44aa-aaba-48a59c2933d9","name":"MAKE: Th√™m kh√°ch v√†o s·ª± ki·ªán","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[1060,280]}],"connections":{"G·ª≠i email cho kh√°ch":{"main":[[{"node":"N·∫øu kh√¥ng c√≥ l·ªói g·ª≠i email","type":"main","index":0}]]},"Nh·∫≠n data t·ª´ Bitable Form":{"main":[[{"node":"G·ª≠i email cho kh√°ch","type":"main","index":0},{"node":"MAKE: Th√™m kh√°ch v√†o s·ª± ki·ªán","type":"main","index":0}]]},"N·∫øu kh√¥ng c√≥ l·ªói g·ª≠i email":{"main":[[{"node":"G·ª≠i l·ªói v·ªÅ Lark Bot","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{"Nh·∫≠n data t·ª´ Bitable Form":[{"json":{"headers":{"host":"app.n8n.vn","user-agent":"Go-http-client/2.0","content-length":"1155","accept-encoding":"gzip","content-type":"multipart/form-data; boundary=b1973e1e07b01c388d11aa03bf2e22311e138721b47d48bb548adc6be366","x-forwarded-for":"3.211.55.69","x-forwarded-host":"app.n8n.vn","x-forwarded-port":"443","x-forwarded-proto":"https","x-forwarded-server":"af4013275608","x-real-ip":"3.211.55.69","x-tt-logid":"02167396254081200000000000000000000ffffadd013cd8e750c"},"params":{},"query":{},"body":{"event":"B√πng n·ªï TMƒêT 2023","name":"Kh√¥i","phone":"0333111868","email":"kdigiseo@gmail.com","start_date":"2023/01/18 08:30","end_date":"2023/01/18 17:30","link_checkin":"t.ly/check-in-tmdt-2023","event_id":"NDI3Z2syNTc1MDU5NG52cmYwbThpbnRkbHQgbGVraG9pNDU2QG0"}}}]},"versionId":"13fe1195-3690-4fb3-a1c1-cbd8a3fcbaa1","triggerCount":1,"tags":[{"createdAt":"2023-01-05T09:55:57.214Z","updatedAt":"2023-01-05T09:55:57.214Z","id":"1","name":"Lark"},{"createdAt":"2023-01-15T09:33:57.136Z","updatedAt":"2023-01-15T09:33:57.136Z","id":"4","name":"Demo Ms. Quy√™n"}]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-01-17T16:22:11.635Z","updatedAt":"2023-01-17T17:32:31.000Z","id":"14","name":"Check in s·ª± ki·ªán","active":true,"nodes":[{"parameters":{"httpMethod":"POST","path":"checkin-su-kien","options":{}},"id":"773a713d-53da-459b-9c82-4a341de9faad","name":"Nh·∫≠n data t·ª´ Bitable","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[840,500],"webhookId":"50950d41-1e5b-431f-9e76-2af0b7f18d15"},{"parameters":{"fromEmail":"KDIGI <no-reply@kdigi.app>","toEmail":"={{ $json[\"body\"][\"email\"] }}","bccEmail":"automation@kdigi.app","subject":"ƒê√£ check-in th√†nh c√¥ng","html":"=Xin ch√†o {{ $json[\"body\"][\"name\"] }},\n<br><br>\nCh√∫c m·ª´ng b·∫°n ƒë√£ check-in th√†nh c√¥ng s·ª± ki·ªán {{ $json[\"body\"][\"event\"] }}\n<br><br>\nM√£ s·ªë d·ª± th∆∞·ªüng c·ªßa b·∫°n l√†: {{ $json[\"body\"][\"code\"] }}\n<br><br>\nVui l√≤ng cho ch√∫ng t√¥i feedback v·ªÅ s·ª± ki·ªán n√†y t·∫°i ƒë√¢y: <a href=\"http://{{ $json[\"body\"][\"link_feedback\"] }}\">{{ $json[\"body\"][\"link_feedback\"] }}</a>\n<br><br>\nRegards!","options":{}},"id":"ca05784e-7734-4f28-a21a-6dea4e34a141","name":"Send Email","type":"n8n-nodes-base.emailSend","typeVersion":1,"position":[1060,500],"credentials":{"smtp":{"id":"8","name":"SMTP account: no-reply@kdigi.app"}}}],"connections":{"Nh·∫≠n data t·ª´ Bitable":{"main":[[{"node":"Send Email","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{"Nh·∫≠n data t·ª´ Bitable":[{"json":{"headers":{"host":"app.n8n.vn","user-agent":"Go-http-client/2.0","content-length":"841","accept-encoding":"gzip","content-type":"multipart/form-data; boundary=f3458b4ce97d7376da0654994e37080ee92f3162ea5baaf5c63084b729cd","x-forwarded-for":"3.211.55.69","x-forwarded-host":"app.n8n.vn","x-forwarded-port":"443","x-forwarded-proto":"https","x-forwarded-server":"af4013275608","x-real-ip":"3.211.55.69","x-tt-logid":"02167397640119500000000000000000000ffff41c94bbf50a30e"},"params":{},"query":{},"body":{"name":"Kh√¥i","phone":"0333111868","email":"kdigiseo@gmail.com","event":"B√πng n·ªï TMƒêT 2023","code":"TMDT0010","link_feedback":"t.ly/feedback-tmdt-2023"}}}]},"versionId":"ed7650a1-703f-4b8c-97a7-ac7e3a15e226","triggerCount":1,"tags":[{"createdAt":"2023-01-05T09:55:57.214Z","updatedAt":"2023-01-05T09:55:57.214Z","id":"1","name":"Lark"},{"createdAt":"2023-01-15T09:33:57.136Z","updatedAt":"2023-01-15T09:33:57.136Z","id":"4","name":"Demo Ms. Quy√™n"}]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-01-17T17:33:31.042Z","updatedAt":"2023-01-17T17:39:27.000Z","id":"15","name":"Feedback s·ª± ki·ªán","active":true,"nodes":[{"parameters":{"httpMethod":"POST","path":"feedback-khoa-hoc","options":{}},"id":"487b12a5-e316-400a-8437-5cbc2e8621a2","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[840,500],"webhookId":"cf34b5e5-09fd-4b8c-9693-249491b1adbc"},{"parameters":{"fromEmail":"KDIGI <no-reply@kdigi.app>","toEmail":"={{ $json[\"body\"][\"email\"] }}","bccEmail":"automation@kdigi.app","subject":"Ch√∫ng t√¥i ƒë√£ nh·∫≠n ƒë∆∞·ª£c feedback c·ªßa b·∫°n","html":"=Xin ch√†o {{ $json[\"body\"][\"name\"] }},\n<br><br>\nCh√∫ng t√¥i ƒë√£ nh·∫≠n ƒë∆∞·ª£c feedback c·ªßa b·∫°n cho s·ª± ki·ªán {{ $json[\"body\"][\"event\"] }}.\n<br>\nƒê√°nh gi√°: {{ $json[\"body\"][\"rating\"] }}\n<br>\n{{ $json[\"body\"][\"unsatisfied\"] }}\n<br>\n{{ $json[\"body\"][\"feedback\"] }}\n<br><br>\nCh√∫ng t√¥i ƒë√£ ghi nh·∫≠n s·ª± ƒë√≥ng g√≥p ch√¢n th√†nh c·ªßa b·∫°n.\n<br><br>\nRegards!","options":{}},"id":"12daf870-b059-4824-9d34-b0718d9b9680","name":"Send Email","type":"n8n-nodes-base.emailSend","typeVersion":1,"position":[1060,500],"credentials":{"smtp":{"id":"8","name":"SMTP account: no-reply@kdigi.app"}}}],"connections":{"Webhook":{"main":[[{"node":"Send Email","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{"Webhook":[{"json":{"headers":{"host":"app.n8n.vn","user-agent":"Go-http-client/2.0","content-length":"956","accept-encoding":"gzip","content-type":"multipart/form-data; boundary=da5aaa8001dc045882a7a764c7c0630f6ddc810ff842bf2a7bc90d0d1f48","x-forwarded-for":"3.211.55.69","x-forwarded-host":"app.n8n.vn","x-forwarded-port":"443","x-forwarded-proto":"https","x-forwarded-server":"af4013275608","x-real-ip":"3.211.55.69","x-tt-logid":"02167397700758900000000000000000000ffffa91578cadb3328"},"params":{},"query":{},"body":{"name":"Kh√¥i","phone":"0333111868","email":"kdigiseo@gmail.com","event":"B√πng n·ªï TMƒêT 2023","rating":"1 sao","unsatisfied":"phi·ªÅn","feedback":"c·∫ßn thay ƒë·ªïi"}}}]},"versionId":"9cef52fa-bb4b-42c4-a502-0d7a7b2fc11d","triggerCount":1,"tags":[{"createdAt":"2023-01-15T09:33:57.136Z","updatedAt":"2023-01-15T09:33:57.136Z","id":"4","name":"Demo Ms. Quy√™n"}]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-01-17T17:50:31.405Z","updatedAt":"2023-01-17T18:10:23.000Z","id":"16","name":"G·ª≠i BTVN","active":true,"nodes":[{"parameters":{"httpMethod":"POST","path":"btvn-su-kien","options":{}},"id":"f277006e-9c9e-4ae6-a607-f99665d8981a","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[840,500],"webhookId":"a448b34e-34b2-46d8-a011-083b16074102"},{"parameters":{"fromEmail":"KDIGI <no-reply@kdigi.app>","toEmail":"={{ $json[\"body\"][\"email\"] }}","bccEmail":"automation@kdigi.app","subject":"=B√†i t·∫≠p c·∫ßn ho√†n th√†nh cho s·ª± ki·ªán  {{ $json[\"body\"][\"event\"] }}","html":"=Xin ch√†o b·∫°n,\n<br><br>\nXin m·ªùi b·∫°n l√†m b√†i t·∫≠p cho s·ª± ki·ªán {{ $json[\"body\"][\"event\"] }}\n<br>\nVui l√≤ng l√†m b√†i t·∫≠p qua link sau: <a href=\"http://{{ $json[\"body\"][\"ex\"] }}\">{{ $json[\"body\"][\"ex\"] }}</a>\n<br><br>\nN·∫øu c√≥ b·∫•t k·ª≥ th·∫Øc m·∫Øc n√†o, vui l√≤ng tham gia group ƒë·ªÉ th·∫£o lu·∫≠n: <a href=\"http://{{ $json[\"body\"][\"link_group\"] }}\">{{ $json[\"body\"][\"link_group\"] }}</a>\n<br><br>\nRegards!","options":{}},"id":"650a24e5-a404-468f-a65e-bdfe8119a820","name":"Send Email","type":"n8n-nodes-base.emailSend","typeVersion":1,"position":[1060,500],"credentials":{"smtp":{"id":"8","name":"SMTP account: no-reply@kdigi.app"}}}],"connections":{"Webhook":{"main":[[{"node":"Send Email","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{"Webhook":[{"json":{"headers":{"host":"app.n8n.vn","user-agent":"Go-http-client/2.0","content-length":"613","accept-encoding":"gzip","content-type":"multipart/form-data; boundary=cf869f4928addf9ffb5fc75275e14709564c77624c0b89da852dfba18830","x-forwarded-for":"3.211.55.69","x-forwarded-host":"app.n8n.vn","x-forwarded-port":"443","x-forwarded-proto":"https","x-forwarded-server":"af4013275608","x-real-ip":"3.211.55.69","x-tt-logid":"02167397886456000000000000000000000ffff41c94bbfb5389e"},"params":{},"query":{},"body":{"email":"kdigiseo@gmail.com, n8n.kdigi@gmail.com","event":"B√πng n·ªï TMƒêT 2023","ex":"t.ly/_iYQ","link_group":"t.ly/group-tmdt-2023"}}}]},"versionId":"6a0858bb-6dc7-4f54-b05e-b1fdbaa223e0","triggerCount":1,"tags":[{"createdAt":"2023-01-05T09:55:57.214Z","updatedAt":"2023-01-05T09:55:57.214Z","id":"1","name":"Lark"},{"createdAt":"2023-01-15T09:33:57.136Z","updatedAt":"2023-01-15T09:33:57.136Z","id":"4","name":"Demo Ms. Quy√™n"}]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-01-17T18:14:37.731Z","updatedAt":"2023-01-17T18:27:02.000Z","id":"17","name":"G·ª≠i k·∫øt qu·∫£ + feedback s·ª± ki·ªán","active":true,"nodes":[{"parameters":{"httpMethod":"POST","path":"ket-qua-su-kien","options":{}},"id":"9c46120c-0a59-4257-81c8-0fc70e7cdcfd","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[840,500],"webhookId":"f597d976-4a75-4859-8361-519b3f60cced"},{"parameters":{"fromEmail":"KDIGI <no-reply@kdigi.app>","toEmail":"={{ $json[\"body\"][\"email\"] }}","bccEmail":"automation@kdigi.app","subject":"K·∫øt qu·∫£ b√†i t·∫≠p s·ª± ki·ªán B√πng n·ªï TMƒêT 2023","html":"=Xin ch√†o {{ $json[\"body\"][\"name\"] }},\n<br><br>\nGi·∫£ng vi√™n ch√∫ng t√¥i c√≥ ƒë√¥i l·ªùi nh·∫≠n x√©t v·ªÅ b√†i t·∫≠p c·ªßa b·∫°n nh∆∞ sau: {{ $json[\"body\"][\"feedback\"] }}\n<br><br>\nRegards!","options":{}},"id":"23d35060-b617-4e09-8ec5-68e28414ddca","name":"Send Email","type":"n8n-nodes-base.emailSend","typeVersion":1,"position":[1060,500],"credentials":{"smtp":{"id":"8","name":"SMTP account: no-reply@kdigi.app"}}}],"connections":{"Webhook":{"main":[[{"node":"Send Email","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{"Webhook":[{"json":{"headers":{"host":"app.n8n.vn","user-agent":"Go-http-client/2.0","content-length":"580","accept-encoding":"gzip","content-type":"multipart/form-data; boundary=6ed185b7d9782f223894534436bea3e31884e86b2529f3f9bedb6a72720b","x-forwarded-for":"3.211.55.69","x-forwarded-host":"app.n8n.vn","x-forwarded-port":"443","x-forwarded-proto":"https","x-forwarded-server":"af4013275608","x-real-ip":"3.211.55.69","x-tt-logid":"02167397979320200000000000000000000ffff41c94bbffe2d83"},"params":{},"query":{},"body":{"name":"Kh√¥i","phone":"0333111868","email":"kdigiseo@gmail.com","feedback":"Vi·∫øt b√†i nh∆∞ h·∫°ch"}}}]},"versionId":"152a1655-4faf-4955-9df1-ec297af0a2a1","triggerCount":1,"tags":[{"createdAt":"2023-01-05T09:55:57.214Z","updatedAt":"2023-01-05T09:55:57.214Z","id":"1","name":"Lark"},{"createdAt":"2023-01-15T09:33:57.136Z","updatedAt":"2023-01-15T09:33:57.136Z","id":"4","name":"Demo Ms. Quy√™n"}]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-01-18T03:50:54.716Z","updatedAt":"2023-01-18T04:45:38.000Z","id":"18","name":"[T·∫øt Qu√™ Em] Kh√°ch ƒëƒÉng k√Ω","active":true,"nodes":[{"parameters":{"httpMethod":"POST","path":"tqe-khdk","options":{}},"id":"4cf8aade-ec4b-4485-858b-1bb8213cc5a9","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[1100,580],"webhookId":"51b575da-193b-482d-876f-f5a20e99aa8f"},{"parameters":{"method":"POST","url":"https://hook.us1.make.com/x03p6yyyjb8p5wa8fqi1pxlagkaese16","sendBody":true,"bodyParameters":{"parameters":[{"name":"event_name","value":"={{ $json[\"body\"][\"event_name\"] }}"},{"name":"name","value":"={{ $json[\"body\"][\"name\"] }}"},{"name":"phone","value":"={{ $json[\"body\"][\"phone\"] }}"},{"name":"email","value":"={{ $json[\"body\"][\"email\"] }}"},{"name":"start_date","value":"={{ $json[\"body\"][\"start_date\"] }}"},{"name":"end_date","value":"={{ $json[\"body\"][\"end_date\"] }}"},{"name":"link_checkin","value":"={{ $json[\"body\"][\"link_checkin\"] }}"}]},"options":{}},"id":"a7b3cc67-a5e8-4222-9b7b-f001504a732a","name":"Send to MAKE <- g·ª≠i l·ªãch","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[1360,460]},{"parameters":{"fromEmail":"KDIGI T·∫øt Qu√™ Em <test@kdigi.app>","toEmail":"={{ $json[\"body\"][\"email\"] }}","bccEmail":"automation@kdigi.app","subject":"=ƒêƒÉng k√Ω s·ª± ki·ªán {{ $json[\"body\"][\"event_name\"] }} th√†nh c√¥ng","html":"=Xin ch√†o {{ $json[\"body\"][\"name\"] }},\n<br><br>\nCh√∫c m·ª´ng b·∫°n ƒë√£ ƒëƒÉng k√Ω tham gia th√†nh c√¥ng s·ª± ki·ªán {{ $json[\"body\"][\"event_name\"] }}.\n<br><br>\nƒê√¢y l√† link check-in khi ƒë·∫øn tham gia, b·∫°n nh·ªõ check-in ƒë·ªÉ nh·∫≠n qu√† nh√©: <a href=\"{{ $json[\"body\"][\"link_checkin\"] }}\">{{ $json[\"body\"][\"link_checkin\"] }}</a>\n<br><br>\nRegards!","options":{}},"id":"0e037f33-7255-44f4-a500-490efb661760","name":"G·ª≠i Email x√°c nh·∫≠n ƒëƒÉng k√Ω th√†nh c√¥ng","type":"n8n-nodes-base.emailSend","typeVersion":1,"position":[1360,660],"credentials":{"smtp":{"id":"15","name":"SMTP account: test@kdigi.app"}}}],"connections":{"Webhook":{"main":[[{"node":"G·ª≠i Email x√°c nh·∫≠n ƒëƒÉng k√Ω th√†nh c√¥ng","type":"main","index":0},{"node":"Send to MAKE <- g·ª≠i l·ªãch","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{"Webhook":[{"json":{"headers":{"host":"app.n8n.vn","user-agent":"Go-http-client/2.0","content-length":"997","accept-encoding":"gzip","content-type":"multipart/form-data; boundary=b024b0ff7ade21e540359242fafe1ff834b2ecb0a24bc14f24faab79d7d8","x-forwarded-for":"3.211.55.69","x-forwarded-host":"app.n8n.vn","x-forwarded-port":"443","x-forwarded-proto":"https","x-forwarded-server":"af4013275608","x-real-ip":"3.211.55.69","x-tt-logid":"02167401559011300000000000000000000ffff3a75f5a1069206"},"params":{},"query":{},"body":{"event_name":"T·∫øt Qu√™ Em","name":"L√™ Qu·ªëc Kh√¥i","phone":"0333111868","email":"n8n.kdigi@gmail.com","start_date":"2023/01/22 07:00","end_date":"2023/01/22 17:30","link_checkin":"https://t.ly/tqe-checkin"}}}]},"versionId":"40f933f4-ce05-4110-92bd-66175da72b48","triggerCount":1,"tags":[{"createdAt":"2023-01-05T09:55:57.214Z","updatedAt":"2023-01-05T09:55:57.214Z","id":"1","name":"Lark"},{"createdAt":"2023-01-18T03:50:59.834Z","updatedAt":"2023-01-18T03:50:59.834Z","id":"5","name":"T·∫øt Qu√™ Em"}]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-01-18T04:46:33.588Z","updatedAt":"2023-01-18T04:51:48.000Z","id":"19","name":"[T·∫øt Qu√™ Em] Checkin","active":true,"nodes":[{"parameters":{"httpMethod":"POST","path":"tqe-checkin","options":{}},"id":"a93f7e28-5465-4912-9648-77bb783058be","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[1100,580],"webhookId":"2699948c-d371-4802-8fb4-cf2e9780582f"},{"parameters":{"fromEmail":"KDIGI T·∫øt Qu√™ Em <test@kdigi.app>","toEmail":"={{ $json[\"body\"][\"email\"] }}","bccEmail":"automation@kdigi.app","subject":"=ƒê√£ Check-in th√†nh c√¥ng s·ª± ki·ªán {{ $json[\"body\"][\"event_name\"] }}","html":"=Xin ch√†o {{ $json[\"body\"][\"name\"] }},\n<br><br>\nCh√∫c m·ª´ng b·∫°n ƒë√£ check-in th√†nh c√¥ng s·ª± ki·ªán {{ $json[\"body\"][\"event_name\"] }}.\n<br><br>\nƒê√¢y l√† link ƒë√°nh gi√° ch·∫•t l∆∞·ª£ng s·ª± ki·ªán. B·∫°n vui l√≤ng cho ch√∫ng t√¥i bi·∫øt t·∫°i ƒë√¢y: <a href=\"{{ $json[\"body\"][\"link_rating\"] }}\">{{ $json[\"body\"][\"link_rating\"] }}</a>\n<br><br>\nRegards!","options":{}},"id":"e07a6a8c-fc83-4dcf-a630-22aa31d31a89","name":"Send Email","type":"n8n-nodes-base.emailSend","typeVersion":1,"position":[1320,580],"credentials":{"smtp":{"id":"15","name":"SMTP account: test@kdigi.app"}}}],"connections":{"Webhook":{"main":[[{"node":"Send Email","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{"Webhook":[{"json":{"headers":{"host":"app.n8n.vn","user-agent":"Go-http-client/2.0","content-length":"727","accept-encoding":"gzip","content-type":"multipart/form-data; boundary=6f6124ebfed20934344001f80b68fd1faa476ef52a34bca583743985e29a","x-forwarded-for":"3.211.55.69","x-forwarded-host":"app.n8n.vn","x-forwarded-port":"443","x-forwarded-proto":"https","x-forwarded-server":"af4013275608","x-real-ip":"3.211.55.69","x-tt-logid":"02167401731154700000000000000000000ffff3a75f5a1d1e464"},"params":{},"query":{},"body":{"event_name":"T·∫øt Qu√™ Em","name":"L√™ Qu·ªëc Kh√¥i","phone":"0333111868","email":"n8n.kdigi@gmail.com","link_rating":"https://t.ly/tqe-rating"}}}]},"versionId":"1c75a8e9-feb5-4753-888e-51705b7e6b0b","triggerCount":1,"tags":[{"createdAt":"2023-01-05T09:55:57.214Z","updatedAt":"2023-01-05T09:55:57.214Z","id":"1","name":"Lark"},{"createdAt":"2023-01-15T09:33:57.136Z","updatedAt":"2023-01-15T09:33:57.136Z","id":"4","name":"Demo Ms. Quy√™n"},{"createdAt":"2023-01-18T03:50:59.834Z","updatedAt":"2023-01-18T03:50:59.834Z","id":"5","name":"T·∫øt Qu√™ Em"}]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-01-18T04:52:49.476Z","updatedAt":"2023-01-18T05:08:16.000Z","id":"20","name":"[T·∫øt Qu√™ Em] ƒê√°nh gi√°","active":true,"nodes":[{"parameters":{"httpMethod":"POST","path":"tqe-rating","options":{}},"id":"1fe0863d-ab5c-42cd-8b3b-80be9dbe2dd5","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[1100,580],"webhookId":"2e061086-1d78-4a9d-9d69-c7ff39f4e090"},{"parameters":{"fromEmail":"KDIG T·∫øt Qu√™ Em <test@kdigi.app>","toEmail":"={{ $json[\"body\"][\"email\"] }}","bccEmail":"automation@kdigi.app","subject":"=ƒê√£ ƒë√°nh gi√° th√†nh c√¥ng s·ª± ki·ªán {{ $json[\"body\"][\"event_name\"] }}","html":"=Xin ch√†o {{ $json[\"body\"][\"name\"] }},\n<br><br>\nCh√∫c m·ª´ng b·∫°n ƒë√£ ƒë√°nh gi√° th√†nh c√¥ng s·ª± ki·ªán {{ $json[\"body\"][\"event_name\"] }}\n<br>\nD∆∞·ªõi ƒë√¢y l√† ƒë√°nh gi√° c·ªßa b·∫°n:\n<br>\nƒê√°nh gi√°: {{ $json[\"body\"][\"rating\"] }}\n<br>\n{{ $json[\"body\"][\"khq\"] }}\n<br>\n{{ $json[\"body\"][\"comment\"] }}\n<br><br>\nRegards!","options":{}},"id":"28f78d8d-c6ec-4020-a632-20a04692b591","name":"Send Email","type":"n8n-nodes-base.emailSend","typeVersion":1,"position":[1320,580],"credentials":{"smtp":{"id":"15","name":"SMTP account: test@kdigi.app"}}}],"connections":{"Webhook":{"main":[[{"node":"Send Email","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{"Webhook":[{"json":{"headers":{"host":"app.n8n.vn","user-agent":"Go-http-client/2.0","content-length":"955","accept-encoding":"gzip","content-type":"multipart/form-data; boundary=f5c7ef2e067159bddbf616608c1b91f4abfeb79bd504790d51bead3cfd9b","x-forwarded-for":"3.211.55.69","x-forwarded-host":"app.n8n.vn","x-forwarded-port":"443","x-forwarded-proto":"https","x-forwarded-server":"af4013275608","x-real-ip":"3.211.55.69","x-tt-logid":"02167401774111300000000000000000000ffff45e92ddee57d07"},"params":{},"query":{},"body":{"event_name":"T·∫øt Qu√™ Em","name":"L√™ Qu·ªëc Kh√¥i","phone":"0333111868","email":"n8n.kdigi@gmail.com","rating":"2 sao","khq":"ko h√†i l√≤ng","comment":"kh√¥ng r√µ"}}}]},"versionId":"b66be0bb-6809-4a8f-b0f8-ed5832b4a11a","triggerCount":1,"tags":[{"createdAt":"2023-01-05T09:55:57.214Z","updatedAt":"2023-01-05T09:55:57.214Z","id":"1","name":"Lark"},{"createdAt":"2023-01-15T09:33:57.136Z","updatedAt":"2023-01-15T09:33:57.136Z","id":"4","name":"Demo Ms. Quy√™n"},{"createdAt":"2023-01-18T03:50:59.834Z","updatedAt":"2023-01-18T03:50:59.834Z","id":"5","name":"T·∫øt Qu√™ Em"}]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-01-18T05:08:47.870Z","updatedAt":"2023-01-18T05:16:24.000Z","id":"21","name":"[T·∫øt Qu√™ Em] BTVN","active":true,"nodes":[{"parameters":{"httpMethod":"POST","path":"tqe-btvn","options":{}},"id":"12f939bf-1b89-4098-8135-65c1f60dbc2c","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[1100,580],"webhookId":"dbb54a16-dd30-4d1b-a7e8-87e246c05072"},{"parameters":{"fromEmail":"KDIGI T·∫øt Qu√™ Em <test@kdigi.app>","toEmail":"={{ $json[\"body\"][\"email\"] }}","bccEmail":"automation@kdigi.app","subject":"=ƒê√¢y l√† b√†i t·∫≠p v·ªÅ nh√† c·ªßa b·∫°n khi tham gia s·ª± ki·ªán  {{ $json[\"body\"][\"event_name\"] }}","html":"=Xin ch√†o b·∫°n,\n<br><br>\nƒê√¢y l√† link b√†i t·∫≠p v·ªÅ nh√† c·ªßa b·∫°n: <a href=\"{{ $json[\"body\"][\"link_btvn\"] }}\">{{ $json[\"body\"][\"link_btvn\"] }}</a>\n<br>\nƒê√¢y l√† group th·∫£o lu·∫≠n: <a href=\"{{ $json[\"body\"][\"link_dis\"] }}\">{{ $json[\"body\"][\"link_dis\"] }}</a>\n<br><br>\nRegards!","options":{}},"id":"e250609a-66f8-4e4d-8ad5-815dba321482","name":"Send Email","type":"n8n-nodes-base.emailSend","typeVersion":1,"position":[1320,580],"credentials":{"smtp":{"id":"15","name":"SMTP account: test@kdigi.app"}}}],"connections":{"Webhook":{"main":[[{"node":"Send Email","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{"Webhook":[{"json":{"headers":{"host":"app.n8n.vn","user-agent":"Go-http-client/2.0","content-length":"600","accept-encoding":"gzip","content-type":"multipart/form-data; boundary=8a747f47585aeb1fd432a11047a1c38c4af3ecc47ade9e78118aa89c3c57","x-forwarded-for":"3.211.55.69","x-forwarded-host":"app.n8n.vn","x-forwarded-port":"443","x-forwarded-proto":"https","x-forwarded-server":"af4013275608","x-real-ip":"3.211.55.69","x-tt-logid":"02167401881401500000000000000000000ffff3a75f5a10fbafb"},"params":{},"query":{},"body":{"email":"n8n.kdigi@gmail.com","event_name":"T·∫øt Qu√™ Em","link_btvn":"https://t.ly/tqe-btvn","link_dis":"t.ly/tqe-cskh"}}}]},"versionId":"67c0be47-9bdb-4620-91ef-e5bbba7a033f","triggerCount":1,"tags":[{"createdAt":"2023-01-05T09:55:57.214Z","updatedAt":"2023-01-05T09:55:57.214Z","id":"1","name":"Lark"},{"createdAt":"2023-01-18T03:50:59.834Z","updatedAt":"2023-01-18T03:50:59.834Z","id":"5","name":"T·∫øt Qu√™ Em"}]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-01-18T05:16:54.003Z","updatedAt":"2023-01-18T05:24:51.000Z","id":"22","name":"[T·∫øt Qu√™ Em] KQ BTVN","active":true,"nodes":[{"parameters":{"httpMethod":"POST","path":"tqe-kq-btvn","options":{}},"id":"859cb4c5-f6e6-4d91-81fe-973d004a5317","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[1100,580],"webhookId":"34e3bc92-825d-48f6-aa3b-bc392418fe15"},{"parameters":{"fromEmail":"KDIGI T·∫øt Qu√™ Em <test@kdigi.app>","toEmail":"={{ $json[\"body\"][\"email\"] }}","bccEmail":"automation@kdigi.app","subject":"K·∫øt qu·∫£ b√†i t·∫≠p v·ªÅ nh√† c·ªßa b·∫°n","html":"=K·∫øt qu·∫£: {{ $json[\"body\"][\"result\"] }}","options":{}},"id":"544addb9-6a48-49bf-bfb8-eaf148a6c29d","name":"Send Email","type":"n8n-nodes-base.emailSend","typeVersion":1,"position":[1320,580],"credentials":{"smtp":{"id":"15","name":"SMTP account: test@kdigi.app"}}}],"connections":{"Webhook":{"main":[[{"node":"Send Email","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{"Webhook":[{"json":{"headers":{"host":"app.n8n.vn","user-agent":"Go-http-client/2.0","content-length":"510","accept-encoding":"gzip","content-type":"multipart/form-data; boundary=a4e4846029602284067bee439453189d8ba081c3bc70528071342ffa3a99","x-forwarded-for":"3.211.55.69","x-forwarded-host":"app.n8n.vn","x-forwarded-port":"443","x-forwarded-proto":"https","x-forwarded-server":"af4013275608","x-real-ip":"3.211.55.69","x-tt-logid":"02167401931088900000000000000000000ffff3a75f5a1542c2f"},"params":{},"query":{},"body":{"name":"L√™ Qu·ªëc Kh√¥i","email":"n8n.kdigi@gmail.com","result":"t√¥i kh√¥ng hi·ªÉu b·∫°n h·ªçc nhi·ªÅu nh∆∞ng ko hi·ªÉu c√¢u h·ªèi?"}}}]},"versionId":"9d979ee0-094d-4970-a4db-ca99ec31112d","triggerCount":1,"tags":[{"createdAt":"2023-01-05T09:55:57.214Z","updatedAt":"2023-01-05T09:55:57.214Z","id":"1","name":"Lark"},{"createdAt":"2023-01-18T03:50:59.834Z","updatedAt":"2023-01-18T03:50:59.834Z","id":"5","name":"T·∫øt Qu√™ Em"}]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-01-25T09:03:16.679Z","updatedAt":"2023-01-25T09:03:16.679Z","id":"23","name":"Test a Thang","active":false,"nodes":[],"connections":{},"settings":{},"staticData":null,"pinData":{},"versionId":"2158da17-ba7e-4aae-8321-316f8253a5e6","triggerCount":0,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-01-29T05:18:00.543Z","updatedAt":"2023-01-29T06:08:42.000Z","id":"24","name":"Form li√™n h·ªá N8N.vn","active":true,"nodes":[{"parameters":{"httpMethod":"POST","path":"contact-n8nvn","options":{}},"id":"0f246586-8f47-46d5-a677-4980c7a3db1c","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[840,500],"webhookId":"490445cd-bf40-465c-acea-2b42cc508e75"},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/bot/v2/hook/5f77a592-f52b-4c1b-8fae-0de5972eba37","sendBody":true,"specifyBody":"json","jsonBody":"={\n    \"msg_type\": \"interactive\",\n    \"card\": {\n        \"config\": {\n            \"wide_screen_mode\": true\n        },\n        \"elements\": [\n            {\n                \"fields\": [\n                    {\n                        \"is_short\": true,\n                        \"text\": {\n                            \"content\": \"**üôã H·ªå V√Ä T√äN**\\n{{ $node[\"Webhook\"].json[\"body\"][\"fields[name][value]\"] }}\",\n                            \"tag\": \"lark_md\"\n                        }\n                    },\n                    {\n                        \"is_short\": true,\n                        \"text\": {\n                            \"content\": \"**üìû S·ªê ƒêI·ªÜN THO·∫†I**\\n{{ $node[\"Webhook\"].json[\"body\"][\"fields[phone][value]\"] }}\",\n                            \"tag\": \"lark_md\"\n                        }\n                    },\n                    {\n                        \"is_short\": false,\n                        \"text\": {\n                            \"content\": \"\",\n                            \"tag\": \"lark_md\"\n                        }\n                    },\n                    {\n                        \"is_short\": true,\n                        \"text\": {\n                            \"content\": \"**‚úâÔ∏è EMAIL**\\n{{ $node[\"Webhook\"].json[\"body\"][\"fields[email][value]\"] }}\",\n                            \"tag\": \"lark_md\"\n                        }\n                    },\n                    {\n                        \"is_short\": false,\n                        \"text\": {\n                            \"content\": \"\",\n                            \"tag\": \"lark_md\"\n                        }\n                    },\n                    {\n                        \"is_short\": true,\n                        \"text\": {\n                            \"content\": \"**üñπ N·ªòI DUNG**\\n{{ $node[\"Webhook\"].json[\"body\"][\"fields[message][raw_value]\"] }}\",\n                            \"tag\": \"lark_md\"\n                        }\n                    }\n                ],\n                \"tag\": \"div\"\n            },\n            {\n                \"actions\": [\n                    {\n                        \"tag\": \"button\",\n                        \"text\": {\n                            \"content\": \"G·ªåI L·∫†I T∆Ø V·∫§N\",\n                            \"tag\": \"plain_text\"\n                        },\n                        \"type\": \"primary\",\n                        \"url\": \"tel:{{ $node[\"Webhook\"].json[\"body\"][\"fields[phone][value]\"] }}\"\n                    },\n                    {\n                        \"tag\": \"button\",\n                        \"text\": {\n                            \"content\": \"EMAIL\",\n                            \"tag\": \"plain_text\"\n                        },\n                        \"type\": \"default\",\n                        \"url\": \"mailto:{{ $node[\"Webhook\"].json[\"body\"][\"fields[email][value]\"] }}\"\n                    }\n                ],\n                \"tag\": \"action\"\n            }\n        ],\n        \"header\": {\n            \"template\": \"blue\",\n            \"title\": {\n                \"content\": \"Y√äU C·∫¶U T∆Ø V·∫§N\",\n                \"tag\": \"plain_text\"\n            }\n        }\n    }\n}\n","options":{}},"id":"f1f17405-faec-45f3-a396-3eefec80f6f8","name":"HTTP Request","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[1060,500]}],"connections":{"Webhook":{"main":[[{"node":"HTTP Request","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{"Webhook":[{"json":{"headers":{"host":"app.n8n.vn","user-agent":"WordPress/6.1.1; https://n8n.vn","content-length":"1036","accept":"*/*","accept-encoding":"deflate, gzip","content-type":"application/x-www-form-urlencoded","referer":"https://app.n8n.vn/webhook-test/contact-n8nvn","x-forwarded-for":"103.175.248.226","x-forwarded-host":"app.n8n.vn","x-forwarded-port":"443","x-forwarded-proto":"https","x-forwarded-server":"af4013275608","x-real-ip":"103.175.248.226"},"params":{},"query":{},"body":{"form[id]":"eeb4d49","form[name]":"New Form","fields[name][id]":"name","fields[name][type]":"text","fields[name][title]":"T√™n c·ªßa b·∫°n","fields[name][value]":"Kh√¥i","fields[name][raw_value]":"Kh√¥i","fields[name][required]":"1","fields[phone][id]":"phone","fields[phone][type]":"tel","fields[phone][title]":"S·ªë ƒëi·ªán tho·∫°i","fields[phone][value]":"0333111868","fields[phone][raw_value]":"0333111868","fields[phone][required]":"1","fields[email][id]":"email","fields[email][type]":"email","fields[email][title]":"Email","fields[email][value]":"lekhoi456@gmail.com","fields[email][raw_value]":"lekhoi456@gmail.com","fields[email][required]":"1","fields[message][id]":"message","fields[message][type]":"textarea","fields[message][title]":"Th√¥ng tin th√™m","fields[message][value]":"Xin ch√†o","fields[message][raw_value]":"Xin ch√†o","fields[message][required]":"0"}}}]},"versionId":"0cec96ed-229e-489d-9a6d-13f5df45ed1f","triggerCount":1,"tags":[{"createdAt":"2023-01-29T05:18:04.163Z","updatedAt":"2023-01-29T05:18:04.163Z","id":"6","name":"n8n.vn"}]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-01-30T09:12:13.772Z","updatedAt":"2023-02-24T17:44:25.000Z","id":"25","name":"[domains] Contact Form","active":true,"nodes":[{"parameters":{"httpMethod":"POST","path":"domain-contact","options":{"responseHeaders":{"entries":[{"name":"Access-Control-Allow-Origin","value":"*"},{"name":"Access-Control-Allow-Methods","value":"POST"},{"name":"Access-Control-Allow-Headers","value":"Content-Type"}]}}},"id":"d72da675-f3ee-4ea3-b184-b276fee76835","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[1060,620],"webhookId":"0f00a442-2d60-46eb-8bb9-0c7089d29ce4"},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/bitable/v1/apps/basusdhCpMksXcO8QYicVoQnzyh/tables/tblcLjNL9RueKk97/records","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $json[\"tenant_access_token\"] }}"}]},"sendBody":true,"contentType":"raw","rawContentType":"application/json","body":"={\n   \"fields\": {\n      \"name\": \"{{ $node[\"Webhook\"].json[\"body\"][\"name\"] }}\",\n      \"phone\": {\n         \"text\": \"{{ $node[\"Webhook\"].json[\"body\"][\"phone\"] }}\",\n         \"link\": \"tel:{{ $node[\"Webhook\"].json[\"body\"][\"phone\"] }}\"\n      },\n      \"email\": {\n         \"text\": \"{{ $node[\"Webhook\"].json[\"body\"][\"email\"] }}\",\n         \"link\": \"mailto:{{ $node[\"Webhook\"].json[\"body\"][\"email\"] }}\"\n      },\n      \"message\": \"{{ $node[\"Webhook\"].json[\"body\"][\"message\"] }}\",\n      \"domain\": \"{{ $node[\"Webhook\"].json[\"body\"][\"domain\"] }}\"\n   }\n}","options":{}},"id":"14facdfc-3821-43d2-a4f8-4d5ce48e7784","name":"HTTP Request","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[1500,620]},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/auth/v3/tenant_access_token/internal/","sendBody":true,"bodyParameters":{"parameters":[{"name":"app_id","value":"cli_a33cd37530b8900a"},{"name":"app_secret","value":"qNz8YxoCCZoGm9Nlm2bOrcUriJsJtHHD"}]},"options":{}},"id":"e0f91538-4ec7-4e31-96f7-f13c2dd8e467","name":"POST to get access_token","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[1280,620]}],"connections":{"Webhook":{"main":[[{"node":"POST to get access_token","type":"main","index":0}]]},"POST to get access_token":{"main":[[{"node":"HTTP Request","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{"Webhook":[{"json":{"headers":{"host":"app.n8n.vn","user-agent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/109.0.0.0 Safari/537.36 Edg/109.0.1518.52","content-length":"557","accept":"*/*","accept-encoding":"gzip, deflate, br","accept-language":"en-US,en;q=0.9,vi;q=0.8","cache-control":"no-cache","content-type":"multipart/form-data; boundary=----WebKitFormBoundaryWJgUHLOels9GJwWg","dnt":"1","origin":"http://127.0.0.1:5500","pragma":"no-cache","referer":"http://127.0.0.1:5500/","sec-ch-ua":"\"Not_A Brand\";v=\"99\", \"Microsoft Edge\";v=\"109\", \"Chromium\";v=\"109\"","sec-ch-ua-mobile":"?0","sec-ch-ua-platform":"\"macOS\"","sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"cross-site","x-forwarded-for":"14.241.182.189","x-forwarded-host":"app.n8n.vn","x-forwarded-port":"443","x-forwarded-proto":"https","x-forwarded-server":"af4013275608","x-real-ip":"14.241.182.189"},"params":{},"query":{},"body":{"name":"Hieu Thanh Kieu","email":"hieulv@kdigi.app","phone":"0348204060","message":"a","domain":"127.0.0.1"}}}],"POST to get access_token":[{"json":{"code":0,"expire":5058,"msg":"ok","tenant_access_token":"t-g2052oh7JEE2SRHAZMGUTQVBRROS6LUPCLKQI4HD"}}]},"versionId":"69c94975-f44b-4ec1-a84d-97ae1707398d","triggerCount":1,"tags":[{"createdAt":"2023-01-05T09:55:57.214Z","updatedAt":"2023-01-05T09:55:57.214Z","id":"1","name":"Lark"},{"createdAt":"2023-01-31T10:26:00.772Z","updatedAt":"2023-01-31T10:26:00.772Z","id":"8","name":"domains"}]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-02-03T07:16:37.982Z","updatedAt":"2023-06-19T10:11:52.000Z","id":"26","name":"[HSVN][KiotViet] Calculate revenue from invoices","active":false,"nodes":[{"parameters":{"path":"hsvn-kiotviet","options":{}},"id":"5e0202dd-a8e6-406b-b30b-a8c6dc448e31","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[440,500],"webhookId":"d7e63753-bd37-410c-80e9-a6be56b4f36b"},{"parameters":{"conditions":{"number":[{"value1":"={{ $node[\"Invoices data\"].json[\"total\"] }}","operation":"larger","value2":"={{ $node[\"Invoices data\"].json[\"pageSize\"] + ($node[\"Config request\"].json['data'][\"currentItem\"]) }}"}]}},"id":"282d9723-57d6-47a4-a591-462fc81acf7b","name":"IF","type":"n8n-nodes-base.if","typeVersion":1,"position":[1540,500]},{"parameters":{"method":"POST","url":"https://id.kiotviet.vn/connect/token","sendBody":true,"contentType":"form-urlencoded","bodyParameters":{"parameters":[{"name":"scopes","value":"PublicApi.Access"},{"name":"grant_type","value":"client_credentials"},{"name":"client_id"},{"name":"client_secret"}]},"options":{}},"id":"f79f94ab-ab02-48ae-853c-15392b2a1aa8","name":"Get access token","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[640,500]},{"parameters":{"url":"={{ $json[\"data\"][\"endpoint\"] }}&currentItem={{ $json[\"data\"][\"currentItem\"] }}","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $node[\"Get access token\"].json[\"access_token\"] }}"},{"name":"Retailer","value":"hsvn"}]},"options":{}},"id":"802bd778-8da5-4718-8013-3b977885820b","name":"Invoices data","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[1100,500]},{"parameters":{"jsCode":"const allData = []\n\nlet counter = 0;\n\ndo {\n  try {\n    const data = $('Flatten list data').all(0, counter);\n    allData.push(...data);\n  } catch (error) {\n    return allData.map(data => ({ json: data.json}));\n  }\n\n  counter++;\n} while(true);"},"id":"5173ce4d-b6d8-4871-a12f-2204f65c85d1","name":"Merge data","type":"n8n-nodes-base.code","typeVersion":1,"position":[1820,480]},{"parameters":{"jsCode":"const reducedData = $('Merge data').all().reduce((acc, cur) => {\n  return cur.json.total + acc\n}, 0)\n\nreturn {total: reducedData};"},"id":"dbf95d4c-b05d-4079-9e46-84e60af8858f","name":"Calculate Revenue","type":"n8n-nodes-base.code","typeVersion":1,"position":[2020,480]},{"parameters":{"jsCode":"const now = new Date();\n\nconst firstDay = new Date(now.getFullYear(), now.getMonth(), 1);\n\nlet lastDay = new Date(now.getFullYear(), now.getMonth() + 1, 0);\nlastDay.setSeconds(lastDay.getSeconds() - 1);\n\nreturn (\n  (items[0].json?.data && { data: items[0].json?.data }) || {\n    data: {\n      endpoint: `https://public.kiotapi.com/invoices?fromPurchaseDate=${firstDay.toISOString()}&toPurchaseDate=${lastDay.toISOString()}&orderBy=createdDate&orderDirection=asc`,\n      currentItem: 0,\n    },\n  }\n);"},"id":"1745ac40-44a2-4e79-a517-e7bf494ec275","name":"Config request","type":"n8n-nodes-base.code","typeVersion":1,"position":[860,500]},{"parameters":{"jsCode":"const result = $('Config request').all()[0].json;\n\nresult.data.currentItem += $('Invoices data').first().json.pageSize;\n\nreturn result;"},"id":"174894da-fa03-4791-b127-3855e61c401c","name":"Set next page number","type":"n8n-nodes-base.code","typeVersion":1,"position":[1540,680]},{"parameters":{"fieldToSplitOut":"=data","options":{}},"id":"d0e5aaad-98dc-4178-a09d-da72fbd61c8e","name":"Flatten list data","type":"n8n-nodes-base.itemLists","typeVersion":1,"position":[1320,500]}],"connections":{"Webhook":{"main":[[{"node":"Get access token","type":"main","index":0}]]},"IF":{"main":[[{"node":"Set next page number","type":"main","index":0}],[{"node":"Merge data","type":"main","index":0}]]},"Get access token":{"main":[[{"node":"Config request","type":"main","index":0}]]},"Invoices data":{"main":[[{"node":"Flatten list data","type":"main","index":0}]]},"Merge data":{"main":[[{"node":"Calculate Revenue","type":"main","index":0}]]},"Config request":{"main":[[{"node":"Invoices data","type":"main","index":0}]]},"Set next page number":{"main":[[{"node":"Config request","type":"main","index":0}]]},"Flatten list data":{"main":[[{"node":"IF","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{"Webhook":[{"json":{"headers":{"host":"app.n8n.vn","user-agent":"PostmanRuntime/7.30.0","accept":"*/*","accept-encoding":"gzip, deflate, br","cache-control":"no-cache","postman-token":"153f5454-73a2-4780-8cca-f335b423b475","x-forwarded-for":"125.235.236.102","x-forwarded-host":"app.n8n.vn","x-forwarded-port":"443","x-forwarded-proto":"https","x-forwarded-server":"af4013275608","x-real-ip":"125.235.236.102"},"params":{},"query":{},"body":{}}}],"Get access token":[{"json":{"access_token":"eyJhbGciOiJSUzI1NiIsInR5cCI6ImF0K2p3dCJ9.eyJuYmYiOjE2NzU0MDg5MTYsImV4cCI6MTY3NTQ5NTMxNiwiaXNzIjoiaHR0cDovL2lkLmtpb3R2aWV0LnZuIiwiY2xpZW50X2lkIjoiZmQ3YTUyYjEtZDJkYS00YzgzLWFlY2ItYWViODA5YzE1NWFkIiwiY2xpZW50X1JldGFpbGVyQ29kZSI6Imhzdm4iLCJjbGllbnRfUmV0YWlsZXJJZCI6IjgyNjcxIiwiY2xpZW50X1VzZXJJZCI6IjMyODAzMyIsImNsaWVudF9TZW5zaXRpdmVBcGkiOiJUcnVlIiwiaWF0IjoxNjc1NDA4OTE2LCJzY29wZSI6WyJQdWJsaWNBcGkuQWNjZXNzIl19.JiWJuOLssMC6I41AIi3evD6RaGGGEiBVgafjwmL9P_0RmLuVb1XowiyOtS7J5c2r0i-iC86kytRphTbf6Xe25ynmhrAA0hB2TsD6fmuUSBBsz9ImOZjVIqxf3yTz9b6zHGG2DMzgxW6RwTKZ8oKbYlmDhVSStOBAqjyO0JyU-xmSoyJ7Aod8F8445hgq06Lf1LRnR3hn33zQwQBIuTr1u4KQvalT2c7u7gP0tVLaUlsrYEdRvjWk2BXpu_EWceX-_KPfXdkhcn-WuHGrMPfnAMAfiXcr4plpZwpHKVJeCxm2cSZ55vU8XyDAwUYmvSMvUabDJt0Tj57qCcABnf2_rQ","expires_in":86400,"token_type":"Bearer","scope":"PublicApi.Access"}}]},"versionId":"d09d4865-9615-4846-a745-e70e1b161157","triggerCount":0,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-02-04T03:28:36.032Z","updatedAt":"2023-02-04T09:41:01.000Z","id":"27","name":"chatgpt","active":true,"nodes":[{"parameters":{"httpMethod":"POST","path":"chatgpt-kdigi","responseMode":"responseNode","options":{}},"id":"e66fdd79-9e0a-4ce6-9bda-771d360882c4","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[700,500],"webhookId":"e0f89681-fdda-4132-aa5b-8a2d95b9527d"},{"parameters":{"respondWith":"json","responseBody":"={ \n    \"challenge\": \"{{ $json[\"body\"][\"challenge\"] }}\"\n} ","options":{"responseCode":200}},"id":"80a053f1-c93e-4014-912f-fdda4e0424f0","name":"Respond to Webhook","type":"n8n-nodes-base.respondToWebhook","typeVersion":1,"position":[860,500]}],"connections":{"Webhook":{"main":[[{"node":"Respond to Webhook","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{},"versionId":"240e859d-d5f0-4555-9d5e-4931a636940f","triggerCount":1,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-02-10T02:29:28.611Z","updatedAt":"2023-02-10T05:31:33.000Z","id":"28","name":"NCMK - ƒê∆°n h√†ng m·ªõi","active":true,"nodes":[{"parameters":{"httpMethod":"POST","path":"ncmk-tao-don-hang","options":{}},"id":"7b246322-66e1-4a79-be5e-2c0034d11cdf","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[1120,580],"webhookId":"259f0538-65a1-432e-8ea3-e38e9113e91a"},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/bot/v2/hook/80c21424-ab2e-4d62-8b07-6f4a9f80877b","sendBody":true,"specifyBody":"json","jsonBody":"={\n    \"msg_type\": \"interactive\",\n    \"card\": {\n        \"config\": {\n            \"wide_screen_mode\": true\n          },\n          \"elements\": [\n            {\n              \"tag\": \"markdown\",\n              \"content\": \"**üõí TH√îNG TIN ƒê∆†N H√ÄNG**\"\n            },\n            {\n              \"tag\": \"markdown\",\n              \"content\": \"**ƒê∆°n h√†ng:**\\n{{$json[\"body\"][\"line_items\"][0][\"name\"]}}\"\n            },\n            {\n              \"tag\": \"div\",\n              \"fields\": [\n                {\n                  \"is_short\": true,\n                  \"text\": {\n                    \"tag\": \"lark_md\",\n                    \"content\": \"**M√£ ƒë∆°n h√†ng:** {{$json[\"body\"][\"line_items\"][0][\"id\"]}}\"\n                  }\n                },\n                {\n                  \"is_short\": true,\n                  \"text\": {\n                    \"tag\": \"lark_md\",\n                    \"content\": \"**{{$json[\"body\"][\"line_items\"][0][\"meta_data\"][0][\"display_key\"]}}:** {{$json[\"body\"][\"line_items\"][0][\"meta_data\"][0][\"display_value\"]}}\"\n                  }\n                },\n                {\n                  \"is_short\": true,\n                  \"text\": {\n                    \"tag\": \"lark_md\",\n                    \"content\": \"**S·ªë l∆∞·ª£ng:** {{$json[\"body\"][\"line_items\"][0][\"quantity\"]}}\"\n                  }\n                },\n                {\n                  \"is_short\": true,\n                  \"text\": {\n                    \"tag\": \"lark_md\",\n                    \"content\": \"**ƒê∆°n gi√°:** {{$json[\"body\"][\"line_items\"][0][\"price\"]}}\"\n                  }\n                },\n                {\n                  \"is_short\": true,\n                  \"text\": {\n                    \"tag\": \"lark_md\",\n                    \"content\": \"**Gi·∫£m gi√°:** {{$json[\"body\"][\"discount_total\"]}}\"\n                  }\n                },\n                {\n                  \"is_short\": true,\n                  \"text\": {\n                    \"tag\": \"lark_md\",\n                    \"content\": \"**Th√†nh ti·ªÅn:** {{$json[\"body\"][\"total\"]}}\"\n                  }\n                },\n                {\n                  \"is_short\": true,\n                  \"text\": {\n                    \"tag\": \"lark_md\",\n                    \"content\": \"**Tr·∫°ng th√°i:** {{ $json[\"body\"][\"status\"]}}\"\n                  }\n                },\n                {\n                  \"is_short\": true,\n                  \"text\": {\n                    \"tag\": \"lark_md\",\n                    \"content\": \"**PTTT:** {{$json[\"body\"][\"payment_method_title\"]}}\"\n                  }\n                }\n              ]\n            },\n            {\n              \"tag\": \"hr\"\n            },\n            {\n              \"tag\": \"markdown\",\n              \"content\": \"**üë§ TH√îNG TIN KH√ÅCH H√ÄNG**\"\n            },\n            {\n              \"tag\": \"div\",\n              \"fields\": [\n                {\n                  \"is_short\": true,\n                  \"text\": {\n                    \"tag\": \"lark_md\",\n                    \"content\": \"**H·ªç v√† t√™n:** {{$json[\"body\"][\"billing\"][\"first_name\"]}} {{$json[\"body\"][\"billing\"][\"last_name\"]}}\"\n                  }\n                },\n                {\n                  \"is_short\": true,\n                  \"text\": {\n                    \"tag\": \"lark_md\",\n                    \"content\": \"**S·ªë ƒëi·ªán tho·∫°i:** {{$json[\"body\"][\"billing\"][\"phone\"]}}\"\n                  }\n                },\n                {\n                  \"is_short\": false,\n                  \"text\": {\n                    \"tag\": \"lark_md\",\n                    \"content\": \"**EmailÔºö**{{$json[\"body\"][\"billing\"][\"email\"]}}\"\n                  }\n                },\n                {\n                  \"is_short\": false,\n                  \"text\": {\n                    \"tag\": \"lark_md\",\n                    \"content\": \"**ƒê·ªãa ch·ªâ:** {{$json[\"body\"][\"billing\"][\"address_1\"]}} {{$json[\"body\"][\"billing\"][\"address_2\"]}} {{$json[\"body\"][\"billing\"][\"city\"]}} {{$json[\"body\"][\"billing\"][\"company\"]}}\"\n                  }\n                },\n                {\n          \"is_short\": false,\n          \"text\": {\n            \"tag\": \"lark_md\",\n            \"content\": \"**Ghi ch√∫:** {{$json[\"body\"][\"customer_note\"]}}\"\n          }\n        }\n              ]\n            },\n            {\n              \"tag\": \"hr\"\n            },\n            {\n              \"tag\": \"action\",\n              \"actions\": [\n                {\n                  \"tag\": \"button\",\n                  \"text\": {\n                    \"tag\": \"plain_text\",\n                    \"content\": \"X·ª≠ l√Ω ƒë∆°n h√†ng\"\n                  },\n                  \"url\": \"https://nucuoimekong.com/wp-admin/post.php?post={{$json[\"body\"][\"id\"]}}&action=edit\",\n                  \"type\": \"primary\"\n                },\n                {\n                  \"tag\": \"button\",\n                  \"text\": {\n                    \"tag\": \"plain_text\",\n                    \"content\": \"G·ªçi ƒëi·ªán t∆∞ v·∫•n\"\n                  },\n                  \"url\": \"tel:{{$json[\"body\"][\"billing\"][\"phone\"]}}\",\n                  \"type\": \"default\"\n                }\n              ]\n            }\n          ],\n          \"header\": {\n            \"template\": \"green\",\n            \"title\": {\n                \"content\": \"{{ $json[\"body\"][\"line_items\"][0][\"id\"] }} - ƒê∆°n h√†ng m·ªõi\",\n                \"tag\": \"plain_text\"\n            }\n          }\n    }\n}\n","options":{}},"id":"41fd3d74-2215-4fa8-9a0c-4ce7f9d7e7a3","name":"HTTP Request","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[1560,580]}],"connections":{"Webhook":{"main":[[{"node":"HTTP Request","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{},"versionId":"417890fe-6ace-4295-945a-ba2c2e4ece5d","triggerCount":1,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-02-10T04:34:18.777Z","updatedAt":"2023-02-10T04:34:18.777Z","id":"29","name":"NCMK - C·∫≠p nh·∫≠t ƒë∆°n h√†ng","active":false,"nodes":[{"parameters":{"httpMethod":"POST","path":"ncmk-tao-don-hang","options":{}},"id":"bba79543-ff27-4b8b-b5c6-3355b6b1b518","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[1120,580],"webhookId":"99bf574b-6057-4e2a-91ba-53bbed30162a"},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/bot/v2/hook/9b461f96-d04b-4bef-be1a-f9b61e16cf14","sendBody":true,"specifyBody":"json","jsonBody":"={\n    \"msg_type\": \"interactive\",\n    \"card\": {\n        \"config\": {\n            \"wide_screen_mode\": true\n          },\n          \"elements\": [\n            {\n              \"tag\": \"markdown\",\n              \"content\": \"**üõí TH√îNG TIN ƒê∆†N H√ÄNG**\"\n            },\n            {\n              \"tag\": \"markdown\",\n              \"content\": \"**ƒê∆°n h√†ng:**\\n{{ $json[\"body\"][\"line_items\"][0][\"name\"] }}\"\n            },\n            {\n              \"tag\": \"div\",\n              \"fields\": [\n                {\n                  \"is_short\": true,\n                  \"text\": {\n                    \"tag\": \"lark_md\",\n                    \"content\": \"**M√£ ƒë∆°n h√†ng:** {{$json[\"body\"][\"line_items\"][0][\"id\"]}}\"\n                  }\n                },\n                {\n                  \"is_short\": true,\n                  \"text\": {\n                    \"tag\": \"lark_md\",\n                    \"content\": \"**{{$json[\"body\"][\"line_items\"][0][\"meta_data\"][0][\"display_key\"]}}:** {{$json[\"body\"][\"line_items\"][0][\"meta_data\"][0][\"display_value\"]}}\"\n                  }\n                },\n                {\n                  \"is_short\": true,\n                  \"text\": {\n                    \"tag\": \"lark_md\",\n                    \"content\": \"**S·ªë l∆∞·ª£ng:** {{$json[\"body\"][\"line_items\"][0][\"quantity\"]}}\"\n                  }\n                },\n                {\n                  \"is_short\": true,\n                  \"text\": {\n                    \"tag\": \"lark_md\",\n                    \"content\": \"**ƒê∆°n gi√°:** {{$json[\"body\"][\"line_items\"][0][\"price\"]}}\"\n                  }\n                },\n                {\n                  \"is_short\": true,\n                  \"text\": {\n                    \"tag\": \"lark_md\",\n                    \"content\": \"**Gi·∫£m gi√°:** {{$json[\"body\"][\"discount_total\"]}}\"\n                  }\n                },\n                {\n                  \"is_short\": true,\n                  \"text\": {\n                    \"tag\": \"lark_md\",\n                    \"content\": \"**Th√†nh ti·ªÅn:** {{$json[\"body\"][\"total\"]}}\"\n                  }\n                },\n                {\n                  \"is_short\": true,\n                  \"text\": {\n                    \"tag\": \"lark_md\",\n                    \"content\": \"**Tr·∫°ng th√°i:** {{ $json[\"body\"][\"status\"]}}\"\n                  }\n                },\n                {\n                  \"is_short\": true,\n                  \"text\": {\n                    \"tag\": \"lark_md\",\n                    \"content\": \"**PTTT:** {{$json[\"body\"][\"payment_method_title\"]}}\"\n                  }\n                }\n              ]\n            },\n            {\n              \"tag\": \"hr\"\n            },\n            {\n              \"tag\": \"markdown\",\n              \"content\": \"**üë§ TH√îNG TIN KH√ÅCH H√ÄNG**\"\n            },\n            {\n              \"tag\": \"div\",\n              \"fields\": [\n                {\n                  \"is_short\": true,\n                  \"text\": {\n                    \"tag\": \"lark_md\",\n                    \"content\": \"**H·ªç v√† t√™nÔºö**\\n{{$json[\"body\"][\"billing\"][\"first_name\"]}} {{$json[\"body\"][\"billing\"][\"last_name\"]}}\"\n                  }\n                },\n                {\n                  \"is_short\": true,\n                  \"text\": {\n                    \"tag\": \"lark_md\",\n                    \"content\": \"**S·ªë ƒëi·ªán tho·∫°iÔºö**\\n{{$json[\"body\"][\"billing\"][\"phone\"]}}\"\n                  }\n                },\n                {\n                  \"is_short\": false,\n                  \"text\": {\n                    \"tag\": \"lark_md\",\n                    \"content\": \"**EmailÔºö**{{$json[\"body\"][\"billing\"][\"email\"]}}\"\n                  }\n                },\n                {\n                  \"is_short\": false,\n                  \"text\": {\n                    \"tag\": \"lark_md\",\n                    \"content\": \"**ƒê·ªãa ch·ªâ:** {{$json[\"body\"][\"billing\"][\"address_1\"]}} {{$json[\"body\"][\"billing\"][\"address_2\"]}} {{$json[\"body\"][\"billing\"][\"city\"]}} {{$json[\"body\"][\"billing\"][\"company\"]}}\"\n                  }\n                },\n                {\n          \"is_short\": false,\n          \"text\": {\n            \"tag\": \"lark_md\",\n            \"content\": \"**Ghi ch√∫:** {{$json[\"body\"][\"customer_note\"]}}\"\n          }\n        }\n              ]\n            },\n            {\n              \"tag\": \"hr\"\n            },\n            {\n              \"tag\": \"action\",\n              \"actions\": [\n                {\n                  \"tag\": \"button\",\n                  \"text\": {\n                    \"tag\": \"plain_text\",\n                    \"content\": \"X·ª≠ l√Ω ƒë∆°n h√†ng\"\n                  },\n                  \"url\": \"https://nucuoimekong.com/wp-admin/post.php?post={{$json[\"body\"][\"id\"]}}&action=edit\",\n                  \"type\": \"primary\"\n                },\n                {\n                  \"tag\": \"button\",\n                  \"text\": {\n                    \"tag\": \"plain_text\",\n                    \"content\": \"G·ªçi ƒëi·ªán t∆∞ v·∫•n\"\n                  },\n                  \"url\": \"tel:{{$json[\"body\"][\"billing\"][\"phone\"]}}\",\n                  \"type\": \"default\"\n                }\n              ]\n            }\n          ],\n          \"header\": {\n            \"template\": \"green\",\n            \"title\": {\n                \"content\": \"{{ $json[\"body\"][\"line_items\"][0][\"id\"] }} - ƒê∆°n h√†ng m·ªõi\",\n                \"tag\": \"plain_text\"\n            }\n          }\n    }\n}\n","options":{}},"id":"8d16ea94-bf16-4ba3-9f45-bcdd64d806c6","name":"HTTP Request","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[1560,580]}],"connections":{"Webhook":{"main":[[{"node":"HTTP Request","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{"Webhook":[{"json":{"headers":{"host":"app.n8n.vn","user-agent":"WooCommerce/7.3.0 Hookshot (WordPress/6.1.1)","content-length":"2595","accept":"*/*","accept-encoding":"deflate, gzip","content-type":"application/json","referer":"https://app.n8n.vn/webhook-test/ncmk-tao-don-hang","x-forwarded-for":"103.175.248.226","x-forwarded-host":"app.n8n.vn","x-forwarded-port":"443","x-forwarded-proto":"https","x-forwarded-server":"af4013275608","x-real-ip":"103.175.248.226","x-wc-webhook-delivery-id":"15feab25dfd239094ce444b7b980e21a","x-wc-webhook-event":"created","x-wc-webhook-id":"5","x-wc-webhook-resource":"order","x-wc-webhook-signature":"UfjVyk7D3mUKNrOWQVBJ6TR0wBr7vxwGxTRymQpyAsE=","x-wc-webhook-source":"https://nucuoimekong.com/","x-wc-webhook-topic":"order.created"},"params":{},"query":{},"body":{"id":44293,"parent_id":0,"status":"on-hold","currency":"VND","version":"7.3.0","prices_include_tax":false,"date_created":"2023-02-10T09:43:01","date_modified":"2023-02-10T09:43:02","discount_total":"0","discount_tax":"0","shipping_total":"0","shipping_tax":"0","cart_tax":"0","total":"200000","total_tax":"0","customer_id":656,"order_key":"wc_order_Kj39rLOFM2KAm","billing":{"first_name":"Khoi","last_name":"","company":"","address_1":"So 27, Duong B2, KDC Hung Phu 1, Hung Phu, Cai Rang","address_2":"","city":"Can Tho","state":"","postcode":"","country":"","email":"lekhoi456@gmail.com","phone":"0333111868"},"shipping":{"first_name":"","last_name":"","company":"","address_1":"","address_2":"","city":"","state":"","postcode":"","country":"","phone":""},"payment_method":"bacs","payment_method_title":"Chuy·ªÉn kho·∫£n ng√¢n h√†ng","transaction_id":"","customer_ip_address":"125.235.236.102","customer_user_agent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/109.0.0.0 Safari/537.36 Edg/109.0.1518.78","created_via":"checkout","customer_note":"Kh√¥i test","date_completed":null,"date_paid":null,"cart_hash":"fd0939d99ea328750bfe9d0e62864be4","number":"44293","meta_data":[{"id":307742,"key":"is_vat_exempt","value":"no"}],"line_items":[{"id":1192,"name":"Tour ch·ª£ n·ªïi C√°i RƒÉng gh√©p ƒëo√†n - Gi√° c·ª±c r·∫ª ch·ªâ v·ªõi 100k","product_id":369,"variation_id":0,"quantity":2,"tax_class":"","subtotal":"200000","subtotal_tax":"0","total":"200000","total_tax":"0","taxes":[],"meta_data":[{"id":12068,"key":"Ng√†y kh·ªüi h√†nh","value":"14/02/2023","display_key":"Ng√†y kh·ªüi h√†nh","display_value":"14/02/2023"}],"sku":"","price":100000,"image":{"id":"14408","src":"https://nucuoimekong.com/wp-content/uploads/ghe-tau-tap-nap-cho-noi-cai-rang.jpg"},"parent_name":null}],"tax_lines":[],"shipping_lines":[],"fee_lines":[],"coupon_lines":[],"refunds":[],"payment_url":"https://nucuoimekong.com/dat-tour/order-pay/44293?pay_for_order=true&key=wc_order_Kj39rLOFM2KAm","is_editable":true,"needs_payment":false,"needs_processing":true,"date_created_gmt":"2023-02-10T02:43:01","date_modified_gmt":"2023-02-10T02:43:02","date_completed_gmt":null,"date_paid_gmt":null,"currency_symbol":"‚Ç´","_links":{"self":[{"href":"https://nucuoimekong.com/wp-json/wc/v3/orders/44293"}],"collection":[{"href":"https://nucuoimekong.com/wp-json/wc/v3/orders"}],"customer":[{"href":"https://nucuoimekong.com/wp-json/wc/v3/customers/656"}]}}}}]},"versionId":"af329dda-b5c0-4a33-8250-e7a578e9b8e9","triggerCount":1,"tags":[{"createdAt":"2023-02-10T04:34:16.814Z","updatedAt":"2023-02-10T04:34:16.814Z","id":"9","name":"ncmk"}]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-02-15T20:55:33.897Z","updatedAt":"2023-02-19T00:17:24.000Z","id":"30","name":"D·ª± b√°o th·ªùi ti·∫øt","active":false,"nodes":[{"parameters":{"cityName":"hanoi","language":"vi"},"id":"c5da4b2d-79a4-44ef-b793-594b08cbacfa","name":"OpenWeatherMap","type":"n8n-nodes-base.openWeatherMap","typeVersion":1,"position":[400,280],"credentials":{"openWeatherMapApi":{"id":"16","name":"OpenWeatherMap account"}}},{"parameters":{"method":"POST","url":"https://www.larksuite.com/flow/api/trigger-webhook/aa085f81beda28bb8c1030c6bca414c9","sendBody":true,"specifyBody":"json","jsonBody":" { \"coord\": { \"lon\": 105.8412, \"lat\": 21.0245 }, \"weather\": { \"id\": 804, \"main\": \"Clouds\", \"description\": \"m√¢y ƒëen u √°m\", \"icon\": \"04n\" }, \"base\": \"stations\", \"main\": { \"temp\": 16, \"feels_like\": 15.3, \"temp_min\": 16, \"temp_max\": 16, \"pressure\": 1022, \"humidity\": 63, \"sea_level\": 1022, \"grnd_level\": 1021 }, \"visibility\": 10000, \"wind\": { \"speed\": 0.11, \"deg\": 61, \"gust\": 0.74 }, \"clouds\": { \"all\": 100 }, \"dt\": 1676494572, \"sys\": { \"type\": 1, \"id\": 9308, \"country\": \"VN\", \"sunrise\": 1676503610, \"sunset\": 1676544895 }, \"timezone\": 25200, \"id\": 1581130, \"name\": \"H√† N·ªôi\", \"cod\": 200 }","options":{}},"id":"8bc18522-d145-49e2-9db4-b312b5e1cb52","name":"HTTP Request","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[600,280]},{"parameters":{"rule":{"interval":[{"triggerAtHour":7}]}},"id":"59e47bbf-9c40-45b7-9258-42d7c6c51733","name":"Schedule Trigger","type":"n8n-nodes-base.scheduleTrigger","typeVersion":1,"position":[160,280]}],"connections":{"OpenWeatherMap":{"main":[[{"node":"HTTP Request","type":"main","index":0}]]},"Schedule Trigger":{"main":[[{"node":"OpenWeatherMap","type":"main","index":0}]]}},"settings":{},"staticData":{"node:Schedule Trigger":{"recurrencyRules":[]}},"pinData":{},"versionId":"6a72e297-8cef-41ed-a6d3-4a18acdd2e71","triggerCount":1,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-02-15T21:27:04.483Z","updatedAt":"2023-02-27T03:03:59.000Z","id":"31","name":"Woo order","active":false,"nodes":[{"parameters":{"event":"order.created"},"id":"b3596d9f-d5ba-49f8-8696-180ebc23a5d5","name":"WooCommerce Trigger","type":"n8n-nodes-base.wooCommerceTrigger","typeVersion":1,"position":[520,260],"webhookId":"177edec4-2bed-4ea0-a4df-d72a96d29799","credentials":{"wooCommerceApi":{"id":"17","name":"WooCommerce account"}}},{"parameters":{"method":"POST","url":"https://www.larksuite.com/flow/api/trigger-webhook/1288112ee189990d6286a7c04a0e0165","sendBody":true,"specifyBody":"json","jsonBody":"\n{\n\"id\":\n3544,\n\"parent_id\":\n0,\n\"status\":\n\"on-hold\",\n\"currency\":\n\"VND\",\n\"version\":\n\"7.4.0\",\n\"prices_include_tax\":\nfalse,\n\"date_created\":\n\"2023-02-16T04:27:27\",\n\"date_modified\":\n\"2023-02-16T04:27:27\",\n\"discount_total\":\n\"0\",\n\"discount_tax\":\n\"0\",\n\"shipping_total\":\n\"0\",\n\"shipping_tax\":\n\"0\",\n\"cart_tax\":\n\"0\",\n\"total\":\n\"1460000\",\n\"total_tax\":\n\"0\",\n\"customer_id\":\n1,\n\"order_key\":\n\"wc_order_2wGwkaDBmt2Uo\",\n\"billing\":\n{\n\"first_name\":\n\"Nguy·ªÖn T√¢m Quang\",\n\"last_name\":\n\"\",\n\"company\":\n\"\",\n\"address_1\":\n\"240 M·ªπ ƒê√¨nh\",\n\"address_2\":\n\"\",\n\"city\":\n\"\",\n\"state\":\n\"\",\n\"postcode\":\n\"\",\n\"country\":\n\"\",\n\"email\":\n\"quangsocial@gmail.com\",\n\"phone\":\n\"0965623663\"\n},\n\"shipping\":\n{\n\"first_name\":\n\"\",\n\"last_name\":\n\"\",\n\"company\":\n\"\",\n\"address_1\":\n\"\",\n\"address_2\":\n\"\",\n\"city\":\n\"\",\n\"state\":\n\"\",\n\"postcode\":\n\"\",\n\"country\":\n\"\",\n\"phone\":\n\"\"\n},\n\"payment_method\":\n\"bacs\",\n\"payment_method_title\":\n\"Chuy·ªÉn kho·∫£n ng√¢n h√†ng\",\n\"transaction_id\":\n\"\",\n\"customer_ip_address\":\n\"42.113.129.185\",\n\"customer_user_agent\":\n\"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/110.0.0.0 Safari/537.36\",\n\"created_via\":\n\"checkout\",\n\"customer_note\":\n\"\",\n\"date_completed\":\nnull,\n\"date_paid\":\nnull,\n\"cart_hash\":\n\"67a82e001f2576e974d90d9d8817d64b\",\n\"number\":\n\"3544\",\n\"meta_data\":\n[\n{\n\"id\":\n20009,\n\"key\":\n\"is_vat_exempt\",\n\"value\":\n\"no\"\n}\n],\n\"line_items\":\n[\n{\n\"id\":\n362,\n\"name\":\n\"Tr√† √î Long - ƒê·∫°i C√°t T∆∞·ªùng - H≈© ƒê·ªè\",\n\"product_id\":\n981,\n\"variation_id\":\n1381,\n\"quantity\":\n1,\n\"tax_class\":\n\"\",\n\"subtotal\":\n\"1460000\",\n\"subtotal_tax\":\n\"0\",\n\"total\":\n\"1460000\",\n\"total_tax\":\n\"0\",\n\"taxes\":\n[\n],\n\"meta_data\":\n[\n{\n\"id\":\n3507,\n\"key\":\n\"hu\",\n\"value\":\n\"H≈© ƒê·ªè\",\n\"display_key\":\n\"H≈©\",\n\"display_value\":\n\"H≈© ƒê·ªè\"\n},\n{\n\"id\":\n3508,\n\"key\":\n\"_reduced_stock\",\n\"value\":\n\"1\",\n\"display_key\":\n\"_reduced_stock\",\n\"display_value\":\n\"1\"\n}\n],\n\"sku\":\n\"T8HUDO\",\n\"price\":\n1460000,\n\"image\":\n{\n\"id\":\n3335,\n\"src\":\n\"https://tinhhoatraviet.vn/wp-content/uploads/2021/12/dct1-2.png\"\n},\n\"parent_name\":\n\"Tr√† √î Long - ƒê·∫°i C√°t T∆∞·ªùng\"\n}\n],\n\"tax_lines\":\n[\n],\n\"shipping_lines\":\n[\n],\n\"fee_lines\":\n[\n],\n\"coupon_lines\":\n[\n],\n\"refunds\":\n[\n],\n\"payment_url\":\n\"https://tinhhoatraviet.vn/thanh-toan/order-pay/3544?pay_for_order=true&key=wc_order_2wGwkaDBmt2Uo\",\n\"is_editable\":\ntrue,\n\"needs_payment\":\nfalse,\n\"needs_processing\":\ntrue,\n\"date_created_gmt\":\n\"2023-02-15T21:27:27\",\n\"date_modified_gmt\":\n\"2023-02-15T21:27:27\",\n\"date_completed_gmt\":\nnull,\n\"date_paid_gmt\":\nnull,\n\"currency_symbol\":\n\"‚Ç´\",\n\"_links\":\n{\n\"self\":\n[\n{\n\"href\":\n\"https://tinhhoatraviet.vn/wp-json/wc/v3/orders/3544\"\n}\n],\n\"collection\":\n[\n{\n\"href\":\n\"https://tinhhoatraviet.vn/wp-json/wc/v3/orders\"\n}\n],\n\"customer\":\n[\n{\n\"href\":\n\"https://tinhhoatraviet.vn/wp-json/wc/v3/customers/1\"\n}\n]\n},\n\"msg_type\":\n\"interactive\",\n\"card\":\n{\n\"config\":\n{\n\"wide_screen_mode\":\ntrue\n},\n\"header\":\n{\n\"template\":\n\"green\",\n\"title\":\n{\n\"content\":\n\"(15/02/2023 21:27:34) ORDER ON-HOLD\",\n\"tag\":\n\"plain_text\"\n}\n},\n\"i18n_elements\":\n{\n\"en_us\":\n[\n{\n\"fields\":\n[\n{\n\"is_short\":\ntrue,\n\"text\":\n{\n\"content\":\n\"üó≥ ORDER NUMBER: **3544**\",\n\"tag\":\n\"lark_md\"\n}\n},\n{\n\"is_short\":\ntrue,\n\"text\":\n{\n\"content\":\n\"üìÖ DATE: **15/02/2023 21:27:34**\",\n\"tag\":\n\"lark_md\"\n}\n},\n{\n\"is_short\":\nfalse,\n\"text\":\n{\n\"content\":\n\"\",\n\"tag\":\n\"lark_md\"\n}\n},\n{\n\"is_short\":\ntrue,\n\"text\":\n{\n\"content\":\n\"üì© EMAIL: **quangsocial@gmail.com**\",\n\"tag\":\n\"lark_md\"\n}\n},\n{\n\"is_short\":\ntrue,\n\"text\":\n{\n\"content\":\n\"üèß PAYMENT METHOD: **Chuy·ªÉn kho·∫£n ng√¢n h√†ng**\",\n\"tag\":\n\"lark_md\"\n}\n},\n{\n\"tag\":\n\"div\",\n\"text\":\n{\n\"content\":\n\"- BILLING DETAILS\",\n\"tag\":\n\"lark_md\"\n}\n},\n{\n\"is_short\":\nfalse,\n\"text\":\n{\n\"content\":\n\"\",\n\"tag\":\n\"lark_md\"\n}\n},\n{\n\"is_short\":\ntrue,\n\"text\":\n{\n\"content\":\n\"üë§ **Nguy·ªÖn T√¢m Quang ()**\",\n\"tag\":\n\"lark_md\"\n}\n},\n{\n\"is_short\":\ntrue,\n\"text\":\n{\n\"content\":\n\"üì±**0965623663**\",\n\"tag\":\n\"lark_md\"\n}\n},\n{\n\"is_short\":\ntrue,\n\"text\":\n{\n\"content\":\n\"üöï **240 M·ªπ ƒê√¨nh , , , **\",\n\"tag\":\n\"lark_md\"\n}\n},\n{\n\"tag\":\n\"div\",\n\"text\":\n{\n\"content\":\n\"- SHIPPING DETAILS\",\n\"tag\":\n\"lark_md\"\n}\n},\n{\n\"is_short\":\nfalse,\n\"text\":\n{\n\"content\":\n\"\",\n\"tag\":\n\"lark_md\"\n}\n},\n{\n\"is_short\":\ntrue,\n\"text\":\n{\n\"content\":\n\"üë§ ** ()**\",\n\"tag\":\n\"lark_md\"\n}\n},\n{\n\"is_short\":\ntrue,\n\"text\":\n{\n\"content\":\n\"üì±****\",\n\"tag\":\n\"lark_md\"\n}\n},\n{\n\"is_short\":\ntrue,\n\"text\":\n{\n\"content\":\n\"üöï ** , , , **\",\n\"tag\":\n\"lark_md\"\n}\n}\n],\n\"tag\":\n\"div\"\n},\n{\n\"tag\":\n\"div\",\n\"text\":\n{\n\"content\":\n\"- **ORDER DETAILS**\",\n\"tag\":\n\"lark_md\"\n}\n},\n{\n\"fields\":\n[\n{\n\"is_short\":\ntrue,\n\"text\":\n{\n\"content\":\n\"**Product**\",\n\"tag\":\n\"lark_md\"\n}\n},\n{\n\"is_short\":\ntrue,\n\"text\":\n{\n\"content\":\n\"**Sub total**\",\n\"tag\":\n\"lark_md\"\n}\n},\n{\n\"is_short\":\nfalse,\n\"text\":\n{\n\"content\":\n\"\",\n\"tag\":\n\"lark_md\"\n}\n},\n{\n\"is_short\":\ntrue,\n\"text\":\n{\n\"content\":\n\"Tr√† √î Long - ƒê·∫°i C√°t T∆∞·ªùng - H≈© ƒê·ªè x 1\",\n\"tag\":\n\"lark_md\"\n}\n},\n{\n\"is_short\":\ntrue,\n\"text\":\n{\n\"content\":\n\"1.460.000\",\n\"tag\":\n\"lark_md\"\n}\n},\n{\n\"is_short\":\nfalse,\n\"text\":\n{\n\"content\":\n\"\",\n\"tag\":\n\"lark_md\"\n}\n},\n{\n\"is_short\":\ntrue,\n\"text\":\n{\n\"content\":\n\"**Shipping**\",\n\"tag\":\n\"lark_md\"\n}\n},\n{\n\"is_short\":\ntrue,\n\"text\":\n{\n\"content\":\n\"\",\n\"tag\":\n\"lark_md\"\n}\n},\n{\n\"is_short\":\ntrue,\n\"text\":\n{\n\"content\":\nnull,\n\"tag\":\n\"lark_md\"\n}\n},\n{\n\"is_short\":\nfalse,\n\"text\":\n{\n\"content\":\n\"\",\n\"tag\":\n\"lark_md\"\n}\n},\n{\n\"is_short\":\ntrue,\n\"text\":\n{\n\"content\":\n\"**TOTAL**\",\n\"tag\":\n\"lark_md\"\n}\n},\n{\n\"is_short\":\ntrue,\n\"text\":\n{\n\"content\":\n\"**1.460.000 ‚Ç´**\",\n\"tag\":\n\"lark_md\"\n}\n}\n],\n\"tag\":\n\"div\"\n},\n{\n\"actions\":\n[\n{\n\"tag\":\n\"button\",\n\"text\":\n{\n\"content\":\n\"MANAGE\",\n\"tag\":\n\"plain_text\"\n},\n\"type\":\n\"primary\",\n\"url\":\n\"https://tinhhoatraviet.vn/wp-admin/post.php?post=3544&action=edit\"\n}\n],\n\"tag\":\n\"action\"\n}\n]\n}\n}\n}","options":{}},"id":"fa7436ac-0187-47c1-b4d0-7ad9d12aa635","name":"HTTP Request","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[840,260]}],"connections":{"WooCommerce Trigger":{"main":[[{"node":"HTTP Request","type":"main","index":0}]]}},"settings":{},"staticData":{"node:WooCommerce Trigger":{"webhookId":17,"secret":"6a935b552e8783ba4dd051a38da1288a"}},"pinData":{},"versionId":"c440c94f-29b8-4f82-b40f-a670b3923887","triggerCount":1,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-02-24T02:35:49.606Z","updatedAt":"2023-02-24T02:38:01.000Z","id":"33","name":"[Lark] Get app access token","active":false,"nodes":[{"parameters":{},"id":"0d2483c3-d460-47a7-b561-27ea1c406edc","name":"When clicking \"Execute Workflow\"","type":"n8n-nodes-base.manualTrigger","typeVersion":1,"position":[620,400]},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/auth/v3/app_access_token/internal","sendBody":true,"specifyBody":"json","jsonBody":"{ \"app_id\" : \"cli_a372a34abe789010\", \"app_secret\" : \"DKmzzhZm18FAtMhlk2pLwczi6JVMvytI\"  }","options":{}},"id":"500013e7-7854-42f6-b92b-2e93dff15f64","name":"HTTP Request","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[840,400]},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/authen/v1/access_token","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $json[\"app_access_token\"] }}"}]},"sendBody":true,"specifyBody":"json","jsonBody":"{     \"grant_type\": \"authorization_code\",     \"code\": \"141hfefa068a4ba7abdf99a1c98ad47v\" }","options":{}},"id":"746cbc58-f6df-419d-8083-f66139a61bb0","name":"HTTP Request1","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[1060,400]},{"parameters":{"operation":"update","documentId":{"__rl":true,"value":"1RDBBTEXxrC07DE8hjVFYrhIzz5h9BHhojcFhgZDOBxU","mode":"list","cachedResultName":"Lark Connector Token","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1RDBBTEXxrC07DE8hjVFYrhIzz5h9BHhojcFhgZDOBxU/edit?usp=drivesdk"},"sheetName":{"__rl":true,"value":"gid=0","mode":"list","cachedResultName":"Trang t√≠nh1","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1RDBBTEXxrC07DE8hjVFYrhIzz5h9BHhojcFhgZDOBxU/edit#gid=0"},"columnToMatchOn":"key","valueToMatchOn":"lark_key","fieldsUi":{"values":[{"column":"access_token","fieldValue":"={{ $json[\"data\"][\"access_token\"] }}"},{"column":"expires_in","fieldValue":"={{ $json[\"data\"][\"expires_in\"] }}"},{"column":"refresh_token","fieldValue":"={{ $json[\"data\"][\"refresh_token\"] }}"},{"column":"refresh_expires_in","fieldValue":"={{ $json[\"data\"][\"refresh_expires_in\"] }}"}]},"options":{}},"id":"8f93c974-c5a6-45cb-80dc-13d263532f8d","name":"Google Sheets","type":"n8n-nodes-base.googleSheets","typeVersion":3,"position":[1280,400],"credentials":{"googleSheetsOAuth2Api":{"id":"3","name":"Google Sheets lekhoi456@gmail.com"}}}],"connections":{"When clicking \"Execute Workflow\"":{"main":[[{"node":"HTTP Request","type":"main","index":0}]]},"HTTP Request":{"main":[[{"node":"HTTP Request1","type":"main","index":0}]]},"HTTP Request1":{"main":[[{"node":"Google Sheets","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{},"versionId":"7b1cc06a-a537-466f-88ca-6a0357911207","triggerCount":0,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-02-24T02:36:37.047Z","updatedAt":"2023-02-24T02:39:36.000Z","id":"34","name":"[Lark] Get Refresh token","active":false,"nodes":[{"parameters":{"rule":{"interval":[{"field":"minutes","minutesInterval":110}]}},"id":"2dfbf5fa-2bff-4c7d-bcf4-1ddafc925f89","name":"110m","type":"n8n-nodes-base.scheduleTrigger","typeVersion":1,"position":[520,180]},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/auth/v3/app_access_token/internal","sendBody":true,"specifyBody":"json","jsonBody":"{ \"app_id\" : \"cli_a372a34abe789010\", \"app_secret\" : \"DKmzzhZm18FAtMhlk2pLwczi6JVMvytI\" }","options":{}},"id":"55f57b77-db00-4aa4-bf8b-a20fd7596435","name":"Get app_access_token","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[740,180]},{"parameters":{"documentId":{"__rl":true,"value":"1RDBBTEXxrC07DE8hjVFYrhIzz5h9BHhojcFhgZDOBxU","mode":"list","cachedResultName":"Lark Connector Token","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1RDBBTEXxrC07DE8hjVFYrhIzz5h9BHhojcFhgZDOBxU/edit?usp=drivesdk"},"sheetName":{"__rl":true,"value":"gid=0","mode":"list","cachedResultName":"Kdigivn","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1RDBBTEXxrC07DE8hjVFYrhIzz5h9BHhojcFhgZDOBxU/edit#gid=0"},"filtersUI":{"values":[{"lookupColumn":"key","lookupValue":"lark_key"}]},"options":{}},"id":"ecfb0782-4125-4a40-b876-f150fd2f6fac","name":"Get refresh_token","type":"n8n-nodes-base.googleSheets","typeVersion":3,"position":[960,180],"credentials":{"googleSheetsOAuth2Api":{"id":"3","name":"Google Sheets lekhoi456@gmail.com"}}},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/authen/v1/refresh_access_token","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $node[\"Get app_access_token\"].json[\"app_access_token\"] }}"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\n    \"grant_type\": \"refresh_token\",\n    \"refresh_token\": \"{{ $json[\"refresh_token\"] }}\"\n}","options":{}},"id":"6195d85f-5e54-4ae1-8318-f1ecfd42f0b0","name":"Get access_token, refresh_token","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[1180,180]},{"parameters":{"operation":"update","documentId":{"__rl":true,"value":"1RDBBTEXxrC07DE8hjVFYrhIzz5h9BHhojcFhgZDOBxU","mode":"list","cachedResultName":"Lark Connector Token","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1RDBBTEXxrC07DE8hjVFYrhIzz5h9BHhojcFhgZDOBxU/edit?usp=drivesdk"},"sheetName":{"__rl":true,"value":"gid=0","mode":"list","cachedResultName":"Kdigivn","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1RDBBTEXxrC07DE8hjVFYrhIzz5h9BHhojcFhgZDOBxU/edit#gid=0"},"columnToMatchOn":"key","valueToMatchOn":"lark_key","fieldsUi":{"values":[{"column":"access_token","fieldValue":"={{ $json[\"data\"][\"access_token\"] }}"},{"column":"expires_in","fieldValue":"={{ $json[\"data\"][\"expires_in\"] }}"},{"column":"refresh_token","fieldValue":"={{ $json[\"data\"][\"refresh_token\"] }}"},{"column":"refresh_expires_in","fieldValue":"={{ $json[\"data\"][\"refresh_expires_in\"] }}"}]},"options":{}},"id":"4ab7811f-075e-4b56-8aef-eccf6c06f862","name":"Update access token, refresh token","type":"n8n-nodes-base.googleSheets","typeVersion":3,"position":[1400,180],"credentials":{"googleSheetsOAuth2Api":{"id":"3","name":"Google Sheets lekhoi456@gmail.com"}}}],"connections":{"110m":{"main":[[{"node":"Get app_access_token","type":"main","index":0}]]},"Get app_access_token":{"main":[[{"node":"Get refresh_token","type":"main","index":0}]]},"Get refresh_token":{"main":[[{"node":"Get access_token, refresh_token","type":"main","index":0}]]},"Get access_token, refresh_token":{"main":[[{"node":"Update access token, refresh token","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{},"versionId":"fd9278d9-ea73-47c2-b4da-a7fa88dd893f","triggerCount":0,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-02-24T10:38:32.009Z","updatedAt":"2023-05-15T04:00:31.000Z","id":"35","name":"[Caresoft] Get call logs every hour","active":true,"nodes":[{"parameters":{"rule":{"interval":[{"field":"hours"}]}},"id":"863e67af-d7e6-4a44-924f-99d4a40e96e4","name":"Schedule Trigger","type":"n8n-nodes-base.scheduleTrigger","typeVersion":1,"position":[840,400]},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/auth/v3/tenant_access_token/internal/","sendBody":true,"specifyBody":"json","jsonBody":"{\n    \"app_id\": \"cli_a372a34abe789010\",\n    \"app_secret\": \"DKmzzhZm18FAtMhlk2pLwczi6JVMvytI\"\n}","options":{}},"id":"86de20e1-3dda-4a68-93ab-1b39d8b4628c","name":"Get tenant access token","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[1360,400]},{"parameters":{"jsCode":"// Loop over input items and add a new field\n// called 'myNewField' to the JSON of each one\nlet startDate = new Date($('Schedule Trigger').first().json.timestamp);\nlet endDate = new Date($('Schedule Trigger').first().json.timestamp);\n\nstartDate.setHours(startDate.getHours() + 6);\n// startDate.setHours(startDate.getHours() - 720); // fetch data previous 30 days\nstartDate.setMinutes(0);\nstartDate.setSeconds(1);\n\nendDate.setHours(endDate.getHours() + 7); // Add 7 hrs to compensate for Caresoft time\n\nreturn {\n  json: {\n    startDate: startDate.toISOString(),\n    endDate: endDate.toISOString(),\n  },\n};"},"id":"31014313-6699-4671-a7ef-1204b3061fdf","name":"Get start time","type":"n8n-nodes-base.code","typeVersion":1,"position":[1000,400]},{"parameters":{"url":"https://web11.caresoft.vn/hsvn/api/v1/calls","sendQuery":true,"queryParameters":{"parameters":[{"name":"start_time_since","value":"={{ $node[\"Get start time\"].json.startDate }}"},{"name":"start_time_to","value":"={{ $node[\"Get start time\"].json.endDate }}"},{"name":"count","value":"500"},{"name":"page","value":"1"},{"name":"order_by","value":"start_time"},{"name":"order_type","value":"desc"}]},"sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"Bearer 1g6yF9w3pPbn-kc"}]},"options":{}},"id":"838ef8d3-5b73-4868-9fb6-0a87404515f9","name":"Get call log in the last hour","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[1180,400]},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/bitable/v1/apps/baslg7TBWBKBB5Bc5vJhovnm3Jc/tables/tbl62BNK4pAYT76F/records/batch_create","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $node[\"Get tenant access token\"].json.tenant_access_token }}"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\"records\":{{ JSON.stringify($('[Call Log] Convert to Lark format').first().json.records) }}}","options":{}},"id":"b9e07148-6d3b-4a9b-9be9-461909cb1999","name":"[Call data] Add records to Bitable","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[1800,520]},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/bitable/v1/apps/baslg7TBWBKBB5Bc5vJhovnm3Jc/tables/tblstCVsQu0Etn5e/records/batch_create","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $node[\"Get tenant access token\"].json.tenant_access_token }}"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\"records\":{{ JSON.stringify($('[Raw call log] Convert to Lark format').first().json.records) }}}","options":{}},"id":"2e649d4c-1b89-4081-8336-05d2f3494333","name":"[Raw call log data] Add records to Bitable","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[1800,300]},{"parameters":{"jsCode":"let input = $('Get call log in the last hour').first().json.calls;\n\n// Get calls data\nlet records = input.map((call) => {\n  let fields = {\n    id: call.id,\n    customer_id: call.customer_id,\n    call_id: call.call_id,\n    path: {\n      text: \"Xem cu·ªôc g·ªçi\",\n      link: call.path\n    },\n    path_download: {\n      text:\"T·∫£i cu·ªôc g·ªçi\",\n      link: call.path_download\n    },\n    caller: call.caller,\n    called: call.called,\n    user_id: call.user_id,\n    agent_id: call.agent_id.split(',').at(-1),\n    agent_log: call.agent_id,\n    group_id: call.group_id,\n    call_type: call.call_type,\n    start_time: new Date(call.start_time).getTime() - 3600000*7, // substract 7hrs\n    call_status: call.call_status,\n    end_time: new Date(call.end_time).getTime() - 3600000*7,\n    wait_time: call.wait_time,\n    hold_time: call.hold_time,\n    talk_time: call.talk_time,\n    end_status: call.end_status,\n    ticket_id: call.ticket_id,\n    last_agent_id: call.last_agent_id,\n    last_user_id: call.last_user_id,\n    call_survey: call.call_survey,\n    call_survey_result: call.call_survey_result,\n    missed_reason: call.missed_reason,\n  };\n  return { fields };\n});\n\nlet result = { json: { records } };\nreturn result;"},"id":"9299045c-c9bb-4f90-87b9-30f6f1f596d9","name":"[Raw call log] Convert to Lark format","type":"n8n-nodes-base.code","typeVersion":1,"position":[1600,300]},{"parameters":{"jsCode":"let input = $('Get call log in the last hour').first().json.calls;\n\n// Get calls data\nlet records = input.map((call) => {\n  let fields = {    \n    \"ID cu·ªôc g·ªçi\": call.call_id,   \n    // customer_id: call.customer_id,\n    // agent_id: call.agent_id,\n    // group_id: call.group_id,    \n    // ticket_id: call.ticket_id,   \n  };\n  return { fields };\n});\n\nlet result = { json: { records } };\nreturn result;"},"id":"7ae0b4f9-1a55-4161-94b2-33aa3ef65902","name":"[Call Log] Convert to Lark format","type":"n8n-nodes-base.code","typeVersion":1,"position":[1600,520]}],"connections":{"Schedule Trigger":{"main":[[{"node":"Get start time","type":"main","index":0}]]},"Get tenant access token":{"main":[[{"node":"[Raw call log] Convert to Lark format","type":"main","index":0},{"node":"[Call Log] Convert to Lark format","type":"main","index":0}]]},"Get start time":{"main":[[{"node":"Get call log in the last hour","type":"main","index":0}]]},"Get call log in the last hour":{"main":[[{"node":"Get tenant access token","type":"main","index":0}]]},"[Raw call log] Convert to Lark format":{"main":[[{"node":"[Raw call log data] Add records to Bitable","type":"main","index":0}]]},"[Call Log] Convert to Lark format":{"main":[[{"node":"[Call data] Add records to Bitable","type":"main","index":0}]]}},"settings":{},"staticData":{"node:Schedule Trigger":{"recurrencyRules":[]}},"pinData":{},"versionId":"736cda1b-02b7-40a3-9f97-0ec7823cbe13","triggerCount":1,"tags":[{"createdAt":"2023-02-27T05:42:03.910Z","updatedAt":"2023-02-27T05:42:03.910Z","id":"10","name":"Caresoft"}]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-02-27T07:44:22.984Z","updatedAt":"2023-03-01T03:17:23.000Z","id":"36","name":"[Caresoft] Get agents daily","active":true,"nodes":[{"parameters":{"rule":{"interval":[{}]}},"id":"f9daa424-4069-40ab-a679-b065d765c7d1","name":"Schedule Trigger","type":"n8n-nodes-base.scheduleTrigger","typeVersion":1,"position":[840,400]},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/auth/v3/tenant_access_token/internal/","sendBody":true,"specifyBody":"json","jsonBody":"{\n    \"app_id\": \"cli_a372a34abe789010\",\n    \"app_secret\": \"DKmzzhZm18FAtMhlk2pLwczi6JVMvytI\"\n}","options":{}},"id":"cf95d5c8-492c-45a7-aafa-c284c9146382","name":"Get tenant access token","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[1000,400]},{"parameters":{"jsCode":"let input = $('Get agents').first().json.agents;\n\n// Get calls data\nlet records = input.map((agent) => {\n  let fields = {\n     \"id\":agent.id,\n    \"username\":agent.username,\n    \"email\":{\n      text: agent.email,\n      link: agent.email\n    },\n    \"phone_no\":agent.phone_no,\n    \"agent_id\":agent.agent_id,\n    \"created_at\":agent.created_at,\n    \"updated_at\":agent.updated_at,\n    \"group_id\":agent.group_id,\n    \"group_name\":agent.group_name,\n    \"role_id\":agent.role_id,\n    \"login_status\":agent.login_status,\n    \"call_status\":agent.call_status,\n  };\n  return { fields };\n});\n\nlet result = { json: { records } };\nreturn result;"},"id":"f22c39b7-9b44-4957-a254-c747f06ef854","name":"Convert to Lark format","type":"n8n-nodes-base.code","typeVersion":1,"position":[2140,420]},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/bitable/v1/apps/baslg7TBWBKBB5Bc5vJhovnm3Jc/tables/tblTRHA0aXNj5TXU/records/batch_create","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $node[\"Get tenant access token\"].json.tenant_access_token }}"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\"records\":{{ JSON.stringify($('Convert to Lark format').first().json.records) }}}","options":{}},"id":"8784d563-bc3c-4b25-a1d9-ec5e40ca1f6c","name":"Add records to Bitable","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[2340,420]},{"parameters":{"url":"https://open.larksuite.com/open-apis/bitable/v1/apps/baslg7TBWBKBB5Bc5vJhovnm3Jc/tables/tblTRHA0aXNj5TXU/records","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $node[\"Get tenant access token\"].json.tenant_access_token }}"}]},"options":{}},"id":"37c07281-2603-4d06-a86d-1b3b8a594d3f","name":"Get all records","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[1180,400]},{"parameters":{"jsCode":"let input = $('Get all records').first().json.data.items;\n\nlet records = input.map((record) => {\n  return record.record_id\n})\n\nreturn {json: {records}};"},"id":"0c65d3bc-1193-4280-995c-5c585cb29442","name":"Get record id","type":"n8n-nodes-base.code","typeVersion":1,"position":[1520,180]},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/bitable/v1/apps/baslg7TBWBKBB5Bc5vJhovnm3Jc/tables/tblTRHA0aXNj5TXU/records/batch_delete","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $node[\"Get tenant access token\"].json.tenant_access_token }}"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\"records\":{{ JSON.stringify($node[\"Get record id\"].json.records) }} }","options":{}},"id":"69699655-1c78-4080-a89f-e4e76c2dc87a","name":"Delete records","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[1740,180]},{"parameters":{"url":"https://web11.caresoft.vn/hsvn/api/v1/agents","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"Bearer 1g6yF9w3pPbn-kc"}]},"options":{}},"id":"771eed38-4240-4b8d-addb-51ed8fdb8bf6","name":"Get agents","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[1940,420]},{"parameters":{"conditions":{"number":[{"value1":"={{ $json.data.items?.length }}","operation":"larger"}]}},"id":"9f462855-ac74-4b3f-be2d-c918a7c0c02f","name":"IF","type":"n8n-nodes-base.if","typeVersion":1,"position":[1360,400]}],"connections":{"Schedule Trigger":{"main":[[{"node":"Get tenant access token","type":"main","index":0}]]},"Get tenant access token":{"main":[[{"node":"Get all records","type":"main","index":0}]]},"Get all records":{"main":[[{"node":"IF","type":"main","index":0}]]},"Get record id":{"main":[[{"node":"Delete records","type":"main","index":0}]]},"Get agents":{"main":[[{"node":"Convert to Lark format","type":"main","index":0}]]},"Delete records":{"main":[[{"node":"Get agents","type":"main","index":0}]]},"Convert to Lark format":{"main":[[{"node":"Add records to Bitable","type":"main","index":0}]]},"IF":{"main":[[{"node":"Get record id","type":"main","index":0}],[{"node":"Get agents","type":"main","index":0}]]}},"settings":{},"staticData":{"node:Schedule Trigger":{"recurrencyRules":[]}},"pinData":{},"versionId":"2c147ad4-b3ed-442f-9500-d6e3c828836d","triggerCount":1,"tags":[{"createdAt":"2023-02-27T05:42:03.910Z","updatedAt":"2023-02-27T05:42:03.910Z","id":"10","name":"Caresoft"}]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-02-27T08:54:26.591Z","updatedAt":"2023-05-15T04:28:00.000Z","id":"37","name":"[Caresoft] Get chat every hour","active":true,"nodes":[{"parameters":{"rule":{"interval":[{"field":"hours"}]}},"id":"30e9137c-8f8c-42d8-82fd-06d0775d7c82","name":"Schedule Trigger","type":"n8n-nodes-base.scheduleTrigger","typeVersion":1,"position":[800,380]},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/auth/v3/tenant_access_token/internal/","sendBody":true,"specifyBody":"json","jsonBody":"{\n    \"app_id\": \"cli_a372a34abe789010\",\n    \"app_secret\": \"DKmzzhZm18FAtMhlk2pLwczi6JVMvytI\"\n}","options":{}},"id":"655d5dfb-ea6b-4fc8-87cc-17817b7e311b","name":"Get tenant access token","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[1800,420]},{"parameters":{"jsCode":"// Loop over input items and add a new field\n// called 'myNewField' to the JSON of each one\nlet startDate = new Date($('Schedule Trigger').first().json.timestamp);\nlet endDate = new Date($('Schedule Trigger').first().json.timestamp);\n\nstartDate.setHours(startDate.getHours() + 6);\n// startDate.setHours(startDate.getHours() - 720); // fetch data previous 30 days\nstartDate.setMinutes(0);\nstartDate.setSeconds(1);\n\nendDate.setHours(endDate.getHours() + 7); // Add 7 hrs to compensate for Caresoft time\n\nreturn {\n  json: {\n    startDate: startDate.toISOString(),\n    endDate: endDate.toISOString(),\n  },\n};"},"id":"b4b4b035-7389-4dae-82b2-a2b7cf126819","name":"Get start time","type":"n8n-nodes-base.code","typeVersion":1,"position":[960,380]},{"parameters":{"url":"https://web11.caresoft.vn/hsvn/api/v1/chats","sendQuery":true,"queryParameters":{"parameters":[{"name":"start_time_since","value":"={{ $node[\"Get start time\"].json.startDate }}"},{"name":"start_time_to","value":"={{ $node[\"Get start time\"].json.endDate }}"},{"name":"count","value":"500"},{"name":"chat_type","value":"1"},{"name":"page","value":"1"},{"name":"order_by","value":"start_time"},{"name":"order_type","value":"desc"}]},"sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"Bearer 1g6yF9w3pPbn-kc"}]},"options":{}},"id":"ae517972-e83d-4541-bf93-3eda14885a38","name":"Get chat from agents in the last hour","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[1240,300]},{"parameters":{"url":"https://web11.caresoft.vn/hsvn/api/v1/chats","sendQuery":true,"queryParameters":{"parameters":[{"name":"start_time_since","value":"={{ $node[\"Get start time\"].json.startDate }}"},{"name":"start_time_to","value":"={{ $node[\"Get start time\"].json.endDate }}"},{"name":"count","value":"500"},{"name":"chat_type","value":"0"},{"name":"page","value":"1"},{"name":"order_by","value":"start_time"},{"name":"order_type","value":"desc"}]},"sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"Bearer 1g6yF9w3pPbn-kc"}]},"options":{}},"id":"98a195ed-b9ee-4f92-bcc1-274bdaef7e3e","name":"Get chat from customers in the last hour","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[1240,520]},{"parameters":{"jsCode":"let data = $('Get chat from agents in the last hour').first().json\nlet chats = data.chats;\n\n// Get chat data\nchats = chats.map((chat) => {\n  return { ...chat, chat_type: 1 };\n});\n\nreturn chats;\n"},"id":"fdc669f7-2e61-42d8-b509-dac1b6accb9c","name":"Add chat type for agents","type":"n8n-nodes-base.code","typeVersion":1,"position":[1440,300]},{"parameters":{"jsCode":"let data = $('Get chat from customers in the last hour').first().json\nlet chats = data.chats;\n\n// Get chat data\nchats = chats.map((chat) => {\n  return { ...chat, chat_type: 0 };\n});\n\nreturn chats;\n"},"id":"4c0ca03a-f9fe-49e8-9d88-281dfa2fc8d7","name":"Add chat type for customers","type":"n8n-nodes-base.code","typeVersion":1,"position":[1440,520]},{"parameters":{"jsCode":"let input1 = $('Add chat type for agents').all();\nlet input2 = $('Add chat type for customers').all();\n\nconst input = [...input1, ...input2];\n\n// Get calls data\nlet records = input.map((chat) => {\n  let fields = {\n    ticket_id: chat.json.ticket_id,\n    ticket_no: chat.json.ticket_no,\n    customer_id: chat.json.customer_id,\n    group_name: chat.json.group_name,\n    conversation_id: chat.json.conversation_id,\n    cus_email: chat.json.cus_email,\n    cus_name: chat.json.cus_name,\n    cus_phone: chat.json.cus_phone,\n    start_time: new Date(chat.json.start_time).getTime() - 3600000*7,\n    end_time: new Date(chat.json.end_time).getTime() - 3600000*7,\n    chat_duration: chat.json.chat_duration,\n    agent_email: chat.json.agent_email,\n    agent_name: chat.json.agent_name,\n    ring_time: chat.json.ring_time && new Date(chat.json.ring_time).getTime() - 3600000*7,\n    meet_time: chat.json.meet_time && new Date(chat.json.meet_time).getTime() - 3600000*7,\n    waitTime: chat.json.waitTime,\n    answer_time: chat.json.answer_time,\n    chat_status: chat.json.chat_status,\n    is_trigger: chat.json.is_trigger,\n    facebook_page_id: chat.json.facebook_page_id,\n    service_id: chat.json.service_id,\n    chat_type: chat.json.chat_type,\n  };\n  return { fields };\n});\n\nlet result = { json: { records } };\nreturn result;\n"},"id":"cc345f46-5589-47b9-a79d-7c45cc74a45e","name":"[Raw chat] Convert to Lark format","type":"n8n-nodes-base.code","typeVersion":1,"position":[2020,260]},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/bitable/v1/apps/baslg7TBWBKBB5Bc5vJhovnm3Jc/tables/tbli8yYZM1ABVqbO/records/batch_create","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $node[\"Get tenant access token\"].json.tenant_access_token }}"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\"records\":{{ JSON.stringify($('[Raw chat] Convert to Lark format').first().json.records) }}}","options":{}},"id":"71c29c56-edb3-433e-bd65-648afc6ca78c","name":"[Raw chat] Add records to Bitable","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[2240,260]},{"parameters":{"jsCode":"let input1 = $('Add chat type for agents').all();\nlet input2 = $('Add chat type for customers').all();\n\nconst input = [...input1, ...input2];\n\nconsole.log(input)\n\n// Get calls data\nlet records = input.map((chat) => {\n  let fields = {\n    \"ID chat\": chat.json.conversation_id,\n  };\n  return { fields };\n});\n\nlet result = { json: { records } };\nreturn result;\n"},"id":"cff219b0-10ab-458d-9f54-5155b9d6c85b","name":"[Chat] Convert to Lark format","type":"n8n-nodes-base.code","typeVersion":1,"position":[2020,560]},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/bitable/v1/apps/baslg7TBWBKBB5Bc5vJhovnm3Jc/tables/tbl91enKGtCUlweo/records/batch_create","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $node[\"Get tenant access token\"].json.tenant_access_token }}"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\"records\":{{ JSON.stringify($('[Chat] Convert to Lark format').first().json.records) }}}","options":{}},"id":"777318c0-c6a7-40d6-929e-27be746f1a6b","name":"[Chat] Add records to Bitable","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[2240,560]}],"connections":{"Schedule Trigger":{"main":[[{"node":"Get start time","type":"main","index":0}]]},"Get chat from agents in the last hour":{"main":[[{"node":"Add chat type for agents","type":"main","index":0}]]},"Get start time":{"main":[[{"node":"Get chat from agents in the last hour","type":"main","index":0},{"node":"Get chat from customers in the last hour","type":"main","index":0}]]},"Add chat type for agents":{"main":[[{"node":"Get tenant access token","type":"main","index":0}]]},"Get chat from customers in the last hour":{"main":[[{"node":"Add chat type for customers","type":"main","index":0}]]},"[Raw chat] Convert to Lark format":{"main":[[{"node":"[Raw chat] Add records to Bitable","type":"main","index":0}]]},"Get tenant access token":{"main":[[{"node":"[Chat] Convert to Lark format","type":"main","index":0},{"node":"[Raw chat] Convert to Lark format","type":"main","index":0}]]},"[Chat] Convert to Lark format":{"main":[[{"node":"[Chat] Add records to Bitable","type":"main","index":0}]]},"Add chat type for customers":{"main":[[{"node":"Get tenant access token","type":"main","index":0}]]}},"settings":{},"staticData":{"node:Schedule Trigger":{"recurrencyRules":[]}},"pinData":{"Schedule Trigger":[{"json":{"timestamp":"2023-05-15T00:00:00.000+07:00","Readable date":"May 15th 2023, 11:26:24 am","Readable time":"11:26:24 am","Day of week":"Monday","Year":"2023","Month":"May","Day of month":"15","Hour":"11","Minute":"26","Second":"24","Timezone":"+07 +07:00"}}]},"versionId":"a06c5e84-3182-408f-92a0-4fc53e62e4c0","triggerCount":1,"tags":[{"createdAt":"2023-02-27T05:42:03.910Z","updatedAt":"2023-02-27T05:42:03.910Z","id":"10","name":"Caresoft"}]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-03-01T02:50:25.268Z","updatedAt":"2023-03-01T03:21:03.000Z","id":"38","name":"[Caresoft] Get services daily","active":true,"nodes":[{"parameters":{"rule":{"interval":[{}]}},"id":"11ef4d74-ec72-4891-922c-dc1c04143dcb","name":"Schedule Trigger","type":"n8n-nodes-base.scheduleTrigger","typeVersion":1,"position":[840,400]},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/auth/v3/tenant_access_token/internal/","sendBody":true,"specifyBody":"json","jsonBody":"{\n    \"app_id\": \"cli_a372a34abe789010\",\n    \"app_secret\": \"DKmzzhZm18FAtMhlk2pLwczi6JVMvytI\"\n}","options":{}},"id":"961a4016-d024-44da-922b-177b90fba90c","name":"Get tenant access token","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[1000,400]},{"parameters":{"jsCode":"let input = $('Get services').first().json.services;\n\n// Get service data\nlet records = input.map((service) => {\n  let fields = {\n    service_id: service.service_id,\n    service_name: service.service_name,\n    service_type: service.service_type,\n  };\n  return { fields };\n});\n\nlet result = { json: { records } };\nreturn result;"},"id":"a6263710-643e-44bb-9795-9807bd58c6f2","name":"Convert to Lark format","type":"n8n-nodes-base.code","typeVersion":1,"position":[2220,420]},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/bitable/v1/apps/baslg7TBWBKBB5Bc5vJhovnm3Jc/tables/tblvWBVlhi8a1SSh/records/batch_create","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $node[\"Get tenant access token\"].json.tenant_access_token }}"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\"records\":{{ JSON.stringify($('Convert to Lark format').first().json.records) }}}","options":{}},"id":"1d4696d1-89c6-4930-aeed-740ede43eddf","name":"Add records to Bitable","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[2420,420]},{"parameters":{"url":"https://open.larksuite.com/open-apis/bitable/v1/apps/baslg7TBWBKBB5Bc5vJhovnm3Jc/tables/tblvWBVlhi8a1SSh/records","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $node[\"Get tenant access token\"].json.tenant_access_token }}"}]},"options":{}},"id":"9b527dea-7ee7-431a-9243-5e25d4bafb8a","name":"Get all records","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[1180,400]},{"parameters":{"jsCode":"let input = $('Get all records').first().json.data.items;\nlet records=[]\nif (input){\nrecords   = input.map((record) => {\n  return record.record_id\n})\n}\n\n\nreturn {json: {records}};"},"id":"b198d543-a7d3-4457-96d2-fb6986978edd","name":"Get record id","type":"n8n-nodes-base.code","typeVersion":1,"position":[1580,280]},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/bitable/v1/apps/baslg7TBWBKBB5Bc5vJhovnm3Jc/tables/tblvWBVlhi8a1SSh/records/batch_delete","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $node[\"Get tenant access token\"].json.tenant_access_token }}"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\"records\":{{ JSON.stringify($node[\"Get record id\"].json.records) }} }","options":{}},"id":"5dcb1f29-b36a-4369-bfbd-2007ab609d81","name":"Delete records","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[1780,280]},{"parameters":{"url":"https://web11.caresoft.vn/hsvn/api/v1/services","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"Bearer 1g6yF9w3pPbn-kc"}]},"options":{}},"id":"cd326008-4c61-495f-ae6d-0d6e6026fdec","name":"Get services","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[2020,420]},{"parameters":{"conditions":{"number":[{"value1":"={{ $json.data.items?.length }}","operation":"larger"}]}},"id":"e4634045-1d1e-4eb3-9877-2c2098126d1c","name":"IF","type":"n8n-nodes-base.if","typeVersion":1,"position":[1400,400]}],"connections":{"Schedule Trigger":{"main":[[{"node":"Get tenant access token","type":"main","index":0}]]},"Get tenant access token":{"main":[[{"node":"Get all records","type":"main","index":0}]]},"Get all records":{"main":[[{"node":"IF","type":"main","index":0}]]},"Get record id":{"main":[[{"node":"Delete records","type":"main","index":0}]]},"Delete records":{"main":[[{"node":"Get services","type":"main","index":0}]]},"Convert to Lark format":{"main":[[{"node":"Add records to Bitable","type":"main","index":0}]]},"Get services":{"main":[[{"node":"Convert to Lark format","type":"main","index":0}]]},"IF":{"main":[[{"node":"Get record id","type":"main","index":0}],[{"node":"Get services","type":"main","index":0}]]}},"settings":{},"staticData":{"node:Schedule Trigger":{"recurrencyRules":[]}},"pinData":{},"versionId":"e83fe7d4-43b2-4617-970d-507147af4b3f","triggerCount":1,"tags":[{"createdAt":"2023-02-27T05:42:03.910Z","updatedAt":"2023-02-27T05:42:03.910Z","id":"10","name":"Caresoft"}]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-03-01T04:19:30.800Z","updatedAt":"2023-03-10T07:38:06.000Z","id":"39","name":"[Caresoft] Get customer (contact) every hour","active":true,"nodes":[{"parameters":{"rule":{"interval":[{"field":"hours"}]}},"id":"e7d9bb00-38bd-4e52-91c5-49c93eb718e6","name":"Schedule Trigger","type":"n8n-nodes-base.scheduleTrigger","typeVersion":1,"position":[840,400]},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/auth/v3/tenant_access_token/internal/","sendBody":true,"specifyBody":"json","jsonBody":"{\n    \"app_id\": \"cli_a372a34abe789010\",\n    \"app_secret\": \"DKmzzhZm18FAtMhlk2pLwczi6JVMvytI\"\n}","options":{}},"id":"6a80115e-8f14-48b1-b332-74c24788d6e4","name":"Get tenant access token","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[1600,400]},{"parameters":{"jsCode":"// Loop over input items and add a new field\n// called 'myNewField' to the JSON of each one\nlet startDate = new Date($('Schedule Trigger').first().json.timestamp);\nlet endDate = new Date($('Schedule Trigger').first().json.timestamp);\n\nstartDate.setHours(startDate.getHours() - 1);\n// startDate.setHours(startDate.getHours() - 720);\nstartDate.setMinutes(0);\nstartDate.setSeconds(1);\n\nreturn {\n  json: {\n    startDate: startDate.toISOString(),\n    endDate: endDate.toISOString(),\n  },\n};"},"id":"30657346-c877-40d0-bed4-5ed10eecedd1","name":"Get start time","type":"n8n-nodes-base.code","typeVersion":1,"position":[1000,400]},{"parameters":{"jsCode":"let input = $('Get customer in the last hour').first().json.contacts;\n\n// Get calls data\nlet records = input.map((contact) => {\n  let fields = {\n    id: contact.id,\n    username: contact.username,\n    phone_no:contact.phone_no, \n    updated_at: new Date(contact.updated_at).getTime(),\n    created_at: new Date(contact.created_at).getTime(),    \n  };\n  return { fields };\n});\n\nlet result = { json: { records } };\nreturn result;"},"id":"5cce7f5f-d67b-4337-976b-80224d7f4172","name":"Convert to Lark format","type":"n8n-nodes-base.code","typeVersion":1,"position":[1380,400]},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/bitable/v1/apps/baslg7TBWBKBB5Bc5vJhovnm3Jc/tables/tbljzeaqj3GQGfGn/records/batch_create","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $node[\"Get tenant access token\"].json.tenant_access_token }}"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\"records\":{{ JSON.stringify($('Convert to Lark format').first().json.records) }}}","options":{}},"id":"0eff6724-eca8-4b84-b0f0-410028594aec","name":"Add records to Bitable","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[1800,400]},{"parameters":{"url":"https://web11.caresoft.vn/hsvn/api/v1/contacts","sendQuery":true,"queryParameters":{"parameters":[{"name":"created_since","value":"={{ $node[\"Get start time\"].json.startDate }}"},{"name":"created_to","value":"={{ $node[\"Get start time\"].json.endDate }}"},{"name":"count","value":"500"},{"name":"page","value":"1"},{"name":"order_by","value":"created_at"},{"name":"order_type","value":"desc"}]},"sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"Bearer 1g6yF9w3pPbn-kc"}]},"options":{}},"id":"95f1b105-dae3-4d72-9a86-cae1cbebdfd9","name":"Get customer in the last hour","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[1180,400]}],"connections":{"Schedule Trigger":{"main":[[{"node":"Get start time","type":"main","index":0}]]},"Get tenant access token":{"main":[[{"node":"Add records to Bitable","type":"main","index":0}]]},"Get start time":{"main":[[{"node":"Get customer in the last hour","type":"main","index":0}]]},"Convert to Lark format":{"main":[[{"node":"Get tenant access token","type":"main","index":0}]]},"Get customer in the last hour":{"main":[[{"node":"Convert to Lark format","type":"main","index":0}]]}},"settings":{},"staticData":{"node:Schedule Trigger":{"recurrencyRules":[]}},"pinData":{},"versionId":"7e1c9965-9a4c-490f-b84b-8213439549d1","triggerCount":1,"tags":[{"createdAt":"2023-02-27T05:42:03.910Z","updatedAt":"2023-02-27T05:42:03.910Z","id":"10","name":"Caresoft"}]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-03-01T07:08:36.232Z","updatedAt":"2023-03-01T07:17:59.000Z","id":"40","name":"[Caresoft] Get groups daily","active":true,"nodes":[{"parameters":{"rule":{"interval":[{}]}},"id":"c7be411e-8a92-4bab-99fe-f7d86bc5ef9d","name":"Schedule Trigger","type":"n8n-nodes-base.scheduleTrigger","typeVersion":1,"position":[840,400]},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/auth/v3/tenant_access_token/internal/","sendBody":true,"specifyBody":"json","jsonBody":"{\n    \"app_id\": \"cli_a372a34abe789010\",\n    \"app_secret\": \"DKmzzhZm18FAtMhlk2pLwczi6JVMvytI\"\n}","options":{}},"id":"e0cb034b-1125-4b39-bd3d-24eeb1e9e733","name":"Get tenant access token","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[1000,400]},{"parameters":{"jsCode":"let input = $('Get groups').first().json.groups;\n\n// Get group data\nlet records = input.map((group) => {\n  let fields = {\n    group_id: group.group_id,\n    group_name: group.group_name,\n    created_at: new Date(group.created_at).getTime(),\n  };\n  return { fields };\n});\n\nlet result = { json: { records } };\nreturn result;"},"id":"a7d1eb4b-2b6d-4639-a548-2c09bf988a7a","name":"Convert to Lark format","type":"n8n-nodes-base.code","typeVersion":1,"position":[2220,420]},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/bitable/v1/apps/baslg7TBWBKBB5Bc5vJhovnm3Jc/tables/tblgtgataBeDsj3U/records/batch_create","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $node[\"Get tenant access token\"].json.tenant_access_token }}"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\"records\":{{ JSON.stringify($('Convert to Lark format').first().json.records) }}}","options":{}},"id":"23f5b069-4a6c-4562-9da6-080994dcf097","name":"Add records to Bitable","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[2420,420]},{"parameters":{"url":"https://open.larksuite.com/open-apis/bitable/v1/apps/baslg7TBWBKBB5Bc5vJhovnm3Jc/tables/tblgtgataBeDsj3U/records","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $node[\"Get tenant access token\"].json.tenant_access_token }}"}]},"options":{}},"id":"4db7878c-b757-4615-8bcc-e5dbc40471de","name":"Get all records","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[1180,400]},{"parameters":{"jsCode":"let input = $('Get all records').first().json.data.items;\nlet records=[]\nif (input){\nrecords   = input.map((record) => {\n  return record.record_id\n})\n}\n\n\nreturn {json: {records}};"},"id":"abe23209-ba80-47f3-b2cb-e0aa1c0fc8ca","name":"Get record id","type":"n8n-nodes-base.code","typeVersion":1,"position":[1580,280]},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/bitable/v1/apps/baslg7TBWBKBB5Bc5vJhovnm3Jc/tables/tblgtgataBeDsj3U/records/batch_delete","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $node[\"Get tenant access token\"].json.tenant_access_token }}"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\"records\":{{ JSON.stringify($node[\"Get record id\"].json.records) }} }","options":{}},"id":"3bb891d5-2e13-445f-88a7-2db081519137","name":"Delete records","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[1780,280]},{"parameters":{"conditions":{"number":[{"value1":"={{ $json.data.items?.length }}","operation":"larger"}]}},"id":"6f4a1025-e8cf-43b0-93d6-79ef106efbab","name":"IF","type":"n8n-nodes-base.if","typeVersion":1,"position":[1400,400]},{"parameters":{"url":"https://web11.caresoft.vn/hsvn/api/v1/groups","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"Bearer 1g6yF9w3pPbn-kc"}]},"options":{}},"id":"fa8e589f-668f-428e-b793-134508b9a9ab","name":"Get groups","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[2020,420]}],"connections":{"Schedule Trigger":{"main":[[{"node":"Get tenant access token","type":"main","index":0}]]},"Get tenant access token":{"main":[[{"node":"Get all records","type":"main","index":0}]]},"Get all records":{"main":[[{"node":"IF","type":"main","index":0}]]},"Get record id":{"main":[[{"node":"Delete records","type":"main","index":0}]]},"Delete records":{"main":[[{"node":"Get groups","type":"main","index":0}]]},"Convert to Lark format":{"main":[[{"node":"Add records to Bitable","type":"main","index":0}]]},"IF":{"main":[[{"node":"Get record id","type":"main","index":0}],[{"node":"Get groups","type":"main","index":0}]]},"Get groups":{"main":[[{"node":"Convert to Lark format","type":"main","index":0}]]}},"settings":{},"staticData":{"node:Schedule Trigger":{"recurrencyRules":[]}},"pinData":{},"versionId":"751a617a-6fcc-4be2-ade7-44c48a7ac9b4","triggerCount":1,"tags":[{"createdAt":"2023-02-27T05:42:03.910Z","updatedAt":"2023-02-27T05:42:03.910Z","id":"10","name":"Caresoft"}]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-03-03T15:30:10.908Z","updatedAt":"2023-03-04T03:30:33.000Z","id":"41","name":"Test Approval","active":true,"nodes":[{"parameters":{"httpMethod":"POST","path":"ncmk-test-approval","options":{}},"id":"a92027ca-15d0-436f-ba1e-5bcb584b5c5e","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[840,520],"webhookId":"c4883d48-c2dc-4a6c-8863-f130813df13f"},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/bitable/v1/apps/basusKDT1IASI9v2xdYd0u1c6Zd/tables/tblp0Z3LRV8RTR4h/records","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $node[\"get_tenant_access_token\"].json[\"tenant_access_token\"] }}"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\n    \"fields\": {\n        \"request_number\": \"{{ $node[\"Webhook\"].json[\"body\"][\"request_number\"] }}\",\n        \"approval_name\": \"{{ $node[\"Webhook\"].json[\"body\"][\"approval_name\"] }}\",\n        \"type\": \"{{ $node[\"Webhook\"].json[\"body\"][\"type\"] }}\",\n        \"user_id\": \"{{ $node[\"Webhook\"].json[\"body\"][\"user_id\"] }}\",\n        \"department\": [\n            \"{{ $node[\"Webhook\"].json[\"body\"][\"department\"] }}\"\n        ],\n        \"status\": \"{{ $node[\"Webhook\"].json[\"body\"][\"status\"] }}\",\n        \"start_time\": 1580486400000,\n        \"end_time\": 1580486500000,\n        \n        \"short_answer\": \"{{ $node[\"Webhook\"].json[\"body\"][\"short_answer\"] }}\",\n        \"paragraph\": \"{{ $node[\"Webhook\"].json[\"body\"][\"paragraph\"] }}\",\n        \"description\": \"{{ $node[\"Webhook\"].json[\"body\"][\"description\"] }}\",\n        \"number\": 1,\n        \"amount\": 100,\n        \"single_select\": \"{{ $node[\"Webhook\"].json[\"body\"][\"single_select\"] }}\",\n        \"checkbox\": [\n            \"X\",\n            \"Z\"\n        ],\n        \"date\": 1580486400000,\n        \"date_start_time\": 1580486400000,\n        \"date_end_time\": 1580486400000,\n        \"date_duration\": 2,\n        \"contacts\": [\n          {\n            \"id\": \"ou_1aef8a42bf9a438e5189f715bab87736\"\n          }\n        ]\n    }\n}","options":{}},"id":"1915e584-a192-4fe1-b16b-0aa44cfd801f","name":"HTTP Request","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[1500,540]},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/auth/v3/tenant_access_token/internal/","sendBody":true,"bodyParameters":{"parameters":[{"name":"app_id","value":"cli_a32b3e8f78b8d00a"},{"name":"app_secret","value":"zhC23rEIttxawmct2aXFjeHiZpqTAyIG"}]},"options":{}},"id":"d2251ca3-f3e5-4402-9e3b-f4c2a9f1c033","name":"get_tenant_access_token","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[1060,520]}],"connections":{"Webhook":{"main":[[{"node":"get_tenant_access_token","type":"main","index":0}]]},"get_tenant_access_token":{"main":[[{"node":"HTTP Request","type":"main","index":0}]]}},"settings":{"saveExecutionProgress":true,"saveManualExecutions":true,"callerPolicy":"workflowsFromSameOwner"},"staticData":null,"pinData":{"Webhook":[{"json":{"headers":{"host":"app.n8n.vn","user-agent":"Go-http-client/2.0","content-length":"522","accept-encoding":"gzip","content-type":"application/json","x-forwarded-for":"3.211.55.69","x-forwarded-host":"app.n8n.vn","x-forwarded-port":"443","x-forwarded-proto":"https","x-forwarded-server":"af4013275608","x-lark-flow-accesskey":"lark_action_message_va","x-lark-flow-nonce":"ffa678f5649a0da5","x-lark-flow-signature":"d3547611438568a9a899038795b20f77dabaea2acca50d8ee967ab4ebc4626ba","x-real-ip":"3.211.55.69"},"params":{},"query":{},"body":{"end_time":"-","date_duration":"2","approval_name":"Test to Bitable","department":"Ph√≤ng Gi·∫£p ph√°p C√¥ng ngh·ªá","start_time":"2023-03-04 02:31","paragraph":"Paragraph","description":"","number":"1","formular":"1000000","single_select":"A","type":"Pending","request_number":"202303040004","short_answer":"Shortname","date_start_time":"Mar 17 2023","user_name":"L√™ Qu·ªëc Kh√¥i","user_id":"7133088781992771589","amount":"1000000","date_end_time":"Mar 18 2023","status":"Pending","checkbox":"X,Z","date":"Mar 07 2023"}}}]},"versionId":"f193cc03-1733-46c3-a4bd-bcbb548cba98","triggerCount":1,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-03-07T05:34:42.414Z","updatedAt":"2023-03-07T12:04:16.000Z","id":"42","name":"My workflow 5","active":false,"nodes":[{"parameters":{"path":"ncmk-zns","responseMode":"responseNode","options":{}},"id":"c4614ab2-49fa-463b-93a9-7b90484d2556","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[840,520],"webhookId":"db6d70ed-2bfc-4b32-9a2b-c83b3853afd5"},{"parameters":{"respondWith":"json","options":{}},"id":"5d367bbc-0b14-4340-83b1-2ecc2b77ec82","name":"Respond to Webhook","type":"n8n-nodes-base.respondToWebhook","typeVersion":1,"position":[1060,520]}],"connections":{"Webhook":{"main":[[{"node":"Respond to Webhook","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{},"versionId":"3acd9d6f-0344-4fb0-9521-6c09ec77d627","triggerCount":1,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-03-07T10:29:04.992Z","updatedAt":"2023-05-14T04:57:34.000Z","id":"43","name":"Ph√≤ng v√© g·ª≠i zalo zns","active":true,"nodes":[{"parameters":{"httpMethod":"POST","path":"ncmk-phong-ve-zns","options":{}},"id":"8902284b-4f3f-4001-b3e4-8c80066a8d22","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[840,540],"webhookId":"dfa7db72-9657-44d2-ac57-f9430a4ca50d"},{"parameters":{"method":"POST","url":"https://business.openapi.zalo.me/message/template","sendHeaders":true,"headerParameters":{"parameters":[{"name":"access_token","value":"={{ $node.Airtable.json.fields.access_token }}"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\n    \"phone\": \"{{$node[\"Code\"].json[\"sdtZalo\"]}}\",\n    \"template_id\": \"249129\",\n    \"template_data\": {\n        \"ma_dat_cho\": \"{{$node[\"Code\"].json[\"maDatCho\"]}}\",\n        \"hang\": \"{{$node[\"Code\"].json[\"hang\"]}}\",\n        \"ngay_khoi_hanh\": \"{{$node[\"Code\"].json[\"ngayKhoiHanh\"]}}\",\n        \"customer_name\": \"{{$node[\"Code\"].json[\"customerName\"]}}\",\n        \"thong_tin_ve\": \"{{$node[\"Code\"].json[\"thongTinVe\"]}}\",\n        \"ten_hanh_khach\": \"{{$node[\"Code\"].json[\"tenHanhKhach\"]}}\",\n        \"gia_ban\": {{$node[\"Code\"].json[\"giaBan\"]}},\n        \"tinh_trang_thanh_toan\": \"{{$node[\"Code\"].json[\"tinhTrangThanhToan\"]}}\"\n    },\n    \"tracking_id\": \"ncmk_phong_ve_gui_ve\"\n}\n","options":{}},"id":"3c19a95a-6711-40c5-844a-6b7d1b59963a","name":"HTTP Request","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[1680,520]},{"parameters":{"jsCode":"let data = $('Webhook').first().json.body;\n\nlet sdtZalo = '84' + ((data.sdt_zalo === '') ? data.sdt.slice(1) : data.sdt_zalo.slice(1));\nsdtZalo = sdtZalo.replace(/\\s/g, '');\n\nlet thongTinVe = (data.thong_tin_ve === '') ? '-' : data.thong_tin_ve.replace(/\\n/g, \", \");\n\nlet hang = (data.hang === '') ? '-' : data.hang.replace(/\\n/g, \", \");\n\nlet maDatCho = (data.ma_dat_cho === '') ? '-' : data.ma_dat_cho.replace(/\\n/g, \", \");\n\nlet tenHanhKhach = (data.ten_hanh_khach === '') ? '-' : data.ten_hanh_khach.replace(/\\n/g, \", \");\n\nlet ngayKhoiHanh = (data.ngay_khoi_hanh === '') ? '-' : new Date(data.ngay_khoi_hanh).toLocaleDateString('en-GB');\n\nlet giaBan = (data.gia_ban === '') ? 0 : data.gia_ban;\n\nlet giaBanLark = (data.gia_ban === '') ? 0 : Math.floor(+data.gia_ban).toLocaleString(\"en-US\") + \" VND\";;\nlet tinhTrangThanhToan = (data.tinh_trang_thanh_toan === 'true') ? 'ƒê√£ thanh to√°n' : 'Ch∆∞a thanh to√°n ƒë·ªß';\n\nlet customerName = (data.customer_name === '') ? '-' : data.customer_name.replace(/\\n/g, \", \");\n\nlet loaiKhach = (data.loai_khach === '') ? '-' : data.loai_khach.replace(/\\n/g, \", \");\n\nlet nhanVienXuatVe = (data.nhan_vien_xuat_ve === '') ? '-' : data.nhan_vien_xuat_ve.replace(/\\n/g, \", \");\n\nreturn {\n  sdtZalo,\n  thongTinVe,\n  hang,\n  maDatCho,\n  tenHanhKhach,\n  ngayKhoiHanh,\n  giaBan,\n  giaBanLark,\n  tinhTrangThanhToan,\n  customerName,\n  loaiKhach,\n  nhanVienXuatVe\n}"},"id":"4eecece2-44b2-474b-b740-0622bee10dd6","name":"Code","type":"n8n-nodes-base.code","typeVersion":1,"position":[1500,520]},{"parameters":{"conditions":{"number":[{"value1":"={{Number($json.data.quota.remainingQuota) }}","operation":"smallerEqual","value2":5}]}},"id":"941b1e59-ea50-4884-b73f-eb6753dc3062","name":"IF remainingQuota < 5","type":"n8n-nodes-base.if","typeVersion":1,"position":[2300,540]},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/bot/v2/hook/cfa4bb90-0e41-45df-9af0-66fdd358063d","sendBody":true,"specifyBody":"json","jsonBody":"={\n    \"msg_type\": \"text\",\n    \"content\": {\n        \"text\": \"H·∫°n m·ª©c c√≤n l·∫°i {{ $node[\"HTTP Request\"].json[\"data\"][\"quota\"][\"remainingQuota\"] }}/{{ $node[\"HTTP Request\"].json[\"data\"][\"quota\"][\"dailyQuota\"] }}. ZaloZNS: Vui l√≤ng Topup!\"\n    }\n}","options":{}},"id":"8475c010-5102-4a33-9b18-1e0a9ce93bd3","name":"HTTP Request1","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[2540,440]},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/bot/v2/hook/cfa4bb90-0e41-45df-9af0-66fdd358063d","sendBody":true,"specifyBody":"json","jsonBody":"={\n    \"msg_type\": \"interactive\",\n    \"card\": {\n        \"config\": {\n            \"wide_screen_mode\": true\n        },\n        \"elements\": [\n            {\n                \"tag\": \"div\",\n                \"fields\": [\n                    {\n                        \"is_short\": true,\n                        \"text\": {\n                            \"tag\": \"lark_md\",\n                            \"content\": \"H√£ng\"\n                        }\n                    },\n                    {\n                        \"is_short\": true,\n                        \"text\": {\n                            \"tag\": \"lark_md\",\n                            \"content\": \"{{ $node[\"Webhook\"].json[\"body\"][\"hang\"] }}\"\n                        }\n                    },\n                    {\n                        \"is_short\": true,\n                        \"text\": {\n                            \"tag\": \"lark_md\",\n                            \"content\": \"Th√¥ng tin v√©\"\n                        }\n                    },\n                    {\n                        \"is_short\": true,\n                        \"text\": {\n                            \"tag\": \"lark_md\",\n                            \"content\": \"{{$node[\"Code\"].json[\"thongTinVe\"]}}\"\n                        }\n                    },\n                    {\n                        \"is_short\": true,\n                        \"text\": {\n                            \"tag\": \"lark_md\",\n                            \"content\": \"M√£ ƒë·∫∑t ch·ªó\"\n                        }\n                    },\n                    {\n                        \"is_short\": true,\n                        \"text\": {\n                            \"tag\": \"lark_md\",\n                            \"content\": \"{{ $node[\"Webhook\"].json[\"body\"][\"ma_dat_cho\"] }}\"\n                        }\n                    },\n                    {\n                        \"is_short\": true,\n                        \"text\": {\n                            \"tag\": \"lark_md\",\n                            \"content\": \"T√™n h√†nh kh√°ch\"\n                        }\n                    },\n                    {\n                        \"is_short\": true,\n                        \"text\": {\n                            \"tag\": \"lark_md\",\n                            \"content\": \"{{ $node[\"Code\"].json[\"tenHanhKhach\"] }}\"\n                        }\n                    },\n                    {\n                        \"is_short\": true,\n                        \"text\": {\n                            \"tag\": \"lark_md\",\n                            \"content\": \"Ng√†y kh·ªüi h√†nh\"\n                        }\n                    },\n                    {\n                        \"is_short\": true,\n                        \"text\": {\n                            \"tag\": \"lark_md\",\n                            \"content\": \"{{ $node[\"Code\"].json[\"ngayKhoiHanh\"] }}\"\n                        }\n                    },\n                    {\n                        \"is_short\": true,\n                        \"text\": {\n                            \"tag\": \"lark_md\",\n                            \"content\": \"Gi√° b√°n\"\n                        }\n                    },\n                    {\n                        \"is_short\": true,\n                        \"text\": {\n                            \"tag\": \"lark_md\",\n                            \"content\": \"{{ $node[\"Code\"].json[\"giaBanLark\"] }}\"\n                        }\n                    },\n                    {\n                        \"is_short\": true,\n                        \"text\": {\n                            \"tag\": \"lark_md\",\n                            \"content\": \"T√¨nh tr·∫°ng thanh to√°n\"\n                        }\n                    },\n                    {\n                        \"is_short\": true,\n                        \"text\": {\n                            \"tag\": \"lark_md\",\n                            \"content\": \"{{ $node[\"Code\"].json[\"tinhTrangThanhToan\"] }}\"\n                        }\n                    }\n                ]\n            },\n            {\n                \"tag\": \"action\",\n                \"actions\": [\n                    {\n                        \"tag\": \"button\",\n                        \"text\": {\n                            \"tag\": \"plain_text\",\n                            \"content\": \"Chat Zalo v·ªõi kh√°ch\"\n                        },\n                        \"url\": \"https://zalo.me/{{ $node[\"Webhook\"].json[\"body\"][\"sdt_zalo\"] }}\",\n                        \"type\": \"primary\"\n                    },\n                    {\n                        \"tag\": \"button\",\n                        \"text\": {\n                            \"tag\": \"plain_text\",\n                            \"content\": \"M·ªü CRM\"\n                        },\n                        \"url\": \"https://phongve.ncmk.app\",\n                        \"type\": \"default\"\n                    }\n                ]\n            }\n        ],\n                \"header\": {\n                        \"template\": \"green\",\n                        \"title\": {\n                                  \"content\": \"{{ $node[\"Webhook\"].json[\"body\"][\"nhan_vien_xuat_ve\"] }} ƒë√£ ch·ªët th√†nh c√¥ng 1 ƒë∆°n h√†ng üéâ\",\n                                  \"tag\": \"plain_text\"\n                         }\n                 }\n    }\n}","options":{}},"id":"806a910c-bfee-489e-a052-568aebd815a0","name":"HTTP Request2","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[2540,620]},{"parameters":{"application":{"__rl":true,"value":"appg7xGBQYqUYbJAr","mode":"id"},"table":{"__rl":true,"value":"tblWAtHbJemABDvCG","mode":"id"},"id":"recqr9eRsaI69jq2D"},"id":"0ccc2f3b-d960-4e67-9912-c5b39067c08f","name":"Airtable","type":"n8n-nodes-base.airtable","typeVersion":1,"position":[1280,520],"credentials":{"airtableApi":{"id":"20","name":"Airtable: lekhoi456@gmail.com"}}},{"parameters":{"conditions":{"string":[{"value1":"={{ $json.body.loai_khach }}","value2":"Kh√°ch l·∫ª"},{"value1":"={{ $json.body.loai_khach }}","operation":"isEmpty"}]},"combineOperation":"any"},"id":"25f7c478-171e-4916-9aa8-f3fb4854bc8d","name":"IF","type":"n8n-nodes-base.if","typeVersion":1,"position":[1060,540]},{"parameters":{"conditions":{"string":[{"value1":"={{ $node[\"HTTP Request\"].json.data.quota.remainingQuota }}","operation":"isEmpty"}]}},"id":"1e9c6897-a38d-412b-b649-201621d22520","name":"IF1","type":"n8n-nodes-base.if","typeVersion":1,"position":[1880,520]},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/bot/v2/hook/cfa4bb90-0e41-45df-9af0-66fdd358063d","sendBody":true,"specifyBody":"json","jsonBody":"={\n    \"msg_type\": \"text\",\n    \"content\": {\n        \"text\": \"C√≥ l·ªói khi g·ª≠i. Vui l√≤ng ki·ªÉm tra!\"\n    }\n}","options":{}},"id":"9981d992-3767-4dd1-b2a3-509df08ba099","name":"HTTP Request3","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[2320,220]},{"parameters":{"conditions":{"number":[{"value1":"={{ $node[\"HTTP Request\"].json.error }}","operation":"equal","value2":-118}]}},"id":"501973be-8f7c-4fc2-b3d5-9a99f6e0a7b8","name":"IF2","type":"n8n-nodes-base.if","typeVersion":1,"position":[2100,420]},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/bot/v2/hook/cfa4bb90-0e41-45df-9af0-66fdd358063d","sendBody":true,"specifyBody":"json","jsonBody":"={\n    \"msg_type\": \"text\",\n    \"content\": {\n        \"text\": \"Kh√¥ng t√¨m th·∫•y t√†i kho·∫£n Zalo\"\n    }\n}","options":{}},"id":"3bd8eb59-1dc5-4488-8972-f53deb48757e","name":"HTTP Request4","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[2320,60]}],"connections":{"Webhook":{"main":[[{"node":"IF","type":"main","index":0}]]},"Code":{"main":[[{"node":"HTTP Request","type":"main","index":0}]]},"HTTP Request":{"main":[[{"node":"IF1","type":"main","index":0}]]},"IF remainingQuota < 5":{"main":[[{"node":"HTTP Request1","type":"main","index":0}],[{"node":"HTTP Request2","type":"main","index":0}]]},"Airtable":{"main":[[{"node":"Code","type":"main","index":0}]]},"IF":{"main":[[{"node":"Airtable","type":"main","index":0}]]},"IF1":{"main":[[{"node":"IF2","type":"main","index":0}],[{"node":"IF remainingQuota < 5","type":"main","index":0}]]},"IF2":{"main":[[{"node":"HTTP Request4","type":"main","index":0}],[{"node":"HTTP Request3","type":"main","index":0}]]}},"settings":{"saveExecutionProgress":false,"saveManualExecutions":false,"callerPolicy":"workflowsFromSameOwner"},"staticData":null,"pinData":{"Webhook":[{"json":{"headers":{"host":"app.n8n.vn","user-agent":"Go-http-client/2.0","content-length":"1642","accept-encoding":"gzip","content-type":"multipart/form-data; boundary=dbf35de732d5364c681e296feaa79066bc993b02de889c2ae5fd7615ee8f","x-forwarded-for":"3.211.55.69","x-forwarded-host":"app.n8n.vn","x-forwarded-port":"443","x-forwarded-proto":"https","x-forwarded-server":"422302823b8a","x-real-ip":"3.211.55.69","x-tt-logid":"02168085530122800000000000000000000fffff03552d75d01fa"},"params":{},"query":{},"body":{"thong_tin_ve":"V√© m√°y bay SGN-SIN-SGN","hang":"Vietjet Air","ma_dat_cho":"DB5RPM","ten_hanh_khach":"LE QUOC KHOI","ngay_khoi_hanh":"2023/03/14","gia_ban":"3018000","tinh_trang_thanh_toan":"true","sdt_zalo":"0333111868","customer_name":"Le Khoi ","loai_khach":"Kh√°ch l·∫ª","nhan_vien_xuat_ve":"H·ªì Th·ªã T∆∞·ªùng Vy","sdt":"0333111868"}}}]},"versionId":"e346827a-8873-4bd4-9af4-ade19dd25013","triggerCount":1,"tags":[{"createdAt":"2023-02-10T04:34:16.814Z","updatedAt":"2023-02-10T04:34:16.814Z","id":"9","name":"ncmk"}]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-03-07T12:06:44.816Z","updatedAt":"2023-03-07T13:06:04.000Z","id":"44","name":"NCMK get access token from refresh token","active":true,"nodes":[{"parameters":{"method":"POST","url":"https://oauth.zaloapp.com/v4/oa/access_token","sendHeaders":true,"headerParameters":{"parameters":[{"name":"secret_key","value":"SL5w2Q2CO9pDY5UIWPmy"}]},"sendBody":true,"contentType":"form-urlencoded","bodyParameters":{"parameters":[{"name":"refresh_token","value":"={{ $json.fields.refresh_token }}"},{"name":"app_id","value":"4407756291557198333"},{"name":"grant_type","value":"refresh_token"}]},"options":{}},"id":"2142f330-f306-4a2a-a505-e5be40f25fd6","name":"HTTP Request","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[1320,520]},{"parameters":{"application":{"__rl":true,"value":"appg7xGBQYqUYbJAr","mode":"id"},"table":{"__rl":true,"value":"tblWAtHbJemABDvCG","mode":"id"},"id":"recqr9eRsaI69jq2D"},"id":"2a079137-20e2-4216-af2f-4da3223342f2","name":"Airtable","type":"n8n-nodes-base.airtable","typeVersion":1,"position":[1160,520],"credentials":{"airtableApi":{"id":"20","name":"Airtable: lekhoi456@gmail.com"}}},{"parameters":{"operation":"update","application":{"__rl":true,"value":"appg7xGBQYqUYbJAr","mode":"id"},"table":{"__rl":true,"value":"tblWAtHbJemABDvCG","mode":"id"},"id":"recqr9eRsaI69jq2D","options":{}},"id":"ce566e3f-24ae-42f6-a387-874616641d02","name":"Airtable1","type":"n8n-nodes-base.airtable","typeVersion":1,"position":[1640,520],"credentials":{"airtableApi":{"id":"20","name":"Airtable: lekhoi456@gmail.com"}}},{"parameters":{"jsCode":"let data = $('HTTP Request').first().json.data\nlet result = JSON.parse(data)\nreturn result\n"},"id":"8b9ca8dd-459c-4924-98eb-a01f1e7da85c","name":"Code","type":"n8n-nodes-base.code","typeVersion":1,"position":[1480,520]},{"parameters":{"rule":{"interval":[{"triggerAtHour":20}]}},"id":"75c6e8b0-b0b0-404e-9399-955fd1aa1367","name":"Schedule Trigger","type":"n8n-nodes-base.scheduleTrigger","typeVersion":1,"position":[1000,520]}],"connections":{"HTTP Request":{"main":[[{"node":"Code","type":"main","index":0}]]},"Airtable":{"main":[[{"node":"HTTP Request","type":"main","index":0}]]},"Code":{"main":[[{"node":"Airtable1","type":"main","index":0}]]},"Schedule Trigger":{"main":[[{"node":"Airtable","type":"main","index":0}]]}},"settings":{},"staticData":{"node:Schedule Trigger":{"recurrencyRules":[]}},"pinData":{},"versionId":"129e00df-6238-418b-90de-e48d60d45da9","triggerCount":1,"tags":[{"createdAt":"2023-02-10T04:34:16.814Z","updatedAt":"2023-02-10T04:34:16.814Z","id":"9","name":"ncmk"}]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-03-07T14:28:00.274Z","updatedAt":"2023-03-07T14:29:56.000Z","id":"45","name":"Send error - zalozns","active":false,"nodes":[{"parameters":{},"id":"7017b82a-f841-463c-8c31-06c71a1a6964","name":"Error Trigger","type":"n8n-nodes-base.errorTrigger","typeVersion":1,"position":[900,320]},{"parameters":{"conditions":{"number":[{"value1":"={{ $json.execution.id }}","operation":"equal","value2":43}]}},"id":"3107dcd1-529e-4e9f-9b11-de61f3808bf7","name":"IF","type":"n8n-nodes-base.if","typeVersion":1,"position":[1140,320]},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/bot/v2/hook/3a6b855e-fb8f-42ce-b137-c14b44655625","sendBody":true,"specifyBody":"json","jsonBody":"={\n    \"msg_type\": \"text\",\n    \"content\": {\n        \"text\": \"C√≥ l·ªói khi g·ª≠i. Vui l√≤ng ki·ªÉm tra!\"\n    }\n}","options":{}},"id":"e7bf34ed-2491-4c8b-b5d3-13e1e4ff011c","name":"HTTP Request","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[1360,300]}],"connections":{"Error Trigger":{"main":[[{"node":"IF","type":"main","index":0}]]},"IF":{"main":[[{"node":"HTTP Request","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{},"versionId":"14986bb4-f12a-40c1-a66d-6c25bf627f6c","triggerCount":0,"tags":[{"createdAt":"2023-02-10T04:34:16.814Z","updatedAt":"2023-02-10T04:34:16.814Z","id":"9","name":"ncmk"}]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-03-08T07:41:48.722Z","updatedAt":"2023-03-08T07:54:31.000Z","id":"46","name":"[NCMK] Ph√≤ng v√© m·ªùi kh√°ch h√†ng ƒë√°nh gi√°","active":true,"nodes":[{"parameters":{"httpMethod":"POST","path":"ncmk-phong-ve-zns-danh-gia","options":{}},"id":"ad07e1f8-f84d-453e-a42a-ed68e55cf48e","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[840,520],"webhookId":"13e41e45-134c-4e8d-884c-5ffccb6974c1"},{"parameters":{"application":{"__rl":true,"value":"appg7xGBQYqUYbJAr","mode":"id"},"table":{"__rl":true,"value":"tblWAtHbJemABDvCG","mode":"id"},"id":"recqr9eRsaI69jq2D"},"id":"0c71694d-ae9a-4857-86b1-b81ddc802644","name":"Airtable","type":"n8n-nodes-base.airtable","typeVersion":1,"position":[1080,520],"credentials":{"airtableApi":{"id":"20","name":"Airtable: lekhoi456@gmail.com"}}},{"parameters":{"jsCode":"let data = $('Webhook').first().json.body\nlet sdtZalo = '84' + data.sdt_zalo.slice(1)\nlet tenKhachHang = data.ten_khach_hang.replace(/\\n/g, \", \");\nif (tenKhachHang === '') {\n  tenKhachHang = 'KH√îNG R√ï'\n}\nlet dichVu = data.dich_vu.replace(/\\n/g, \", \");\nlet maDatCho = data.ma_dat_cho;\nif (maDatCho === '') {\n  maDatCho = '-'\n}\n\nreturn {\n  sdtZalo,\n  tenKhachHang,\n  dichVu,\n  maDatCho\n}\n        "},"id":"c4c4d542-880d-44db-ad08-5aa1cab3d3ea","name":"Code","type":"n8n-nodes-base.code","typeVersion":1,"position":[1300,540]},{"parameters":{"method":"POST","url":"https://business.openapi.zalo.me/message/template","sendHeaders":true,"headerParameters":{"parameters":[{"name":"access_token","value":"={{ $node.Airtable.json.fields.access_token }}"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\n    \"phone\": \"{{ $node[\"Code\"].json[\"sdtZalo\"] }}\",\n    \"template_id\": \"249055\",\n    \"template_data\": {\n        \"customer_name\": \"{{ $node[\"Code\"].json[\"tenKhachHang\"] }}\",\n        \"ten_dich_vu\": \"{{ $node[\"Code\"].json[\"dichVu\"] }}\",\n        \"ma_don_hang\": \"{{ $node[\"Code\"].json[\"maDatCho\"] }}\"\n    },\n    \"tracking_id\": \"ncmk_phong_ve_moi_danh_gia\"\n}\n","options":{}},"id":"31182224-b28e-4f3f-b09f-44bf335f69b4","name":"HTTP Request","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[1540,540]}],"connections":{"Webhook":{"main":[[{"node":"Airtable","type":"main","index":0}]]},"Airtable":{"main":[[{"node":"Code","type":"main","index":0}]]},"Code":{"main":[[{"node":"HTTP Request","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{},"versionId":"875322aa-7dd0-49ce-a899-663109be64d0","triggerCount":1,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-03-09T04:15:49.349Z","updatedAt":"2023-03-09T06:53:39.000Z","id":"47","name":"[HSVN] ƒê∆°n h√†ng Web","active":true,"nodes":[{"parameters":{"httpMethod":"POST","path":"hsvn-don-hang-web","options":{}},"id":"404cd10d-97d6-405f-832e-718f44d0ac65","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[1100,600],"webhookId":"3e7006f3-5ad9-4110-8a00-27db89f90e1f"},{"parameters":{"jsCode":"const data = $(\"Webhook\").first().json;\n\n// Order Info\nconst orderId = data.body.id;\nconst source = data.headers[\"x-wc-webhook-source\"]\n    .replace(\"http://\", \"\")\n    .replace(\"https://\", \"\")\n    .replace(\"www.\", \"\")\n    .split(/[/?#]/)[0]\n    .toUpperCase();\n\nconst modifiedDate = new Date(data.body.date_modified).toLocaleString('vi-VN');\n\nlet orderStatus = \"\";\nswitch (data.body.status) {\n    case \"pending\":\n        orderStatus = \"ƒêang ch·ªù\";\n        break;\n    case \"processing\":\n        orderStatus = \"ƒêang x·ª≠ l√Ω\";\n        break;\n    case \"on-hold\":\n        orderStatus = \"Gi·ªØ\";\n        break;\n    case \"completed\":\n        orderStatus = \"Ho√†n th√†nh\";\n        break;\n    case \"cancelled\":\n        orderStatus = \"ƒê√£ hu·ª∑\";\n        break;\n    case \"refunded\":\n        orderStatus = \"Ho√†n ti·ªÅn\";\n        break;\n    case \"failed\":\n        orderStatus = \"Th·∫•t b·∫°i\";\n        break;\n\n    case \"trash\":\n        orderStatus = \"ƒê√£ xo√°\";\n        break;\n\n    default:\n        orderStatus = \"-\";\n}\n\nconst paymentMethod = data.body.payment_method_title;\nconst discount =\n  Math.floor(+data.body.discount_total).toLocaleString(\"en-US\") + \" VND\";\nconst total = Math.floor(+data.body.total).toLocaleString(\"en-US\") + \" VND\";\n\n//Client info\nconst customerName = `${data.body.billing.last_name} ${data.body.billing.first_name}`;\nconst customerAddr = `${data.body.billing.address_1},  ${data.body.billing.city}`;\nconst customerEmail = data.body.billing.email;\nconst customerPhone = data.body.billing.phone;\nconst customerNote = data.body.customer_note;\n\n// Product info\nconst products = data.body.line_items.map((product) => {\n    const result = {\n        name: product.name,\n        quantity: product.quantity,\n        price: product.price.toLocaleString(\"en-US\") + \" VND\",\n        productTotal:\n            Math.floor(+product.total).toLocaleString(\"en-US\") + \" VND\",\n    };\n\n    return result;\n});\n\nlet result = {\n    orderId,\n    source,\n    modifiedDate,\n    orderStatus,\n    paymentMethod,\n    discount,\n    total,\n    customerName,\n    customerAddr,\n    customerEmail,\n    customerPhone,\n    customerNote,\n    products,\n};\n\nreturn result;\n"},"id":"56b9ea97-92ad-48ab-827f-03825292ba77","name":"Code","type":"n8n-nodes-base.code","typeVersion":1,"position":[1320,600]},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/bot/v2/hook/02ed9414-8ff6-4013-b735-16d23d16cf3d","sendBody":true,"specifyBody":"json","jsonBody":"={{ JSON.stringify($('Code1').first().json)}}","options":{}},"id":"7b21c048-078b-46c7-ac75-198fb869280a","name":"HTTP Request","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[1760,600]},{"parameters":{"jsCode":"const data = $(\"Code\").first().json;\nconst products = data.products;\n\nlet elements = [];\n\n// Add products\nproducts.forEach((product) => {\n    elements.push({\n        tag: \"div\",\n        fields: [\n            {\n                is_short: false,\n                text: {\n                    tag: \"lark_md\",\n                    content: `**S·∫£n ph·∫©m:** ${product.name}`,\n                },\n            },\n            {\n                is_short: true,\n                text: {\n                    tag: \"lark_md\",\n                    content: `**S·ªë l∆∞·ª£ng:** ${product.quantity}`,\n                },\n            },\n            {\n                is_short: true,\n                text: {\n                    tag: \"lark_md\",\n                    content: `**ƒê∆°n gi√°:** ${product.price}`,\n                },\n            },\n            {\n                is_short: false,\n                text: {\n                    tag: \"lark_md\",\n                    content: `**T·∫°m t√≠nh:** ${product.productTotal}`,\n                },\n            },\n        ],\n    });\n    elements.push({\n        tag: \"hr\",\n    });\n});\n\n// Add Order Info\nelements.push({\n    tag: \"div\",\n    fields: [\n        {\n            is_short: true,\n            text: {\n                tag: \"lark_md\",\n                content: `**M√£ ƒë∆°n h√†ng:** ${data.orderId}`,\n            },\n        },\n        {\n            is_short: true,\n            text: {\n                tag: \"lark_md\",\n                content: `**Ng√†y thay ƒë·ªïi:** ${data.modifiedDate}`,\n            },\n        },\n        {\n            is_short: true,\n            text: {\n                tag: \"lark_md\",\n                content: `**Tr·∫°ng th√°i:** ${data.orderStatus}`,\n            },\n        },\n        {\n            is_short: true,\n            text: {\n                tag: \"lark_md\",\n                content: `**PTTT:** ${data.paymentMethod}`,\n            },\n        },\n        {\n            is_short: true,\n            text: {\n                tag: \"lark_md\",\n                content: `**Gi·∫£m gi√°:** ${data.discount}`,\n            },\n        },\n        {\n            is_short: true,\n            text: {\n                tag: \"lark_md\",\n                content: `**Th√†nh ti·ªÅn:** ${data.total}`,\n            },\n        },\n    ],\n});\nelements.push({\n    tag: \"hr\",\n});\n\n// Add customer info\nelements.push({\n    tag: \"div\",\n    fields: [\n        {\n            is_short: true,\n            text: {\n                tag: \"lark_md\",\n                content: `**H·ªç v√† t√™n:** ${data.customerName}`,\n            },\n        },\n        {\n            is_short: true,\n            text: {\n                tag: \"lark_md\",\n                content: `**S·ªë ƒëi·ªán tho·∫°i:** ${data.customerPhone}`,\n            },\n        },\n        {\n            is_short: false,\n            text: {\n                tag: \"lark_md\",\n                content: `**Email:** ${data.customerEmail}`,\n            },\n        },\n        {\n            is_short: false,\n            text: {\n                tag: \"lark_md\",\n                content: `**ƒê·ªãa ch·ªâ:** ${data.customerAddr}`,\n            },\n        },\n        {\n            is_short: false,\n            text: {\n                tag: \"lark_md\",\n                content: `**Ghi ch√∫:** ${data.customerNote}`,\n            },\n        },\n    ],\n});\n// elements.push({\n//     tag:'hr'\n//   })\n\n// Add action buttons\nelements.push({\n    tag: \"action\",\n    actions: [\n        {\n            tag: \"button\",\n            text: {\n                tag: \"plain_text\",\n                content: \"X·ª≠ l√Ω ƒë∆°n h√†ng\",\n            },\n            url: `https://${data.source}/wp-admin/post.php?post=${data.orderId}&action=edit`,\n            type: \"primary\",\n        },\n        {\n            tag: \"button\",\n            text: {\n                tag: \"plain_text\",\n                content: \"G·ªçi ƒëi·ªán t∆∞ v·∫•n\",\n            },\n            url: `tel:${data.customerPhone}`,\n            type: \"default\",\n        },\n    ],\n});\n\nlet result = {\n    msg_type: \"interactive\",\n    card: {\n        config: {\n            wide_screen_mode: true,\n        },\n        header: {\n            template: \"blue\",\n            title: {\n                content: `üõí M·ªòT C·∫¨P NH·∫¨T T·ª™ ${data.source} - ${data.orderId}`,\n                tag: \"plain_text\",\n            },\n        },\n        elements,\n    },\n};\n\nreturn { json: result };"},"id":"ae6bf272-8b58-4e01-bab0-bbe89e739f92","name":"Code1","type":"n8n-nodes-base.code","typeVersion":1,"position":[1540,600]}],"connections":{"Webhook":{"main":[[{"node":"Code","type":"main","index":0}]]},"Code":{"main":[[{"node":"Code1","type":"main","index":0}]]},"Code1":{"main":[[{"node":"HTTP Request","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{"Webhook":[{"json":{"headers":{"host":"app.n8n.vn","user-agent":"WooCommerce/7.3.0 Hookshot (WordPress/6.1.1)","content-length":"2840","accept":"*/*","accept-encoding":"deflate, gzip, br","content-type":"application/json","referer":"https://app.n8n.vn/webhook-test/hsvn-don-hang-web","x-forwarded-for":"66.42.52.245","x-forwarded-host":"app.n8n.vn","x-forwarded-port":"443","x-forwarded-proto":"https","x-forwarded-server":"af4013275608","x-real-ip":"66.42.52.245","x-wc-webhook-delivery-id":"8a70d14fe7d1d84c70a7a10b1798bdd8","x-wc-webhook-event":"created","x-wc-webhook-id":"2","x-wc-webhook-resource":"order","x-wc-webhook-signature":"56L12YLGC2H0UvJnntp40uUWptMz9VxyWkVEgjItZeE=","x-wc-webhook-source":"https://vuabatmuoi.com/","x-wc-webhook-topic":"order.created"},"params":{},"query":{},"body":{"id":5972,"parent_id":0,"status":"processing","currency":"VND","version":"7.3.0","prices_include_tax":false,"date_created":"2023-03-09T11:18:37","date_modified":"2023-03-09T11:18:37","discount_total":"0","discount_tax":"0","shipping_total":"0","shipping_tax":"0","cart_tax":"0","total":"1212000","total_tax":"0","customer_id":30,"order_key":"wc_order_J9c8c5ufE9wCc","billing":{"first_name":"Tr·ª±c","last_name":"V≈© VƒÉn","company":"","address_1":"An Kh√°nh","address_2":"","city":"H√† N·ªôi","state":"","postcode":"","country":"VN","email":"lehien.adw@gmail.com","phone":"03012346845"},"shipping":{"first_name":"","last_name":"","company":"","address_1":"","address_2":"","city":"","state":"","postcode":"","country":"","phone":""},"payment_method":"cod","payment_method_title":"Thanh to√°n khi nh·∫≠n h√†ng","transaction_id":"","customer_ip_address":"117.5.76.36","customer_user_agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/110.0.0.0 Safari/537.36","created_via":"checkout","customer_note":"c·∫ßn g·ªçi l·∫°i t∆∞ v·∫•n","date_completed":null,"date_paid":null,"cart_hash":"41d0d85387f493fbbc40cd87837560d0","number":"5972","meta_data":[{"id":31015,"key":"is_vat_exempt","value":"no"}],"line_items":[{"id":220,"name":"ƒê√®n b·∫Øt mu·ªói v√† c√¥n tr√πng th√¥ng minh Nion GD04, c√¥ng su·∫•t 4W","product_id":4409,"variation_id":0,"quantity":3,"tax_class":"","subtotal":"1047000","subtotal_tax":"0","total":"1047000","total_tax":"0","taxes":[],"meta_data":[],"sku":"","price":349000,"image":{"id":"4412","src":"https://vuabatmuoi.com/wp-content/uploads/2022/11/GD14-2.jpg"},"parent_name":null},{"id":221,"name":"V·ª£t b·∫Øt mu·ªói v√† c√¥n tr√πng R·∫°ng ƒê√¥ng - Model RD.01","product_id":4816,"variation_id":0,"quantity":1,"tax_class":"","subtotal":"165000","subtotal_tax":"0","total":"165000","total_tax":"0","taxes":[],"meta_data":[],"sku":"","price":165000,"image":{"id":"4848","src":"https://vuabatmuoi.com/wp-content/uploads/2022/12/vot-muoi-rang-dong-2-1.jpg"},"parent_name":null}],"tax_lines":[],"shipping_lines":[],"fee_lines":[],"coupon_lines":[],"refunds":[],"payment_url":"https://vuabatmuoi.com/thanh-toan/order-pay/5972/?pay_for_order=true&key=wc_order_J9c8c5ufE9wCc","is_editable":false,"needs_payment":false,"needs_processing":true,"date_created_gmt":"2023-03-09T04:18:37","date_modified_gmt":"2023-03-09T04:18:37","date_completed_gmt":null,"date_paid_gmt":null,"currency_symbol":"‚Ç´","_links":{"self":[{"href":"https://vuabatmuoi.com/wp-json/wc/v3/orders/5972"}],"collection":[{"href":"https://vuabatmuoi.com/wp-json/wc/v3/orders"}],"customer":[{"href":"https://vuabatmuoi.com/wp-json/wc/v3/customers/30"}]}}}}]},"versionId":"99916087-fb8d-4f2c-aa79-29fc45c7b7b8","triggerCount":1,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-03-13T02:38:26.375Z","updatedAt":"2023-03-23T07:50:37.000Z","id":"48","name":"[KiotViet] Get invoices every hour","active":true,"nodes":[{"parameters":{"rule":{"interval":[{"field":"hours"}]}},"id":"e64d5874-244f-4cce-94bb-2f84ee4d12cc","name":"Schedule Trigger","type":"n8n-nodes-base.scheduleTrigger","typeVersion":1,"position":[-920,640]},{"parameters":{"jsCode":"let startDate = new Date($('Schedule Trigger').first().json.timestamp);\nlet endDate = new Date($('Schedule Trigger').first().json.timestamp);\n\nstartDate.setHours(startDate.getHours() - 1);\n// startDate.setHours(startDate.getHours() - 960); // fetch data previous 30 days\nstartDate.setMinutes(0);\nstartDate.setSeconds(1);\n\nreturn {\n  json: {\n    startDate: startDate.toISOString(),\n    endDate: endDate.toISOString(),\n  },\n};"},"id":"1038c2c9-6659-4984-b739-6b92ebec9407","name":"Get start time","type":"n8n-nodes-base.code","typeVersion":1,"position":[-760,640]},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/auth/v3/tenant_access_token/internal/","sendBody":true,"specifyBody":"json","jsonBody":"{\n    \"app_id\": \"cli_a372a34abe789010\",\n    \"app_secret\": \"DKmzzhZm18FAtMhlk2pLwczi6JVMvytI\"\n}","options":{}},"id":"d3f212db-626c-4947-9ea8-e6853d7e0427","name":"[Lark] Get tenant access token","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[280,640]},{"parameters":{"jsCode":"let input = $('Merge').all();\n\n// Get calls data\nlet records = input.map((invoice) => {\n  invoice = invoice.json;\n  let fields = {\n    id: invoice.id + '',\n    uuid: invoice.uuid,\n    code: invoice.code,\n    purchaseDate: new Date(invoice.purchaseDate).getTime() - 3600000*7,\n    branchId: invoice.branchId,\n    branchName: invoice.branchName,\n    soldById: invoice.soldById,\n    soldByName: invoice.soldByName,\n    customerId: invoice.customerId,\n    customerCode: invoice.customerCode,\n    customerName: invoice.customerName,\n    orderId: invoice.orderId,\n    orderCode: invoice.orderCode,\n    total: invoice.total,\n    totalPayment: invoice.totalPayment,\n    discount: invoice.discount,\n    status: invoice.status,\n    statusValue: invoice.statusValue,\n    description: invoice.description,\n    usingCod: invoice.usingCod,\n    createdDate: new Date(invoice.createdDate).getTime() - 3600000*7,\n    hsvnBranch: invoice.hsvnBranch,\n  };\n  return { fields };\n});\n\nlet result = { json: { records } };\nreturn result;\n"},"id":"19242efe-deee-4523-9df1-d5edd75e020c","name":"[Raw invoice] Convert to Lark format","type":"n8n-nodes-base.code","typeVersion":1,"position":[520,420]},{"parameters":{"jsCode":"let input = $('Merge').all();\n\n// Get calls data\nlet records = input.map((invoice) => {\n  invoice = invoice.json;\n  let fields = {\n    'ID ho√° ƒë∆°n': invoice.id+\"\",\n  };\n  return { fields };\n});\n\nlet result = { json: { records } };\nreturn result;\n"},"id":"df442939-1e26-47f3-9cc6-25b5f3d007f1","name":"[Invoice] Convert to Lark format","type":"n8n-nodes-base.code","typeVersion":1,"position":[520,640]},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/bitable/v1/apps/baslg7TBWBKBB5Bc5vJhovnm3Jc/tables/tblXaAcA44lgEryg/records/batch_create","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $node[\"[Lark] Get tenant access token\"].json.tenant_access_token }}"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\"records\":{{ JSON.stringify($('[Raw invoice] Convert to Lark format').first().json.records) }}}","options":{}},"id":"ef17b988-1cc3-472a-85a6-49ee9dd505cb","name":"[Raw invoice data] Add records to Bitable","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[720,420]},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/bitable/v1/apps/baslg7TBWBKBB5Bc5vJhovnm3Jc/tables/tbleHHPxpu06Uaku/records/batch_create","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $node[\"[Lark] Get tenant access token\"].json.tenant_access_token }}"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\"records\":{{ JSON.stringify($('[Invoice] Convert to Lark format').first().json.records) }}}","options":{}},"id":"66829fc4-6fcb-43e5-938c-250a0ac39692","name":"[Invoice data] Add records to Bitable","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[720,640]},{"parameters":{"method":"POST","url":"https://id.kiotviet.vn/connect/token","sendBody":true,"contentType":"form-urlencoded","bodyParameters":{"parameters":[{"name":"scopes","value":"PublicApi.Access"},{"name":"grant_type","value":"client_credentials"},{"name":"client_id","value":"fd7a52b1-d2da-4c83-aecb-aeb809c155ad"},{"name":"client_secret","value":"5C19A423F0EA1C9737CC99C8920DE9E7B51617CD"}]},"options":{}},"id":"27618cc2-9fa5-4daa-92fb-1a3bdefe4a89","name":"[KiotViet_HN] Get access token","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[-500,540]},{"parameters":{"url":"https://public.kiotapi.com/invoices","sendQuery":true,"queryParameters":{"parameters":[{"name":"fromPurchaseDate1","value":"={{ $node[\"Get start time\"].json.startDate }}"},{"name":"toPurchaseDate1","value":"={{ $node[\"Get start time\"].json.endDate }}"},{"name":"pageSize","value":"100"},{"name":"currentItem","value":"0"},{"name":"orderBy","value":"purchaseDate"},{"name":"orderDirection","value":"desc"}]},"sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $('[KiotViet_HN] Get access token').first().json.access_token }}"},{"name":"Retailer","value":"hsvn"}]},"options":{}},"id":"cb5f6306-4c5c-4f18-91a4-85c50510a143","name":"[KiotViet_HN] Get invoices in the last hour","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[-300,540]},{"parameters":{"method":"POST","url":"https://id.kiotviet.vn/connect/token","sendBody":true,"contentType":"form-urlencoded","bodyParameters":{"parameters":[{"name":"scopes","value":"PublicApi.Access"},{"name":"grant_type","value":"client_credentials"},{"name":"client_id","value":"f42db3cb-c567-41dc-9720-233de955b423"},{"name":"client_secret","value":"7395EB38A48D49BFDEABC7D140BEAAA605F0F9AA"}]},"options":{}},"id":"9cb5197e-1b31-454a-91e8-8da2451dc58b","name":"[KiotViet_HCM] Get access token","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[-500,740]},{"parameters":{},"id":"40d2cf91-6b47-4572-b23c-744fb204d00d","name":"Merge","type":"n8n-nodes-base.merge","typeVersion":2,"position":[100,640]},{"parameters":{"url":"https://public.kiotapi.com/invoices","sendQuery":true,"queryParameters":{"parameters":[{"name":"fromPurchaseDate","value":"={{ $node[\"Get start time\"].json.startDate }}"},{"name":"toPurchaseDate","value":"={{ $node[\"Get start time\"].json.endDate }}"},{"name":"pageSize","value":"100"},{"name":"currentItem","value":"0"},{"name":"orderBy","value":"purchaseDate"},{"name":"orderDirection","value":"desc"}]},"sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $('[KiotViet_HCM] Get access token').first().json.access_token }}"},{"name":"Retailer","value":"cnhcm"}]},"options":{}},"id":"917f8c37-fbd9-42e8-b565-1f4f052806b2","name":"[KiotViet_HCM] Get invoices in the last hour","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[-300,740]},{"parameters":{"jsCode":"let input = $('Merge').all();\n\n// Get calls data\nlet records = input.map((invoice) => {\n  invoice = invoice.json;\n  let fields = {\n    ID: invoice.id+\"\",\n    type: 'Invoice',\n    purchaseDate:new Date(invoice.purchaseDate).getTime() - 3600000*7,\n    createdDate:new Date(invoice.createdDate).getTime() - 3600000*7,\n  };\n  return { fields };\n});\n\nlet result = { json: { records } };\nreturn result;\n"},"id":"350c3160-2f28-433c-bfd0-dc887f4286fe","name":"[Order + Invoice] Convert to Lark format","type":"n8n-nodes-base.code","typeVersion":1,"position":[520,860]},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/bitable/v1/apps/baslg7TBWBKBB5Bc5vJhovnm3Jc/tables/tbl700SZbgdgShtP/records/batch_create","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $node[\"[Lark] Get tenant access token\"].json.tenant_access_token }}"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\"records\":{{ JSON.stringify($('[Order + Invoice] Convert to Lark format').first().json.records) }}}","options":{}},"id":"ffa30b11-e63e-4177-90af-62a009611429","name":"[Order + Invoice data] Add records to Bitable","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[720,860]},{"parameters":{"jsCode":"let timeData = $('Get start time').first().json;\n\nlet data = $('[KiotViet_HN] Get invoices in the last hour').first().json;\nlet invoices = data.data;\n\n// Filter invoices from last hour\ninvoices = invoices.filter((invoice) => {\n  let date = new Date(invoice.purchaseDate);\n  date.setHours(date.getHours() - 7);\n\n  const isoPurchaseDate = date.toISOString();\n  return (\n    timeData.startDate <= isoPurchaseDate && isoPurchaseDate <= timeData.endDate\n  );\n});\n\n// Get invoices data\ninvoices = invoices.map((invoice) => {\n  return { ...invoice, hsvnBranch: 'HN' };\n});\n\nreturn invoices;"},"id":"3f9d1866-7d81-494c-914f-6ac8c42de7b5","name":"Filter by purchaseDate & Add HSVN branch for HN","type":"n8n-nodes-base.code","typeVersion":1,"position":[-120,540]},{"parameters":{"jsCode":"let timeData = $('Get start time').first().json;\n\nlet data = $('[KiotViet_HCM] Get invoices in the last hour').first().json;\nlet invoices = data.data;\n\n// Filter invoices from last hour\ninvoices = invoices.filter((invoice) => {\n  let date = new Date(invoice.purchaseDate);\n  date.setHours(date.getHours() - 7);\n\n  const isoPurchaseDate = date.toISOString();\n  return (\n    timeData.startDate <= isoPurchaseDate && isoPurchaseDate <= timeData.endDate\n  );\n});\n\n// Get invoices data\ninvoices = invoices.map((invoice) => {\n  return { ...invoice, hsvnBranch: 'HCM' };\n});\n\nreturn invoices;\n"},"id":"bf5111ee-47ca-45a6-9b77-8812f9da9677","name":"Filter by purchaseDate & Add HSVN branch for HCM","type":"n8n-nodes-base.code","typeVersion":1,"position":[-120,740]}],"connections":{"Schedule Trigger":{"main":[[{"node":"Get start time","type":"main","index":0}]]},"[Lark] Get tenant access token":{"main":[[{"node":"[Raw invoice] Convert to Lark format","type":"main","index":0},{"node":"[Invoice] Convert to Lark format","type":"main","index":0},{"node":"[Order + Invoice] Convert to Lark format","type":"main","index":0}]]},"[Raw invoice] Convert to Lark format":{"main":[[{"node":"[Raw invoice data] Add records to Bitable","type":"main","index":0}]]},"[Invoice] Convert to Lark format":{"main":[[{"node":"[Invoice data] Add records to Bitable","type":"main","index":0}]]},"[KiotViet_HN] Get access token":{"main":[[{"node":"[KiotViet_HN] Get invoices in the last hour","type":"main","index":0}]]},"[KiotViet_HCM] Get access token":{"main":[[{"node":"[KiotViet_HCM] Get invoices in the last hour","type":"main","index":0}]]},"Merge":{"main":[[{"node":"[Lark] Get tenant access token","type":"main","index":0}]]},"[KiotViet_HN] Get invoices in the last hour":{"main":[[{"node":"Filter by purchaseDate & Add HSVN branch for HN","type":"main","index":0}]]},"Get start time":{"main":[[{"node":"[KiotViet_HN] Get access token","type":"main","index":0},{"node":"[KiotViet_HCM] Get access token","type":"main","index":0}]]},"[KiotViet_HCM] Get invoices in the last hour":{"main":[[{"node":"Filter by purchaseDate & Add HSVN branch for HCM","type":"main","index":0}]]},"[Order + Invoice] Convert to Lark format":{"main":[[{"node":"[Order + Invoice data] Add records to Bitable","type":"main","index":0}]]},"Filter by purchaseDate & Add HSVN branch for HN":{"main":[[{"node":"Merge","type":"main","index":0}]]},"Filter by purchaseDate & Add HSVN branch for HCM":{"main":[[{"node":"Merge","type":"main","index":1}]]}},"settings":{},"staticData":{"node:Schedule Trigger":{"recurrencyRules":[]}},"pinData":{"Schedule Trigger":[{"json":{"timestamp":"2023-03-23T14:00:00.000+07:00","Readable date":"March 23rd 2023, 2:25:56 pm","Readable time":"2:25:56 pm","Day of week":"Thursday","Year":"2023","Month":"March","Day of month":"23","Hour":"14","Minute":"25","Second":"56","Timezone":"+07 +07:00"}}]},"versionId":"97a2bcd3-0b4f-4b86-a847-eb3f64622cb8","triggerCount":1,"tags":[{"createdAt":"2023-03-13T02:38:31.340Z","updatedAt":"2023-03-13T02:38:31.340Z","id":"11","name":"KiotViet"}]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-03-19T15:49:28.062Z","updatedAt":"2023-03-23T07:54:30.000Z","id":"49","name":"[KiotViet] Get orders every hour","active":true,"nodes":[{"parameters":{"rule":{"interval":[{"field":"hours"}]}},"id":"097192f9-5db3-47b0-b25f-3448aa2f40a0","name":"Schedule Trigger","type":"n8n-nodes-base.scheduleTrigger","typeVersion":1,"position":[-920,640]},{"parameters":{"jsCode":"// Loop over input items and add a new field\n// called 'myNewField' to the JSON of each one\nlet startDate = new Date($('Schedule Trigger').first().json.timestamp);\nlet endDate = new Date($('Schedule Trigger').first().json.timestamp);\n\nstartDate.setHours(startDate.getHours() - 1);\n// startDate.setHours(startDate.getHours() - 960); // fetch data previous 30 days\nstartDate.setMinutes(0);\nstartDate.setSeconds(1);\n\nreturn {\n  json: {\n    startDate: startDate.toISOString(),\n    endDate: endDate.toISOString(),\n  },\n};"},"id":"27fc18cb-7008-48fd-b892-bd4fd02cdde1","name":"Get start time","type":"n8n-nodes-base.code","typeVersion":1,"position":[-760,640]},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/auth/v3/tenant_access_token/internal/","sendBody":true,"specifyBody":"json","jsonBody":"{\n    \"app_id\": \"cli_a372a34abe789010\",\n    \"app_secret\": \"DKmzzhZm18FAtMhlk2pLwczi6JVMvytI\"\n}","options":{}},"id":"2a5469d0-3e04-43c0-b352-b1af4f7a2ac0","name":"[Lark] Get tenant access token","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[280,640]},{"parameters":{"method":"POST","url":"https://id.kiotviet.vn/connect/token","sendBody":true,"contentType":"form-urlencoded","bodyParameters":{"parameters":[{"name":"scopes","value":"PublicApi.Access"},{"name":"grant_type","value":"client_credentials"},{"name":"client_id","value":"fd7a52b1-d2da-4c83-aecb-aeb809c155ad"},{"name":"client_secret","value":"5C19A423F0EA1C9737CC99C8920DE9E7B51617CD"}]},"options":{}},"id":"5b1f9753-b227-48a0-8ec7-86ebe8e3d941","name":"[KiotViet_HN] Get access token","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[-500,540]},{"parameters":{"method":"POST","url":"https://id.kiotviet.vn/connect/token","sendBody":true,"contentType":"form-urlencoded","bodyParameters":{"parameters":[{"name":"scopes","value":"PublicApi.Access"},{"name":"grant_type","value":"client_credentials"},{"name":"client_id","value":"f42db3cb-c567-41dc-9720-233de955b423"},{"name":"client_secret","value":"7395EB38A48D49BFDEABC7D140BEAAA605F0F9AA"}]},"options":{}},"id":"6b202828-5962-4386-925b-af29414bfb7f","name":"[KiotViet_HCM] Get access token","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[-500,740]},{"parameters":{},"id":"4d75873d-1cb8-43f4-bc99-297d4f8525cb","name":"Merge","type":"n8n-nodes-base.merge","typeVersion":2,"position":[100,640]},{"parameters":{"url":"https://public.kiotapi.com/orders","sendQuery":true,"queryParameters":{"parameters":[{"name":"pageSize","value":"100"},{"name":"currentItem","value":"0"},{"name":"orderBy","value":"purchaseDate"},{"name":"orderDirection","value":"desc"}]},"sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $('[KiotViet_HN] Get access token').first().json.access_token }}"},{"name":"Retailer","value":"hsvn"}]},"options":{}},"id":"74b21e27-0fa8-44cf-80c9-73673dd2f21d","name":"[KiotViet_HN] Get all orders","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[-300,540]},{"parameters":{"url":"https://public.kiotapi.com/orders","sendQuery":true,"queryParameters":{"parameters":[{"name":"pageSize","value":"100"},{"name":"currentItem","value":"0"},{"name":"orderBy","value":"purchaseDate"},{"name":"orderDirection","value":"desc"}]},"sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $('[KiotViet_HCM] Get access token').first().json.access_token }}"},{"name":"Retailer","value":"cnhcm"}]},"options":{}},"id":"c2b442ec-723c-427c-a490-d9a46cd9205e","name":"[KiotViet_HCM] Get all orders","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[-300,740]},{"parameters":{"jsCode":"let timeData = $('Get start time').first().json;\n\nlet data = $('[KiotViet_HN] Get all orders').first().json;\nlet orders = data.data;\n\n// Filter orders from last hour\norders = orders.filter((order) => {\n  let date = new Date(order.purchaseDate);\n  date.setHours(date.getHours() - 7);\n\n  const isoPurchaseDate = date.toISOString();\n  return (\n    timeData.startDate <= isoPurchaseDate && isoPurchaseDate <= timeData.endDate\n  );\n});\n\n// Get orders data\norders = orders.map((order) => {\n  return { ...order, hsvnBranch: 'HN' };\n});\n\nreturn orders;\n"},"id":"ce3414d8-b4c6-41e2-bcfc-cf346c6252f9","name":"Filter orders from last hour & Add HSVN branch for HN","type":"n8n-nodes-base.code","typeVersion":1,"position":[-120,540]},{"parameters":{"jsCode":"let timeData = $('Get start time').first().json;\n\nlet data = $('[KiotViet_HCM] Get all orders').first().json;\nlet orders = data.data;\n\n// Filter orders from last hour\norders = orders.filter((order) => {\n  let date = new Date(order.purchaseDate);\n  date.setHours(date.getHours() - 7);\n\n  const isoPurchaseDate = date.toISOString();\n  return (\n    timeData.startDate <= isoPurchaseDate && isoPurchaseDate <= timeData.endDate\n  );\n});\n\n// Get orders data\norders = orders.map((order) => {\n  return { ...order, hsvnBranch: 'HCM' };\n});\n\nreturn orders;\n"},"id":"ebb1dc0a-37e9-46aa-b189-23c3a4d5ae6f","name":"Filter orders from last hour & Add HSVN branch for HCM","type":"n8n-nodes-base.code","typeVersion":1,"position":[-120,740]},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/bitable/v1/apps/baslg7TBWBKBB5Bc5vJhovnm3Jc/tables/tblbAkzrlJSMQ0LN/records/batch_create","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $node[\"[Lark] Get tenant access token\"].json.tenant_access_token }}"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\"records\":{{ JSON.stringify($('[Raw order] Convert to Lark format').first().json.records) }}}","options":{}},"id":"dbfa750c-c653-45a0-880e-1e0c12647187","name":"[Raw order data] Add records to Bitable","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[720,420]},{"parameters":{"jsCode":"let input = $('Merge').all();\n\n// Get calls data\nlet records = input.map((order) => {\n  order = order.json;\n  let fields = {\n    id: order.id + '',\n    uuid: order.uuid,\n    code: order.code,\n    purchaseDate: new Date(order.purchaseDate).getTime() - 3600000*7,\n    branchId: order.branchId,\n    branchName: order.branchName,\n    soldById: order.soldById,\n    soldByName: order.soldByName,\n    customerId: order.customerId,\n    customerCode: order.customerCode,\n    customerName: order.customerName,\n    orderId: order.orderId,\n    orderCode: order.orderCode,\n    total: order.total,\n    totalPayment: order.totalPayment,\n    discount: order.discount,\n    status: order.status,\n    statusValue: order.statusValue,\n    description: order.description,\n    usingCod: order.usingCod,\n    createdDate: new Date(order.createdDate).getTime() - 3600000*7,\n    hsvnBranch: order.hsvnBranch,\n  };\n  return { fields };\n});\n\nlet result = { json: { records } };\nreturn result;\n"},"id":"e5d0a546-f4d5-43e9-94b1-7faa403f4817","name":"[Raw order] Convert to Lark format","type":"n8n-nodes-base.code","typeVersion":1,"position":[520,420]},{"parameters":{"jsCode":"let input = $('Merge').all();\n\n// Get calls data\nlet records = input.map((order) => {\n  order = order.json;\n  let fields = {\n    'ID ƒë∆°n h√†ng': order.id+\"\",\n  };\n  return { fields };\n});\n\nlet result = { json: { records } };\nreturn result;\n"},"id":"62e289e3-5f47-406d-93f2-38cec659efab","name":"[Order] Convert to Lark format","type":"n8n-nodes-base.code","typeVersion":1,"position":[520,640]},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/bitable/v1/apps/baslg7TBWBKBB5Bc5vJhovnm3Jc/tables/tblBk4ORszXYRZna/records/batch_create","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $node[\"[Lark] Get tenant access token\"].json.tenant_access_token }}"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\"records\":{{ JSON.stringify($('[Order] Convert to Lark format').first().json.records) }}}","options":{}},"id":"28df0ef9-47a1-48c0-ae10-058e3625d351","name":"[Order data] Add records to Bitable","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[720,640]},{"parameters":{"jsCode":"let input = $('Merge').all();\n\n// Get calls data\nlet records = input.map((order) => {\n  order = order.json;\n  let fields = {\n    ID: order.id+\"\",\n    type: 'Order',\n    purchaseDate:new Date(order.purchaseDate).getTime() - 3600000*7,\n    createdDate:new Date(order.createdDate).getTime() - 3600000*7,\n  };\n  return { fields };\n});\n\nlet result = { json: { records } };\nreturn result;\n"},"id":"fa60d596-68a9-49f4-830f-9053392d43d8","name":"[Order+Invoice] Convert to Lark format","type":"n8n-nodes-base.code","typeVersion":1,"position":[520,860]},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/bitable/v1/apps/baslg7TBWBKBB5Bc5vJhovnm3Jc/tables/tbl700SZbgdgShtP/records/batch_create","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $node[\"[Lark] Get tenant access token\"].json.tenant_access_token }}"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\"records\":{{ JSON.stringify($('[Order+Invoice] Convert to Lark format').first().json.records) }}}","options":{}},"id":"b2f0b9a2-d198-4678-b0f6-dee3b21cec01","name":"[Order+Invoice data] Add records to Bitable","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[720,860]}],"connections":{"Schedule Trigger":{"main":[[{"node":"Get start time","type":"main","index":0}]]},"[Lark] Get tenant access token":{"main":[[{"node":"[Raw order] Convert to Lark format","type":"main","index":0},{"node":"[Order] Convert to Lark format","type":"main","index":0},{"node":"[Order+Invoice] Convert to Lark format","type":"main","index":0}]]},"[KiotViet_HN] Get access token":{"main":[[{"node":"[KiotViet_HN] Get all orders","type":"main","index":0}]]},"[KiotViet_HCM] Get access token":{"main":[[{"node":"[KiotViet_HCM] Get all orders","type":"main","index":0}]]},"Merge":{"main":[[{"node":"[Lark] Get tenant access token","type":"main","index":0}]]},"Get start time":{"main":[[{"node":"[KiotViet_HN] Get access token","type":"main","index":0},{"node":"[KiotViet_HCM] Get access token","type":"main","index":0}]]},"[KiotViet_HN] Get all orders":{"main":[[{"node":"Filter orders from last hour & Add HSVN branch for HN","type":"main","index":0}]]},"[KiotViet_HCM] Get all orders":{"main":[[{"node":"Filter orders from last hour & Add HSVN branch for HCM","type":"main","index":0}]]},"Filter orders from last hour & Add HSVN branch for HN":{"main":[[{"node":"Merge","type":"main","index":0}]]},"Filter orders from last hour & Add HSVN branch for HCM":{"main":[[{"node":"Merge","type":"main","index":1}]]},"[Raw order] Convert to Lark format":{"main":[[{"node":"[Raw order data] Add records to Bitable","type":"main","index":0}]]},"[Order] Convert to Lark format":{"main":[[{"node":"[Order data] Add records to Bitable","type":"main","index":0}]]},"[Order+Invoice] Convert to Lark format":{"main":[[{"node":"[Order+Invoice data] Add records to Bitable","type":"main","index":0}]]}},"settings":{},"staticData":{"node:Schedule Trigger":{"recurrencyRules":[]}},"pinData":{"Schedule Trigger":[{"json":{"timestamp":"2023-03-23T14:00:00.000+07:00","Readable date":"March 23rd 2023, 2:50:57 pm","Readable time":"2:50:57 pm","Day of week":"Thursday","Year":"2023","Month":"March","Day of month":"23","Hour":"14","Minute":"50","Second":"57","Timezone":"+07 +07:00"}}]},"versionId":"32c05c34-414a-470e-846a-a986fad8804e","triggerCount":1,"tags":[{"createdAt":"2023-03-13T02:38:31.340Z","updatedAt":"2023-03-13T02:38:31.340Z","id":"11","name":"KiotViet"}]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-04-06T09:06:22.887Z","updatedAt":"2023-07-27T01:34:23.000Z","id":"51","name":"Send OTP - HauNH","active":true,"nodes":[{"parameters":{"httpMethod":"POST","path":"send-otp","options":{}},"id":"f86b333d-93ee-4652-a1e0-8afd6dcef054","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[460,460],"webhookId":"45909263-3dae-4761-8dc3-947057cb08a1"},{"parameters":{"fromEmail":"=OTP Service <{{ $json[\"query\"][\"emailFrom\"] }}>","toEmail":"={{ $json[\"query\"][\"emailTo\"] }}","subject":"={{ $json[\"query\"][\"title\"] }}","html":"=<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\">\n<html xmlns=\"http://www.w3.org/1999/xhtml\" xmlns:o=\"urn:schemas-microsoft-com:office:office\" style=\"font-family:arial, 'helvetica neue', helvetica, sans-serif\">\n<head>\n<meta charset=\"UTF-8\">\n<meta content=\"width=device-width, initial-scale=1\" name=\"viewport\">\n<meta name=\"x-apple-disable-message-reformatting\">\n<meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\n<meta content=\"telephone=no\" name=\"format-detection\">\n<title>OTP</title><!--[if (mso 16)]>\n<style type=\"text/css\">\na {text-decoration: none;}\n</style>\n<![endif]--><!--[if gte mso 9]><style>sup { font-size: 100% !important; }</style><![endif]--><!--[if gte mso 9]>\n<xml>\n<o:OfficeDocumentSettings>\n<o:AllowPNG></o:AllowPNG>\n<o:PixelsPerInch>96</o:PixelsPerInch>\n</o:OfficeDocumentSettings>\n</xml>\n<![endif]--><!--[if !mso]><!-- -->\n<link href=\"https://fonts.googleapis.com/css2?family=Imprima&display=swap\" rel=\"stylesheet\"><!--<![endif]-->\n<style type=\"text/css\">\n#outlook a {\npadding:0;\n}\n.es-button {\nmso-style-priority:100!important;\ntext-decoration:none!important;\n}\na[x-apple-data-detectors] {\ncolor:inherit!important;\ntext-decoration:none!important;\nfont-size:inherit!important;\nfont-family:inherit!important;\nfont-weight:inherit!important;\nline-height:inherit!important;\n}\n.es-desk-hidden {\ndisplay:none;\nfloat:left;\noverflow:hidden;\nwidth:0;\nmax-height:0;\nline-height:0;\nmso-hide:all;\n}\n@media only screen and (max-width:600px) {p, ul li, ol li, a { line-height:150%!important } h1, h2, h3, h1 a, h2 a, h3 a { line-height:120% } h1 { font-size:30px!important; text-align:left } h2 { font-size:24px!important; text-align:left } h3 { font-size:20px!important; text-align:left } .es-header-body h1 a, .es-content-body h1 a, .es-footer-body h1 a { font-size:30px!important; text-align:left } .es-header-body h2 a, .es-content-body h2 a, .es-footer-body h2 a { font-size:24px!important; text-align:left } .es-header-body h3 a, .es-content-body h3 a, .es-footer-body h3 a { font-size:20px!important; text-align:left } .es-menu td a { font-size:14px!important } .es-header-body p, .es-header-body ul li, .es-header-body ol li, .es-header-body a { font-size:14px!important } .es-content-body p, .es-content-body ul li, .es-content-body ol li, .es-content-body a { font-size:14px!important } .es-footer-body p, .es-footer-body ul li, .es-footer-body ol li, .es-footer-body a { font-size:14px!important } .es-infoblock p, .es-infoblock ul li, .es-infoblock ol li, .es-infoblock a { font-size:12px!important } *[class=\"gmail-fix\"] { display:none!important } .es-m-txt-c, .es-m-txt-c h1, .es-m-txt-c h2, .es-m-txt-c h3 { text-align:center!important } .es-m-txt-r, .es-m-txt-r h1, .es-m-txt-r h2, .es-m-txt-r h3 { text-align:right!important } .es-m-txt-l, .es-m-txt-l h1, .es-m-txt-l h2, .es-m-txt-l h3 { text-align:left!important } .es-m-txt-r img, .es-m-txt-c img, .es-m-txt-l img { display:inline!important } .es-button-border { display:block!important } a.es-button, button.es-button { font-size:18px!important; display:block!important; border-right-width:0px!important; border-left-width:0px!important; border-top-width:15px!important; border-bottom-width:15px!important } .es-adaptive table, .es-left, .es-right { width:100%!important } .es-content table, .es-header table, .es-footer table, .es-content, .es-footer, .es-header { width:100%!important; max-width:600px!important } .es-adapt-td { display:block!important; width:100%!important } .adapt-img { width:100%!important; height:auto!important } .es-m-p0 { padding:0px!important } .es-m-p0r { padding-right:0px!important } .es-m-p0l { padding-left:0px!important } .es-m-p0t { padding-top:0px!important } .es-m-p0b { padding-bottom:0!important } .es-m-p20b { padding-bottom:20px!important } .es-mobile-hidden, .es-hidden { display:none!important } tr.es-desk-hidden, td.es-desk-hidden, table.es-desk-hidden { width:auto!important; overflow:visible!important; float:none!important; max-height:inherit!important; line-height:inherit!important } tr.es-desk-hidden { display:table-row!important } table.es-desk-hidden { display:table!important } td.es-desk-menu-hidden { display:table-cell!important } .es-menu td { width:1%!important } table.es-table-not-adapt, .esd-block-html table { width:auto!important } table.es-social { display:inline-block!important } table.es-social td { display:inline-block!important } .es-desk-hidden { display:table-row!important; width:auto!important; overflow:visible!important; max-height:inherit!important } .h-auto { height:auto!important } }\n</style>\n</head>\n<body data-new-gr-c-s-loaded=\"14.1101.0\" style=\"width:100%;font-family:arial, 'helvetica neue', helvetica, sans-serif;-webkit-text-size-adjust:100%;-ms-text-size-adjust:100%;padding:0;Margin:0\">\n<div class=\"es-wrapper-color\" style=\"background-color:#FFFFFF\"><!--[if gte mso 9]>\n<v:background xmlns:v=\"urn:schemas-microsoft-com:vml\" fill=\"t\">\n<v:fill type=\"tile\" color=\"#ffffff\"></v:fill>\n</v:background>\n<![endif]-->\n<table class=\"es-wrapper\" width=\"100%\" cellspacing=\"0\" cellpadding=\"0\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;padding:0;Margin:0;width:100%;height:100%;background-repeat:repeat;background-position:center top;background-color:#FFFFFF\">\n<tr>\n<td valign=\"top\" style=\"padding:0;Margin:0\">\n<table cellpadding=\"0\" cellspacing=\"0\" class=\"es-content\" align=\"center\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;table-layout:fixed !important;width:100%\">\n<tr>\n<td align=\"center\" style=\"padding:0;Margin:0\">\n<table bgcolor=\"#efefef\" class=\"es-content-body\" align=\"center\" cellpadding=\"0\" cellspacing=\"0\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;background-color:#EFEFEF;border-radius:20px 20px 0 0;width:600px\">\n<tr>\n<td align=\"left\" style=\"padding:0;Margin:0;padding-top:40px;padding-left:40px;padding-right:40px\">\n<table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\">\n<tr>\n<td align=\"center\" valign=\"top\" style=\"padding:0;Margin:0;width:520px\">\n<table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" role=\"presentation\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\">\n<tr>\n<td align=\"center\" style=\"padding:0;Margin:0;font-size:0px\"><a target=\"_blank\" href=\"https://www.facebook.com\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:underline;color:#2D3142;font-size:18px\"><img src=\"https://upload.wikimedia.org/wikipedia/commons/a/ab/Android_O_Preview_Logo.png\" alt style=\"display:block;border:0;outline:none;text-decoration:none;-ms-interpolation-mode:bicubic;border-radius:100px\" width=\"180\"></a></td>\n</tr>\n</table></td>\n</tr>\n</table></td>\n</tr>\n<tr>\n<td align=\"left\" style=\"padding:0;Margin:0;padding-top:20px;padding-left:40px;padding-right:40px\">\n<table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\">\n<tr>\n<td align=\"center\" valign=\"top\" style=\"padding:0;Margin:0;width:520px\">\n<table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" bgcolor=\"#fafafa\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:separate;border-spacing:0px;background-color:#fafafa;border-radius:10px\" role=\"presentation\">\n<tr>\n<td align=\"left\" style=\"padding:20px;Margin:0\"><h3 style=\"Margin:0;line-height:34px;mso-line-height-rule:exactly;font-family:Imprima, Arial, sans-serif;font-size:28px;font-style:normal;font-weight:bold;color:#2D3142\">Dear {{ $json[\"query\"][\"otp\"] }},</h3><p style=\"Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:Imprima, Arial, sans-serif;line-height:27px;color:#2D3142;font-size:18px\"><br><br>Congratulations on being selected for the <strong>{{ $json[\"query\"][\"otp\"] }}</strong> position. We were impressed with your qualifications, experience, and skills.<br><br>As the next step in our recruitment process, we would like to invite you to take our entrance test. The test is available online at button below. Please complete the test within 48h of receiving this email.<br><br>If you encounter any technical difficulties or have any questions, please do not hesitate to contact us.<br><br>We look forward to receiving your test results and wish you the best of luck.<br><br>Best regards,<br><strong>OTP Service</strong></p></td>\n</tr>\n</table></td>\n</tr>\n</table></td>\n</tr>\n</table></td>\n</tr>\n</table>\n<table cellpadding=\"0\" cellspacing=\"0\" class=\"es-content\" align=\"center\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;table-layout:fixed !important;width:100%\">\n<tr>\n<td align=\"center\" style=\"padding:0;Margin:0\">\n<table bgcolor=\"#efefef\" class=\"es-content-body\" align=\"center\" cellpadding=\"0\" cellspacing=\"0\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;background-color:#EFEFEF;width:600px\">\n<tr>\n<td align=\"left\" style=\"Margin:0;padding-top:30px;padding-bottom:40px;padding-left:40px;padding-right:40px\">\n<table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\">\n<tr>\n<td align=\"center\" valign=\"top\" style=\"padding:0;Margin:0;width:520px\">\n<table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" role=\"presentation\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\">\n<tr>\n<td align=\"center\" style=\"padding:0;Margin:0\"><!--[if mso]><a href=\"\" target=\"_blank\" hidden>\n<v:roundrect xmlns:v=\"urn:schemas-microsoft-com:vml\" xmlns:w=\"urn:schemas-microsoft-com:office:word\" esdevVmlButton href=\"\"\nstyle=\"height:56px; v-text-anchor:middle; width:520px\" arcsize=\"50%\" stroke=\"f\" fillcolor=\"#7630f3\">\n<w:anchorlock></w:anchorlock>\n<center style='color:#ffffff; font-family:-apple-system, \"system-ui\", \"Segoe UI\", Roboto, Helvetica, Arial, sans-serif, \"Apple Color Emoji\", \"Segoe UI Emoji\", \"Segoe UI Symbol\"; font-size:22px; font-weight:700; line-height:22px; mso-text-raise:1px'>Take a Test</center>\n</v:roundrect></a>\n<![endif]--><!--[if !mso]><!-- --><span class=\"msohide es-button-border\" style=\"border-style:solid;border-color:#2CB543;background:#7630f3;border-width:0px;display:block;border-radius:30px;width:auto;mso-border-alt:10px;mso-hide:all\"><a href=\"https://talomedia.larksuite.com/share/base/form/shrusCFhOMy2eGjNR9SVmTBwd2d\" class=\"es-button msohide\" target=\"_blank\" style=\"mso-style-priority:100 !important;text-decoration:none;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;color:#FFFFFF;font-size:22px;padding:15px 20px 15px 20px;display:block;background:#7630f3;border-radius:30px;font-family:-apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol';font-weight:bold;font-style:normal;line-height:26px;width:auto;text-align:center;mso-hide:all;padding-left:5px;padding-right:5px;border-color:#7630f3\">Take a Test</a></span><!--<![endif]--></td>\n</tr>\n</table></td>\n</tr>\n</table></td>\n</tr>\n</table></td>\n</tr>\n</table>\n<table cellpadding=\"0\" cellspacing=\"0\" class=\"es-content\" align=\"center\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;table-layout:fixed !important;width:100%\">\n<tr>\n<td align=\"center\" style=\"padding:0;Margin:0\">\n<table bgcolor=\"#efefef\" class=\"es-content-body\" align=\"center\" cellpadding=\"0\" cellspacing=\"0\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;background-color:#EFEFEF;border-radius:0 0 20px 20px;width:600px\">\n<tr>\n<td class=\"esdev-adapt-off\" align=\"left\" style=\"Margin:0;padding-top:20px;padding-bottom:20px;padding-left:40px;padding-right:40px\">\n<table cellpadding=\"0\" cellspacing=\"0\" class=\"esdev-mso-table\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;width:520px\">\n<tr>\n<td class=\"esdev-mso-td\" valign=\"top\" style=\"padding:0;Margin:0\">\n<table cellpadding=\"0\" cellspacing=\"0\" align=\"left\" class=\"es-left\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;float:left\">\n<tr>\n<td align=\"center\" valign=\"top\" style=\"padding:0;Margin:0;width:47px\">\n<table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" role=\"presentation\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\">\n<tr>\n<td align=\"center\" class=\"es-m-txt-l\" style=\"padding:0;Margin:0;font-size:0px\"><a target=\"_blank\" href=\"https://viewstripo.email\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:underline;color:#2D3142;font-size:18px\"><img src=\"https://dnsfnr.stripocdn.email/content/guids/CABINET_ee77850a5a9f3068d9355050e69c76d26d58c3ea2927fa145f0d7a894e624758/images/group_4076325.png\" alt=\"Demo\" style=\"display:block;border:0;outline:none;text-decoration:none;-ms-interpolation-mode:bicubic\" width=\"37\" title=\"Demo\"></a></td>\n</tr>\n</table></td>\n</tr>\n</table></td>\n<td style=\"padding:0;Margin:0;width:20px\"></td>\n<td class=\"esdev-mso-td\" valign=\"top\" style=\"padding:0;Margin:0\">\n<table cellpadding=\"0\" cellspacing=\"0\" class=\"es-right\" align=\"right\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;float:right\">\n<tr>\n<td align=\"center\" valign=\"top\" style=\"padding:0;Margin:0;width:453px\">\n<table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" role=\"presentation\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\">\n<tr>\n<td align=\"left\" style=\"padding:0;Margin:0\"><p style=\"Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:Imprima, Arial, sans-serif;line-height:32px;color:#2D3142;font-size:16px\">If you have any questions, contact us via any channel below!</p></td>\n</tr>\n</table></td>\n</tr>\n</table></td>\n</tr>\n</table></td>\n</tr>\n</table></td>\n</tr>\n</table>\n<table cellpadding=\"0\" cellspacing=\"0\" class=\"es-footer\" align=\"center\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;table-layout:fixed !important;width:100%;background-color:transparent;background-repeat:repeat;background-position:center top\">\n<tr>\n<td align=\"center\" style=\"padding:0;Margin:0\">\n<table bgcolor=\"#bcb8b1\" class=\"es-footer-body\" align=\"center\" cellpadding=\"0\" cellspacing=\"0\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;background-color:#FFFFFF;width:600px\">\n<tr>\n<td align=\"left\" style=\"Margin:0;padding-left:20px;padding-right:20px;padding-bottom:30px;padding-top:40px\">\n<table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\">\n<tr>\n<td align=\"left\" style=\"padding:0;Margin:0;width:560px\">\n<table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" role=\"presentation\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\">\n<tr>\n<td align=\"center\" class=\"es-m-txt-c\" style=\"padding:0;Margin:0;padding-top:10px;padding-bottom:20px;font-size:0\">\n<table cellpadding=\"0\" cellspacing=\"0\" class=\"es-table-not-adapt es-social\" role=\"presentation\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\">\n<tr>\n<td align=\"center\" valign=\"top\" style=\"padding:0;Margin:0\"><a target=\"_blank\" href=\"https://www.facebook.com\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:underline;color:#2D3142;font-size:14px\"><img src=\"https://dnsfnr.stripocdn.email/content/assets/img/social-icons/logo-black/facebook-logo-black.png\" alt=\"Fb\" title=\"Facebook\" height=\"24\" style=\"display:block;border:0;outline:none;text-decoration:none;-ms-interpolation-mode:bicubic\"></a></td>\n<td align=\"center\" valign=\"top\" style=\"padding:0;Margin:0\"><a target=\"_blank\" href=\"mailto:email@gmail.comt?subject=Get%20Support%20from%20Test%20Invited\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:underline;color:#2D3142;font-size:14px\"><img src=\"https://dnsfnr.stripocdn.email/content/assets/img/other-icons/logo-black/mail-logo-black.png\" alt=\"Email\" title=\"Email\" height=\"24\" style=\"display:block;border:0;outline:none;text-decoration:none;-ms-interpolation-mode:bicubic\"></a></td>\n<td align=\"center\" valign=\"top\" style=\"padding:0;Margin:0\"><a target=\"_blank\" href=\"https://goo.gl/maps\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:underline;color:#2D3142;font-size:14px\"><img src=\"https://dnsfnr.stripocdn.email/content/assets/img/other-icons/logo-black/location-logo-black.png\" alt=\"Map Marker\" title=\"Map Marker\" height=\"24\" style=\"display:block;border:0;outline:none;text-decoration:none;-ms-interpolation-mode:bicubic\"></a></td>\n<td align=\"center\" valign=\"top\" style=\"padding:0;Margin:0\"><a target=\"_blank\" href=\"tel:0905060708\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:underline;color:#2D3142;font-size:14px\"><img src=\"https://dnsfnr.stripocdn.email/content/assets/img/other-icons/logo-black/phone-logo-black.png\" alt=\"Phone\" title=\"Phone\" height=\"24\" style=\"display:block;border:0;outline:none;text-decoration:none;-ms-interpolation-mode:bicubic\"></a></td>\n<td align=\"center\" valign=\"top\" style=\"padding:0;Margin:0\"><a target=\"_blank\" href=\"https://www.google.com/maps\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:underline;color:#2D3142;font-size:14px\"><img src=\"https://dnsfnr.stripocdn.email/content/assets/img/other-icons/logo-black/googlebusiness-logo-black.png\" alt=\"Google Business\" title=\"Google Business\" height=\"24\" style=\"display:block;border:0;outline:none;text-decoration:none;-ms-interpolation-mode:bicubic\"></a></td>\n</tr>\n</table></td>\n</tr>\n<tr>\n<td align=\"center\" style=\"padding:0;Margin:0\"><p style=\"Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:Imprima, Arial, sans-serif;line-height:20px;color:#2D3142;font-size:13px\"><a target=\"_blank\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:none;color:#2D3142;font-size:14px\" href=\"\"></a><a target=\"_blank\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:none;color:#2D3142;font-size:14px\" href=\"\">Privacy Policy</a><a target=\"_blank\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:none;color:#2D3142;font-size:13px\" href=\"\"></a> ‚Ä¢ <a target=\"_blank\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:none;color:#2D3142;font-size:14px\" href=\"\">Unsubscribe</a></p></td>\n</tr>\n<tr>\n<td align=\"center\" style=\"padding:0;Margin:0;padding-top:20px\"><p style=\"Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:Imprima, Arial, sans-serif;line-height:21px;color:#2D3142;font-size:14px\"><a target=\"_blank\" href=\"\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:underline;color:#2D3142;font-size:14px\"></a>Copyright ¬© 2023&nbsp;<a target=\"_blank\" href=\"\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:underline;color:#2D3142;font-size:14px\"></a></p></td>\n</tr>\n</table></td>\n</tr>\n</table></td>\n</tr>\n</table></td>\n</tr>\n</table></td>\n</tr>\n</table>\n</div>\n</body>\n</html>","options":{}},"id":"e4f8f1f4-9231-4fd9-99a8-e5fd8e6bcb2c","name":"Send Email","type":"n8n-nodes-base.emailSend","typeVersion":1,"position":[640,460],"credentials":{"smtp":{"id":"93","name":"Demo 02"}}}],"connections":{"Webhook":{"main":[[{"node":"Send Email","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{},"versionId":"dc7e8e0f-5ef3-4b3d-8252-09d57ca1d9b5","triggerCount":1,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-04-06T09:12:33.142Z","updatedAt":"2023-06-30T07:23:55.000Z","id":"52","name":"Send email FAIL","active":false,"nodes":[{"parameters":{"httpMethod":"POST","path":"email-fail","options":{}},"id":"d369549f-f24f-4cf7-ae42-fa73e6fc9177","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[460,460],"webhookId":"afd87589-2781-4abf-82f0-5c0713040617"},{"parameters":{"fromEmail":"HR's Talo Media<hr@talomedia.net>","toEmail":"={{ $json[\"query\"][\"email\"] }}","ccEmail":"hr@talomedia.net","subject":"=[Talo Media]Regarding Your Application for [{{ $json[\"query\"][\"position\"] }}] Position","html":"=<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\">\n<html xmlns=\"http://www.w3.org/1999/xhtml\" xmlns:o=\"urn:schemas-microsoft-com:office:office\" style=\"font-family:arial, 'helvetica neue', helvetica, sans-serif\">\n<head>\n<meta charset=\"UTF-8\">\n<meta content=\"width=device-width, initial-scale=1\" name=\"viewport\">\n<meta name=\"x-apple-disable-message-reformatting\">\n<meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\n<meta content=\"telephone=no\" name=\"format-detection\">\n<title>Pass CV - Test 1</title><!--[if (mso 16)]>\n<style type=\"text/css\">\na {text-decoration: none;}\n</style>\n<![endif]--><!--[if gte mso 9]><style>sup { font-size: 100% !important; }</style><![endif]--><!--[if gte mso 9]>\n<xml>\n<o:OfficeDocumentSettings>\n<o:AllowPNG></o:AllowPNG>\n<o:PixelsPerInch>96</o:PixelsPerInch>\n</o:OfficeDocumentSettings>\n</xml>\n<![endif]--><!--[if !mso]><!-- -->\n<link href=\"https://fonts.googleapis.com/css2?family=Imprima&display=swap\" rel=\"stylesheet\"><!--<![endif]-->\n<style type=\"text/css\">\n#outlook a {\npadding:0;\n}\n.es-button {\nmso-style-priority:100!important;\ntext-decoration:none!important;\n}\na[x-apple-data-detectors] {\ncolor:inherit!important;\ntext-decoration:none!important;\nfont-size:inherit!important;\nfont-family:inherit!important;\nfont-weight:inherit!important;\nline-height:inherit!important;\n}\n.es-desk-hidden {\ndisplay:none;\nfloat:left;\noverflow:hidden;\nwidth:0;\nmax-height:0;\nline-height:0;\nmso-hide:all;\n}\n@media only screen and (max-width:600px) {p, ul li, ol li, a { line-height:150%!important } h1, h2, h3, h1 a, h2 a, h3 a { line-height:120% } h1 { font-size:30px!important; text-align:left } h2 { font-size:24px!important; text-align:left } h3 { font-size:20px!important; text-align:left } .es-header-body h1 a, .es-content-body h1 a, .es-footer-body h1 a { font-size:30px!important; text-align:left } .es-header-body h2 a, .es-content-body h2 a, .es-footer-body h2 a { font-size:24px!important; text-align:left } .es-header-body h3 a, .es-content-body h3 a, .es-footer-body h3 a { font-size:20px!important; text-align:left } .es-menu td a { font-size:14px!important } .es-header-body p, .es-header-body ul li, .es-header-body ol li, .es-header-body a { font-size:14px!important } .es-content-body p, .es-content-body ul li, .es-content-body ol li, .es-content-body a { font-size:14px!important } .es-footer-body p, .es-footer-body ul li, .es-footer-body ol li, .es-footer-body a { font-size:14px!important } .es-infoblock p, .es-infoblock ul li, .es-infoblock ol li, .es-infoblock a { font-size:12px!important } *[class=\"gmail-fix\"] { display:none!important } .es-m-txt-c, .es-m-txt-c h1, .es-m-txt-c h2, .es-m-txt-c h3 { text-align:center!important } .es-m-txt-r, .es-m-txt-r h1, .es-m-txt-r h2, .es-m-txt-r h3 { text-align:right!important } .es-m-txt-l, .es-m-txt-l h1, .es-m-txt-l h2, .es-m-txt-l h3 { text-align:left!important } .es-m-txt-r img, .es-m-txt-c img, .es-m-txt-l img { display:inline!important } .es-button-border { display:block!important } a.es-button, button.es-button { font-size:18px!important; display:block!important; border-right-width:0px!important; border-left-width:0px!important; border-top-width:15px!important; border-bottom-width:15px!important } .es-adaptive table, .es-left, .es-right { width:100%!important } .es-content table, .es-header table, .es-footer table, .es-content, .es-footer, .es-header { width:100%!important; max-width:600px!important } .es-adapt-td { display:block!important; width:100%!important } .adapt-img { width:100%!important; height:auto!important } .es-m-p0 { padding:0px!important } .es-m-p0r { padding-right:0px!important } .es-m-p0l { padding-left:0px!important } .es-m-p0t { padding-top:0px!important } .es-m-p0b { padding-bottom:0!important } .es-m-p20b { padding-bottom:20px!important } .es-mobile-hidden, .es-hidden { display:none!important } tr.es-desk-hidden, td.es-desk-hidden, table.es-desk-hidden { width:auto!important; overflow:visible!important; float:none!important; max-height:inherit!important; line-height:inherit!important } tr.es-desk-hidden { display:table-row!important } table.es-desk-hidden { display:table!important } td.es-desk-menu-hidden { display:table-cell!important } .es-menu td { width:1%!important } table.es-table-not-adapt, .esd-block-html table { width:auto!important } table.es-social { display:inline-block!important } table.es-social td { display:inline-block!important } .es-desk-hidden { display:table-row!important; width:auto!important; overflow:visible!important; max-height:inherit!important } .h-auto { height:auto!important } }\n</style>\n</head>\n<body data-new-gr-c-s-loaded=\"14.1101.0\" style=\"width:100%;font-family:arial, 'helvetica neue', helvetica, sans-serif;-webkit-text-size-adjust:100%;-ms-text-size-adjust:100%;padding:0;Margin:0\">\n<div class=\"es-wrapper-color\" style=\"background-color:#FFFFFF\"><!--[if gte mso 9]>\n<v:background xmlns:v=\"urn:schemas-microsoft-com:vml\" fill=\"t\">\n<v:fill type=\"tile\" color=\"#ffffff\"></v:fill>\n</v:background>\n<![endif]-->\n<table class=\"es-wrapper\" width=\"100%\" cellspacing=\"0\" cellpadding=\"0\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;padding:0;Margin:0;width:100%;height:100%;background-repeat:repeat;background-position:center top;background-color:#FFFFFF\">\n<tr>\n<td valign=\"top\" style=\"padding:0;Margin:0\">\n<table cellpadding=\"0\" cellspacing=\"0\" class=\"es-content\" align=\"center\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;table-layout:fixed !important;width:100%\">\n<tr>\n<td align=\"center\" style=\"padding:0;Margin:0\">\n<table bgcolor=\"#efefef\" class=\"es-content-body\" align=\"center\" cellpadding=\"0\" cellspacing=\"0\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;background-color:#EFEFEF;border-radius:20px 20px 0 0;width:600px\">\n<tr>\n<td align=\"left\" style=\"padding:0;Margin:0;padding-top:40px;padding-left:40px;padding-right:40px\">\n<table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\">\n<tr>\n<td align=\"center\" valign=\"top\" style=\"padding:0;Margin:0;width:520px\">\n<table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" role=\"presentation\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\">\n<tr>\n<td align=\"center\" style=\"padding:0;Margin:0;font-size:0px\"><a target=\"_blank\" href=\"https://www.facebook.com/TaloMedia.Inc\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:underline;color:#2D3142;font-size:18px\"><img src=\"https://trello.com/1/cards/616fe1684cafe70babf9447c/attachments/641bd4cc956ddc145421c7bb/download/logo_cover_-_min.png\" alt style=\"display:block;border:0;outline:none;text-decoration:none;-ms-interpolation-mode:bicubic;border-radius:100px\" width=\"180\"></a></td>\n</tr>\n</table></td>\n</tr>\n</table></td>\n</tr>\n<tr>\n<td align=\"left\" style=\"padding:0;Margin:0;padding-top:20px;padding-left:40px;padding-right:40px\">\n<table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\">\n<tr>\n<td align=\"center\" valign=\"top\" style=\"padding:0;Margin:0;width:520px\">\n<table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" bgcolor=\"#fafafa\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:separate;border-spacing:0px;background-color:#fafafa;border-radius:10px\" role=\"presentation\">\n<tr>\n<td align=\"left\" style=\"padding:20px;Margin:0\"><h3 style=\"Margin:0;line-height:34px;mso-line-height-rule:exactly;font-family:Imprima, Arial, sans-serif;font-size:28px;font-style:normal;font-weight:bold;color:#2D3142\">Dear {{ $json[\"query\"][\"name\"] }},</h3><p style=\"Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:Imprima, Arial, sans-serif;line-height:27px;color:#2D3142;font-size:18px\"><br><br>Thank you for your interest in the <strong>{{ $json[\"query\"][\"position\"] }}</strong> position at <strong>Talo Media</strong>. We appreciate the time and effort you put into submitting your application.<br><br>After careful consideration, we regret to inform you that we have decided not to move forward with your application. We received many qualified candidates and unfortunately, we cannot invite everyone to the next stage of the recruitment process.<br><br>Please do not be discouraged by this decision. We encourage you to continue exploring other opportunities that align with your interests and qualifications. We appreciate your interest in our company and wish you the best of luck in your future endeavors.<br><br>Thank you again for your application and your interest in working with us.<br><br>Best regards,<br><strong>Talo Media</strong></p></td>\n</tr>\n</table></td>\n</tr>\n</table></td>\n</tr>\n</table></td>\n</tr>\n</table>\n<table cellpadding=\"0\" cellspacing=\"0\" class=\"es-content\" align=\"center\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;table-layout:fixed !important;width:100%\">\n<tr>\n<td align=\"center\" style=\"padding:0;Margin:0\">\n<table bgcolor=\"#efefef\" class=\"es-content-body\" align=\"center\" cellpadding=\"0\" cellspacing=\"0\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;background-color:#EFEFEF;width:600px\">\n<tr>\n\n</tr>\n<tr>\n<td align=\"left\" style=\"padding:0;Margin:0;padding-left:40px;padding-right:40px\">\n<table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\">\n<tr>\n<td align=\"center\" valign=\"top\" style=\"padding:0;Margin:0;width:520px\">\n<table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" role=\"presentation\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\">\n<tr>\n<td align=\"center\" style=\"padding:20px;Margin:0;font-size:0px\">\n<table border=\"0\" width=\"100%\" height=\"100%\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\">\n<tr>\n<td style=\"padding:0;Margin:0;border-bottom:1px dashed #cccccc;background:none;height:1px;width:100%;margin:0px\"></td>\n</tr>\n</table></td>\n</tr>\n</table></td>\n</tr>\n</table></td>\n</tr>\n</table></td>\n</tr>\n</table>\n<table cellpadding=\"0\" cellspacing=\"0\" class=\"es-content\" align=\"center\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;table-layout:fixed !important;width:100%\">\n<tr>\n<td align=\"center\" style=\"padding:0;Margin:0\">\n<table bgcolor=\"#efefef\" class=\"es-content-body\" align=\"center\" cellpadding=\"0\" cellspacing=\"0\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;background-color:#EFEFEF;border-radius:0 0 20px 20px;width:600px\">\n<tr>\n<td class=\"esdev-adapt-off\" align=\"left\" style=\"Margin:0;padding-top:20px;padding-bottom:20px;padding-left:40px;padding-right:40px\">\n<table cellpadding=\"0\" cellspacing=\"0\" class=\"esdev-mso-table\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;width:520px\">\n<tr>\n<td class=\"esdev-mso-td\" valign=\"top\" style=\"padding:0;Margin:0\">\n<table cellpadding=\"0\" cellspacing=\"0\" align=\"left\" class=\"es-left\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;float:left\">\n<tr>\n<td align=\"center\" valign=\"top\" style=\"padding:0;Margin:0;width:47px\">\n<table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" role=\"presentation\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\">\n<tr>\n<td align=\"center\" class=\"es-m-txt-l\" style=\"padding:0;Margin:0;font-size:0px\"><a target=\"_blank\" href=\"https://viewstripo.email\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:underline;color:#2D3142;font-size:18px\"><img src=\"https://dnsfnr.stripocdn.email/content/guids/CABINET_ee77850a5a9f3068d9355050e69c76d26d58c3ea2927fa145f0d7a894e624758/images/group_4076325.png\" alt=\"Demo\" style=\"display:block;border:0;outline:none;text-decoration:none;-ms-interpolation-mode:bicubic\" width=\"37\" title=\"Demo\"></a></td>\n</tr>\n</table></td>\n</tr>\n</table></td>\n<td style=\"padding:0;Margin:0;width:20px\"></td>\n<td class=\"esdev-mso-td\" valign=\"top\" style=\"padding:0;Margin:0\">\n<table cellpadding=\"0\" cellspacing=\"0\" class=\"es-right\" align=\"right\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;float:right\">\n<tr>\n<td align=\"center\" valign=\"top\" style=\"padding:0;Margin:0;width:453px\">\n<table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" role=\"presentation\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\">\n<tr>\n<td align=\"left\" style=\"padding:0;Margin:0\"><p style=\"Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:Imprima, Arial, sans-serif;line-height:32px;color:#2D3142;font-size:16px\">If you have any questions, contact us via any channel below!</p></td>\n</tr>\n</table></td>\n</tr>\n</table></td>\n</tr>\n</table></td>\n</tr>\n</table></td>\n</tr>\n</table>\n<table cellpadding=\"0\" cellspacing=\"0\" class=\"es-footer\" align=\"center\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;table-layout:fixed !important;width:100%;background-color:transparent;background-repeat:repeat;background-position:center top\">\n<tr>\n<td align=\"center\" style=\"padding:0;Margin:0\">\n<table bgcolor=\"#bcb8b1\" class=\"es-footer-body\" align=\"center\" cellpadding=\"0\" cellspacing=\"0\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;background-color:#FFFFFF;width:600px\">\n<tr>\n<td align=\"left\" style=\"Margin:0;padding-left:20px;padding-right:20px;padding-bottom:30px;padding-top:40px\">\n<table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\">\n<tr>\n<td align=\"left\" style=\"padding:0;Margin:0;width:560px\">\n<table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" role=\"presentation\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\">\n<tr>\n<td align=\"center\" class=\"es-m-txt-c\" style=\"padding:0;Margin:0;padding-top:10px;padding-bottom:20px;font-size:0\">\n<table cellpadding=\"0\" cellspacing=\"0\" class=\"es-table-not-adapt es-social\" role=\"presentation\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\">\n<tr>\n<td align=\"center\" valign=\"top\" style=\"padding:0;Margin:0\"><a target=\"_blank\" href=\"https://www.facebook.com/TaloMedia.Inc\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:underline;color:#2D3142;font-size:14px\"><img src=\"https://dnsfnr.stripocdn.email/content/assets/img/social-icons/logo-black/facebook-logo-black.png\" alt=\"Fb\" title=\"Facebook\" height=\"24\" style=\"display:block;border:0;outline:none;text-decoration:none;-ms-interpolation-mode:bicubic\"></a></td>\n<td align=\"center\" valign=\"top\" style=\"padding:0;Margin:0\"><a target=\"_blank\" href=\"mailto:hr@talomedia.net?subject=Get%20Support%20from%20Test%20Invited\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:underline;color:#2D3142;font-size:14px\"><img src=\"https://dnsfnr.stripocdn.email/content/assets/img/other-icons/logo-black/mail-logo-black.png\" alt=\"Email\" title=\"Email\" height=\"24\" style=\"display:block;border:0;outline:none;text-decoration:none;-ms-interpolation-mode:bicubic\"></a></td>\n<td align=\"center\" valign=\"top\" style=\"padding:0;Margin:0\"><a target=\"_blank\" href=\"https://goo.gl/maps/vsN1kZ1EGutGxb3t5\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:underline;color:#2D3142;font-size:14px\"><img src=\"https://dnsfnr.stripocdn.email/content/assets/img/other-icons/logo-black/location-logo-black.png\" alt=\"Map Marker\" title=\"Map Marker\" height=\"24\" style=\"display:block;border:0;outline:none;text-decoration:none;-ms-interpolation-mode:bicubic\"></a></td>\n<td align=\"center\" valign=\"top\" style=\"padding:0;Margin:0\"><a target=\"_blank\" href=\"tel:0905033554\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:underline;color:#2D3142;font-size:14px\"><img src=\"https://dnsfnr.stripocdn.email/content/assets/img/other-icons/logo-black/phone-logo-black.png\" alt=\"Phone\" title=\"Phone\" height=\"24\" style=\"display:block;border:0;outline:none;text-decoration:none;-ms-interpolation-mode:bicubic\"></a></td>\n<td align=\"center\" valign=\"top\" style=\"padding:0;Margin:0\"><a target=\"_blank\" href=\"https://www.google.com/maps/contrib/114365313953020145193/photos/@16.0561659,108.2188394,17z/data=!4m3!8m2!3m1!1e1\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:underline;color:#2D3142;font-size:14px\"><img src=\"https://dnsfnr.stripocdn.email/content/assets/img/other-icons/logo-black/googlebusiness-logo-black.png\" alt=\"Google Business\" title=\"Google Business\" height=\"24\" style=\"display:block;border:0;outline:none;text-decoration:none;-ms-interpolation-mode:bicubic\"></a></td>\n</tr>\n</table></td>\n</tr>\n<tr>\n<td align=\"center\" style=\"padding:0;Margin:0\"><p style=\"Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:Imprima, Arial, sans-serif;line-height:20px;color:#2D3142;font-size:13px\"><a target=\"_blank\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:none;color:#2D3142;font-size:14px\" href=\"\"></a><a target=\"_blank\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:none;color:#2D3142;font-size:14px\" href=\"\">Privacy Policy</a><a target=\"_blank\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:none;color:#2D3142;font-size:13px\" href=\"\"></a> ‚Ä¢ <a target=\"_blank\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:none;color:#2D3142;font-size:14px\" href=\"\">Unsubscribe</a></p></td>\n</tr>\n<tr>\n<td align=\"center\" style=\"padding:0;Margin:0;padding-top:20px\"><p style=\"Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:Imprima, Arial, sans-serif;line-height:21px;color:#2D3142;font-size:14px\"><a target=\"_blank\" href=\"\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:underline;color:#2D3142;font-size:14px\"></a>Copyright ¬© 2023&nbsp;Talo Media<a target=\"_blank\" href=\"\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:underline;color:#2D3142;font-size:14px\"></a></p></td>\n</tr>\n</table></td>\n</tr>\n</table></td>\n</tr>\n</table></td>\n</tr>\n</table></td>\n</tr>\n</table>\n</div>\n</body>\n</html>","options":{}},"id":"62911a6d-cdb0-4d9d-ae5c-6d967f5936a0","name":"Send Email","type":"n8n-nodes-base.emailSend","typeVersion":1,"position":[640,460],"credentials":{"smtp":{"id":"21","name":"SMTP HR@TaloMedia.Net"}}}],"connections":{"Webhook":{"main":[[{"node":"Send Email","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{},"versionId":"7bea5ced-6789-4513-abdb-4066657021fd","triggerCount":1,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-04-06T09:16:46.838Z","updatedAt":"2023-06-30T07:23:55.000Z","id":"53","name":"Send email pass Test -> Interview","active":false,"nodes":[{"parameters":{"httpMethod":"POST","path":"pass-test-interview","options":{}},"id":"669efed4-a7b7-42bf-9b4d-14990bc934b1","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[460,460],"webhookId":"bd76a670-4445-4a78-b8a0-2325ce3aff64"},{"parameters":{"fromEmail":"=HR's Talo Media <talohuynh@talomedia.net>","toEmail":"={{ $json[\"query\"][\"email\"] }}","ccEmail":"hr@talomedia.net","bccEmail":"=","subject":"=[Talo Media]Invitation to Interview for {{ $json[\"query\"][\"position\"] }} Position","html":"=<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\">\n<html xmlns=\"http://www.w3.org/1999/xhtml\" xmlns:o=\"urn:schemas-microsoft-com:office:office\" style=\"font-family:arial, 'helvetica neue', helvetica, sans-serif\">\n<head>\n<meta charset=\"UTF-8\">\n<meta content=\"width=device-width, initial-scale=1\" name=\"viewport\">\n<meta name=\"x-apple-disable-message-reformatting\">\n<meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\n<meta content=\"telephone=no\" name=\"format-detection\">\n<title>Pass CV - Test 1</title><!--[if (mso 16)]>\n<style type=\"text/css\">\na {text-decoration: none;}\n</style>\n<![endif]--><!--[if gte mso 9]><style>sup { font-size: 100% !important; }</style><![endif]--><!--[if gte mso 9]>\n<xml>\n<o:OfficeDocumentSettings>\n<o:AllowPNG></o:AllowPNG>\n<o:PixelsPerInch>96</o:PixelsPerInch>\n</o:OfficeDocumentSettings>\n</xml>\n<![endif]--><!--[if !mso]><!-- -->\n<link href=\"https://fonts.googleapis.com/css2?family=Imprima&display=swap\" rel=\"stylesheet\"><!--<![endif]-->\n<style type=\"text/css\">\n#outlook a {\npadding:0;\n}\n.es-button {\nmso-style-priority:100!important;\ntext-decoration:none!important;\n}\na[x-apple-data-detectors] {\ncolor:inherit!important;\ntext-decoration:none!important;\nfont-size:inherit!important;\nfont-family:inherit!important;\nfont-weight:inherit!important;\nline-height:inherit!important;\n}\n.es-desk-hidden {\ndisplay:none;\nfloat:left;\noverflow:hidden;\nwidth:0;\nmax-height:0;\nline-height:0;\nmso-hide:all;\n}\n.btn-link {\n    border: none;\n    outline: none;\n    background: none;\n    cursor: pointer;\n    color: #0000EE;\n    padding: 0;\n    text-decoration: underline;\n    font-family: inherit;\n    font-size: inherit;\n}\n@media only screen and (max-width:600px) {p, ul li, ol li, a { line-height:150%!important } h1, h2, h3, h1 a, h2 a, h3 a { line-height:120% } h1 { font-size:30px!important; text-align:left } h2 { font-size:24px!important; text-align:left } h3 { font-size:20px!important; text-align:left } .es-header-body h1 a, .es-content-body h1 a, .es-footer-body h1 a { font-size:30px!important; text-align:left } .es-header-body h2 a, .es-content-body h2 a, .es-footer-body h2 a { font-size:24px!important; text-align:left } .es-header-body h3 a, .es-content-body h3 a, .es-footer-body h3 a { font-size:20px!important; text-align:left } .es-menu td a { font-size:14px!important } .es-header-body p, .es-header-body ul li, .es-header-body ol li, .es-header-body a { font-size:14px!important } .es-content-body p, .es-content-body ul li, .es-content-body ol li, .es-content-body a { font-size:14px!important } .es-footer-body p, .es-footer-body ul li, .es-footer-body ol li, .es-footer-body a { font-size:14px!important } .es-infoblock p, .es-infoblock ul li, .es-infoblock ol li, .es-infoblock a { font-size:12px!important } *[class=\"gmail-fix\"] { display:none!important } .es-m-txt-c, .es-m-txt-c h1, .es-m-txt-c h2, .es-m-txt-c h3 { text-align:center!important } .es-m-txt-r, .es-m-txt-r h1, .es-m-txt-r h2, .es-m-txt-r h3 { text-align:right!important } .es-m-txt-l, .es-m-txt-l h1, .es-m-txt-l h2, .es-m-txt-l h3 { text-align:left!important } .es-m-txt-r img, .es-m-txt-c img, .es-m-txt-l img { display:inline!important } .es-button-border { display:block!important } a.es-button, button.es-button { font-size:18px!important; display:block!important; border-right-width:0px!important; border-left-width:0px!important; border-top-width:15px!important; border-bottom-width:15px!important } .es-adaptive table, .es-left, .es-right { width:100%!important } .es-content table, .es-header table, .es-footer table, .es-content, .es-footer, .es-header { width:100%!important; max-width:600px!important } .es-adapt-td { display:block!important; width:100%!important } .adapt-img { width:100%!important; height:auto!important } .es-m-p0 { padding:0px!important } .es-m-p0r { padding-right:0px!important } .es-m-p0l { padding-left:0px!important } .es-m-p0t { padding-top:0px!important } .es-m-p0b { padding-bottom:0!important } .es-m-p20b { padding-bottom:20px!important } .es-mobile-hidden, .es-hidden { display:none!important } tr.es-desk-hidden, td.es-desk-hidden, table.es-desk-hidden { width:auto!important; overflow:visible!important; float:none!important; max-height:inherit!important; line-height:inherit!important } tr.es-desk-hidden { display:table-row!important } table.es-desk-hidden { display:table!important } td.es-desk-menu-hidden { display:table-cell!important } .es-menu td { width:1%!important } table.es-table-not-adapt, .esd-block-html table { width:auto!important } table.es-social { display:inline-block!important } table.es-social td { display:inline-block!important } .es-desk-hidden { display:table-row!important; width:auto!important; overflow:visible!important; max-height:inherit!important } .h-auto { height:auto!important } }\n</style>\n</head>\n<body data-new-gr-c-s-loaded=\"14.1101.0\" style=\"width:100%;font-family:arial, 'helvetica neue', helvetica, sans-serif;-webkit-text-size-adjust:100%;-ms-text-size-adjust:100%;padding:0;Margin:0\">\n<div class=\"es-wrapper-color\" style=\"background-color:#FFFFFF\"><!--[if gte mso 9]>\n<v:background xmlns:v=\"urn:schemas-microsoft-com:vml\" fill=\"t\">\n<v:fill type=\"tile\" color=\"#ffffff\"></v:fill>\n</v:background>\n<![endif]-->\n<table class=\"es-wrapper\" width=\"100%\" cellspacing=\"0\" cellpadding=\"0\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;padding:0;Margin:0;width:100%;height:100%;background-repeat:repeat;background-position:center top;background-color:#FFFFFF\">\n<tr>\n<td valign=\"top\" style=\"padding:0;Margin:0\">\n<table cellpadding=\"0\" cellspacing=\"0\" class=\"es-content\" align=\"center\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;table-layout:fixed !important;width:100%\">\n<tr>\n<td align=\"center\" style=\"padding:0;Margin:0\">\n<table bgcolor=\"#efefef\" class=\"es-content-body\" align=\"center\" cellpadding=\"0\" cellspacing=\"0\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;background-color:#EFEFEF;border-radius:20px 20px 0 0;width:600px\">\n<tr>\n<td align=\"left\" style=\"padding:0;Margin:0;padding-top:40px;padding-left:40px;padding-right:40px\">\n<table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\">\n<tr>\n<td align=\"center\" valign=\"top\" style=\"padding:0;Margin:0;width:520px\">\n<table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" role=\"presentation\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\">\n<tr>\n<td align=\"center\" style=\"padding:0;Margin:0;font-size:0px\"><a target=\"_blank\" href=\"https://www.facebook.com/TaloMedia.Inc\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:underline;color:#2D3142;font-size:18px\"><img src=\"https://trello.com/1/cards/616fe1684cafe70babf9447c/attachments/641bd4cc956ddc145421c7bb/download/logo_cover_-_min.png\" alt style=\"display:block;border:0;outline:none;text-decoration:none;-ms-interpolation-mode:bicubic;border-radius:100px\" width=\"180\"></a></td>\n</tr>\n</table></td>\n</tr>\n</table></td>\n</tr>\n<tr>\n<td align=\"left\" style=\"padding:0;Margin:0;padding-top:20px;padding-left:40px;padding-right:40px\">\n<table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\">\n<tr>\n<td align=\"center\" valign=\"top\" style=\"padding:0;Margin:0;width:520px\">\n<table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" bgcolor=\"#fafafa\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:separate;border-spacing:0px;background-color:#fafafa;border-radius:10px\" role=\"presentation\">\n<tr>\n<td align=\"left\" style=\"padding:20px;Margin:0\"><h3 style=\"Margin:0;line-height:34px;mso-line-height-rule:exactly;font-family:Imprima, Arial, sans-serif;font-size:28px;font-style:normal;font-weight:bold;color:#2D3142\">Dear {{ $json[\"query\"][\"name\"] }},</h3><p style=\"Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:Imprima, Arial, sans-serif;line-height:27px;color:#2D3142;font-size:18px\"><br><br>I hope this message finds you well. I am pleased to inform you that you have successfully completed the entrance test for the <strong>{{ $json[\"query\"][\"position\"] }}</strong> position at <strong>Talo Media</strong>. Congratulations! Your performance on the test was impressive and we believe that you have the skills and abilities necessary to excel in this position.<br><br>As the next step in our recruitment process, we would like to invite you to participate in an interview with our team. The interview will provide us with an opportunity to learn more about your experience, qualifications, and potential fit within our organization.<br><br>We are excited to meet with you and would like to schedule the interview for <strong>{{ $json[\"query\"][\"timeInterview\"] }}</strong>, please confirm by button below. If not, we can arrange for an alternative time that is more convenient. Please let us know if this date and time work for you.<br><br>Once again, congratulations on this achievement and we look forward to meeting with you soon.<br><br>Best regards,<br><strong>Talo Media</strong></p></td>\n</tr>\n</table></td>\n</tr>\n</table></td>\n</tr>\n</table></td>\n</tr>\n</table>\n<table cellpadding=\"0\" cellspacing=\"0\" class=\"es-content\" align=\"center\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;table-layout:fixed !important;width:100%\">\n<tr>\n<td align=\"center\" style=\"padding:0;Margin:0\">\n<table bgcolor=\"#efefef\" class=\"es-content-body\" align=\"center\" cellpadding=\"0\" cellspacing=\"0\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;background-color:#EFEFEF;width:600px\">\n<tr>\n<td align=\"left\" style=\"Margin:0;padding-top:30px;padding-bottom:40px;padding-left:40px;padding-right:40px\">\n<table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\">\n<tr>\n<td align=\"center\" valign=\"top\" style=\"padding:0;Margin:0;width:520px\">\n<table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" role=\"presentation\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\">\n<tr>\n<td align=\"center\" style=\"padding:0;Margin:0\"><!--[if mso]><a href=\"\" target=\"_blank\" hidden>\n<v:roundrect xmlns:v=\"urn:schemas-microsoft-com:vml\" xmlns:w=\"urn:schemas-microsoft-com:office:word\" esdevVmlButton href=\"\"\nstyle=\"height:56px; v-text-anchor:middle; width:520px\" arcsize=\"50%\" stroke=\"f\" fillcolor=\"#7630f3\">\n<w:anchorlock></w:anchorlock>\n<center style='color:#ffffff; font-family:-apple-system, \"system-ui\", \"Segoe UI\", Roboto, Helvetica, Arial, sans-serif, \"Apple Color Emoji\", \"Segoe UI Emoji\", \"Segoe UI Symbol\"; font-size:22px; font-weight:700; line-height:22px; mso-text-raise:1px'>Take a Test</center>\n</v:roundrect></a>\n<![endif]--><!--[if !mso]><!-- -->\n   <form action=\"https://app.n8n.vn/webhook/confirm-interview?recordID={{ $json[\"query\"][\"recordID\"] }}\" method=\"post\">\n    <button type=\"submit\" style=\"mso-style-priority:100 !important;text-decoration:none;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;color:#FFFFFF;font-size:22px;padding:15px 20px 15px 20px;display:block;background:#7630f3;border-radius:30px;font-family:-apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol';font-weight:bold;font-style:normal;line-height:26px;width:auto;text-align:center;mso-hide:all;padding-left:50px;padding-right:50px;border-color:#7630f3\">Confirm Interview</button>\n</form>\n<!--<![endif]--></td>\n</tr>\n  </table></td>\n</tr>\n</table></td>\n</tr>\n</table></td>\n</tr>\n</table>\n<table cellpadding=\"0\" cellspacing=\"0\" class=\"es-content\" align=\"center\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;table-layout:fixed !important;width:100%\">\n<tr>\n<td align=\"center\" style=\"padding:0;Margin:0\">\n<table bgcolor=\"#efefef\" class=\"es-content-body\" align=\"center\" cellpadding=\"0\" cellspacing=\"0\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;background-color:#EFEFEF;border-radius:0 0 20px 20px;width:600px\">\n<tr>\n<td class=\"esdev-adapt-off\" align=\"left\" style=\"Margin:0;padding-top:20px;padding-bottom:20px;padding-left:40px;padding-right:40px\">\n<table cellpadding=\"0\" cellspacing=\"0\" class=\"esdev-mso-table\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;width:520px\">\n<tr>\n<td class=\"esdev-mso-td\" valign=\"top\" style=\"padding:0;Margin:0\">\n<table cellpadding=\"0\" cellspacing=\"0\" align=\"left\" class=\"es-left\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;float:left\">\n<tr>\n<td align=\"center\" valign=\"top\" style=\"padding:0;Margin:0;width:47px\">\n<table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" role=\"presentation\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\">\n<tr>\n<td align=\"center\" class=\"es-m-txt-l\" style=\"padding:0;Margin:0;font-size:0px\"><a target=\"_blank\" href=\"https://viewstripo.email\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:underline;color:#2D3142;font-size:18px\"><img src=\"https://dnsfnr.stripocdn.email/content/guids/CABINET_ee77850a5a9f3068d9355050e69c76d26d58c3ea2927fa145f0d7a894e624758/images/group_4076325.png\" alt=\"Demo\" style=\"display:block;border:0;outline:none;text-decoration:none;-ms-interpolation-mode:bicubic\" width=\"37\" title=\"Demo\"></a></td>\n</tr>\n</table></td>\n</tr>\n</table></td>\n<td style=\"padding:0;Margin:0;width:20px\"></td>\n<td class=\"esdev-mso-td\" valign=\"top\" style=\"padding:0;Margin:0\">\n<table cellpadding=\"0\" cellspacing=\"0\" class=\"es-right\" align=\"right\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;float:right\">\n<tr>\n<td align=\"center\" valign=\"top\" style=\"padding:0;Margin:0;width:453px\">\n<table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" role=\"presentation\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\">\n<tr>\n<td align=\"left\" style=\"padding:0;Margin:0\"><p style=\"Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:Imprima, Arial, sans-serif;line-height:32px;color:#2D3142;font-size:16px\">If you have any questions, contact us via any channel below!</p></td>\n</tr>\n</table></td>\n</tr>\n</table></td>\n</tr>\n</table></td>\n</tr>\n</table></td>\n</tr>\n</table>\n<table cellpadding=\"0\" cellspacing=\"0\" class=\"es-footer\" align=\"center\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;table-layout:fixed !important;width:100%;background-color:transparent;background-repeat:repeat;background-position:center top\">\n<tr>\n<td align=\"center\" style=\"padding:0;Margin:0\">\n<table bgcolor=\"#bcb8b1\" class=\"es-footer-body\" align=\"center\" cellpadding=\"0\" cellspacing=\"0\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;background-color:#FFFFFF;width:600px\">\n<tr>\n<td align=\"left\" style=\"Margin:0;padding-left:20px;padding-right:20px;padding-bottom:30px;padding-top:40px\">\n<table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\">\n<tr>\n<td align=\"left\" style=\"padding:0;Margin:0;width:560px\">\n<table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" role=\"presentation\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\">\n<tr>\n<td align=\"center\" class=\"es-m-txt-c\" style=\"padding:0;Margin:0;padding-top:10px;padding-bottom:20px;font-size:0\">\n<table cellpadding=\"0\" cellspacing=\"0\" class=\"es-table-not-adapt es-social\" role=\"presentation\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\">\n<tr>\n<td align=\"center\" valign=\"top\" style=\"padding:0;Margin:0\"><a target=\"_blank\" href=\"https://www.facebook.com/TaloMedia.Inc\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:underline;color:#2D3142;font-size:14px\"><img src=\"https://dnsfnr.stripocdn.email/content/assets/img/social-icons/logo-black/facebook-logo-black.png\" alt=\"Fb\" title=\"Facebook\" height=\"24\" style=\"display:block;border:0;outline:none;text-decoration:none;-ms-interpolation-mode:bicubic\"></a></td>\n<td align=\"center\" valign=\"top\" style=\"padding:0;Margin:0\"><a target=\"_blank\" href=\"mailto:hr@talomedia.net?subject=Get%20Support%20from%20Test%20Invited\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:underline;color:#2D3142;font-size:14px\"><img src=\"https://dnsfnr.stripocdn.email/content/assets/img/other-icons/logo-black/mail-logo-black.png\" alt=\"Email\" title=\"Email\" height=\"24\" style=\"display:block;border:0;outline:none;text-decoration:none;-ms-interpolation-mode:bicubic\"></a></td>\n<td align=\"center\" valign=\"top\" style=\"padding:0;Margin:0\"><a target=\"_blank\" href=\"https://goo.gl/maps/vsN1kZ1EGutGxb3t5\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:underline;color:#2D3142;font-size:14px\"><img src=\"https://dnsfnr.stripocdn.email/content/assets/img/other-icons/logo-black/location-logo-black.png\" alt=\"Map Marker\" title=\"Map Marker\" height=\"24\" style=\"display:block;border:0;outline:none;text-decoration:none;-ms-interpolation-mode:bicubic\"></a></td>\n<td align=\"center\" valign=\"top\" style=\"padding:0;Margin:0\"><a target=\"_blank\" href=\"tel:0905033554\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:underline;color:#2D3142;font-size:14px\"><img src=\"https://dnsfnr.stripocdn.email/content/assets/img/other-icons/logo-black/phone-logo-black.png\" alt=\"Phone\" title=\"Phone\" height=\"24\" style=\"display:block;border:0;outline:none;text-decoration:none;-ms-interpolation-mode:bicubic\"></a></td>\n<td align=\"center\" valign=\"top\" style=\"padding:0;Margin:0\"><a target=\"_blank\" href=\"https://www.google.com/maps/contrib/114365313953020145193/photos/@16.0561659,108.2188394,17z/data=!4m3!8m2!3m1!1e1\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:underline;color:#2D3142;font-size:14px\"><img src=\"https://dnsfnr.stripocdn.email/content/assets/img/other-icons/logo-black/googlebusiness-logo-black.png\" alt=\"Google Business\" title=\"Google Business\" height=\"24\" style=\"display:block;border:0;outline:none;text-decoration:none;-ms-interpolation-mode:bicubic\"></a></td>\n</tr>\n</table></td>\n</tr>\n<tr>\n<td align=\"center\" style=\"padding:0;Margin:0\"><p style=\"Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:Imprima, Arial, sans-serif;line-height:20px;color:#2D3142;font-size:13px\"><a target=\"_blank\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:none;color:#2D3142;font-size:14px\" href=\"\"></a><a target=\"_blank\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:none;color:#2D3142;font-size:14px\" href=\"\">Privacy Policy</a><a target=\"_blank\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:none;color:#2D3142;font-size:13px\" href=\"\"></a> ‚Ä¢ <a target=\"_blank\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:none;color:#2D3142;font-size:14px\" href=\"\">Unsubscribe</a></p></td>\n</tr>\n<tr>\n<td align=\"center\" style=\"padding:0;Margin:0;padding-top:20px\"><p style=\"Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:Imprima, Arial, sans-serif;line-height:21px;color:#2D3142;font-size:14px\"><a target=\"_blank\" href=\"\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:underline;color:#2D3142;font-size:14px\"></a>Copyright ¬© 2023&nbsp;Talo Media<a target=\"_blank\" href=\"\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:underline;color:#2D3142;font-size:14px\"></a></p></td>\n</tr>\n</table></td>\n</tr>\n</table></td>\n</tr>\n</table></td>\n</tr>\n</table></td>\n</tr>\n</table>\n</div>\n</body>\n</html>","options":{}},"id":"657e0555-d4fa-4159-8e02-3620780abf5f","name":"Send Email","type":"n8n-nodes-base.emailSend","typeVersion":1,"position":[640,460],"credentials":{"smtp":{"id":"21","name":"SMTP HR@TaloMedia.Net"}}}],"connections":{"Webhook":{"main":[[{"node":"Send Email","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{},"versionId":"0ae48f47-dab9-4d44-8e33-d0f64ad94c86","triggerCount":1,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-04-06T09:22:47.753Z","updatedAt":"2023-06-30T07:23:56.000Z","id":"54","name":"Confirm Interview","active":false,"nodes":[{"parameters":{"httpMethod":"POST","path":"confirm-interview","responseCode":"200","options":{"responseData":"Thank you for your response! See you in the interview!"}},"id":"184417d5-8dc7-4afb-8c29-a51dbc7b3c47","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[260,460],"webhookId":"98edff47-c9f7-4d9e-aa91-47eab79adeeb"},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/auth/v3/app_access_token/internal","sendBody":true,"specifyBody":"json","jsonBody":"={\n  \"app_id\": \"cli_a31d441721f8500a\",\n  \"app_secret\": \"pgsa9rESeuH6ltJlMpR8EfbemxaJOnCu\"\n}","options":{}},"id":"fc36eca1-f4f4-4678-a3b2-1b576b2e6ea9","name":"Token","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[480,460]},{"parameters":{"method":"PUT","url":"=https://open.larksuite.com/open-apis/bitable/v1/apps/Jpeab1HTAa6APNsNThVu33z6s6d/tables/tbl4ARTmaxIDqC6R/records/{{ $node[\"Webhook\"].json[\"query\"][\"recordID\"] }}","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $json[\"app_access_token\"] }}"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\n  \"fields\": {\n  \"Interview Confirm\": \"OK\"\n  }\n}","options":{}},"id":"18bdd668-ba62-4074-9502-4fd04c056496","name":"Send Confirm","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[680,460]}],"connections":{"Token":{"main":[[{"node":"Send Confirm","type":"main","index":0}]]},"Webhook":{"main":[[{"node":"Token","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{},"versionId":"aa1abf94-0c4c-44b2-a73e-22628fb0119d","triggerCount":1,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-04-06T10:42:07.199Z","updatedAt":"2023-07-26T14:54:51.000Z","id":"55","name":"Trigger Apply Email","active":false,"nodes":[{"parameters":{"mode":"runOnceForEachItem","jsCode":"// Add a new field called 'myNewField' to the\n// JSON of the item\n$input.item.json.email = $('Email Trigger').item.json.from.split(\"<\")[1];\n$input.item.json.email = $input.item.json.email.replace(\">\",\"\")\n\n$input.item.json.isApplyEmail = $('Email Trigger').item.json.subject.toLowerCase().includes(\"apply\");\n\nreturn $input.item;"},"id":"803bd1bb-7634-4184-89d0-66862307049f","name":"Code","type":"n8n-nodes-base.code","typeVersion":1,"position":[-40,540]},{"parameters":{"conditions":{"boolean":[{"value1":"={{ $json[\"isApplyEmail\"] }}","value2":"={{ true }}"}]}},"id":"6f3968bc-8aeb-4177-8337-bb6f6048d22a","name":"IF","type":"n8n-nodes-base.if","typeVersion":1,"position":[160,540]},{"parameters":{"fromEmail":"hr@talomedia.net","toEmail":"=hi.talomart@gmail.com","subject":"Request for Information: Next Steps in Your Job Application","text":"sdfaf","html":"=","options":{}},"id":"dd9dfe15-678f-4ce0-98a6-7d27e2a03ccc","name":"Send Email input Form","type":"n8n-nodes-base.emailSend","typeVersion":1,"position":[440,520],"credentials":{"smtp":{"id":"21","name":"SMTP HR@TaloMedia.Net"}}},{"parameters":{"postProcessAction":"nothing","downloadAttachments":true,"options":{}},"id":"db1e3783-3582-4fd7-a2c1-a370f3134a1a","name":"Email Trigger (IMAP)","type":"n8n-nodes-base.emailReadImap","typeVersion":2,"position":[-280,540],"credentials":{"imap":{"id":"22","name":"IMAP HR@TaloMedia.Net"}}}],"connections":{"Code":{"main":[[{"node":"IF","type":"main","index":0}]]},"Email Trigger (IMAP)":{"main":[[{"node":"Code","type":"main","index":0}]]},"IF":{"main":[[{"node":"Send Email input Form","type":"main","index":0}]]}},"settings":{},"staticData":{"node:Email Trigger (IMAP)":{"lastMessageUid":209}},"pinData":{},"versionId":"76ebfbd8-8232-4c5e-ac43-2f91ea720beb","triggerCount":1,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-04-06T14:31:20.285Z","updatedAt":"2023-06-30T07:23:58.000Z","id":"56","name":"Send email pass interview","active":false,"nodes":[{"parameters":{"httpMethod":"POST","path":"pass-interview","options":{}},"id":"e607ac1f-28ca-4432-8c9d-0a986bf2e4da","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[460,460],"webhookId":"48ccf998-0039-4f7f-911a-e3f0d7f34f06"},{"parameters":{"fromEmail":"HR's Talo Media<hr@talomedia.net>","toEmail":"={{ $json[\"query\"][\"email\"] }}","ccEmail":"hr@talomedia.net","subject":"=[Talo Media]Chuc mung ban da trung tuyen vao vi tri [{{ $json[\"query\"][\"position\"] }}] tai Talo Media","html":"=<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\">\n<html xmlns=\"http://www.w3.org/1999/xhtml\" xmlns:o=\"urn:schemas-microsoft-com:office:office\" style=\"font-family:arial, 'helvetica neue', helvetica, sans-serif\">\n<head>\n<meta charset=\"UTF-8\">\n<meta content=\"width=device-width, initial-scale=1\" name=\"viewport\">\n<meta name=\"x-apple-disable-message-reformatting\">\n<meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\n<meta content=\"telephone=no\" name=\"format-detection\">\n<title>Pass CV - Test 1</title><!--[if (mso 16)]>\n<style type=\"text/css\">\na {text-decoration: none;}\n</style>\n<![endif]--><!--[if gte mso 9]><style>sup { font-size: 100% !important; }</style><![endif]--><!--[if gte mso 9]>\n<xml>\n<o:OfficeDocumentSettings>\n<o:AllowPNG></o:AllowPNG>\n<o:PixelsPerInch>96</o:PixelsPerInch>\n</o:OfficeDocumentSettings>\n</xml>\n<![endif]--><!--[if !mso]><!-- -->\n<link href=\"https://fonts.googleapis.com/css2?family=Imprima&display=swap\" rel=\"stylesheet\"><!--<![endif]-->\n<style type=\"text/css\">\n#outlook a {\npadding:0;\n}\n.es-button {\nmso-style-priority:100!important;\ntext-decoration:none!important;\n}\na[x-apple-data-detectors] {\ncolor:inherit!important;\ntext-decoration:none!important;\nfont-size:inherit!important;\nfont-family:inherit!important;\nfont-weight:inherit!important;\nline-height:inherit!important;\n}\n.es-desk-hidden {\ndisplay:none;\nfloat:left;\noverflow:hidden;\nwidth:0;\nmax-height:0;\nline-height:0;\nmso-hide:all;\n}\n@media only screen and (max-width:600px) {p, ul li, ol li, a { line-height:150%!important } h1, h2, h3, h1 a, h2 a, h3 a { line-height:120% } h1 { font-size:30px!important; text-align:left } h2 { font-size:24px!important; text-align:left } h3 { font-size:20px!important; text-align:left } .es-header-body h1 a, .es-content-body h1 a, .es-footer-body h1 a { font-size:30px!important; text-align:left } .es-header-body h2 a, .es-content-body h2 a, .es-footer-body h2 a { font-size:24px!important; text-align:left } .es-header-body h3 a, .es-content-body h3 a, .es-footer-body h3 a { font-size:20px!important; text-align:left } .es-menu td a { font-size:14px!important } .es-header-body p, .es-header-body ul li, .es-header-body ol li, .es-header-body a { font-size:14px!important } .es-content-body p, .es-content-body ul li, .es-content-body ol li, .es-content-body a { font-size:14px!important } .es-footer-body p, .es-footer-body ul li, .es-footer-body ol li, .es-footer-body a { font-size:14px!important } .es-infoblock p, .es-infoblock ul li, .es-infoblock ol li, .es-infoblock a { font-size:12px!important } *[class=\"gmail-fix\"] { display:none!important } .es-m-txt-c, .es-m-txt-c h1, .es-m-txt-c h2, .es-m-txt-c h3 { text-align:center!important } .es-m-txt-r, .es-m-txt-r h1, .es-m-txt-r h2, .es-m-txt-r h3 { text-align:right!important } .es-m-txt-l, .es-m-txt-l h1, .es-m-txt-l h2, .es-m-txt-l h3 { text-align:left!important } .es-m-txt-r img, .es-m-txt-c img, .es-m-txt-l img { display:inline!important } .es-button-border { display:block!important } a.es-button, button.es-button { font-size:18px!important; display:block!important; border-right-width:0px!important; border-left-width:0px!important; border-top-width:15px!important; border-bottom-width:15px!important } .es-adaptive table, .es-left, .es-right { width:100%!important } .es-content table, .es-header table, .es-footer table, .es-content, .es-footer, .es-header { width:100%!important; max-width:600px!important } .es-adapt-td { display:block!important; width:100%!important } .adapt-img { width:100%!important; height:auto!important } .es-m-p0 { padding:0px!important } .es-m-p0r { padding-right:0px!important } .es-m-p0l { padding-left:0px!important } .es-m-p0t { padding-top:0px!important } .es-m-p0b { padding-bottom:0!important } .es-m-p20b { padding-bottom:20px!important } .es-mobile-hidden, .es-hidden { display:none!important } tr.es-desk-hidden, td.es-desk-hidden, table.es-desk-hidden { width:auto!important; overflow:visible!important; float:none!important; max-height:inherit!important; line-height:inherit!important } tr.es-desk-hidden { display:table-row!important } table.es-desk-hidden { display:table!important } td.es-desk-menu-hidden { display:table-cell!important } .es-menu td { width:1%!important } table.es-table-not-adapt, .esd-block-html table { width:auto!important } table.es-social { display:inline-block!important } table.es-social td { display:inline-block!important } .es-desk-hidden { display:table-row!important; width:auto!important; overflow:visible!important; max-height:inherit!important } .h-auto { height:auto!important } }\n</style>\n</head>\n<body data-new-gr-c-s-loaded=\"14.1101.0\" style=\"width:100%;font-family:arial, 'helvetica neue', helvetica, sans-serif;-webkit-text-size-adjust:100%;-ms-text-size-adjust:100%;padding:0;Margin:0\">\n<div class=\"es-wrapper-color\" style=\"background-color:#FFFFFF\"><!--[if gte mso 9]>\n<v:background xmlns:v=\"urn:schemas-microsoft-com:vml\" fill=\"t\">\n<v:fill type=\"tile\" color=\"#ffffff\"></v:fill>\n</v:background>\n<![endif]-->\n<table class=\"es-wrapper\" width=\"100%\" cellspacing=\"0\" cellpadding=\"0\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;padding:0;Margin:0;width:100%;height:100%;background-repeat:repeat;background-position:center top;background-color:#FFFFFF\">\n<tr>\n<td valign=\"top\" style=\"padding:0;Margin:0\">\n<table cellpadding=\"0\" cellspacing=\"0\" class=\"es-content\" align=\"center\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;table-layout:fixed !important;width:100%\">\n<tr>\n<td align=\"center\" style=\"padding:0;Margin:0\">\n<table bgcolor=\"#efefef\" class=\"es-content-body\" align=\"center\" cellpadding=\"0\" cellspacing=\"0\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;background-color:#EFEFEF;border-radius:20px 20px 0 0;width:600px\">\n<tr>\n<td align=\"left\" style=\"padding:0;Margin:0;padding-top:40px;padding-left:40px;padding-right:40px\">\n<table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\">\n<tr>\n<td align=\"center\" valign=\"top\" style=\"padding:0;Margin:0;width:520px\">\n<table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" role=\"presentation\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\">\n<tr>\n<td align=\"center\" style=\"padding:0;Margin:0;font-size:0px\"><a target=\"_blank\" href=\"https://www.facebook.com/TaloMedia.Inc\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:underline;color:#2D3142;font-size:18px\"><img src=\"https://trello.com/1/cards/616fe1684cafe70babf9447c/attachments/641bd4cc956ddc145421c7bb/download/logo_cover_-_min.png\" alt style=\"display:block;border:0;outline:none;text-decoration:none;-ms-interpolation-mode:bicubic;border-radius:100px\" width=\"180\"></a></td>\n</tr>\n</table></td>\n</tr>\n</table></td>\n</tr>\n<tr>\n<td align=\"left\" style=\"padding:0;Margin:0;padding-top:20px;padding-left:40px;padding-right:40px\">\n<table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\">\n<tr>\n<td align=\"center\" valign=\"top\" style=\"padding:0;Margin:0;width:520px\">\n<table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" bgcolor=\"#fafafa\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:separate;border-spacing:0px;background-color:#fafafa;border-radius:10px\" role=\"presentation\">\n<tr>\n<td align=\"left\" style=\"padding:20px;Margin:0\"><h3 style=\"Margin:0;line-height:34px;mso-line-height-rule:exactly;font-family:Imprima, Arial, sans-serif;font-size:28px;font-style:normal;font-weight:bold;color:#2D3142\">Dear {{ $json[\"query\"][\"name\"] }},</h3><p style=\"Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:Imprima, Arial, sans-serif;line-height:27px;color:#2D3142;font-size:18px\"><br><br>Congratulations on your successful interview for the Designer position! I am thrilled to offer my best wishes for your new role. Your hard work and achievements have paid off, and I am confident that you will excel as a {{ $json[\"query\"][\"position\"] }}.<br><br>As you prepare to start your new adventure, please know that you have my support and encouragement. Your creativity and skills will be a valuable asset to our team, and we are excited to have you on board.<br><br>If you have any questions or concerns, please feel free to reach out to me. Otherwise, I wish you all the best in your new role!<br><br>Best regards,<br><strong>Talo Media</strong></p></td>\n</tr>\n</table></td>\n</tr>\n</table></td>\n</tr>\n</table></td>\n</tr>\n</table>\n<table cellpadding=\"0\" cellspacing=\"0\" class=\"es-content\" align=\"center\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;table-layout:fixed !important;width:100%\">\n<tr>\n<td align=\"center\" style=\"padding:0;Margin:0\">\n<table bgcolor=\"#efefef\" class=\"es-content-body\" align=\"center\" cellpadding=\"0\" cellspacing=\"0\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;background-color:#EFEFEF;width:600px\">\n<tr>\n\n</tr>\n<tr>\n<td align=\"left\" style=\"padding:0;Margin:0;padding-left:40px;padding-right:40px\">\n<table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\">\n<tr>\n<td align=\"center\" valign=\"top\" style=\"padding:0;Margin:0;width:520px\">\n<table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" role=\"presentation\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\">\n<tr>\n<td align=\"center\" style=\"padding:20px;Margin:0;font-size:0px\">\n<table border=\"0\" width=\"100%\" height=\"100%\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\">\n<tr>\n<td style=\"padding:0;Margin:0;border-bottom:1px dashed #cccccc;background:none;height:1px;width:100%;margin:0px\"></td>\n</tr>\n</table></td>\n</tr>\n</table></td>\n</tr>\n</table></td>\n</tr>\n</table></td>\n</tr>\n</table>\n<table cellpadding=\"0\" cellspacing=\"0\" class=\"es-content\" align=\"center\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;table-layout:fixed !important;width:100%\">\n<tr>\n<td align=\"center\" style=\"padding:0;Margin:0\">\n<table bgcolor=\"#efefef\" class=\"es-content-body\" align=\"center\" cellpadding=\"0\" cellspacing=\"0\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;background-color:#EFEFEF;border-radius:0 0 20px 20px;width:600px\">\n<tr>\n<td class=\"esdev-adapt-off\" align=\"left\" style=\"Margin:0;padding-top:20px;padding-bottom:20px;padding-left:40px;padding-right:40px\">\n<table cellpadding=\"0\" cellspacing=\"0\" class=\"esdev-mso-table\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;width:520px\">\n<tr>\n<td class=\"esdev-mso-td\" valign=\"top\" style=\"padding:0;Margin:0\">\n<table cellpadding=\"0\" cellspacing=\"0\" align=\"left\" class=\"es-left\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;float:left\">\n<tr>\n<td align=\"center\" valign=\"top\" style=\"padding:0;Margin:0;width:47px\">\n<table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" role=\"presentation\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\">\n<tr>\n<td align=\"center\" class=\"es-m-txt-l\" style=\"padding:0;Margin:0;font-size:0px\"><a target=\"_blank\" href=\"https://viewstripo.email\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:underline;color:#2D3142;font-size:18px\"><img src=\"https://dnsfnr.stripocdn.email/content/guids/CABINET_ee77850a5a9f3068d9355050e69c76d26d58c3ea2927fa145f0d7a894e624758/images/group_4076325.png\" alt=\"Demo\" style=\"display:block;border:0;outline:none;text-decoration:none;-ms-interpolation-mode:bicubic\" width=\"37\" title=\"Demo\"></a></td>\n</tr>\n</table></td>\n</tr>\n</table></td>\n<td style=\"padding:0;Margin:0;width:20px\"></td>\n<td class=\"esdev-mso-td\" valign=\"top\" style=\"padding:0;Margin:0\">\n<table cellpadding=\"0\" cellspacing=\"0\" class=\"es-right\" align=\"right\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;float:right\">\n<tr>\n<td align=\"center\" valign=\"top\" style=\"padding:0;Margin:0;width:453px\">\n<table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" role=\"presentation\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\">\n<tr>\n<td align=\"left\" style=\"padding:0;Margin:0\"><p style=\"Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:Imprima, Arial, sans-serif;line-height:32px;color:#2D3142;font-size:16px\">If you have any questions, contact us via any channel below!</p></td>\n</tr>\n</table></td>\n</tr>\n</table></td>\n</tr>\n</table></td>\n</tr>\n</table></td>\n</tr>\n</table>\n<table cellpadding=\"0\" cellspacing=\"0\" class=\"es-footer\" align=\"center\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;table-layout:fixed !important;width:100%;background-color:transparent;background-repeat:repeat;background-position:center top\">\n<tr>\n<td align=\"center\" style=\"padding:0;Margin:0\">\n<table bgcolor=\"#bcb8b1\" class=\"es-footer-body\" align=\"center\" cellpadding=\"0\" cellspacing=\"0\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;background-color:#FFFFFF;width:600px\">\n<tr>\n<td align=\"left\" style=\"Margin:0;padding-left:20px;padding-right:20px;padding-bottom:30px;padding-top:40px\">\n<table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\">\n<tr>\n<td align=\"left\" style=\"padding:0;Margin:0;width:560px\">\n<table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" role=\"presentation\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\">\n<tr>\n<td align=\"center\" class=\"es-m-txt-c\" style=\"padding:0;Margin:0;padding-top:10px;padding-bottom:20px;font-size:0\">\n<table cellpadding=\"0\" cellspacing=\"0\" class=\"es-table-not-adapt es-social\" role=\"presentation\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\">\n<tr>\n<td align=\"center\" valign=\"top\" style=\"padding:0;Margin:0\"><a target=\"_blank\" href=\"https://www.facebook.com/TaloMedia.Inc\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:underline;color:#2D3142;font-size:14px\"><img src=\"https://dnsfnr.stripocdn.email/content/assets/img/social-icons/logo-black/facebook-logo-black.png\" alt=\"Fb\" title=\"Facebook\" height=\"24\" style=\"display:block;border:0;outline:none;text-decoration:none;-ms-interpolation-mode:bicubic\"></a></td>\n<td align=\"center\" valign=\"top\" style=\"padding:0;Margin:0\"><a target=\"_blank\" href=\"mailto:hr@talomedia.net?subject=Get%20Support%20from%20Test%20Invited\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:underline;color:#2D3142;font-size:14px\"><img src=\"https://dnsfnr.stripocdn.email/content/assets/img/other-icons/logo-black/mail-logo-black.png\" alt=\"Email\" title=\"Email\" height=\"24\" style=\"display:block;border:0;outline:none;text-decoration:none;-ms-interpolation-mode:bicubic\"></a></td>\n<td align=\"center\" valign=\"top\" style=\"padding:0;Margin:0\"><a target=\"_blank\" href=\"https://goo.gl/maps/vsN1kZ1EGutGxb3t5\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:underline;color:#2D3142;font-size:14px\"><img src=\"https://dnsfnr.stripocdn.email/content/assets/img/other-icons/logo-black/location-logo-black.png\" alt=\"Map Marker\" title=\"Map Marker\" height=\"24\" style=\"display:block;border:0;outline:none;text-decoration:none;-ms-interpolation-mode:bicubic\"></a></td>\n<td align=\"center\" valign=\"top\" style=\"padding:0;Margin:0\"><a target=\"_blank\" href=\"tel:0905033554\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:underline;color:#2D3142;font-size:14px\"><img src=\"https://dnsfnr.stripocdn.email/content/assets/img/other-icons/logo-black/phone-logo-black.png\" alt=\"Phone\" title=\"Phone\" height=\"24\" style=\"display:block;border:0;outline:none;text-decoration:none;-ms-interpolation-mode:bicubic\"></a></td>\n<td align=\"center\" valign=\"top\" style=\"padding:0;Margin:0\"><a target=\"_blank\" href=\"https://www.google.com/maps/contrib/114365313953020145193/photos/@16.0561659,108.2188394,17z/data=!4m3!8m2!3m1!1e1\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:underline;color:#2D3142;font-size:14px\"><img src=\"https://dnsfnr.stripocdn.email/content/assets/img/other-icons/logo-black/googlebusiness-logo-black.png\" alt=\"Google Business\" title=\"Google Business\" height=\"24\" style=\"display:block;border:0;outline:none;text-decoration:none;-ms-interpolation-mode:bicubic\"></a></td>\n</tr>\n</table></td>\n</tr>\n<tr>\n<td align=\"center\" style=\"padding:0;Margin:0\"><p style=\"Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:Imprima, Arial, sans-serif;line-height:20px;color:#2D3142;font-size:13px\"><a target=\"_blank\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:none;color:#2D3142;font-size:14px\" href=\"\"></a><a target=\"_blank\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:none;color:#2D3142;font-size:14px\" href=\"\">Privacy Policy</a><a target=\"_blank\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:none;color:#2D3142;font-size:13px\" href=\"\"></a> ‚Ä¢ <a target=\"_blank\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:none;color:#2D3142;font-size:14px\" href=\"\">Unsubscribe</a></p></td>\n</tr>\n<tr>\n<td align=\"center\" style=\"padding:0;Margin:0;padding-top:20px\"><p style=\"Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:Imprima, Arial, sans-serif;line-height:21px;color:#2D3142;font-size:14px\"><a target=\"_blank\" href=\"\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:underline;color:#2D3142;font-size:14px\"></a>Copyright ¬© 2023&nbsp;Talo Media<a target=\"_blank\" href=\"\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:underline;color:#2D3142;font-size:14px\"></a></p></td>\n</tr>\n</table></td>\n</tr>\n</table></td>\n</tr>\n</table></td>\n</tr>\n</table></td>\n</tr>\n</table>\n</div>\n</body>\n</html>","options":{}},"id":"dcfe627c-9128-4e5a-8112-f7724df98498","name":"Send Email","type":"n8n-nodes-base.emailSend","typeVersion":1,"position":[640,460],"credentials":{"smtp":{"id":"21","name":"SMTP HR@TaloMedia.Net"}}}],"connections":{"Webhook":{"main":[[{"node":"Send Email","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{},"versionId":"c1ef47f6-8fbe-4ddb-80fb-c760e9db5c22","triggerCount":1,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-04-07T01:54:00.658Z","updatedAt":"2023-04-07T01:56:04.000Z","id":"58","name":"[Report]","active":false,"nodes":[],"connections":{},"settings":{},"staticData":null,"pinData":{},"versionId":"7e7c6108-1790-4fb8-9411-7776687f5064","triggerCount":0,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-04-07T09:54:08.366Z","updatedAt":"2023-04-24T04:00:10.000Z","id":"59","name":"Flow 7.4","active":true,"nodes":[{"parameters":{"httpMethod":"POST","path":"demo24","options":{}},"id":"e2afc959-52fc-47a6-b16b-b9cbe310663c","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[580,300],"webhookId":"d09f50e3-af56-44e5-b86a-f75302bde907"},{"parameters":{"fromEmail":"=giangvandayne@gmail.com","toEmail":"={{$json[\"query\"][\"email\"]}}","subject":"welcome b·∫°n t·ªõi 2C HR n√®","text":"Hello anh em ","options":{}},"id":"0f67205f-7fbe-4f7a-9423-80ec0144d074","name":"Send Email","type":"n8n-nodes-base.emailSend","typeVersion":2,"position":[800,300],"credentials":{"smtp":{"id":"25","name":"SMTP account 3"}}}],"connections":{"Webhook":{"main":[[{"node":"Send Email","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{},"versionId":"46c90301-51fe-4934-ba7b-2f6070e6335b","triggerCount":1,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-04-07T10:41:10.346Z","updatedAt":"2023-04-07T10:42:00.000Z","id":"60","name":"OTB update tracking","active":true,"nodes":[{"parameters":{"httpMethod":"POST","path":"talomedia-otb","options":{}},"id":"bc301484-55b5-42cd-a088-fd29b0e12512","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[460,460],"webhookId":"81464ef8-d328-44d5-b130-572b3522bdd7"},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/bot/v2/hook/6d961042-59b3-4507-a0aa-200215db070c","sendBody":true,"specifyBody":"json","jsonBody":"={\n  \"msg_type\": \"interactive\",\n  \"card\": {\n    \"config\": {\n      \"wide_screen_mode\": true,\n      \"enable_forward\": true\n    },\n    \"elements\": [\n      {\n        \"tag\": \"div\",\n        \"fields\": [\n          {\n            \"is_short\": true,\n            \"text\": {\n              \"tag\": \"lark_md\",\n              \"content\": \"**üè∑ OTB ID:**\\n {{ $json[\"body\"][\"selfId\"] }}\"\n            }\n          },\n          {\n            \"is_short\": true,\n            \"text\": {\n              \"tag\": \"lark_md\",\n              \"content\": \"**üë§ Etsy ID:**\\n {{ $json[\"body\"][\"refId\"] }}\"\n            }\n          },\n          {\n            \"is_short\": true,\n            \"text\": {\n              \"tag\": \"lark_md\",\n              \"content\": \"**üõí Carrier:**\\n {{ $json[\"body\"][\"trackingCodes\"][0][\"trackingCarrierCode\"] }}\"\n            }\n          },\n          {\n            \"is_short\": true,\n            \"text\": {\n              \"tag\": \"lark_md\",\n              \"content\": \"**üí∞ Tracking number:**\\n {{ $json[\"body\"][\"trackingCodes\"][0][\"trackingCode\"] }}\"\n            }\n          }\n        ]\n      }\n    ],\n    \"header\": {\n      \"template\": \"green\",\n      \"title\": {\n        \"content\": \"üéâ Tracking is available üéâ\",\n        \"tag\": \"plain_text\"\n      }\n    }\n  }\n} ","options":{}},"id":"d8f5a396-fa76-4e91-9734-a34fb48b6530","name":"HTTP Request","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[680,460]}],"connections":{"Webhook":{"main":[[{"node":"HTTP Request","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{"Webhook":[{"json":{"headers":{"x-real-ip":"51.81.185.144","x-forwarded-for":"51.81.185.144","host":"py748pun4bepze6lrtl7y6wc.hooks.n8n.cloud","x-forwarded-proto":"https","x-nginx-proxy":"true","connection":"close","content-length":"1509","accept":"application/json, text/plain, */*","content-type":"application/json; charset=utf-8","cache-control":"no-cache","user-agent":"axios/0.21.1"},"params":{},"query":{},"body":{"id":"63d9c2b4084e364614d0c554","address":{"id":"63d9c2b4084e364614d0c54f","firstName":"Maria","lastName":"Martinez","state":{"id":"1436","name":"Florida","stateCode":"FL"},"country":{"id":"US","name":"United States"},"city":"Miami Gardens","email":"","otherState":"","phone":"","street":"5351 NW 201st St","street2":"","zipcode":"33055-4673"},"addedTrackingCode":1,"addressFullName":"Maria Martinez","country":"United States","couponCode":"","isAllowAddressUpdatable":false,"isDraft":false,"isValidAddress":true,"orderItems":[{"id":"63d9c2b5084e364614d0c56c","applyFastShipping":false,"attributes":["T-Shirt Classic Color: White","Tshirt 2D Size: M"],"createdAt":1675215541087,"price":650,"productId":"63d9c147084e364614d0aa3f","productName":"Leopard Una Reina Nacio En Febrero Shirt - Born In February - February Birthday Shirt - Birthday Girl - Spanish Birthday Shirt Women DQ5O","productSku":"SEVMy-DQ5O","productTypeName":"Classic Tshirt","qty":1,"imageUrl":"https://cloud-us1.platfox.com/file/anwmhw52i30zjcznbvzvjp","shippingPrice":669,"sellerStatus":"PROCESSING","trackingCarrierCode":"USPS","trackingCode":"9400109205568543726914"}],"orderStatus":"PROCESSING:1","refId":"2781844620","selfId":"#TaloH6_8","subTotalAmount":650,"totalAmount":1319,"totalDiscountAmount":0,"totalDiscountShippingAmount":0,"totalOrderItems":1,"totalQty":1,"totalShippingAmount":669,"trackingCodes":[{"trackingCarrierCode":"USPS","trackingCode":"9400109205568543726914"}],"createdAt":1675215541091,"placedAt":1675215851900}}}]},"versionId":"83fedd5f-94bf-49b7-8508-b84cefef313e","triggerCount":1,"tags":[{"createdAt":"2023-04-07T10:40:23.898Z","updatedAt":"2023-04-07T10:40:23.898Z","id":"13","name":"Talo Media"}]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-04-07T10:52:49.969Z","updatedAt":"2023-07-27T14:59:21.000Z","id":"61","name":"Get Etsy order and push Notify","active":true,"nodes":[{"parameters":{"keepOnlySet":true,"values":{"string":[{"name":"emailFrom","value":"={{ $json[\"from\"][\"value\"][0][\"address\"] }}"},{"name":"emailSubject","value":"={{ $json[\"subject\"] }}"},{"name":"emailContent","value":"={{ $json[\"text\"] }}"},{"name":"emailTo","value":"={{ $json[\"to\"][\"value\"][0][\"address\"] }}"}]},"options":{"dotNotation":false}},"id":"3cfcef77-f1fb-4118-b55f-ac9680e8c7d1","name":"Set","type":"n8n-nodes-base.set","typeVersion":1,"position":[-620,1140]},{"parameters":{"pollTimes":{"item":[{"mode":"everyMinute"}]},"simple":false,"filters":{},"options":{}},"id":"ca6f31f5-901b-458d-b68e-292942577a99","name":"Etsy Gmail Trigger","type":"n8n-nodes-base.gmailTrigger","typeVersion":1,"position":[-820,1140],"credentials":{"gmailOAuth2":{"id":"24","name":"Gmail Etsy.TaloMedia@gmail.com"}}},{"parameters":{"mode":"runOnceForEachItem","jsCode":"// JSON of the item\n$input.item.json.shop = $('Set').all()[0].json.emailContent.split('Shop ')[1]\n$input.item.json.shop = $input.item.json.shop.split(':')[0]\n\n$input.item.json.card = $('Set').all()[0].json.emailContent.split(' account ending in ')[1]\n$input.item.json.card = $input.item.json.card.split(':')[0]\n\n$input.item.json.money = $('Set').all()[0].json.emailSubject.split('Your funds of ')[1]\n$input.item.json.money = $input.item.json.money.split(' ')[0]\n\n\nreturn $input.item;"},"id":"3b6224fe-3525-42ff-a253-385eda3e9e52","name":"Etsy.Deposit","type":"n8n-nodes-base.code","typeVersion":1,"position":[-140,1780]},{"parameters":{"dataType":"string","value1":"={{ $json[\"emailFrom\"] }}","rules":{"rules":[{"operation":"contains","value2":"transaction@etsy.com"},{"operation":"contains","value2":"conversations@mail.etsy.com","output":1},{"operation":"contains","value2":"support@etsy.com","output":2},{"operation":"contains","value2":"noreply@etsy.com","output":3},{"operation":"contains","value2":"legal@etsy.com","output":3},{"operation":"contains","value2":"trust@etsy.com>","output":3},{"operation":"contains","value2":"billing@etsy.com","output":3},{"operation":"contains","value2":"noreply@mail.etsy.com","output":3},{"operation":"contains","value2":"HappyHuesCo108@gmail.com¬†"}]}},"id":"aa46e6ec-dfed-439d-9448-97b147539fcc","name":"Switch Etsy Email","type":"n8n-nodes-base.switch","typeVersion":1,"position":[-400,1140],"notesInFlow":false,"notes":"1. Etsy Order: \n- Digital: \"Etsy Order confirmation for\":  transaction@etsy.com\n- Physical: \"You made a sale on Etsy - Ship by\": transaction@etsy.com\n2. Etsy Conversation: \"Etsy Conversation with\": conversation@mail.etsy.com\n3. Deposit: \"Your funds of ‚Ç¨1,206.19 EUR are on the way!\" support@etsy.com\n4.  Kh√°ch m·ªü case: \"Etsy Support commented on your case\": noreply@etsy.com\n5. B·ªã Report: \"Notice of Intellectual Property Infringement\": noreply@etsy.com \n6. ƒê√£ ƒëi·ªÅn Counter: \"We‚Äôve processed your counter notice\": legal@etsy.com"},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/bot/v2/hook/6f9ac876-945b-4234-9936-cfe96918acd6","sendBody":true,"specifyBody":"json","jsonBody":"={{ $json[\"messageJson\"] }}","options":{}},"id":"11d3402b-7bf2-43ca-b06b-4bddcecf990e","name":"Push to Lark message1","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[440,1480]},{"parameters":{"mode":"runOnceForEachItem","jsCode":"// Add a new field called 'myNewField' to the\n// JSON of the item\n$input.item.json.emailSubject = $('Set').all()[0].json.emailSubject.split('Etsy Conversation with ')[1]\n$input.item.json.buyerName = $input.item.json.emailSubject.split(' from ')[0]\n//Kiem tra tin nhan khach co Store ko\nif ($input.item.json.emailSubject.includes(' from ')) {\n  $input.item.json.buyerStore = $input.item.json.emailSubject.split(' from ')[1]\n  //Gan json ten store\n  $input.item.json.buyerStoreJsonLabel = \"{\\\"is_short\\\":true,\\\"text\\\":{\\\"tag\\\":\\\"lark_md\\\",\\\"content\\\":\\\"**üíà Store:**\\\\n \" + \n$input.item.json.buyerStore + \"\\\"}},\";\n  //Gan json link ve store\n  $input.item.json.buyerStoreJsonAction = \"{\\\"tag\\\":\\\"button\\\",\\\"text\\\":{\\\"content\\\":\\\"View Shop\\\",\\\"tag\\\":\\\"lark_md\\\"},\\\"url\\\":\\\"https://etsy.com/shop/\" + $input.item.json.buyerStore + \"\\\",\\\"type\\\":\\\"default\\\",\\\"value\\\":{}}\"\n}\n\n$input.item.json.buyerMess = $('Set').all()[0].json.emailContent.split('<https://www.etsy.com/conversations/')[2]\n$input.item.json.buyerMess = $input.item.json.buyerMess.split('>')[1]\n$input.item.json.buyerMess = $input.item.json.buyerMess.split('Reply')[0]\n// $input.item.json.buyerMess = JSON.stringify($input.item.json.buyerMess);\n$input.item.json.buyerMess = $input.item.json.buyerMess.replaceAll(/\\n/g, \" \");\n$input.item.json.buyerMess = $input.item.json.buyerMess.replaceAll(\"\\\"\", \" \");\n\n//Kiem tra tin nhan co listing ko\nif ($input.item.json.buyerMess.includes('etsy.com/listing/')) {\n  $input.item.json.buyerListing = $input.item.json.buyerMess.split('etsy.com/listing/')[1]\n  $input.item.json.buyerListing = $input.item.json.buyerListing.split('/')[0]\n  $input.item.json.buyerListingJsonLabel = \"{\\\"is_short\\\":true,\\\"text\\\":{\\\"tag\\\":\\\"lark_md\\\",\\\"content\\\":\\\"**üè∑ Listing:**\\\\n \" + $input.item.json.buyerListing + \"\\\"}},\";\n    //Kiem tra co listing ko, neu ko co them , gan json bt\n    $input.item.json.buyerListingJsonAction = \"{\\\"tag\\\":\\\"button\\\",\\\"text\\\":{\\\"content\\\":\\\"ViewListing\\\",\\\"tag\\\":\\\"lark_md\\\"},\\\"url\\\":\\\"https://etsy.com/listing/\" + $input.item.json.buyerListing + \"\\\",\\\"type\\\":\\\"default\\\",\\\"value\\\":{}}\"\n  \n}\n//Noi json lai thanh message push ve Lark\nif ($input.item.json.buyerListing && $input.item.json.buyerStore) {\n  $input.item.json.messageJson = \"{\\\"msg_type\\\":\\\"interactive\\\",\\\"card\\\":{\\\"config\\\":{\\\"wide_screen_mode\\\":true,\\\"enable_forward\\\":true},\\\"elements\\\":[{\\\"tag\\\":\\\"div\\\",\\\"fields\\\":[ \" + $input.item.json.buyerStoreJsonLabel + $input.item.json.buyerListingJsonLabe + \"{\\\"is_short\\\":false,\\\"text\\\":{\\\"tag\\\":\\\"lark_md\\\",\\\"content\\\":\\\"**üí≠Message:**\\\\n\" + $input.item.json.buyerMess + \"\\\"}}]},{\\\"actions\\\":[\" + $input.item.json.buyerStoreJsonAction + \",\" + $input.item.json.buyerListingJsonAction + \"],\\\"tag\\\":\\\"action\\\"}],\\\"header\\\":{\\\"template\\\":\\\"green\\\",\\\"title\\\":{\\\"content\\\":\\\"üëã WalterKlooShop message: \" + $input.item.json.emailSubject + \" üëã\\\",\\\"tag\\\":\\\"plain_text\\\"}}}}\"\n} else if ($input.item.json.buyerListing) {\n  $input.item.json.messageJson = \"{\\\"msg_type\\\":\\\"interactive\\\",\\\"card\\\":{\\\"config\\\":{\\\"wide_screen_mode\\\":true,\\\"enable_forward\\\":true},\\\"elements\\\":[{\\\"tag\\\":\\\"div\\\",\\\"fields\\\":[ \" + $input.item.json.buyerListingJsonLabe + \"{\\\"is_short\\\":false,\\\"text\\\":{\\\"tag\\\":\\\"lark_md\\\",\\\"content\\\":\\\"**üí≠Message:**\\\\n\" + $input.item.json.buyerMess + \"\\\"}}]},{\\\"actions\\\":[\" + $input.item.json.buyerListingJsonAction + \"],\\\"tag\\\":\\\"action\\\"}],\\\"header\\\":{\\\"template\\\":\\\"green\\\",\\\"title\\\":{\\\"content\\\":\\\"üëã WalterKlooShop message: \" + $input.item.json.emailSubject + \" üëã\\\",\\\"tag\\\":\\\"plain_text\\\"}}}}\"\n} else if ($input.item.json.buyerStore) {\n    $input.item.json.messageJson = \"{\\\"msg_type\\\":\\\"interactive\\\",\\\"card\\\":{\\\"config\\\":{\\\"wide_screen_mode\\\":true,\\\"enable_forward\\\":true},\\\"elements\\\":[{\\\"tag\\\":\\\"div\\\",\\\"fields\\\":[ \" + $input.item.json.buyerStoreJsonLabel + \"{\\\"is_short\\\":false,\\\"text\\\":{\\\"tag\\\":\\\"lark_md\\\",\\\"content\\\":\\\"**üí≠Message:**\\\\n\" + $input.item.json.buyerMess + \"\\\"}}]},{\\\"actions\\\":[\" + $input.item.json.buyerStoreJsonAction + \"],\\\"tag\\\":\\\"action\\\"}],\\\"header\\\":{\\\"template\\\":\\\"green\\\",\\\"title\\\":{\\\"content\\\":\\\"üëã WalterKlooShop message: \" + $input.item.json.emailSubject + \" üëã\\\",\\\"tag\\\":\\\"plain_text\\\"}}}}\"\n} else {\n  $input.item.json.messageJson = \"{\\\"msg_type\\\":\\\"interactive\\\",\\\"card\\\":{\\\"config\\\":{\\\"wide_screen_mode\\\":true,\\\"enable_forward\\\":true},\\\"elements\\\":[{\\\"tag\\\":\\\"div\\\",\\\"fields\\\":[{\\\"is_short\\\":true,\\\"text\\\":{\\\"tag\\\":\\\"lark_md\\\",\\\"content\\\":\\\"**üí≠Message:**\\\\n\" + $input.item.json.buyerMess + \"\\\"}}]}],\\\"header\\\":{\\\"template\\\":\\\"green\\\",\\\"title\\\":{\\\"content\\\":\\\"üëã WalterKlooShop message: \" + $input.item.json.emailSubject + \" üëã\\\",\\\"tag\\\":\\\"plain_text\\\"}}}}\"\n}\n\n\nreturn $input.item;"},"id":"fe48e6a0-0965-4913-a7a3-1d9613422c7c","name":"Etsy.Conversation.DE01","type":"n8n-nodes-base.code","typeVersion":1,"position":[160,1380],"notes":"link etsy truoc: https://anotepad.com/notes/4hg8493d\nlink etsy sau: "},{"parameters":{"mode":"runOnceForEachItem","jsCode":"// Add a new field called 'myNewField' to the\n// JSON of the item\n$input.item.json.emailSubject = $('Set').all()[0].json.emailSubject.split('Etsy Conversation with ')[1]\n$input.item.json.buyerName = $input.item.json.emailSubject.split(' from ')[0]\n//Kiem tra tin nhan khach co Store ko\nif ($input.item.json.emailSubject.includes(' from ')) {\n  $input.item.json.buyerStore = $input.item.json.emailSubject.split(' from ')[1]\n  //Gan json ten store\n  $input.item.json.buyerStoreJsonLabel = \"{\\\"is_short\\\":true,\\\"text\\\":{\\\"tag\\\":\\\"lark_md\\\",\\\"content\\\":\\\"**üíà Store:**\\\\n \" + \n$input.item.json.buyerStore + \"\\\"}},\";\n  //Gan json link ve store\n  $input.item.json.buyerStoreJsonAction = \"{\\\"tag\\\":\\\"button\\\",\\\"text\\\":{\\\"content\\\":\\\"View Shop\\\",\\\"tag\\\":\\\"lark_md\\\"},\\\"url\\\":\\\"https://etsy.com/shop/\" + $input.item.json.buyerStore + \"\\\",\\\"type\\\":\\\"default\\\",\\\"value\\\":{}}\"\n}\n\n$input.item.json.buyerMess = $('Set').all()[0].json.emailContent.split('<https://www.etsy.com/conversations/')[2]\n$input.item.json.buyerMess = $input.item.json.buyerMess.split('>')[1]\n$input.item.json.buyerMess = $input.item.json.buyerMess.split('Reply')[0]\n// $input.item.json.buyerMess = JSON.stringify($input.item.json.buyerMess);\n$input.item.json.buyerMess = $input.item.json.buyerMess.replaceAll(/\\n/g, \" \");\n$input.item.json.buyerMess = $input.item.json.buyerMess.replaceAll(\"\\\"\", \" \");\n\n//Kiem tra tin nhan co listing ko\nif ($input.item.json.buyerMess.includes('etsy.com/listing/')) {\n  $input.item.json.buyerListing = $input.item.json.buyerMess.split('etsy.com/listing/')[1]\n  $input.item.json.buyerListing = $input.item.json.buyerListing.split('/')[0]\n  $input.item.json.buyerListingJsonLabel = \"{\\\"is_short\\\":true,\\\"text\\\":{\\\"tag\\\":\\\"lark_md\\\",\\\"content\\\":\\\"**üè∑ Listing:**\\\\n \" + $input.item.json.buyerListing + \"\\\"}},\";\n    //Kiem tra co listing ko, neu ko co them , gan json bt\n    $input.item.json.buyerListingJsonAction = \"{\\\"tag\\\":\\\"button\\\",\\\"text\\\":{\\\"content\\\":\\\"ViewListing\\\",\\\"tag\\\":\\\"lark_md\\\"},\\\"url\\\":\\\"https://etsy.com/listing/\" + $input.item.json.buyerListing + \"\\\",\\\"type\\\":\\\"default\\\",\\\"value\\\":{}}\"\n  \n}\n//Noi json lai thanh message push ve Lark\nif ($input.item.json.buyerListing && $input.item.json.buyerStore) {\n  $input.item.json.messageJson = \"{\\\"msg_type\\\":\\\"interactive\\\",\\\"card\\\":{\\\"config\\\":{\\\"wide_screen_mode\\\":true,\\\"enable_forward\\\":true},\\\"elements\\\":[{\\\"tag\\\":\\\"div\\\",\\\"fields\\\":[ \" + $input.item.json.buyerStoreJsonLabel + $input.item.json.buyerListingJsonLabe + \"{\\\"is_short\\\":false,\\\"text\\\":{\\\"tag\\\":\\\"lark_md\\\",\\\"content\\\":\\\"**üí≠Message:**\\\\n\" + $input.item.json.buyerMess + \"\\\"}}]},{\\\"actions\\\":[\" + $input.item.json.buyerStoreJsonAction + \",\" + $input.item.json.buyerListingJsonAction + \"],\\\"tag\\\":\\\"action\\\"}],\\\"header\\\":{\\\"template\\\":\\\"green\\\",\\\"title\\\":{\\\"content\\\":\\\"üëã RgbShirt message: \" + $input.item.json.emailSubject + \" üëã\\\",\\\"tag\\\":\\\"plain_text\\\"}}}}\"\n} else if ($input.item.json.buyerListing) {\n  $input.item.json.messageJson = \"{\\\"msg_type\\\":\\\"interactive\\\",\\\"card\\\":{\\\"config\\\":{\\\"wide_screen_mode\\\":true,\\\"enable_forward\\\":true},\\\"elements\\\":[{\\\"tag\\\":\\\"div\\\",\\\"fields\\\":[ \" + $input.item.json.buyerListingJsonLabe + \"{\\\"is_short\\\":false,\\\"text\\\":{\\\"tag\\\":\\\"lark_md\\\",\\\"content\\\":\\\"**üí≠Message:**\\\\n\" + $input.item.json.buyerMess + \"\\\"}}]},{\\\"actions\\\":[\" + $input.item.json.buyerListingJsonAction + \"],\\\"tag\\\":\\\"action\\\"}],\\\"header\\\":{\\\"template\\\":\\\"green\\\",\\\"title\\\":{\\\"content\\\":\\\"üëã RgbShirt message: \" + $input.item.json.emailSubject + \" üëã\\\",\\\"tag\\\":\\\"plain_text\\\"}}}}\"\n} else if ($input.item.json.buyerStore) {\n    $input.item.json.messageJson = \"{\\\"msg_type\\\":\\\"interactive\\\",\\\"card\\\":{\\\"config\\\":{\\\"wide_screen_mode\\\":true,\\\"enable_forward\\\":true},\\\"elements\\\":[{\\\"tag\\\":\\\"div\\\",\\\"fields\\\":[ \" + $input.item.json.buyerStoreJsonLabel + \"{\\\"is_short\\\":false,\\\"text\\\":{\\\"tag\\\":\\\"lark_md\\\",\\\"content\\\":\\\"**üí≠Message:**\\\\n\" + $input.item.json.buyerMess + \"\\\"}}]},{\\\"actions\\\":[\" + $input.item.json.buyerStoreJsonAction + \"],\\\"tag\\\":\\\"action\\\"}],\\\"header\\\":{\\\"template\\\":\\\"green\\\",\\\"title\\\":{\\\"content\\\":\\\"üëã RgbShirt message: \" + $input.item.json.emailSubject + \" üëã\\\",\\\"tag\\\":\\\"plain_text\\\"}}}}\"\n} else {\n  $input.item.json.messageJson = \"{\\\"msg_type\\\":\\\"interactive\\\",\\\"card\\\":{\\\"config\\\":{\\\"wide_screen_mode\\\":true,\\\"enable_forward\\\":true},\\\"elements\\\":[{\\\"tag\\\":\\\"div\\\",\\\"fields\\\":[{\\\"is_short\\\":true,\\\"text\\\":{\\\"tag\\\":\\\"lark_md\\\",\\\"content\\\":\\\"**üí≠Message:**\\\\n\" + $input.item.json.buyerMess + \"\\\"}}]}],\\\"header\\\":{\\\"template\\\":\\\"green\\\",\\\"title\\\":{\\\"content\\\":\\\"üëã RgbShirt message: \" + $input.item.json.emailSubject + \" üëã\\\",\\\"tag\\\":\\\"plain_text\\\"}}}}\"\n}\n\n\nreturn $input.item;"},"id":"eb9789b0-6838-4e64-ae7b-f04f645e5cf5","name":"Etsy.Conversation.OTB01","type":"n8n-nodes-base.code","typeVersion":1,"position":[160,1520],"notes":"link etsy truoc: https://anotepad.com/notes/4hg8493d\nlink etsy sau: "},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/bot/v2/hook/cea8a270-7e98-4dd2-b219-33148d5050ce","sendBody":true,"specifyBody":"json","jsonBody":"={\n    \"msg_type\": \"interactive\",\n    \"card\": {\n        \"config\": {\n            \"wide_screen_mode\": true,\n            \"enable_forward\": true\n        },\n        \"elements\": [\n            {\n                \"tag\": \"div\",\n                \"fields\": [\n                    {\n                        \"is_short\": true,\n                        \"text\": {\n                            \"tag\": \"lark_md\",\n                            \"content\": \"**üè∑ Order ID:**\\n {{ $json[\"orderID\"] }}\"\n                        }\n                    },\n                    {\n                        \"is_short\": true,\n                        \"text\": {\n                            \"tag\": \"lark_md\",\n                            \"content\": \"**üë§ Customer:**\\n {{ $json[\"buyerName\"] }}\"\n                        }\n                    },\n                    {\n                        \"is_short\": true,\n                        \"text\": {\n                            \"tag\": \"lark_md\",\n                            \"content\": \"**üõí Total Items:**\\n {{ $json[\"orderQuantity\"] }}\"\n                        }\n                    },\n                    {\n                        \"is_short\": true,\n                        \"text\": {\n                            \"tag\": \"lark_md\",\n                            \"content\": \"**üíà Store:**\\n {{ $json[\"shopName\"] }}\"\n                        }\n                    },\n                    {\n                        \"is_short\": true,\n                        \"text\": {\n                            \"tag\": \"lark_md\",\n                            \"content\": \"**üí∞ Order Value:**\\n {{ $json[\"orderTotal\"] }}\"\n                        }\n                    },\n                    {\n                        \"is_short\": false,\n                        \"text\": {\n                            \"tag\": \"lark_md\",\n                            \"content\": \"**üì• Order Detail:**\\n{{ $json[\"orderProductDetail\"] }}\"\n                        }\n                    }\n                ]\n            }\n        ],\n        \"header\": {\n            \"template\": \"green\",\n            \"title\": {\n                \"content\": \"üéâ Digital Order: {{ $json[\"orderQuantity\"] }} items, {{ $json[\"orderTotal\"] }} from {{ $json[\"shopName\"] }} üéâ\",\n                \"tag\": \"plain_text\"\n            }\n        }\n    }\n}","options":{}},"id":"e870ac0c-e2bc-45ce-b403-09b7c4569bb6","name":"Order Digital push","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[460,620]},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/bot/v2/hook/cea8a270-7e98-4dd2-b219-33148d5050ce","sendBody":true,"specifyBody":"json","jsonBody":"={\n    \"msg_type\": \"interactive\",\n    \"card\": {\n        \"config\": {\n            \"wide_screen_mode\": true,\n            \"enable_forward\": true\n        },\n        \"elements\": [\n            {\n                \"tag\": \"div\",\n                \"fields\": [\n                    {\n                        \"is_short\": true,\n                        \"text\": {\n                            \"tag\": \"lark_md\",\n                            \"content\": \"**üè∑ Order ID:**\\n {{ $json[\"orderID\"] }}\"\n                        }\n                    },\n                    {\n                        \"is_short\": true,\n                        \"text\": {\n                            \"tag\": \"lark_md\",\n                            \"content\": \"**üë§ Customer:**\\n {{ $json[\"buyerName\"] }}\"\n                        }\n                    },\n                    {\n                        \"is_short\": true,\n                        \"text\": {\n                            \"tag\": \"lark_md\",\n                            \"content\": \"**üõí Total Items:**\\n {{ $json[\"orderQuantity\"] }}\"\n                        }\n                    },\n                    {\n                        \"is_short\": true,\n                        \"text\": {\n                            \"tag\": \"lark_md\",\n                            \"content\": \"**üíà Store:**\\n {{ $json[\"shopName\"] }}\"\n                        }\n                    },\n                    {\n                        \"is_short\": true,\n                        \"text\": {\n                            \"tag\": \"lark_md\",\n                            \"content\": \"**üí∞ Order Value:**\\n {{ $json[\"orderTotal\"] }}\"\n                        }\n                    },\n        {\n          \"is_short\": true,\n          \"text\": {\n            \"tag\": \"lark_md\",\n            \"content\": \"**üöÄ Ship Date:**\\n {{ $json[\"shipDate\"] }}\"\n          }\n        },\n                    {\n                        \"is_short\": true,\n                        \"text\": {\n                            \"tag\": \"lark_md\",\n                            \"content\": \"**üì¶ Shipment Address:**\\n {{ $json[\"shippingAdress\"] }}\"\n                        }\n                    },\n                    {\n                        \"is_short\": false,\n                        \"text\": {\n                            \"tag\": \"lark_md\",\n                            \"content\": \"**üì• Order Detail:**\\n  {{ $json[\"orderProductDetail\"] }}\"\n                        }\n                    }\n                ]\n            }\n        ],\n        \"header\": {\n            \"template\": \"green\",\n            \"title\": {\n                \"content\": \"üéâ New Order: {{ $json[\"orderQuantity\"] }} items, {{ $json[\"orderTotal\"] }} from {{ $json[\"shopName\"] }} üéâ\",\n                \"tag\": \"plain_text\"\n            }\n        }\n    }\n}","options":{}},"id":"569ceea0-dd0a-4865-8d7c-3d83b0461490","name":"Order Shirt push","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[460,980]},{"parameters":{"url":"https://open.larksuite.com/open-apis/bot/v2/hook/f10ed0c1-eeb6-4fd7-9e18-414ef0dd999d","sendBody":true,"specifyBody":"json","jsonBody":"={\n    \"msg_type\": \"interactive\",\n    \"card\": {\n        \"config\": {\n            \"wide_screen_mode\": true,\n            \"enable_forward\": true\n        },\n        \"elements\": [\n            {\n                \"tag\": \"div\",\n                \"fields\": [\n                    {\n                        \"is_short\": true,\n                        \"text\": {\n                            \"tag\": \"lark_md\",\n                            \"content\": \"**üíà Store:**\\n {{ $json[\"shop\"] }}\"\n                        }\n                    },\n                    {\n                        \"is_short\": true,\n                        \"text\": {\n                            \"tag\": \"lark_md\",\n                            \"content\": \"**üè∑ End card:**\\n {{ $json[\"card\"] }}\"\n                        }\n                    },\n                    {\n                        \"is_short\": true,\n                        \"text\": {\n                            \"tag\": \"lark_md\",\n                            \"content\": \"**üí∞ Money:**\\n {{ $json[\"money\"] }}\"\n                        }\n                    }\n                ]\n            }\n        ],\n        \"header\": {\n            \"template\": \"green\",\n            \"title\": {\n                \"content\": \"üéâ Deposit to: {{ $json[\"shop\"] }} with {{ $json[\"money\"] }} üéâ\",\n                \"tag\": \"plain_text\"\n            }\n        }\n    }\n}","options":{}},"id":"152cc4a9-3362-4c7f-b639-1d01d8dc4717","name":"HTTP Request","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[140,1840]},{"parameters":{"url":"https://open.larksuite.com/open-apis/bot/v2/hook/f10ed0c1-eeb6-4fd7-9e18-414ef0dd999d","sendBody":true,"specifyBody":"json","jsonBody":"={\n    \"msg_type\": \"interactive\",\n    \"card\": {\n        \"config\": {\n            \"wide_screen_mode\": true,\n            \"enable_forward\": true\n        },\n        \"elements\": [\n            {\n                \"tag\": \"div\",\n                \"fields\": [\n                    {\n                        \"is_short\": true,\n                        \"text\": {\n                            \"tag\": \"lark_md\",\n                            \"content\": \"**üíà Store email:**\\n {{ $json[\"emailTo\"] }}\"\n                        }\n                    }\n                ]\n            }\n        ],\n        \"header\": {\n            \"template\": \"green\",\n            \"title\": {\n                \"content\": \"ü•π {{ $json[\"emailSubject\"] }} ü•π\",\n                \"tag\": \"plain_text\"\n            }\n        }\n    }\n}","options":{}},"id":"a42fade8-14b7-4b46-89ab-6557dbbead44","name":"HTTP Request1","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[-140,2020]},{"parameters":{"mode":"runOnceForEachItem","jsCode":"//Get order Total\n$input.item.json.orderTotal = $('Set').item.json.emailSubject.split('Etsy Order confirmation for: ')[1];\n$input.item.json.orderTotal = $input.item.json.orderTotal.split(' ')[0];\n\n//Get buyer Name\n$input.item.json.buyerName = $('Set').item.json.emailSubject.split(' from: ')[1];\n$input.item.json.buyerName = $input.item.json.buyerName.split(' (')[0];\n\n//Get Order ID\n$input.item.json.orderID = $('Set').item.json.emailSubject.split('(')[1];\n$input.item.json.orderID = $input.item.json.orderID.split(')')[0];\n\n//Get Orrder Quantity\n$input.item.json.orderQuantity = $('Set').item.json.emailContent.split('Congratulations on your Etsy sale of ')[1];\n$input.item.json.orderQuantity = $input.item.json.orderQuantity.split(' item')[0];\n\n//Get Shop Name\n$input.item.json.shopName = $('Set').item.json.emailContent.split('Shop: ')[1];\n$input.item.json.shopName = $input.item.json.shopName.split('\\n')[0];\n\n//Get Buyer Name\n$input.item.json.buyerName = $('Set').item.json.emailContent.split('<https://www.etsy.com/people/')[1];\n$input.item.json.buyerName = $input.item.json.buyerName.split('?')[0];\n\n//Get Buyer Email\n$input.item.json.buyerEmail = $('Set').item.json.emailContent.split('Send them an email <')[1];\n$input.item.json.buyerEmail = $input.item.json.buyerEmail.split('>')[0];\n$input.item.json.buyerEmail = $input.item.json.buyerEmail.replaceAll('mailto:', '');\n\n//Get Order Products list\n$input.item.json.orderProducts = $('Set').item.json.emailContent.split('<https://www.etsy.com/transaction/');\n//Remove first item\n$input.item.json.orderProducts.shift();\nlet i = 0;\ndo {\n  $input.item.json.orderProducts[i] = $input.item.json.orderProducts[i].split('>')[1];\n  i++;\n} while (i < $input.item.json.orderProducts.length);\n\n//Get Order paid\n$input.item.json.orderPaid = $input.item.json.orderProducts[$input.item.json.orderProducts.length - 1].split('Order total')[1];\n//$input.item.json.orderPaid = $input.item.json.orderPaid.replaceAll('\\n', ' ');\n$input.item.json.orderPaid = $input.item.json.orderPaid.trim()\n\n//Beauty last order item detail\n$input.item.json.orderProducts[$input.item.json.orderProducts.length - 1] = $input.item.json.orderProducts[$input.item.json.orderProducts.length - 1].split('Order total')[0];\n//Beauty title\ni = 0;\ndo {\n  $input.item.json.orderProducts[i] = $input.item.json.orderProducts[i].replaceAll('\\n',' ');\n  $input.item.json.orderProducts[i] = $input.item.json.orderProducts[i].trim();\n  i+=2;\n} while (i < $input.item.json.orderProducts.length);\n//Beauty order detail\ni = 1;\ndo {\n  $input.item.json.orderProducts[i] = $input.item.json.orderProducts[i].split('Personalized item')[0];\n  $input.item.json.orderProducts[i] = $input.item.json.orderProducts[i].trim();\n  let index01 = $input.item.json.orderProducts[i].indexOf(\"Shop\");\n  index01 = $input.item.json.orderProducts[i].substring(0,index01)\n  let index02 = $input.item.json.orderProducts[i].indexOf(\"Quantity:\");\n  index02 = $input.item.json.orderProducts[i].substring(index02,$input.item.json.orderProducts[i].length)\n  $input.item.json.orderProducts[i] = index01 + index02;\n  i+=2;\n} while (i < $input.item.json.orderProducts.length);\n\n//Merch order detail to string\n$input.item.json.orderProductDetail = '';\ni = 0;\ndo {\n  $input.item.json.orderProductDetail += $input.item.json.orderProducts[i] + '\\n' + $input.item.json.orderProducts[i+1] + '\\n \\n ';\n  i+=2;\n} while (i < $input.item.json.orderProducts.length);\n$input.item.json.orderProductDetail = $input.item.json.orderProductDetail.replaceAll('\\n', '\\\\n');\n$input.item.json.orderProductDetail = $input.item.json.orderProductDetail.trim()\n\n$input.item.json.orderProductDetail = $input.item.json.orderProductDetail.split('No returns or exchanges');\ni = 0;\ndo {\n  if ($input.item.json.orderProductDetail[i].includes(']')) {\n    $input.item.json.orderProductDetail[i] = $input.item.json.orderProductDetail[i].split(']')[1]\n    $input.item.json.orderProductDetail[i] = $input.item.json.orderProductDetail[i].trim()\n  }\n  i+=1;\n} while (i < $input.item.json.orderProductDetail.length);\n//Remove last items\n$input.item.json.orderProductDetail.pop()\n\nreturn $input.item;"},"id":"25104f81-fa12-4334-af8e-2330d95f2c2b","name":"Order Digital","type":"n8n-nodes-base.code","typeVersion":1,"position":[120,700]},{"parameters":{"mode":"runOnceForEachItem","jsCode":"//Get Ship date\n$input.item.json.shipDate = $('Set').all()[0].json.emailSubject.split('Ship by ')[1];\n$input.item.json.shipDate = $input.item.json.shipDate.split(' - [')[0];\n\n//Get Order ID\n$input.item.json.orderID = $('Set').all()[0].json.emailSubject.split(', Order ')[1];\n$input.item.json.orderID = $input.item.json.orderID.replaceAll(']','');\n\n//Get Order Total\n$input.item.json.orderTotal = $('Set').all()[0].json.emailSubject.split(', Order ')[0];\n$input.item.json.orderTotal = $input.item.json.orderTotal.split('[')[1];\n\n//Get Orrder Quantity\n$input.item.json.orderQuantity = $('Set').all()[0].json.emailContent.split('Congratulations on your Etsy sale of ')[1];\n$input.item.json.orderQuantity = $input.item.json.orderQuantity.split(' item')[0];\n\n//Get Shop Name\n$input.item.json.shopName = $('Set').all()[0].json.emailContent.split('Shop: ')[1];\n$input.item.json.shopName = $input.item.json.shopName.split('\\n')[0];\n\n//Get Buyer Name\n$input.item.json.buyerName = $('Set').all()[0].json.emailContent.split('<https://www.etsy.com/people/')[1];\n$input.item.json.buyerName = $input.item.json.buyerName.split('?')[0];\n\n//Get Buyer Email\n$input.item.json.buyerEmail = $('Set').all()[0].json.emailContent.split('Send them an email <')[1];\n$input.item.json.buyerEmail = $input.item.json.buyerEmail.split('>')[0];\n$input.item.json.buyerEmail = $input.item.json.buyerEmail.replaceAll('mailto:', '');\n\n//Get Shipping Address\nif ($('Set').all()[0].json.emailContent.includes('United States')) {\n  $input.item.json.shippingAdress = $('Set').all()[0].json.emailContent.split('Shipping address')[1];\n  $input.item.json.shippingAdress = $input.item.json.shippingAdress.replaceAll('\\n', ' ');\n  $input.item.json.shippingAdress = $input.item.json.shippingAdress.replaceAll('*', '');\n  $input.item.json.shippingAdress = $input.item.json.shippingAdress.trim();\n  $input.item.json.shippingAdress = $input.item.json.shippingAdress.split('United States')[0];\n  $input.item.json.shippingAdress = $input.item.json.shippingAdress.trim();\n  $input.item.json.shippingAdress = $input.item.json.shippingAdress + \", US\"\n} else {\n  $input.item.json.shippingAdress = 'International Shipping'\n}\n\n//Get Order Products list\n$input.item.json.orderProducts = $('Set').all()[0].json.emailContent.split('<https://www.etsy.com/transaction/');\n//Remove first item\n$input.item.json.orderProducts.shift();\nlet i = 0;\ndo {\n  $input.item.json.orderProducts[i] = $input.item.json.orderProducts[i].split('>')[1];\n  i++;\n} while (i < $input.item.json.orderProducts.length);\n\n//Get Order paid\n$input.item.json.orderPaid = $input.item.json.orderProducts[$input.item.json.orderProducts.length - 1].split('Order total')[1];\n//$input.item.json.orderPaid = $input.item.json.orderPaid.replaceAll('\\n', ' ');\n$input.item.json.orderPaid = $input.item.json.orderPaid.trim()\n\n//Beauty last order item detail\n$input.item.json.orderProducts[$input.item.json.orderProducts.length - 1] = $input.item.json.orderProducts[$input.item.json.orderProducts.length - 1].split('Order total')[0];\n//Beauty title\ni = 0;\ndo {\n  $input.item.json.orderProducts[i] = $input.item.json.orderProducts[i].replaceAll('\\n',' ');\n  $input.item.json.orderProducts[i] = $input.item.json.orderProducts[i].trim();\n  i+=2;\n} while (i < $input.item.json.orderProducts.length);\n//Beauty order detail\ni = 1;\ndo {\n  $input.item.json.orderProducts[i] = $input.item.json.orderProducts[i].split('Personalized item')[0];\n  $input.item.json.orderProducts[i] = $input.item.json.orderProducts[i].trim();\n  let index01 = $input.item.json.orderProducts[i].indexOf(\"Shop\");\n  index01 = $input.item.json.orderProducts[i].substring(0,index01)\n  let index02 = $input.item.json.orderProducts[i].indexOf(\"Quantity:\");\n  index02 = $input.item.json.orderProducts[i].substring(index02,$input.item.json.orderProducts[i].length)\n  $input.item.json.orderProducts[i] = index01 + index02;\n  i+=2;\n} while (i < $input.item.json.orderProducts.length);\n\n//Merch order detail to string\n$input.item.json.orderProductDetail = '';\ni = 0;\ndo {\n  $input.item.json.orderProductDetail += $input.item.json.orderProducts[i] + '\\n' + $input.item.json.orderProducts[i+1] + '\\n \\n ';\n  i+=2;\n} while (i < $input.item.json.orderProducts.length);\n$input.item.json.orderProductDetail = $input.item.json.orderProductDetail.replaceAll('\\n', '\\\\n');\n$input.item.json.orderProductDetail = $input.item.json.orderProductDetail.trim()\n\nconsole.log($input.item.json.orderProductDetail)\n\nreturn $input.item;"},"id":"790e01a8-0f88-47e7-a0dd-e26341351e10","name":"Order Shirt","type":"n8n-nodes-base.code","typeVersion":1,"position":[120,840]},{"parameters":{"mode":"runOnceForEachItem","jsCode":"//Get Ship date\n$input.item.json.orderID = $('Set').all()[0].json.emailSubject.split('Order #')[1];\n$input.item.json.orderID = $input.item.json.orderID.split(')')[0];\n\n$input.item.json.orderTotal = $('Set').all()[0].json.emailContent.split('a refund of ')[1];\n$input.item.json.orderTotal = $input.item.json.orderTotal.split(' for order number')[0];\n\n$input.item.json.shop = $('Set').all()[0].json.emailContent.split('Transaction ID:')[0];\n$input.item.json.index = $input.item.json.shop.lastIndexOf('>');\n$input.item.json.shop = $input.item.json.shop.substring($input.item.json.index + 1, $input.item.json.shop.leght)\n$input.item.json.shop = $input.item.json.shop.trim()\n\nreturn $input.item;"},"id":"ef625c2b-0c42-4cc3-9d89-8913d63ee822","name":"Refund","type":"n8n-nodes-base.code","typeVersion":1,"position":[120,1000]},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/bot/v2/hook/cea8a270-7e98-4dd2-b219-33148d5050ce","sendBody":true,"specifyBody":"json","jsonBody":"={\n    \"msg_type\": \"interactive\",\n    \"card\": {\n        \"config\": {\n            \"wide_screen_mode\": true,\n            \"enable_forward\": true\n        },\n        \"elements\": [\n            {\n                \"tag\": \"div\",\n                \"fields\": [\n                    {\n                        \"is_short\": true,\n                        \"text\": {\n                            \"tag\": \"lark_md\",\n                            \"content\": \"**üè∑ Order ID:**\\n {{ $json[\"orderID\"] }}\"\n                        }\n                    },\n                    {\n                        \"is_short\": true,\n                        \"text\": {\n                            \"tag\": \"lark_md\",\n                            \"content\": \"**üíà Store:**\\n {{ $json[\"shop\"] }}\"\n                        }\n                    },\n                    {\n                        \"is_short\": true,\n                        \"text\": {\n                            \"tag\": \"lark_md\",\n                            \"content\": \"**üí∞ Order Value:**\\n {{ $json[\"orderTotal\"] }}\"\n                        }\n                    }\n                ]\n            }\n        ],\n        \"header\": {\n            \"template\": \"green\",\n            \"title\": {\n                \"content\": \"ü•π Refund order: {{ $json[\"orderID\"] }}, {{ $json[\"orderTotal\"] }} from {{ $json[\"shop\"] }} ü•π\",\n                \"tag\": \"plain_text\"\n            }\n        }\n    }\n}","options":{}},"id":"d1b19ce0-588f-492c-a472-9d180a54d208","name":"Order refund push","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[460,1180]},{"parameters":{"dataType":"string","value1":"={{ $json[\"emailSubject\"] }}","rules":{"rules":[{"operation":"contains","value2":"Etsy Order confirmation"},{"operation":"contains","value2":"You made a sale on Etsy","output":1},{"operation":"contains","value2":"You have issued a refund","output":2}]}},"id":"3377ba18-aff0-4c1f-a9d2-011ab2f421d1","name":"Switch Order","type":"n8n-nodes-base.switch","typeVersion":1,"position":[-80,860],"notes":"0: Digital\n1: Shirt\n2: Refund"},{"parameters":{"dataType":"string","value1":"={{ $json[\"emailTo\"] }}","rules":{"rules":[{"operation":"contains","value2":"snguyenthihong1@gmail.com"},{"operation":"contains","value2":"mylittlesuitcase@hotmail.com","output":1},{"operation":"contains","value2":"Pdxot@outlook.com","output":2},{"operation":"contains","value2":"rockwoodprinting@outlook.com","output":3}]}},"id":"73814cf2-b831-45bb-a108-791735ee8b64","name":"Switch Conversation","type":"n8n-nodes-base.switch","typeVersion":1,"position":[-100,1380],"notesInFlow":false,"notes":"1. Etsy Order: \n- Digital: \"Etsy Order confirmation for\":  transaction@etsy.com\n- Physical: \"You made a sale on Etsy - Ship by\": transaction@etsy.com\n2. Etsy Conversation: \"Etsy Conversation with\": conversation@mail.etsy.com\n3. Deposit: \"Your funds of ‚Ç¨1,206.19 EUR are on the way!\" support@etsy.com\n4.  Kh√°ch m·ªü case: \"Etsy Support commented on your case\": noreply@etsy.com\n5. B·ªã Report: \"Notice of Intellectual Property Infringement\": noreply@etsy.com \n6. ƒê√£ ƒëi·ªÅn Counter: \"We‚Äôve processed your counter notice\": legal@etsy.com"},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/bitable/v1/apps/basusWMkQKs4oizEv3IdwmTW5cb/tables/tbllED6JBrfYxc0s/records/","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $json[\"app_access_token\"] }}"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\n  \"fields\": {\n  \"Order ID\": {{ $node[\"Convert Order Physical info to push Order Total Bitable\"].json[\"orderID\"] }},\n  \"Shop\": \"{{ $node[\"Order Shirt\"].json[\"shopName\"] }}\",\n  \"Type\": \"Physical\",\n  \"Quantity\": {{ $node[\"Convert Order Physical info to push Order Total Bitable\"].json[\"orderQuantity\"] }},\n  \"Value\": {{ $node[\"Convert Order Physical info to push Order Total Bitable\"].json[\"orderTotal\"] }},\n  \"Ship\": \"{{ $node[\"Order Shirt\"].json[\"shipDate\"] }}\",\n  \"Customer Email\": \"{{ $node[\"Order Shirt\"].json[\"buyerEmail\"] }}\"\n      }\n}","options":{}},"id":"8e56b72f-f779-4bc7-945b-e8667fc38626","name":"Push order Physical to Order Total","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[980,800]},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/bitable/v1/apps/basusWMkQKs4oizEv3IdwmTW5cb/tables/tbllED6JBrfYxc0s/records/","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $json[\"app_access_token\"] }}"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\n  \"fields\": {\n  \"Order ID\": {{ $node[\"Convert Order Digital info to push Order Total Bitable\"].json[\"orderID\"] }},\n  \"Shop\": \"{{ $node[\"Order Digital\"].json[\"shopName\"] }}\",\n  \"Type\": \"Digital\",\n  \"Quantity\": {{ $node[\"Convert Order Digital info to push Order Total Bitable\"].json[\"orderQuantity\"] }},\n  \"Value\": {{ $node[\"Convert Order Digital info to push Order Total Bitable\"].json[\"orderTotal\"] }},\n  \"Customer Email\": \"{{ $node[\"Order Digital\"].json[\"buyerEmail\"] }}\"\n      }\n}","options":{}},"id":"e8c30702-de8a-4e61-9d64-c5ba6b1f0177","name":"Push order Digital to Order Total","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[980,460]},{"parameters":{"mode":"runOnceForEachItem","jsCode":"// Add a new field called 'myNewField' to the\n// JSON of the item\n$input.item.json.orderID = Number($('Order Digital').all()[0].json.orderID.replace(\"#\",\"\"));\n$input.item.json.orderTotal = Number($('Order Digital').all()[0].json.orderTotal.replaceAll(\"$\",\"\").replaceAll(\"‚Ç¨\",\"\"));\n$input.item.json.orderQuantity = Number($('Order Digital').all()[0].json.orderQuantity);\n\nreturn $input.item;"},"id":"3ddff51b-c512-4906-8677-f9faa7c6541e","name":"Convert Order Digital info to push Order Total Bitable","type":"n8n-nodes-base.code","typeVersion":1,"position":[720,460]},{"parameters":{"mode":"runOnceForEachItem","jsCode":"// Add a new field called 'myNewField' to the\n// JSON of the item\n$input.item.json.orderID = Number($('Order Shirt').all()[0].json.orderID.replace(\"#\",\"\"));\n$input.item.json.orderTotal = Number($('Order Shirt').all()[0].json.orderTotal.replaceAll(\"$\",\"\").replaceAll(\"‚Ç¨\",\"\"));\n$input.item.json.orderQuantity = Number($('Order Shirt').all()[0].json.orderQuantity);\n\nreturn $input.item;"},"id":"403627e9-5c67-4de8-8499-435634f933e6","name":"Convert Order Physical info to push Order Total Bitable","type":"n8n-nodes-base.code","typeVersion":1,"position":[720,800]},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/auth/v3/app_access_token/internal","sendBody":true,"specifyBody":"json","jsonBody":"{    \"app_id\": \"cli_a31d441721f8500a\",     \"app_secret\": \"pgsa9rESeuH6ltJlMpR8EfbemxaJOnCu\"   }","options":{}},"id":"ee942248-e790-4f61-b198-83b0c913b36b","name":"Get token for Physical from Lark","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[460,800]},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/auth/v3/app_access_token/internal","sendBody":true,"specifyBody":"json","jsonBody":"{    \"app_id\": \"cli_a31d441721f8500a\",     \"app_secret\": \"pgsa9rESeuH6ltJlMpR8EfbemxaJOnCu\"   }","options":{}},"id":"5e014f7a-c06d-42f4-a65c-ca3782659ed5","name":"Get token for Digital from Lark","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[460,460]},{"parameters":{"mode":"runOnceForEachItem","jsCode":"// Add a new field called 'myNewField' to the\n// JSON of the item\n$input.item.json.emailSubject = $('Set').all()[0].json.emailSubject.split('Etsy Conversation with ')[1]\n$input.item.json.buyerName = $input.item.json.emailSubject.split(' from ')[0]\n//Kiem tra tin nhan khach co Store ko\nif ($input.item.json.emailSubject.includes(' from ')) {\n  $input.item.json.buyerStore = $input.item.json.emailSubject.split(' from ')[1]\n  //Gan json ten store\n  $input.item.json.buyerStoreJsonLabel = \"{\\\"is_short\\\":true,\\\"text\\\":{\\\"tag\\\":\\\"lark_md\\\",\\\"content\\\":\\\"**üíà Store:**\\\\n \" + \n$input.item.json.buyerStore + \"\\\"}},\";\n  //Gan json link ve store\n  $input.item.json.buyerStoreJsonAction = \"{\\\"tag\\\":\\\"button\\\",\\\"text\\\":{\\\"content\\\":\\\"View Shop\\\",\\\"tag\\\":\\\"lark_md\\\"},\\\"url\\\":\\\"https://etsy.com/shop/\" + $input.item.json.buyerStore + \"\\\",\\\"type\\\":\\\"default\\\",\\\"value\\\":{}}\"\n}\n\n$input.item.json.buyerMess = $('Set').all()[0].json.emailContent.split('<https://www.etsy.com/conversations/')[2]\n$input.item.json.buyerMess = $input.item.json.buyerMess.split('>')[1]\n$input.item.json.buyerMess = $input.item.json.buyerMess.split('Reply')[0]\n// $input.item.json.buyerMess = JSON.stringify($input.item.json.buyerMess);\n$input.item.json.buyerMess = $input.item.json.buyerMess.replaceAll(/\\n/g, \" \");\n$input.item.json.buyerMess = $input.item.json.buyerMess.replaceAll(\"\\\"\", \" \");\n\n//Kiem tra tin nhan co listing ko\nif ($input.item.json.buyerMess.includes('etsy.com/listing/')) {\n  $input.item.json.buyerListing = $input.item.json.buyerMess.split('etsy.com/listing/')[1]\n  $input.item.json.buyerListing = $input.item.json.buyerListing.split('/')[0]\n  $input.item.json.buyerListingJsonLabel = \"{\\\"is_short\\\":true,\\\"text\\\":{\\\"tag\\\":\\\"lark_md\\\",\\\"content\\\":\\\"**üè∑ Listing:**\\\\n \" + $input.item.json.buyerListing + \"\\\"}},\";\n    //Kiem tra co listing ko, neu ko co them , gan json bt\n    $input.item.json.buyerListingJsonAction = \"{\\\"tag\\\":\\\"button\\\",\\\"text\\\":{\\\"content\\\":\\\"ViewListing\\\",\\\"tag\\\":\\\"lark_md\\\"},\\\"url\\\":\\\"https://etsy.com/listing/\" + $input.item.json.buyerListing + \"\\\",\\\"type\\\":\\\"default\\\",\\\"value\\\":{}}\"\n  \n}\n//Noi json lai thanh message push ve Lark\nif ($input.item.json.buyerListing && $input.item.json.buyerStore) {\n  $input.item.json.messageJson = \"{\\\"msg_type\\\":\\\"interactive\\\",\\\"card\\\":{\\\"config\\\":{\\\"wide_screen_mode\\\":true,\\\"enable_forward\\\":true},\\\"elements\\\":[{\\\"tag\\\":\\\"div\\\",\\\"fields\\\":[ \" + $input.item.json.buyerStoreJsonLabel + $input.item.json.buyerListingJsonLabe + \"{\\\"is_short\\\":false,\\\"text\\\":{\\\"tag\\\":\\\"lark_md\\\",\\\"content\\\":\\\"**üí≠Message:**\\\\n\" + $input.item.json.buyerMess + \"\\\"}}]},{\\\"actions\\\":[\" + $input.item.json.buyerStoreJsonAction + \",\" + $input.item.json.buyerListingJsonAction + \"],\\\"tag\\\":\\\"action\\\"}],\\\"header\\\":{\\\"template\\\":\\\"green\\\",\\\"title\\\":{\\\"content\\\":\\\"üëã RockwoodPrints message: \" + $input.item.json.emailSubject + \" üëã\\\",\\\"tag\\\":\\\"plain_text\\\"}}}}\"\n} else if ($input.item.json.buyerListing) {\n  $input.item.json.messageJson = \"{\\\"msg_type\\\":\\\"interactive\\\",\\\"card\\\":{\\\"config\\\":{\\\"wide_screen_mode\\\":true,\\\"enable_forward\\\":true},\\\"elements\\\":[{\\\"tag\\\":\\\"div\\\",\\\"fields\\\":[ \" + $input.item.json.buyerListingJsonLabe + \"{\\\"is_short\\\":false,\\\"text\\\":{\\\"tag\\\":\\\"lark_md\\\",\\\"content\\\":\\\"**üí≠Message:**\\\\n\" + $input.item.json.buyerMess + \"\\\"}}]},{\\\"actions\\\":[\" + $input.item.json.buyerListingJsonAction + \"],\\\"tag\\\":\\\"action\\\"}],\\\"header\\\":{\\\"template\\\":\\\"green\\\",\\\"title\\\":{\\\"content\\\":\\\"üëã RockwoodPrints message: \" + $input.item.json.emailSubject + \" üëã\\\",\\\"tag\\\":\\\"plain_text\\\"}}}}\"\n} else if ($input.item.json.buyerStore) {\n    $input.item.json.messageJson = \"{\\\"msg_type\\\":\\\"interactive\\\",\\\"card\\\":{\\\"config\\\":{\\\"wide_screen_mode\\\":true,\\\"enable_forward\\\":true},\\\"elements\\\":[{\\\"tag\\\":\\\"div\\\",\\\"fields\\\":[ \" + $input.item.json.buyerStoreJsonLabel + \"{\\\"is_short\\\":false,\\\"text\\\":{\\\"tag\\\":\\\"lark_md\\\",\\\"content\\\":\\\"**üí≠Message:**\\\\n\" + $input.item.json.buyerMess + \"\\\"}}]},{\\\"actions\\\":[\" + $input.item.json.buyerStoreJsonAction + \"],\\\"tag\\\":\\\"action\\\"}],\\\"header\\\":{\\\"template\\\":\\\"green\\\",\\\"title\\\":{\\\"content\\\":\\\"üëã RockwoodPrints message: \" + $input.item.json.emailSubject + \" üëã\\\",\\\"tag\\\":\\\"plain_text\\\"}}}}\"\n} else {\n  $input.item.json.messageJson = \"{\\\"msg_type\\\":\\\"interactive\\\",\\\"card\\\":{\\\"config\\\":{\\\"wide_screen_mode\\\":true,\\\"enable_forward\\\":true},\\\"elements\\\":[{\\\"tag\\\":\\\"div\\\",\\\"fields\\\":[{\\\"is_short\\\":true,\\\"text\\\":{\\\"tag\\\":\\\"lark_md\\\",\\\"content\\\":\\\"**üí≠Message:**\\\\n\" + $input.item.json.buyerMess + \"\\\"}}]}],\\\"header\\\":{\\\"template\\\":\\\"green\\\",\\\"title\\\":{\\\"content\\\":\\\"üëã RockwoodPrints message: \" + $input.item.json.emailSubject + \" üëã\\\",\\\"tag\\\":\\\"plain_text\\\"}}}}\"\n}\n\n\nreturn $input.item;"},"id":"2522b9c9-1c56-4453-b510-ca3607336364","name":"Etsy.Conversation.OTB05","type":"n8n-nodes-base.code","typeVersion":1,"position":[160,1660],"notes":"link etsy truoc: https://anotepad.com/notes/4hg8493d\nlink etsy sau: "},{"parameters":{"mode":"runOnceForEachItem","jsCode":"// Add a new field called 'myNewField' to the\n// JSON of the item\n$input.item.json.emailSubject = $('Set').all()[0].json.emailSubject.split('Etsy Conversation with ')[1]\n$input.item.json.buyerName = $input.item.json.emailSubject.split(' from ')[0]\n//Kiem tra tin nhan khach co Store ko\nif ($input.item.json.emailSubject.includes(' from ')) {\n  $input.item.json.buyerStore = $input.item.json.emailSubject.split(' from ')[1]\n  //Gan json ten store\n  $input.item.json.buyerStoreJsonLabel = \"{\\\"is_short\\\":true,\\\"text\\\":{\\\"tag\\\":\\\"lark_md\\\",\\\"content\\\":\\\"**üíà Store:**\\\\n \" + \n$input.item.json.buyerStore + \"\\\"}},\";\n  //Gan json link ve store\n  $input.item.json.buyerStoreJsonAction = \"{\\\"tag\\\":\\\"button\\\",\\\"text\\\":{\\\"content\\\":\\\"View Shop\\\",\\\"tag\\\":\\\"lark_md\\\"},\\\"url\\\":\\\"https://etsy.com/shop/\" + $input.item.json.buyerStore + \"\\\",\\\"type\\\":\\\"default\\\",\\\"value\\\":{}}\"\n}\n\n$input.item.json.buyerMess = $('Set').all()[0].json.emailContent.split('<https://www.etsy.com/conversations/')[2]\n$input.item.json.buyerMess = $input.item.json.buyerMess.split('>')[1]\n$input.item.json.buyerMess = $input.item.json.buyerMess.split('Reply')[0]\n// $input.item.json.buyerMess = JSON.stringify($input.item.json.buyerMess);\n$input.item.json.buyerMess = $input.item.json.buyerMess.replaceAll(/\\n/g, \" \");\n$input.item.json.buyerMess = $input.item.json.buyerMess.replaceAll(\"\\\"\", \" \");\n\n//Kiem tra tin nhan co listing ko\nif ($input.item.json.buyerMess.includes('etsy.com/listing/')) {\n  $input.item.json.buyerListing = $input.item.json.buyerMess.split('etsy.com/listing/')[1]\n  $input.item.json.buyerListing = $input.item.json.buyerListing.split('/')[0]\n  $input.item.json.buyerListingJsonLabel = \"{\\\"is_short\\\":true,\\\"text\\\":{\\\"tag\\\":\\\"lark_md\\\",\\\"content\\\":\\\"**üè∑ Listing:**\\\\n \" + $input.item.json.buyerListing + \"\\\"}},\";\n    //Kiem tra co listing ko, neu ko co them , gan json bt\n    $input.item.json.buyerListingJsonAction = \"{\\\"tag\\\":\\\"button\\\",\\\"text\\\":{\\\"content\\\":\\\"ViewListing\\\",\\\"tag\\\":\\\"lark_md\\\"},\\\"url\\\":\\\"https://etsy.com/listing/\" + $input.item.json.buyerListing + \"\\\",\\\"type\\\":\\\"default\\\",\\\"value\\\":{}}\"\n  \n}\n//Noi json lai thanh message push ve Lark\nif ($input.item.json.buyerListing && $input.item.json.buyerStore) {\n  $input.item.json.messageJson = \"{\\\"msg_type\\\":\\\"interactive\\\",\\\"card\\\":{\\\"config\\\":{\\\"wide_screen_mode\\\":true,\\\"enable_forward\\\":true},\\\"elements\\\":[{\\\"tag\\\":\\\"div\\\",\\\"fields\\\":[ \" + $input.item.json.buyerStoreJsonLabel + $input.item.json.buyerListingJsonLabe + \"{\\\"is_short\\\":false,\\\"text\\\":{\\\"tag\\\":\\\"lark_md\\\",\\\"content\\\":\\\"**üí≠Message:**\\\\n\" + $input.item.json.buyerMess + \"\\\"}}]},{\\\"actions\\\":[\" + $input.item.json.buyerStoreJsonAction + \",\" + $input.item.json.buyerListingJsonAction + \"],\\\"tag\\\":\\\"action\\\"}],\\\"header\\\":{\\\"template\\\":\\\"green\\\",\\\"title\\\":{\\\"content\\\":\\\"üëã SanSanthLTD message: \" + $input.item.json.emailSubject + \" üëã\\\",\\\"tag\\\":\\\"plain_text\\\"}}}}\"\n} else if ($input.item.json.buyerListing) {\n  $input.item.json.messageJson = \"{\\\"msg_type\\\":\\\"interactive\\\",\\\"card\\\":{\\\"config\\\":{\\\"wide_screen_mode\\\":true,\\\"enable_forward\\\":true},\\\"elements\\\":[{\\\"tag\\\":\\\"div\\\",\\\"fields\\\":[ \" + $input.item.json.buyerListingJsonLabe + \"{\\\"is_short\\\":false,\\\"text\\\":{\\\"tag\\\":\\\"lark_md\\\",\\\"content\\\":\\\"**üí≠Message:**\\\\n\" + $input.item.json.buyerMess + \"\\\"}}]},{\\\"actions\\\":[\" + $input.item.json.buyerListingJsonAction + \"],\\\"tag\\\":\\\"action\\\"}],\\\"header\\\":{\\\"template\\\":\\\"green\\\",\\\"title\\\":{\\\"content\\\":\\\"üëã SanSanthLTD message: \" + $input.item.json.emailSubject + \" üëã\\\",\\\"tag\\\":\\\"plain_text\\\"}}}}\"\n} else if ($input.item.json.buyerStore) {\n    $input.item.json.messageJson = \"{\\\"msg_type\\\":\\\"interactive\\\",\\\"card\\\":{\\\"config\\\":{\\\"wide_screen_mode\\\":true,\\\"enable_forward\\\":true},\\\"elements\\\":[{\\\"tag\\\":\\\"div\\\",\\\"fields\\\":[ \" + $input.item.json.buyerStoreJsonLabel + \"{\\\"is_short\\\":false,\\\"text\\\":{\\\"tag\\\":\\\"lark_md\\\",\\\"content\\\":\\\"**üí≠Message:**\\\\n\" + $input.item.json.buyerMess + \"\\\"}}]},{\\\"actions\\\":[\" + $input.item.json.buyerStoreJsonAction + \"],\\\"tag\\\":\\\"action\\\"}],\\\"header\\\":{\\\"template\\\":\\\"green\\\",\\\"title\\\":{\\\"content\\\":\\\"üëã SanSanthLTD message: \" + $input.item.json.emailSubject + \" üëã\\\",\\\"tag\\\":\\\"plain_text\\\"}}}}\"\n} else {\n  $input.item.json.messageJson = \"{\\\"msg_type\\\":\\\"interactive\\\",\\\"card\\\":{\\\"config\\\":{\\\"wide_screen_mode\\\":true,\\\"enable_forward\\\":true},\\\"elements\\\":[{\\\"tag\\\":\\\"div\\\",\\\"fields\\\":[{\\\"is_short\\\":true,\\\"text\\\":{\\\"tag\\\":\\\"lark_md\\\",\\\"content\\\":\\\"**üí≠Message:**\\\\n\" + $input.item.json.buyerMess + \"\\\"}}]}],\\\"header\\\":{\\\"template\\\":\\\"green\\\",\\\"title\\\":{\\\"content\\\":\\\"üëã SanSanthLTD message: \" + $input.item.json.emailSubject + \" üëã\\\",\\\"tag\\\":\\\"plain_text\\\"}}}}\"\n}\n\n// $input.item.json.messageJson = JSON.parse($input.item.json.messageJson);\n\n\nreturn $input.item;"},"id":"b9997396-b0a5-4daf-900f-7b027aff1258","name":"Etsy.Conversation.UK40","type":"n8n-nodes-base.code","typeVersion":1,"position":[160,1240],"notes":"link etsy truoc: https://anotepad.com/notes/4hg8493d\nlink etsy sau: "}],"connections":{"Set":{"main":[[{"node":"Switch Etsy Email","type":"main","index":0}]]},"Etsy Gmail Trigger":{"main":[[{"node":"Set","type":"main","index":0}]]},"Switch Etsy Email":{"main":[[{"node":"Switch Order","type":"main","index":0}],[{"node":"Switch Conversation","type":"main","index":0}],[{"node":"Etsy.Deposit","type":"main","index":0}],[{"node":"HTTP Request1","type":"main","index":0}]]},"Etsy.Conversation.DE01":{"main":[[{"node":"Push to Lark message1","type":"main","index":0}]]},"Etsy.Conversation.OTB01":{"main":[[{"node":"Push to Lark message1","type":"main","index":0}]]},"Etsy.Deposit":{"main":[[{"node":"HTTP Request","type":"main","index":0}]]},"Order Digital":{"main":[[{"node":"Order Digital push","type":"main","index":0},{"node":"Get token for Digital from Lark","type":"main","index":0}]]},"Order Shirt":{"main":[[{"node":"Order Shirt push","type":"main","index":0},{"node":"Get token for Physical from Lark","type":"main","index":0}]]},"Refund":{"main":[[{"node":"Order refund push","type":"main","index":0}]]},"Switch Order":{"main":[[{"node":"Order Digital","type":"main","index":0}],[{"node":"Order Shirt","type":"main","index":0}],[{"node":"Refund","type":"main","index":0}]]},"Switch Conversation":{"main":[[{"node":"Etsy.Conversation.UK40","type":"main","index":0}],[{"node":"Etsy.Conversation.DE01","type":"main","index":0}],[{"node":"Etsy.Conversation.OTB01","type":"main","index":0}],[{"node":"Etsy.Conversation.OTB05","type":"main","index":0}]]},"Convert Order Digital info to push Order Total Bitable":{"main":[[{"node":"Push order Digital to Order Total","type":"main","index":0}]]},"Convert Order Physical info to push Order Total Bitable":{"main":[[{"node":"Push order Physical to Order Total","type":"main","index":0}]]},"Get token for Physical from Lark":{"main":[[{"node":"Convert Order Physical info to push Order Total Bitable","type":"main","index":0}]]},"Get token for Digital from Lark":{"main":[[{"node":"Convert Order Digital info to push Order Total Bitable","type":"main","index":0}]]},"Etsy.Conversation.OTB05":{"main":[[{"node":"Push to Lark message1","type":"main","index":0}]]},"Etsy.Conversation.UK40":{"main":[[{"node":"Push to Lark message1","type":"main","index":0}]]}},"settings":{},"staticData":{"node:Etsy Gmail Trigger":{"possibleDuplicates":["18997dbd81dddf35"],"lastTimeChecked":1690469907}},"pinData":{},"versionId":"43dac0a9-a3a8-4378-a316-4ce5a1e7d3a1","triggerCount":1,"tags":[{"createdAt":"2023-04-07T10:40:23.898Z","updatedAt":"2023-04-07T10:40:23.898Z","id":"13","name":"Talo Media"}]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-04-11T08:09:03.717Z","updatedAt":"2023-04-11T08:09:03.717Z","id":"62","name":"My workflow 6","active":false,"nodes":[{"parameters":{"httpMethod":"POST","path":"path-interview","options":{}},"id":"7859433a-fd52-4729-bcec-f2028b96ea9c","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[620,280],"webhookId":"1f99812f-1d86-49a2-91be-c37f87c3a4fe"},{"parameters":{"options":{}},"id":"045931a8-0147-4f39-816f-95fd1f5f5e0d","name":"Send Email","type":"n8n-nodes-base.emailSend","typeVersion":2,"position":[840,280]}],"connections":{"Webhook":{"main":[[{"node":"Send Email","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{},"versionId":"f34d16bd-45a7-4d77-aecb-b5fbbd55f5d8","triggerCount":0,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-04-13T09:24:55.389Z","updatedAt":"2023-07-15T02:53:35.000Z","id":"63","name":"Template convert data to Bitable format","active":false,"nodes":[{"parameters":{"method":"POST","url":"=https://open.larksuite.com/open-apis/bitable/v1/apps/{{ $input.item.json[\"appId\"] }}/tables/{{ $input.item.json[\"tableId\"] }}/records/batch_create","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $node[\"Get tenant access token\"].json.tenant_access_token }}"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\"records\":{{ JSON.stringify($('[Raw user list] Convert to Lark Base format').first().json.records) }}}","options":{}},"id":"b3539d41-64fc-4b6a-8081-a53b9c37fd54","name":"[Raw user list] Add records to Bitable","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[1800,520]},{"parameters":{"jsCode":"let input = $('Get all users').first().json.data;\n\n// Convert to Lark Base format\nlet records = input.pageLists.map((user) => {\n  let fields = {\n    id: user.id,\n    firstName: user.firstName,\n    lastName: user.lastName,\n    email: {\n      text: user.email,\n      link: user.email,\n    },\n    gender: user.gender,\n    phoneNumber: user.phoneNumber,\n    userType: user.userType,\n    userCode: user.userCode,\n  };\n  return { fields };\n});\n\nlet result = { json: { records } };\nreturn result;\n"},"id":"b3075f71-7d83-406a-806a-4262c017d195","name":"[Raw user list] Convert to Lark Base format","type":"n8n-nodes-base.code","typeVersion":1,"position":[1280,520]},{"parameters":{"values":{"string":[{"name":"appId","value":"your_base_file_app_id"},{"name":"tableId","value":"your_base_file_table_id"}]},"options":{}},"id":"e399531a-5b3f-46b6-bf0b-5809e6bdca2e","name":"Set config Raw user list","type":"n8n-nodes-base.set","typeVersion":2,"position":[1500,520]}],"connections":{"[Raw user list] Convert to Lark Base format":{"main":[[{"node":"Set config Raw user list","type":"main","index":0}]]},"Set config Raw user list":{"main":[[{"node":"[Raw user list] Add records to Bitable","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{},"versionId":"b983df21-073a-455e-9d2a-2f92e5c175eb","triggerCount":0,"tags":[{"createdAt":"2023-04-13T09:24:58.649Z","updatedAt":"2023-06-13T07:54:39.069Z","id":"14","name":"Template"}]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-04-13T09:26:38.465Z","updatedAt":"2023-06-19T07:16:33.000Z","id":"64","name":"Template, get data from Bitable & delete all","active":false,"nodes":[{"parameters":{"url":"https://open.larksuite.com/open-apis/bitable/v1/apps/:bitableId/tables/:tableId/records","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $node[\"Get Lark tenant access token\"].json.tenant_access_token }}"}]},"options":{}},"id":"af3e9460-6c4f-49ed-bdbb-f382fb715ecc","name":"Get all records","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[1120,500]},{"parameters":{"conditions":{"number":[{"value1":"={{ $json.data.items?.length }}","operation":"larger"}]}},"id":"db8d0caa-6085-4f93-87af-ef63393fa22e","name":"Found record","type":"n8n-nodes-base.if","typeVersion":1,"position":[1340,500]},{"parameters":{"jsCode":"let input = $('Get all records').first().json.data.items;\nlet records=[]\nif (input){\nrecords   = input.map((record) => {\n  return record.record_id\n})\n}\n\n\nreturn {json: {records}};"},"id":"3386913a-f06c-4b86-b3e5-fe95f09bcb53","name":"Get record id","type":"n8n-nodes-base.code","typeVersion":1,"position":[1580,480]},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/bitable/v1/apps/:bitableId/tables/:tableId/records/batch_delete","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $node[\"Get Lark tenant access token\"].json.tenant_access_token }}"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\"records\":{{ JSON.stringify($node[\"Get record id\"].json.records) }} }","options":{}},"id":"2bcc5dc8-6032-41b7-bc7f-c5a46758a2ce","name":"Delete records","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[1780,480]}],"connections":{"Get all records":{"main":[[{"node":"Found record","type":"main","index":0}]]},"Found record":{"main":[[{"node":"Get record id","type":"main","index":0}]]},"Get record id":{"main":[[{"node":"Delete records","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{},"versionId":"13acc009-6297-40fc-b527-52a69f4e455b","triggerCount":0,"tags":[{"createdAt":"2023-04-13T09:24:58.649Z","updatedAt":"2023-06-13T07:54:39.069Z","id":"14","name":"Template"}]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-04-15T03:03:41.655Z","updatedAt":"2023-04-15T03:04:49.000Z","id":"65","name":"Test MS SQL","active":false,"nodes":[{"parameters":{"authentication":"headerAuth","path":"746d373c-e98d-4ef3-bff7-ed24883b27d8","options":{}},"id":"3f00df4b-f52d-4351-84dc-5218eb079008","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[740,440],"webhookId":"746d373c-e98d-4ef3-bff7-ed24883b27d8","credentials":{"httpHeaderAuth":{"id":"13","name":"Header Auth account"}}},{"parameters":{"operation":"executeQuery","query":"Select * from [khangnto_lark].[admin].[report_sales_by_date]"},"id":"56803729-7a58-4cff-9c05-8eac82d4cb33","name":"Microsoft SQL","type":"n8n-nodes-base.microsoftSql","typeVersion":1,"position":[960,440],"credentials":{"microsoftSql":{"id":"26","name":"Microsoft SQL account"}}}],"connections":{"Webhook":{"main":[[{"node":"Microsoft SQL","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{"Webhook":[{"json":{"name":"First item","code":1}},{"json":{"name":"Second item","code":2}}]},"versionId":"ce9a8f56-9c35-4950-ba8e-c1e6ad1c8e9e","triggerCount":0,"tags":[{"createdAt":"2023-04-15T03:04:39.651Z","updatedAt":"2023-04-15T03:04:39.651Z","id":"15","name":"MSSQL"}]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-04-18T08:51:00.702Z","updatedAt":"2023-04-20T14:21:36.000Z","id":"69","name":"Shopify flow","active":true,"nodes":[{"parameters":{"rule":{"interval":[{"triggerAtHour":15}]}},"id":"2a816d9c-c467-40e3-9e86-194510d42c9f","name":"Schedule Trigger","type":"n8n-nodes-base.scheduleTrigger","typeVersion":1,"position":[80,120]},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/auth/v3/app_access_token/internal","sendBody":true,"specifyBody":"json","jsonBody":"{   \"app_id\": \"cli_a4b4819701b8902f\",   \"app_secret\": \"c2AKO70ot0MpDtH36TPpmhITkjr6tGOy\" }","options":{}},"id":"35aff4ad-1bf8-4e54-a0c8-22be650c452b","name":"L·∫•y tenant","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[660,120]},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/bitable/v1/apps/PwADb4L7kauBwUsKwUAlm1bggnd/tables/tblTJ4yLfdsBX16U/records/batch_create","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $json[\"tenant_access_token\"] }}"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\"records\":{{ JSON.stringify($node[\"code\"].json[\"records\"]) }}}\n","options":{}},"id":"cb495296-7365-4a3c-8552-c67d0609ae51","name":"B·∫Øn v·ªÅ Base","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[880,120]},{"parameters":{"url":"=https://489f0e86bb73d141993e53799a1e9985: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@coollightshop-1077.myshopify.com/admin/api/2021-10/orders.json?created_at_min=2023-04-{{ $json[\"Day of month\"]-1 }}T00:00:00&created_at_max=2023-04-{{ $json[\"Day of month\"]-1 }}T23:59:59","options":{}},"id":"840d308f-770a-4949-a8af-bdbd78c5b7af","name":"L·∫•y d·ªØ li·ªáu Shopify","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[260,120]},{"parameters":{"jsCode":"// Loop over input items and add a new field\n// called 'myNewField' to the JSON of each one\nconst records = [];\n\nfor (const item of $input.all()) {\n  for (const order of item.json.orders) {\n      for (const lineItem of order.line_items){\n    const fields = {\n      Name: `${order.name}`,\n      Email: order.contact_email,\n      FinancialStatus: order.financial_status,\n      FulfillmentStatus: order.fulfillment_status,\n      Currency: order.currency,\n      Subtotal: Number(order.subtotal_price),\n      Shipping: Number(order.total_shipping_price_set.shop_money.amount),\n      Taxes: Number(order.current_total_tax),\n      Total: Number(order.total_price),\n      DiscountAmount: Number(order.current_total_discounts),\n      Createdat: order.created_at,\n      Lineitemquantity: lineItem.quantity,\n      Lineitemname: lineItem.name,\n      Lineitemprice: Number(lineItem.price),\n      Lineitemsku: lineItem.sku,\n      Lineitemrequiresshipping: lineItem.requies_shipping,\n      Lineitemtaxable: lineItem.taxable.toString(),\n      Lineitemfulfillmentstatus: lineItem.fulfillment_status,\n              BillingName: `${order.billing_address.first_name} ${order.billing_address.last_name}`,\n      BillingStreet:`${order.billing_address.address1}`,\n      BillingAddress1:`${order.billing_address.address1}`,\n      BillingCity: `${order.billing_address.city}`,\n      BillingZip:`${order.billing_address.zip}`,\n      BillingProvince: `${order.billing_address.province}`,\n      BillingCountry: `${order.billing_address.country}`,\n\n\n    };\n    \n    records.push({ fields });\n      }\n  \n      }\n}\n\n//return { records };\n\nlet result = { json: { records } };\nreturn result;\n\n\n\n"},"id":"5230bd44-5c87-4f12-82a0-43c43021b8bf","name":"code","type":"n8n-nodes-base.code","typeVersion":1,"position":[460,120]},{"parameters":{"jsCode":"let input = $('Get all users').first().json.data;\n\n// Get calls data\nlet records = input.pageLists.map((user) => {\n  let fields = {\n    id: user.id,\n    firstName: user.firstName,\n    lastName: user.lastName,\n    email: {\n      text: user.email,\n      link: user.email,\n    },\n    gender: user.gender,\n    phoneNumber: user.phoneNumber,\n    userType: user.userType,\n    userCode: user.userCode,\n  };\n  return { fields };\n});\n\nlet result = { json: { records } };\nreturn result;\n"},"id":"23cd0bb3-dc36-420b-9669-b8ff282a9dbf","name":"[Raw user list] Convert to Lark format","type":"n8n-nodes-base.code","typeVersion":1,"position":[660,340]},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/bitable/v1/apps/SJ5VbAzXOa9ub5sEOZdl1tPvgFf/tables/tblpf80ymKmM8V8k/records/batch_create","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $node[\"Get tenant access token\"].json.tenant_access_token }}"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\"records\":{{ JSON.stringify($('[Raw user list] Convert to Lark format').first().json.records) }}}","options":{}},"id":"8efa1a85-6ec6-4b5b-9bf4-fa01b04e5458","name":"[Raw user list] Add records to Bitable","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[860,340]}],"connections":{"Schedule Trigger":{"main":[[{"node":"L·∫•y d·ªØ li·ªáu Shopify","type":"main","index":0}]]},"L·∫•y tenant":{"main":[[{"node":"B·∫Øn v·ªÅ Base","type":"main","index":0}]]},"L·∫•y d·ªØ li·ªáu Shopify":{"main":[[{"node":"code","type":"main","index":0}]]},"code":{"main":[[{"node":"L·∫•y tenant","type":"main","index":0}]]},"[Raw user list] Convert to Lark format":{"main":[[{"node":"[Raw user list] Add records to Bitable","type":"main","index":0}]]}},"settings":{},"staticData":{"node:Schedule Trigger":{"recurrencyRules":[]}},"pinData":{},"versionId":"07279696-d0cd-4b78-a9f3-b00794bdab10","triggerCount":1,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-04-20T17:00:51.887Z","updatedAt":"2023-04-23T04:32:13.000Z","id":"72","name":"paypal","active":false,"nodes":[{"parameters":{"rule":{"interval":[{}]}},"id":"8871b20a-0980-4ccf-aee4-76b17f116500","name":"Schedule Trigger","type":"n8n-nodes-base.scheduleTrigger","typeVersion":1,"position":[880,420]},{"parameters":{"method":"POST","url":"https://api-m.sandbox.paypal.com/v1/oauth2/token","sendHeaders":true,"headerParameters":{"parameters":[{"name":"authorization","value":"Basic QVdXMVRqZWNUU1pBZ2ZYRU1uemtvN2ZSSV9vSzhFQWNwQ0NMeTc1U0dzRU9kaVpSRW9SSHBhRmxjMS01MEQ2enRFdGw5UE54SmJQUHlMSWk6RUVCZHVTUEJXRy1fUUxuMGthTEVxbXlxTG1mZHo3OEc3MkFxV0N5azNvbUlBSTlhcS03Q0NTOWRrV1VzSURyOFFETzBibTg5c1NnNUxGNzg="}]},"sendBody":true,"contentType":"form-urlencoded","bodyParameters":{"parameters":[{"name":"grant_type","value":"client_credentials"}]},"options":{}},"id":"fc17ee73-2090-41a1-a8f1-7c4349f48ab7","name":"HTTP Request","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[1100,420]}],"connections":{"Schedule Trigger":{"main":[[{"node":"HTTP Request","type":"main","index":0}]]},"HTTP Request":{"main":[[]]}},"settings":{},"staticData":null,"pinData":{},"versionId":"6a017bc7-0179-42b7-8c75-5327bfb98e6c","triggerCount":0,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-04-22T04:48:56.975Z","updatedAt":"2023-06-14T03:25:18.000Z","id":"73","name":"Send Lark mail","active":false,"nodes":[{"parameters":{"httpMethod":"POST","path":"send-email-doanhthu1","options":{}},"id":"35cb6a86-65dd-4a3e-aa61-8e93c571cb54","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[700,380],"webhookId":"81b9df57-4df0-43a1-9fef-b702695bcacb"},{"parameters":{"fromEmail":"MIXUE <long@mixuevn.com>","toEmail":"={{ $json[\"body\"][\"email\"] }}\n\n","subject":"=H·∫†CH TO√ÅN DOANH THU C·ª¨A H√ÄNG","text":"=Dear {{ $json.body.cdt }}!\n1) Vui l√≤ng xem doanh thu c·ª≠a h√†ng: {{ $json[\"body\"][\"cua_hang_1\"] }} theo file ƒë√≠nh k√®m: {{ $json[\"body\"][\"link_1\"] }}.\n2) Vui l√≤ng xem doanh thu c·ª≠a h√†ng: {{ $json[\"body\"][\"cua_hang_2\"] }} theo file ƒë√≠nh k√®m: {{ $json[\"body\"][\"link_2\"] }}.\n3) Vui l√≤ng xem doanh thu c·ª≠a h√†ng: {{ $json[\"body\"][\"cua_hang_3\"] }} theo file ƒë√≠nh k√®m: {{ $json[\"body\"][\"link_3\"] }}.\n4) Vui l√≤ng xem doanh thu c·ª≠a h√†ng: {{ $json[\"body\"][\"cua_hang_4\"] }} theo file ƒë√≠nh k√®m: {{ $json[\"body\"][\"link_4\"] }}.\n5) Vui l√≤ng xem doanh thu c·ª≠a h√†ng: {{ $json[\"body\"][\"cua_hang_5\"] }} theo file ƒë√≠nh k√®m: {{ $json[\"body\"][\"link_5\"] }}.\n6) Vui l√≤ng xem doanh thu c·ª≠a h√†ng: {{ $json[\"body\"][\"cua_hang_6\"] }} theo file ƒë√≠nh k√®m: {{ $json[\"body\"][\"link_6\"] }}.\n7) Vui l√≤ng xem doanh thu c·ª≠a h√†ng: {{ $json[\"body\"][\"cua_hang_7\"] }} theo file ƒë√≠nh k√®m: {{ $json[\"body\"][\"link_7\"] }}.\n8) Vui l√≤ng xem doanh thu c·ª≠a h√†ng: {{ $json[\"body\"][\"cua_hang_8\"] }} theo file ƒë√≠nh k√®m: {{ $json[\"body\"][\"link_8\"] }}.\n9) Vui l√≤ng xem doanh thu c·ª≠a h√†ng: {{ $json[\"body\"][\"cua_hang_9\"] }} theo file ƒë√≠nh k√®m: {{ $json[\"body\"][\"link_9\"] }}.\n10) Vui l√≤ng xem doanh thu c·ª≠a h√†ng: {{ $json[\"body\"][\"cua_hang_10\"] }} theo file ƒë√≠nh k√®m: {{ $json[\"body\"][\"link_10\"] }}.\n11) Vui l√≤ng xem doanh thu c·ª≠a h√†ng: {{ $json[\"body\"][\"cua_hang_11\"] }} theo file ƒë√≠nh k√®m: {{ $json[\"body\"][\"link_11\"] }}.\n12) Vui l√≤ng xem doanh thu c·ª≠a h√†ng: {{ $json[\"body\"][\"cua_hang_12\"] }} theo file ƒë√≠nh k√®m: {{ $json[\"body\"][\"link_12\"] }}.\n{{ $json[\"body\"][\"link_11\"] }}.\n13) Vui l√≤ng xem doanh thu c·ª≠a h√†ng: {{ $json[\"body\"][\"cua_hang_13\"] }} theo file ƒë√≠nh k√®m: {{ $json[\"body\"][\"link_13\"] }}.\nXin l∆∞u √Ω: Link download file ch·ªâ t·ªìn t·∫°i trong 24h, vui l√≤ng download tr∆∞·ªõc khi link h·∫øt h·∫°n!\nN·∫øu c√≥ th·∫Øc m·∫Øc vui l√≤ng li√™n h·ªá v·ªõi L∆∞u Ho√†ng Long, sƒët: 0912.398.152\nTr√¢n tr·ªçng c·∫£m ∆°n!\n ","options":{}},"id":"d5e70739-7e0b-4c0f-b7be-68f26398c0ff","name":"Send Email","type":"n8n-nodes-base.emailSend","typeVersion":2,"position":[920,380],"credentials":{"smtp":{"id":"30","name":"SMTP account 4"}}}],"connections":{"Webhook":{"main":[[{"node":"Send Email","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{},"versionId":"9ded34cf-226f-46c9-9010-4de7fe1e46e8","triggerCount":1,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-04-22T08:36:01.231Z","updatedAt":"2023-05-05T17:04:13.000Z","id":"75","name":"Save Bank Transaction to Base","active":true,"nodes":[{"parameters":{"httpMethod":"POST","path":"save-bank-transaction","options":{}},"id":"6e6e6b31-21f2-45a7-9cf6-645c51c385a1","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[1140,600],"webhookId":"e1971204-e315-4256-8e06-5cce19050212"},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/auth/v3/app_access_token/internal","sendBody":true,"specifyBody":"json","jsonBody":"={\n  \"app_id\": \"cli_a4d8aec809b8d00a\",\n  \"app_secret\": \"By50sJW5xI5EsIFk1uuNidTS5rYaDGvY\"\n}\n","options":{}},"id":"179073f5-6aa1-43d9-9c76-fca2100a08d2","name":"HTTP Request","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[1360,600]},{"parameters":{"method":"POST","url":"=https://open.larksuite.com/open-apis/bitable/v1/apps/Q7RAb2WkHa24lCsVzTXuib7zsKh/tables/tbl2nfbJ4KiMlmWo/records/","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $json[\"app_access_token\"] }}"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\n  \"fields\": {\n     \"Ma giao dich bank\": \"{{ $node[\"Webhook\"].json[\"body\"][\"data\"][0][\"tid\"] }}\",\n     \"Noi Dung\": \"{{$node[\"Webhook\"].json[\"body\"][\"data\"][0][\"description\"]}}\",\n     \"So Tien\": {{ $node[\"Webhook\"].json[\"body\"][\"data\"][0][\"amount\"] }},\n     \"So Du Hien Tai\": {{ $node[\"Webhook\"].json[\"body\"][\"data\"][0][\"cusum_balance\"] }},\n     \"Ngan Hang Nhan Tien\": \"{{ $node[\"Webhook\"].json[\"body\"][\"data\"][0][\"bankName\"] }}\",\n     \"So TK Nhan Tien\": \"{{ $node[\"Webhook\"].json[\"body\"][\"data\"][0][\"bank_sub_acc_id\"] }}\",\n     \"Thoi gian giao dich\": \"{{ $node[\"Webhook\"].json[\"body\"][\"data\"][0][\"when\"] }}\",\n     \"Ma Giao dich Casso\": \"{{ $node[\"Webhook\"].json[\"body\"][\"data\"][0][\"id\"] }}\"\n  }\n}","options":{}},"id":"cbcd0215-4a93-4b3f-aa33-d6fdc276d3b3","name":"HTTP Request1","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[1620,560]}],"connections":{"Webhook":{"main":[[{"node":"HTTP Request","type":"main","index":0}]]},"HTTP Request":{"main":[[{"node":"HTTP Request1","type":"main","index":0}]]},"HTTP Request1":{"main":[[]]}},"settings":{},"staticData":null,"pinData":{},"versionId":"3394e431-e3f0-4614-85a7-be08e731f11c","triggerCount":1,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-04-23T13:04:55.248Z","updatedAt":"2023-04-25T04:49:24.000Z","id":"76","name":"Affiliate 01# Webhook - CopyGGDrive(fromtemplate) - Respond_FileID&URL","active":false,"nodes":[{"parameters":{"httpMethod":"POST","path":"19be3fe6-352e-4eea-946a-da7662f238ce","responseMode":"responseNode","options":{}},"id":"c05ef03d-9263-4700-af61-8c11e465be5a","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[820,400],"webhookId":"19be3fe6-352e-4eea-946a-da7662f238ce"},{"parameters":{"resource":"spreadsheet","title":"=Publisher_{{ $json.body.name }}_ {{ $json.body.ref_code }}","sheetsUi":{"sheetValues":[{"title":"=Dashboard"}]},"options":{}},"id":"9790e970-3b13-4fd5-890e-22982f766b77","name":"Google Sheets","type":"n8n-nodes-base.googleSheets","typeVersion":3,"position":[1660,660],"credentials":{"googleSheetsOAuth2Api":{"id":"35","name":"Google Sheets ngothaikhang@gmail.com"}},"disabled":true},{"parameters":{"operation":"copy","fileId":{"__rl":true,"value":"1FW4KRt9s6jp-LyVMKngAwc8UTk6xiODBxC9WYQ1rCBo","mode":"list","cachedResultName":"Template of Publisher","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1FW4KRt9s6jp-LyVMKngAwc8UTk6xiODBxC9WYQ1rCBo/edit?usp=drivesdk"},"options":{"name":"=Publisher_ {{ $json.body.name }}_ {{ $json.body.ref_code }}","parents":["1vyE3eZUMV0VOOY9b2BTzAQzXbSnoZWd_"]}},"id":"0c3de9cc-3324-4d7e-ba94-6e1f8149ab7c","name":"Google Drive","type":"n8n-nodes-base.googleDrive","typeVersion":2,"position":[1060,400],"credentials":{"googleDriveOAuth2Api":{"id":"36","name":"Google Drive account"}}},{"parameters":{"respondWith":"json","responseBody":"={\n\"status\":\"ok\",\n\"dash_id\":\"{{ $json[\"id\"] }}\",\n\"dash_filename\":\"{{ $json[\"name\"] }}\",\n\"dash_filelink\":\"https://docs.google.com/spreadsheets/d/{{ $json[\"id\"] }}\" \n}","options":{"responseCode":200}},"id":"504750a5-5cc9-47e8-a2e6-73f601583265","name":"Respond to Webhook","type":"n8n-nodes-base.respondToWebhook","typeVersion":1,"position":[1280,400]}],"connections":{"Webhook":{"main":[[{"node":"Google Drive","type":"main","index":0}]]},"Google Drive":{"main":[[{"node":"Respond to Webhook","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{},"versionId":"c85cd91a-06c9-40f0-8056-a95865f0cee4","triggerCount":0,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-04-24T04:00:42.259Z","updatedAt":"2023-04-24T04:00:42.259Z","id":"77","name":"My workflow 7","active":false,"nodes":[{"parameters":{"httpMethod":"POST","path":"2404","options":{}},"id":"ba0cd03f-7563-4c1b-b16f-290e4e22fbae","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[580,300],"webhookId":"5efce8e2-7064-4002-8fa2-04a8cb18e9ef"}],"connections":{},"settings":{},"staticData":null,"pinData":{},"versionId":"4510bc86-82bd-4d24-9efe-86e3176533c4","triggerCount":0,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-04-25T04:50:05.549Z","updatedAt":"2023-04-25T06:48:01.000Z","id":"78","name":"Affiliate 02# Khi c√≥ new Lead - Update record v√†o GGSheet","active":true,"nodes":[{"parameters":{"httpMethod":"POST","path":"043348b4-bca3-4244-84c3-d0cb8763380e","options":{}},"id":"722744ee-9c35-4921-92e7-d562bc94ff0b","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[820,400],"webhookId":"043348b4-bca3-4244-84c3-d0cb8763380e"},{"parameters":{"operation":"append","documentId":{"__rl":true,"value":"={{ $json.body.dash_id }}","mode":"id"},"sheetName":{"__rl":true,"value":"0","mode":"id"},"fieldsUi":{"fieldValues":[{"fieldId":"Lead_ID","fieldValue":"={{ $json.body.lead_id }}"},{"fieldId":"H·ªç t√™n Lead","fieldValue":"={{ $json.body.name }}"},{"fieldId":"S·ªë ƒëi·ªán tho·∫°i","fieldValue":"={{ $json.body.phone }}"},{"fieldId":"Email","fieldValue":"={{ $json.body.email }}"},{"fieldId":"G√≥i","fieldValue":"={{ $json.body.goi }}"},{"fieldId":"T·∫∑ng (th√°ng)","fieldValue":"={{ $json.body.tang_thang }}"},{"fieldId":"Tr·∫°ng th√°i thanh to√°n","fieldValue":"={{ $json.body.payment_status }}"},{"fieldId":"Tr·∫°ng th√°i n√¢ng c·∫•p","fieldValue":"={{ $json.body.upgrade_status }}"},{"fieldId":"M√£ khuy·∫øn m√£i","fieldValue":"={{ $json.body.promotion_code }}"},{"fieldId":"Ng√†y n√¢ng c·∫•p","fieldValue":"={{ $json.body.upgrade_date }}"},{"fieldId":"Tr·∫°ng th√°i ƒë·ªëi so√°t","fieldValue":"={{ $json.body.recon_status }}"},{"fieldId":"K·ª≥ thanh to√°n","fieldValue":"={{ $json.body.ky_thanhtoan }}"},{"fieldId":"L·∫ßn c·∫≠p nh·∫≠t cu√¥i","fieldValue":"={{ $json.body.last_updated }}"}]},"options":{}},"id":"11ecd247-06ab-4290-85b5-c50438c00c89","name":"Google Sheets","type":"n8n-nodes-base.googleSheets","typeVersion":3,"position":[1040,400],"credentials":{"googleSheetsOAuth2Api":{"id":"35","name":"Google Sheets ngothaikhang@gmail.com"}}}],"connections":{"Webhook":{"main":[[{"node":"Google Sheets","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{},"versionId":"856f4d22-7efe-4cda-be1c-6ed0eb77144b","triggerCount":1,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-04-25T06:47:45.052Z","updatedAt":"2023-04-25T07:46:50.000Z","id":"79","name":"Affiliate #02.2 Khi update Lead - Update record v√†o GGSheet","active":true,"nodes":[{"parameters":{"httpMethod":"POST","path":"39a6e0a1-c109-40d9-b9a8-2ccc55ce800e","options":{}},"id":"78af12e0-5253-4aec-8800-90ca45f049c6","name":"Webhook (khi update record)","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[820,600],"webhookId":"b00e2491-e2bd-4719-b2b1-5fed537b2d77"},{"parameters":{"operation":"update","documentId":{"__rl":true,"value":"={{ $json.body.dash_id }}","mode":"id"},"sheetName":{"__rl":true,"value":"0","mode":"id"},"columnToMatchOn":"Lead_ID","valueToMatchOn":"={{ $json.body.lead_id }}","fieldsUi":{"values":[{"column":"H·ªç t√™n Lead","fieldValue":"={{ $json.body.name }}"},{"column":"S·ªë ƒëi·ªán tho·∫°i","fieldValue":"={{ $json.body.phone }}"},{"column":"Email","fieldValue":"={{ $json.body.email }}"},{"column":"G√≥i","fieldValue":"={{ $json.body.goi }}"},{"column":"T·∫∑ng (th√°ng)","fieldValue":"={{ $json.body.tang_thang }}"},{"column":"Tr·∫°ng th√°i thanh to√°n","fieldValue":"={{ $json.body.payment_status }}"},{"column":"Tr·∫°ng th√°i n√¢ng c·∫•p","fieldValue":"={{ $json.body.upgrade_status }}"},{"column":"M√£ khuy·∫øn m√£i","fieldValue":"={{ $json.body.promotion_code }}"},{"column":"Ng√†y n√¢ng c·∫•p","fieldValue":"={{ $json.body.upgrade_date }}"},{"column":"Tr·∫°ng th√°i ƒë·ªëi so√°t","fieldValue":"={{ $json.body.recon_status }}"},{"column":"K·ª≥ thanh to√°n","fieldValue":"={{ $json.body.ky_thanhtoan }}"},{"column":"L·∫ßn c·∫≠p nh·∫≠t cu√¥i","fieldValue":"={{ $json.body.last_updated }}"}]},"options":{}},"id":"98f3d5ef-8f52-4242-8889-10dfa58764e9","name":"Google Sheets1","type":"n8n-nodes-base.googleSheets","typeVersion":3,"position":[1060,600],"credentials":{"googleSheetsOAuth2Api":{"id":"35","name":"Google Sheets ngothaikhang@gmail.com"}}}],"connections":{"Webhook (khi update record)":{"main":[[{"node":"Google Sheets1","type":"main","index":0}]]}},"settings":{},"staticData":{"node:Schedule Trigger":{"recurrencyRules":[]}},"pinData":{},"versionId":"62c45dc2-5f93-4c2d-9127-c1ccacb05c2e","triggerCount":1,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-04-26T06:30:21.139Z","updatedAt":"2023-04-26T07:06:34.000Z","id":"80","name":"Affiliate #02.3a Push qua sheet th√¥ng tin li√™n h·ªá (ƒë·ªÉ test form)","active":false,"nodes":[{"parameters":{"httpMethod":"POST","path":"cde1d3d4-a662-485c-95c1-7fb13b4a3f18","options":{}},"id":"727009b1-b680-4b95-8f80-e64136b9d4e2","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[820,400],"webhookId":"cde1d3d4-a662-485c-95c1-7fb13b4a3f18"},{"parameters":{"operation":"append","documentId":{"__rl":true,"value":"18EUJ28peNa8if24MWU_Xo4TdVRhzr580XGFMrgZSC_I","mode":"id"},"sheetName":{"__rl":true,"value":"2014722475","mode":"id"},"fieldsUi":{"fieldValues":[{"fieldId":"T√™n","fieldValue":"={{ $json.body.lead_name }}"},{"fieldId":"ƒê·ªãa ch·ªâ email","fieldValue":"={{ $json.body.lead_email }}"},{"fieldId":"S·ªë ƒëi·ªán tho·∫°i","fieldValue":"={{ $json.body.lead_phone }}"},{"fieldId":"B·∫°n c√≥ ƒë·ªìng √Ω kh√¥ng?","fieldValue":"={{ $json.body.lead_registerpublisher }}"}]},"options":{}},"id":"59ebd0cc-aee5-4bc4-b2cd-4376e899bb7c","name":"Google Sheets","type":"n8n-nodes-base.googleSheets","typeVersion":3,"position":[1040,400],"credentials":{"googleSheetsOAuth2Api":{"id":"35","name":"Google Sheets ngothaikhang@gmail.com"}}}],"connections":{"Webhook":{"main":[[{"node":"Google Sheets","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{},"versionId":"d58a72ac-f7d5-4edb-8dab-a78180bfb4eb","triggerCount":0,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-04-26T07:06:58.818Z","updatedAt":"2023-04-27T13:54:15.000Z","id":"81","name":"#02.3b ƒë·∫©y t·ª´ ggsheet v·ªÅ Lead table","active":false,"nodes":[{"parameters":{"pollTimes":{"item":[{"mode":"everyMinute"}]},"documentId":{"__rl":true,"value":"18EUJ28peNa8if24MWU_Xo4TdVRhzr580XGFMrgZSC_I","mode":"list","cachedResultName":"Th√¥ng tin li√™n h·ªá (sheet)","cachedResultUrl":"https://docs.google.com/spreadsheets/d/18EUJ28peNa8if24MWU_Xo4TdVRhzr580XGFMrgZSC_I/edit?usp=drivesdk"},"sheetName":{"__rl":true,"value":2014722475,"mode":"list","cachedResultName":"C√¢u tr·∫£ l·ªùi bi·ªÉu m·∫´u 1","cachedResultUrl":"https://docs.google.com/spreadsheets/d/18EUJ28peNa8if24MWU_Xo4TdVRhzr580XGFMrgZSC_I/edit#gid=2014722475"},"event":"rowAdded","options":{}},"id":"e723d2fa-07c9-4767-8b1c-d3df3c1a912b","name":"Google Sheets Trigger","type":"n8n-nodes-base.googleSheetsTrigger","typeVersion":1,"position":[480,400],"credentials":{"googleSheetsTriggerOAuth2Api":{"id":"38","name":"Google Sheets Trigger account"}}},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/auth/v3/app_access_token/internal","sendBody":true,"bodyParameters":{"parameters":[{"name":"Lead_NAME","value":"={{ $json.T√™n }}"},{"name":"SDT","value":"={{ $json[\"S·ªë ƒëi·ªán tho·∫°i\"] }}"}]},"options":{}},"id":"b3f1b777-4024-4043-a7bc-2c7a0088f4e6","name":"HTTP Request","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[700,400]}],"connections":{"Google Sheets Trigger":{"main":[[{"node":"HTTP Request","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{},"versionId":"28d64015-d027-414f-aadc-ae68812d2985","triggerCount":0,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-04-26T16:15:45.902Z","updatedAt":"2023-04-26T17:49:13.000Z","id":"82","name":"(test, ko c·∫ßn) App Script submit form","active":false,"nodes":[{"parameters":{"httpMethod":"POST","path":"90fc87a8-362f-47c8-aa78-6d65e2d1f7d6","options":{}},"id":"66d47e6f-c250-4f75-bee3-52fd596cfa9f","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[820,400],"webhookId":"90fc87a8-362f-47c8-aa78-6d65e2d1f7d6"},{"parameters":{"method":"POST","authentication":"predefinedCredentialType","options":{}},"id":"8743f517-7acc-45f0-a393-0267bcacb641","name":"HTTP Request","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[1040,400]}],"connections":{"Webhook":{"main":[[{"node":"HTTP Request","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{},"versionId":"766653c8-176c-4c62-af1f-b17addefcc6c","triggerCount":0,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-04-27T02:05:52.036Z","updatedAt":"2023-04-27T02:05:52.036Z","id":"83","name":"ggform","active":false,"nodes":[],"connections":{},"settings":{},"staticData":null,"pinData":{},"versionId":"ab40706a-31b4-42a6-8fb1-f189864d64d5","triggerCount":0,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-04-27T02:06:49.551Z","updatedAt":"2023-04-28T01:35:00.000Z","id":"84","name":"wiki - test (Huy l√†m)","active":false,"nodes":[{"parameters":{},"id":"dd59dbc9-0fe2-4e61-99ef-02567539e83e","name":"When clicking \"Execute Workflow\"","type":"n8n-nodes-base.manualTrigger","typeVersion":1,"position":[880,440],"disabled":true},{"parameters":{"resource":"spreadsheet","options":{}},"id":"d309736c-32d3-4be2-9547-e03932da656b","name":"Google Sheets","type":"n8n-nodes-base.googleSheets","typeVersion":3,"position":[1100,440],"credentials":{"googleSheetsOAuth2Api":{"id":"35","name":"Google Sheets ngothaikhang@gmail.com"}},"disabled":true},{"parameters":{"pollTimes":{"item":[{"mode":"everyMinute"}]},"documentId":{"__rl":true,"value":"18EUJ28peNa8if24MWU_Xo4TdVRhzr580XGFMrgZSC_I","mode":"list","cachedResultName":"ThongTinLienHe","cachedResultUrl":"https://docs.google.com/spreadsheets/d/18EUJ28peNa8if24MWU_Xo4TdVRhzr580XGFMrgZSC_I/edit?usp=drivesdk"},"sheetName":{"__rl":true,"value":2014722475,"mode":"list","cachedResultName":"C√¢u tr·∫£ l·ªùi bi·ªÉu m·∫´u 1","cachedResultUrl":"https://docs.google.com/spreadsheets/d/18EUJ28peNa8if24MWU_Xo4TdVRhzr580XGFMrgZSC_I/edit#gid=2014722475"},"event":"rowAdded","options":{}},"id":"b7e5e50d-327d-4b8f-a14b-a63146ef33b6","name":"Google Sheets Trigger","type":"n8n-nodes-base.googleSheetsTrigger","typeVersion":1,"position":[980,200],"credentials":{"googleSheetsTriggerOAuth2Api":{"id":"38","name":"Google Sheets Trigger account"}}},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/auth/v3/app_access_token/internal","sendBody":true,"specifyBody":"json","jsonBody":"{   \"app_id\": \"cli_a4c3e66985f8900a\",   \"app_secret\": \"ZLlDbTSOFGmX37k65jikZfsqEb2VF7jy\" }","options":{}},"id":"4bb8257e-2214-4425-a0cf-b23293e681ac","name":"Lark_tenant","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[1200,200]},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/bitable/v1/apps/ARcGbz0BFacQmvsul7puvr34s1c/tables/tbl3PJDos4rFO52t/records/batch_create","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $json[\"app_access_token\"] }}"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\n  \"records\":[{\"fields\":{\"Lead_NAME\":\"{{ $node[\"Google Sheets Trigger\"].json[\"T√™n\"] }}\",\"SDT\":\"{{ $node[\"Google Sheets Trigger\"].json[\"S·ªë ƒëi·ªán tho·∫°i\"] }}\",\"Email\":\"{{ $node[\"Google Sheets Trigger\"].json[\"ƒê·ªãa ch·ªâ email\"] }}\"}}]}","options":{}},"id":"306875c8-03cc-4006-919c-a1873f301ef6","name":"HTTP Request","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[1420,200]}],"connections":{"When clicking \"Execute Workflow\"":{"main":[[{"node":"Google Sheets","type":"main","index":0}]]},"Google Sheets Trigger":{"main":[[{"node":"Lark_tenant","type":"main","index":0}]]},"Lark_tenant":{"main":[[{"node":"HTTP Request","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{},"versionId":"0b74b5d7-d3f4-4bbb-a828-84b696711a2f","triggerCount":0,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-04-28T01:23:55.689Z","updatedAt":"2023-04-28T15:01:40.000Z","id":"86","name":"wiwi - Khang b·ªï sung","active":false,"nodes":[{"parameters":{},"id":"bb37b1d3-c38d-407c-921e-6658288f81e5","name":"When clicking \"Execute Workflow\"","type":"n8n-nodes-base.manualTrigger","typeVersion":1,"position":[880,440],"disabled":true},{"parameters":{"resource":"spreadsheet","options":{}},"id":"949ea22b-c9f8-4584-9ad1-2c1de953ce6d","name":"Google Sheets","type":"n8n-nodes-base.googleSheets","typeVersion":3,"position":[1100,440],"credentials":{"googleSheetsOAuth2Api":{"id":"35","name":"Google Sheets ngothaikhang@gmail.com"}},"disabled":true},{"parameters":{"pollTimes":{"item":[{"mode":"everyMinute"}]},"documentId":{"__rl":true,"value":"18EUJ28peNa8if24MWU_Xo4TdVRhzr580XGFMrgZSC_I","mode":"list","cachedResultName":"ThongTinLienHe","cachedResultUrl":"https://docs.google.com/spreadsheets/d/18EUJ28peNa8if24MWU_Xo4TdVRhzr580XGFMrgZSC_I/edit?usp=drivesdk"},"sheetName":{"__rl":true,"value":2014722475,"mode":"list","cachedResultName":"C√¢u tr·∫£ l·ªùi bi·ªÉu m·∫´u 1","cachedResultUrl":"https://docs.google.com/spreadsheets/d/18EUJ28peNa8if24MWU_Xo4TdVRhzr580XGFMrgZSC_I/edit#gid=2014722475"},"event":"rowAdded","options":{}},"id":"5ce1de56-482e-40ec-ae18-d03002ab1aa0","name":"Google Sheets Trigger","type":"n8n-nodes-base.googleSheetsTrigger","typeVersion":1,"position":[880,200],"credentials":{"googleSheetsTriggerOAuth2Api":{"id":"38","name":"Google Sheets Trigger account"}}},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/bitable/v1/apps/ARcGbz0BFacQmvsul7puvr34s1c/tables/tbl3PJDos4rFO52t/records/batch_create","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $json[\"app_access_token\"] }}"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\"records\":[{\"fields\":{\"Lead_NAME\":\"{{ $node[\"Google Sheets Trigger\"].json[\"T√™n\"] }}\",\"SDT\":\"{{ $node[\"Google Sheets Trigger\"].json[\"S·ªë ƒëi·ªán tho·∫°i\"] }}\",\"Email\":\"{{ $node[\"Google Sheets Trigger\"].json[\"ƒê·ªãa ch·ªâ email\"] }}\",\"Dangkylampublisher\":\"{{ $node[\"Google Sheets Trigger\"].json[\"ƒêƒÉng k√Ω Publisher\"] }}\" }}]}","options":{}},"id":"f2e63738-5d9a-4970-97ab-8df63279a476","name":"HTTP Request","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[1340,200]},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/auth/v3/app_access_token/internal","sendBody":true,"specifyBody":"json","jsonBody":"{   \"app_id\": \"cli_a4c3e66985f8900a\",   \"app_secret\": \"ZLlDbTSOFGmX37k65jikZfsqEb2VF7jy\" }","options":{}},"id":"8c9004d8-56a0-4bca-8f71-e1731b5604fd","name":"(http) Lark_tenant","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[1100,200]},{"parameters":{"options":{}},"id":"37431dfc-c5e5-4e34-a562-031167a49355","name":"HTTP Request1","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[1320,440],"disabled":true}],"connections":{"When clicking \"Execute Workflow\"":{"main":[[{"node":"Google Sheets","type":"main","index":0}]]},"Google Sheets Trigger":{"main":[[{"node":"(http) Lark_tenant","type":"main","index":0}]]},"(http) Lark_tenant":{"main":[[{"node":"HTTP Request","type":"main","index":0}]]}},"settings":{},"staticData":{"node:Google Sheets Trigger":{"documentId":"18EUJ28peNa8if24MWU_Xo4TdVRhzr580XGFMrgZSC_I","sheetId":2014722475,"lastIndexChecked":2}},"pinData":{},"versionId":"1298aa59-8925-4059-a2cb-cb12a307a876","triggerCount":1,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-05-01T09:56:36.346Z","updatedAt":"2023-07-27T15:00:45.000Z","id":"87","name":"Download Grab's file and upload to Onedrive","active":true,"nodes":[{"parameters":{"pollTimes":{"item":[{"mode":"everyMinute"}]},"simple":false,"filters":{},"options":{"downloadAttachments":true}},"id":"48753341-52eb-44db-ba81-49205f7257c2","name":"Gmail Trigger","type":"n8n-nodes-base.gmailTrigger","typeVersion":1,"position":[260,360],"credentials":{"gmailOAuth2":{"id":"47","name":"Gmail account Hoai"}}},{"parameters":{"conditions":{"string":[{"value1":"={{ $json[\"from\"][\"value\"][0][\"address\"] }}","operation":"contains","value2":"no-reply@grab.com"}]}},"id":"6685271c-9a8e-4f07-a7cf-a126f9f3b72f","name":"IF","type":"n8n-nodes-base.if","typeVersion":1,"position":[480,360]},{"parameters":{"fileName":"={{ $node[\"Gmail Trigger\"].binary.attachment_0.fileName }}","parentId":"5E00F87B95E5BBEF!155620","binaryData":true,"binaryPropertyName":"attachment_0"},"id":"03a27504-b0ca-44ff-8fb8-3e6babc3de7e","name":"Microsoft OneDrive","type":"n8n-nodes-base.microsoftOneDrive","typeVersion":1,"position":[780,300],"alwaysOutputData":false,"credentials":{"microsoftOneDriveOAuth2Api":{"id":"45","name":"Microsoft Drive account Long"}}}],"connections":{"Gmail Trigger":{"main":[[{"node":"IF","type":"main","index":0}]]},"IF":{"main":[[{"node":"Microsoft OneDrive","type":"main","index":0}]]}},"settings":{},"staticData":{"node:Gmail Trigger":{"possibleDuplicates":["18997dd53b41d45f"],"lastTimeChecked":1690470010}},"pinData":{},"versionId":"fae2eece-e8e1-427f-b3f9-cc0c728c8428","triggerCount":1,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-05-03T05:57:03.182Z","updatedAt":"2023-05-14T04:57:59.000Z","id":"88","name":"[Vere.me] Kh√°ch c·∫ßn t∆∞ v·∫•n","active":true,"nodes":[{"parameters":{"httpMethod":"POST","path":"vere-dat-ve","options":{}},"id":"60d8f66b-e08e-495c-84ed-1c9fdd0f8525","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[820,500],"webhookId":"b991f32f-3136-4f61-9188-92c971ec0fea"},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/bot/v2/hook/12319b57-14ab-4066-ae74-2837f7c98e50","sendBody":true,"specifyBody":"json","jsonBody":"={\n    \"msg_type\": \"post\",\n    \"content\": {\n        \"post\": {\n            \"en_us\": {\n                \"title\": \"[V√© R·∫ª.me] {{ $node[\"Webhook\"].json[\"body\"][\"fullname\"] }} c·∫ßn t∆∞ v·∫•n\",\n                \"content\": [\n                    [                      \n                        {\n                            \"tag\": \"a\",\n                            \"text\": \"{{ $node[\"Webhook\"].json[\"body\"][\"source_title\"] }}\\n\",\n                            \"href\": \"{{ $node[\"Webhook\"].json[\"body\"][\"source_url\"] }}\"\n                        },\n                        {\n                            \"tag\": \"text\",\n                            \"text\": \"S·ªë ƒëi·ªán tho·∫°i: {{$node[\"Webhook\"].json[\"body\"][\"phone\"]}}\"\n                        },\n                        {\n                            \"tag\": \"a\",\n                            \"text\": \"\\nNh·∫Øn Zalo c√° nh√¢n cho kh√°ch\",\n                            \"href\": \"https://zalo.me/{{ $node[\"Webhook\"].json[\"body\"][\"phone\"] }}\"\n                        }\n                    ]\n                ]\n            }\n        }\n    }\n}","options":{}},"id":"4ae29e14-e70c-48b7-915a-15e5754ae334","name":"HTTP Request","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[1040,500]},{"parameters":{"conditions":{"string":[{"value1":"={{ $json.StatusMessage }}","value2":"success"}]}},"id":"3e9bf129-a78f-4ba3-90dc-4e630c64d887","name":"IF","type":"n8n-nodes-base.if","typeVersion":1,"position":[1260,500]},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/bot/v2/hook/12319b57-14ab-4066-ae74-2837f7c98e50","sendBody":true,"specifyBody":"json","jsonBody":"={\n    \"msg_type\": \"post\",\n    \"content\": {\n        \"post\": {\n            \"en_us\": {\n                \"title\": \"[V√© R·∫ª.me] C√≥ l·ªói khi g·ª≠i th√¥ng tin kh√°ch c·∫ßn t∆∞ v·∫•n\",\n                \"content\": [\n                    [                      \n                        {\n                            \"tag\": \"a\",\n                            \"text\": \"{{ $node[\"Webhook\"].json[\"body\"][\"source_title\"] }}\\n\",\n                            \"href\": \"{{ $node[\"Webhook\"].json[\"body\"][\"source_url\"] }}\"\n                        },\n                        {\n                            \"tag\": \"text\",\n                            \"text\": \"Vui l√≤ng ki·ªÉm tra\"\n                        }\n                    ]\n                ]\n            }\n        }\n    }\n}","options":{}},"id":"87f52baf-909b-4de5-8e54-9ae542dd03f7","name":"HTTP Request1","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[1480,580]}],"connections":{"Webhook":{"main":[[{"node":"HTTP Request","type":"main","index":0}]]},"HTTP Request":{"main":[[{"node":"IF","type":"main","index":0}]]},"IF":{"main":[[],[{"node":"HTTP Request1","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{"Webhook":[{"json":{"headers":{"host":"app.n8n.vn","user-agent":"WordPress/6.2; https://vere.me","content-length":"291","accept":"*/*","accept-encoding":"deflate, gzip, br","content-type":"application/json; charset=UTF-8","x-forwarded-for":"103.175.248.236","x-forwarded-host":"app.n8n.vn","x-forwarded-port":"443","x-forwarded-proto":"https","x-forwarded-server":"422302823b8a","x-real-ip":"103.175.248.236"},"params":{},"query":{},"body":{"fullname":"Khoi Le Quoc","phone":"0333111868","source_title":"V√© t√†u cao t·ªëc C·∫ßn Th∆° ƒëi C√¥n ƒê·∫£o gi√° r·∫ª - T√†u cao t·ªëc Mai Linh Express","source_url":"https://vere.me:443/ve-tau-cao-toc/can-tho-con-dao-mai-linh-express-2"}}}]},"versionId":"77b9269f-5306-47de-b33e-96ed52230bec","triggerCount":1,"tags":[{"createdAt":"2023-05-09T11:00:16.326Z","updatedAt":"2023-05-09T11:00:16.326Z","id":"16","name":"vere"}]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-05-10T08:52:38.808Z","updatedAt":"2023-05-10T08:52:38.808Z","id":"91","name":"My workflow 8","active":false,"nodes":[{"parameters":{"path":"ab346a35-0d24-4cf2-86b4-3a8742c9bd79","options":{}},"id":"c2b7f2c0-f99f-4373-8958-35b654aa464c","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[800,360],"webhookId":"ab346a35-0d24-4cf2-86b4-3a8742c9bd79"}],"connections":{},"settings":{},"staticData":null,"pinData":{},"versionId":"f6049cbb-a400-4ace-95e6-57b531ce92ef","triggerCount":0,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-05-10T16:56:40.835Z","updatedAt":"2023-05-14T04:58:09.000Z","id":"92","name":"[Vere.me] Kh√°ch c·∫ßn t∆∞ v·∫•n ve tau cao toc chi ti·∫øt","active":true,"nodes":[{"parameters":{"httpMethod":"POST","path":"vere-dat-ve-full","options":{}},"id":"dad457b1-f8e0-4a29-a741-8b49f55596e9","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[820,500],"webhookId":"14831f6a-82d3-4f5a-9f66-40764af62be8"},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/bot/v2/hook/12319b57-14ab-4066-ae74-2837f7c98e50","sendBody":true,"specifyBody":"json","jsonBody":"={{ JSON.stringify($('Code1').first().json)}}","options":{}},"id":"c97fc63f-04bd-48f3-98cf-f3d6d07a8dd8","name":"HTTP Request","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[1480,500]},{"parameters":{"jsCode":"const data = $('Webhook').first().json.body;\n\nlet ten_ve = data.ten_ve || '-';\nten_ve = ten_ve.replace(/\\n/g, \", \");\n\nlet fullname = data.fullname || '-';\nfullname = fullname.replace(/\\n/g, \", \");\n\nlet phone = data.phone || '-';\nphone = phone.replace(/\\n/g, \", \");\n\nlet sdtZalo = '84' + phone.slice(1);\n\nlet nhieu_thong_tin = false;\nif (data.nhieu_thong_tin !== '') nhieu_thong_tin = true;\n\nlet so_chieu = 2;\nif (data.so_chieu == 'M·ªôt chi·ªÅu') so_chieu = 1;\n\nlet ngay_khoi_hanh = (data.ngay_khoi_hanh === '') ? '-' : new Date(data.ngay_khoi_hanh).toLocaleDateString('en-GB');\n\nlet ngay_tro_ve = (data.ngay_tro_ve === '') ? '-' : new Date(data.ngay_tro_ve).toLocaleDateString('en-GB');\n\nlet so_luong_khach = data.so_luong_khach || 0;\n\nlet hang = data.hang || '-';\nhang = hang.replace(/\\n/g, \", \");\n\nlet noi_khoi_hanh = data.noi_khoi_hanh || '-';\nnoi_khoi_hanh = noi_khoi_hanh.replace(/\\n/g, \", \");\n\nlet diem_den = data.diem_den || '-';\ndiem_den = diem_den.replace(/\\n/g, \", \");\n\nlet chatcode = Math.floor(Math.random() * 101);\n\nconst source_title = data.source_title;\nconst source_url = data.source_url;\n\nif (nhieu_thong_tin === false) {\n  ngay_khoi_hanh = '-';\n  ngay_tro_ve = '-';\n  hang = '-';\n  so_chieu = '-';\n  so_luong_khach = '-';\n  noi_khoi_hanh = '-';\n  diem_den = '-';\n}\n\nif (so_chieu === 1) {\n  ngay_tro_ve = '-';\n}\nreturn {\n  chatcode,\n  fullname,\n  phone,\n  sdtZalo,\n  nhieu_thong_tin,\n  ten_ve,\n  so_chieu,\n  ngay_khoi_hanh,\n  ngay_tro_ve,\n  so_luong_khach,\n  hang,\n  noi_khoi_hanh,\n  diem_den,\n  source_title,\n  source_url\n}\n\n\n\n"},"id":"dae0b198-dd59-486e-b2c3-f325de7e057a","name":"Code","type":"n8n-nodes-base.code","typeVersion":1,"position":[1040,500]},{"parameters":{"jsCode":"const data = $(\"Code\").first().json;\n\nlet elements = [];\n\nelements.push({\n    tag: \"div\",\n    fields: [\n        {\n            is_short: true,\n            text: {\n                tag: \"lark_md\",\n                content: `**H·ªç v√† t√™n:** ${data.fullname}`,\n            },\n        },\n        {\n            is_short: true,\n            text: {\n                tag: \"lark_md\",\n                content: `**S·ªë ƒëi·ªán tho·∫°i:** ${data.phone}`,\n            },\n        },\n        {\n            is_short: true,\n            text: {\n                tag: \"lark_md\",\n                content: `**M√£ ƒë·∫∑t v√©:** ${data.chatcode}`,\n            },\n        },\n        {\n            is_short: true,\n            text: {\n                tag: \"lark_md\",\n                content: `**H√£ng:** ${data.hang}`,\n            },\n        },\n        {\n            is_short: true,\n            text: {\n                tag: \"lark_md\",\n                content: `**N∆°i kh·ªüi h√†nh:** ${data.noi_khoi_hanh}`,\n            },\n        },\n        {\n            is_short: true,\n            text: {\n                tag: \"lark_md\",\n                content: `**N∆°i ƒë·∫øn:** ${data.diem_den}`,\n            },\n        },\n        {\n            is_short: true,\n            text: {\n                tag: \"lark_md\",\n                content: `**Ng√†y kh·ªüi h√†nh:** ${data.ngay_khoi_hanh}`,\n            },\n        },\n        {\n            is_short: true,\n            text: {\n                tag: \"lark_md\",\n                content: `**Ng√†y tr·ªü v·ªÅ:** ${data.ngay_tro_ve}`,\n            },\n        },\n        {\n            is_short: true,\n            text: {\n                tag: \"lark_md\",\n                content: `**S·ªë chi·ªÅu:** ${data.so_chieu}`,\n            },\n        },\n        {\n            is_short: true,\n            text: {\n                tag: \"lark_md\",\n                content: `**S·ªë kh√°ch:** ${data.so_luong_khach}`,\n            },\n        },\n    ],\n});\n\n// Add action buttons\nelements.push({\n    tag: \"action\",\n    actions: [\n        {\n            tag: \"button\",\n            text: {\n                tag: \"plain_text\",\n                content: \"Chat Zalo c√° nh√¢n\",\n            },\n            url: `https://zalo.me/${data.phone}`,\n            type: \"primary\",\n        },\n        {\n            tag: \"button\",\n            text: {\n                tag: \"plain_text\",\n                content: \"G·ªçi ƒëi·ªán c√° nh√¢n\",\n            },\n            url: `tel:${data.phone}`,\n            type: \"default\",\n        },\n        {\n            tag: \"button\",\n            text: {\n                tag: \"plain_text\",\n                content: \"Xem tr√™n web\",\n            },\n            url: `${data.source_url}`,\n            type: \"default\",\n        }\n    ],\n});\n\n\nlet result = {\n    msg_type: \"interactive\",\n    card: {\n        config: {\n            wide_screen_mode: true,\n        },\n        header: {\n            template: \"green\",\n            title: {\n                content: `Y√™u c·∫ßu t∆∞ v·∫•n ${data.source_title}`,\n                tag: \"plain_text\",\n            },\n        },\n        elements,\n    },\n};\nreturn { json: result };"},"id":"37879033-15fb-472e-8ca8-d13e297279b8","name":"Code1","type":"n8n-nodes-base.code","typeVersion":1,"position":[1260,500]},{"parameters":{"conditions":{"string":[{"value1":"={{ $json.msg }}","value2":"success"}]}},"id":"af1976ab-35cd-4686-a62e-9696c3c462ad","name":"IF","type":"n8n-nodes-base.if","typeVersion":1,"position":[1700,500]},{"parameters":{"conditions":{"boolean":[{"value1":"={{ $node.Code.json.nhieu_thong_tin }}","value2":"={{ true }}"}]}},"id":"867bbb73-38ff-4697-ac94-68af3163b736","name":"IF1","type":"n8n-nodes-base.if","typeVersion":1,"position":[1880,360]},{"parameters":{"application":{"__rl":true,"value":"appg7xGBQYqUYbJAr","mode":"id"},"table":{"__rl":true,"value":"tblWAtHbJemABDvCG","mode":"id"},"id":"recqr9eRsaI69jq2D"},"id":"b4922fdf-32cc-43e2-927b-70168c0f4197","name":"Airtable","type":"n8n-nodes-base.airtable","typeVersion":1,"position":[2100,360],"credentials":{"airtableApi":{"id":"20","name":"Airtable: lekhoi456@gmail.com"}}},{"parameters":{"method":"POST","url":"https://business.openapi.zalo.me/message/template","sendHeaders":true,"headerParameters":{"parameters":[{"name":"access_token","value":"={{ $node.Airtable.json.fields.access_token }}"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\n    \"phone\": \"{{$node[\"Code\"].json[\"sdtZalo\"]}}\",\n    \"template_id\": \"259151\",\n    \"template_data\": {\n        \"loai_ve\": \"{{$node[\"Webhook\"].json[\"body\"][\"so_chieu\"]}}\",\n        \"ngay_tro_ve\": \"{{$node[\"Code\"].json[\"ngay_tro_ve\"]}}\",\n        \"diem_den\": \"{{$node[\"Code\"].json[\"diem_den\"]}}\",\n        \"hang\": \"{{$node[\"Code\"].json[\"hang\"]}}\",\n        \"ngay_khoi_hanh\": \"{{$node[\"Code\"].json[\"ngay_khoi_hanh\"]}}\",\n        \"ma_dat_ve\": \"{{$node[\"Code\"].json[\"chatcode\"]}}\",\n        \"ten_ve\": \"{{$node[\"Code\"].json[\"ten_ve\"]}}\",\n        \"noi_khoi_hanh\": \"{{$node[\"Code\"].json[\"noi_khoi_hanh\"]}}\",\n        \"trang_thai\": \"ƒêang ki·ªÉm tra v√©\",\n        \"so_luong_khach\": {{$node[\"Code\"].json[\"so_luong_khach\"]}},\n        \"ho_va_ten\": \"{{$node[\"Code\"].json[\"fullname\"]}}\"\n    },\n    \"tracking_id\": \"ncmk_phong_ve_khach_de_lai_thong_tin\"\n}","options":{}},"id":"10d7936e-80d3-4046-9e2b-a9dc478fe32a","name":"HTTP Request1","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[2540,160]},{"parameters":{"conditions":{"number":[{"value1":"={{ $node.Code.json.so_chieu }}","operation":"equal","value2":2}]}},"id":"d422e729-bac2-4b01-bec9-5821bef59cea","name":"IF2","type":"n8n-nodes-base.if","typeVersion":1,"position":[2320,360]},{"parameters":{"method":"POST","url":"https://business.openapi.zalo.me/message/template","sendHeaders":true,"headerParameters":{"parameters":[{"name":"access_token","value":"={{ $node.Airtable.json.fields.access_token }}"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\n    \"phone\": \"{{$node[\"Code\"].json[\"sdtZalo\"]}}\",\n    \"template_id\": \"259152\",\n    \"template_data\": {\n        \"loai_ve\": \"{{$node[\"Webhook\"].json[\"body\"][\"so_chieu\"]}}\",\n        \"diem_den\": \"{{$node[\"Code\"].json[\"diem_den\"]}}\",\n        \"hang\": \"{{$node[\"Code\"].json[\"hang\"]}}\",\n        \"ngay_khoi_hanh\": \"{{$node[\"Code\"].json[\"ngay_khoi_hanh\"]}}\",\n        \"ma_dat_ve\": \"{{$node[\"Code\"].json[\"chatcode\"]}}\",\n        \"ten_ve\": \"{{$node[\"Code\"].json[\"ten_ve\"]}}\",\n        \"noi_khoi_hanh\": \"{{$node[\"Code\"].json[\"noi_khoi_hanh\"]}}\",\n        \"trang_thai\": \"ƒêang ki·ªÉm tra v√©\",\n        \"so_luong_khach\": {{$node[\"Code\"].json[\"so_luong_khach\"]}},\n        \"ho_va_ten\": \"{{$node[\"Code\"].json[\"fullname\"]}}\"\n    },\n    \"tracking_id\": \"ncmk_phong_ve_khach_de_lai_thong_tin\"\n}","options":{}},"id":"0492dd88-647b-4012-8543-424067713a8c","name":"HTTP Request2","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[2540,380]}],"connections":{"Webhook":{"main":[[{"node":"Code","type":"main","index":0}]]},"Code":{"main":[[{"node":"Code1","type":"main","index":0}]]},"Code1":{"main":[[{"node":"HTTP Request","type":"main","index":0}]]},"HTTP Request":{"main":[[{"node":"IF","type":"main","index":0}]]},"IF":{"main":[[{"node":"IF1","type":"main","index":0}]]},"IF1":{"main":[[{"node":"Airtable","type":"main","index":0}]]},"Airtable":{"main":[[{"node":"IF2","type":"main","index":0}]]},"IF2":{"main":[[{"node":"HTTP Request1","type":"main","index":0}],[{"node":"HTTP Request2","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{"Webhook":[{"json":{"headers":{"host":"app.n8n.vn","user-agent":"WordPress/6.2; https://vere.me","content-length":"623","accept":"*/*","accept-encoding":"deflate, gzip, br","content-type":"application/json; charset=UTF-8","x-forwarded-for":"103.175.248.236","x-forwarded-host":"app.n8n.vn","x-forwarded-port":"443","x-forwarded-proto":"https","x-forwarded-server":"422302823b8a","x-real-ip":"103.175.248.236"},"params":{},"query":{},"body":{"fullname":"Tr·∫ßn Thanh Th√°i","phone":"0979234234","nhieu_thong_tin":["T√¥i s·∫Ω cung c·∫•p nhi·ªÅu th√¥ng tin h∆°n"],"so_chieu":"Kh·ª© h·ªìi","ngay_khoi_hanh":"2023-05-13","ngay_tro_ve":"2023-05-14","so_luong_khach":"4","ten_ve":"Superdong: Phan Thi·∫øt - Ph√∫ Qu√Ω","hang":"Superdong","noi_khoi_hanh":"Phan Thi·∫øt","diem_den":"Ph√∫ Qu√Ω","source_title":"V√© t√†u cao t·ªëc Phan Thi·∫øt ƒëi Ph√∫ Qu√Ω gi√° r·∫ª - T√†u cao t·ªëc Superdong","source_url":"https://vere.me:443/ve-tau-cao-toc/phan-thiet-phu-quy-superdong"}}}]},"versionId":"0a6979b6-93cf-4c17-85b2-f32a3d62f192","triggerCount":1,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-05-13T03:30:22.436Z","updatedAt":"2023-05-16T05:57:58.000Z","id":"93","name":"Mieu-Auto-Tao-Don-Dat-Hang","active":false,"nodes":[{"parameters":{"httpMethod":"POST","path":"b89bc4bd-a37b-47a3-9f9f-8e2631d1ca96","options":{}},"id":"629e9a43-0bea-4422-94a4-854bcedaeb52","name":"Get[MaCha]SP","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[260,440],"webhookId":"b89bc4bd-a37b-47a3-9f9f-8e2631d1ca96"},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/auth/v3/tenant_access_token/internal","sendBody":true,"bodyParameters":{"parameters":[{"name":"app_id","value":"cli_a4d6c704d9b85009"},{"name":"app_secret","value":"mY1fnsO5t2PvCRhKV6TxLfYuO5Iw57zh"}]},"options":{"response":{"response":{"fullResponse":true}}}},"id":"0b40b00c-086d-44b8-b074-9fa5ad960754","name":"LayTenant","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[440,440]},{"parameters":{"url":"https://open.larksuite.com/open-apis/bitable/v1/apps/Msutb7MNoaCxwvsCC95ucZGbs1b/tables/tbl9gF3qOqEk1dT2/records","sendQuery":true,"queryParameters":{"parameters":[{"name":"filter","value":"=CurrentValue.[M√£ cha]=\"{{ $node[\"Get[MaCha]SP\"].json[\"body\"][\"macha\"] }}\""},{"name":"page_size","value":"20"}]},"sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $node[\"LayTenant\"].json[\"body\"][\"tenant_access_token\"] }}"}]},"options":{"response":{"response":{"fullResponse":true}}}},"id":"9f1bf527-8d0c-4f71-85b5-50530560d303","name":"LayInfoDonHang","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[640,440]},{"parameters":{"jsCode":"let htmlTables = '<div class=\"table-wrapper\">';\nlet tenXuongSX = \"\"; // T√™n X∆∞·ªüng SX\nlet tenSP = \"\"; // T√™n SP\nlet maRap = \"\"; // M√£ R·∫≠p\n\nlet tongsp=0;\nfor (const item of $input.all()) {\n  for (const items of item.json.body.data.items) {\n    tongsp += parseInt(items.fields[\"S\"]) || 0;;\n    tongsp += parseInt(items.fields[\"M\"]) || 0;;\n    tongsp += parseInt(items.fields[\"L\"]) || 0;;\n    tongsp += parseInt(items.fields[\"XL\"]) || 0;;\n  }\n}\n\n\nfor (const item of $input.all()) {\n  for (const items of item.json.body.data.items) {\n    tenXuongSX = items.fields[\"T√™n X∆∞·ªüng SX\"]|| \"\";\n    tenSP = items.fields[\"T√™n SP Cha\"]?.[0]?.text || \"\";\n\n    const maRapArray = items.fields[\"M√£ R·∫≠p\"];\n    if (Array.isArray(maRapArray) && maRapArray.length > 0) {\n      maRap = maRapArray[0]?.text || \"\";\n    }\n\n\n\nhtmlTables += `<table><thead><tr><th class=\"bentrai\">M√£ R·∫≠p</th><th>${maRap}</th> <th>T√™n SP</th><th>${tenSP}</th></tr></thead><tbody><tr><td>X∆∞·ªüng gia c√¥ng</td><td>${tenXuongSX}</td>\n      <td>S·ªë l∆∞·ª£ng SX</td>\n      <td>${tongsp}</td>\n    </tr>\n    <tr>\n      <td>Ng√†y ƒë·∫∑t h√†ng</td>\n      <td>12/03/2004</td>\n      <td>L·ªánh SX</td>\n      <td>ACB123</td>\n    </tr>\n    <tr>\n      <td>Ng√†y giao d·ª± ki·∫øn</td>\n      <td>15/03/2004</td>\n      <td>Lo·∫°i SX</td>\n      <td>M·ªõi</td>\n    </tr>\n  </tbody>\n</table>\n`;\n  break; // Tho√°t kh·ªèi v√≤ng l·∫∑p sau khi l·∫•y gi√° tr·ªã ƒë·∫ßu ti√™n\n  }\n}\nfor (const item of $input.all()) {\n  for (const items of item.json.body.data.items) {\n    const maSKU = items.fields[\"M√£ SKU\"] || \"\";;\n    const sizeS = items.fields[\"S\"] || \"\";;\n    const sizeM = items.fields[\"M\"] || \"\";;\n    const sizeL = items.fields[\"L\"] || \"\";;\n    const sizeXL = items.fields[\"XL\"] || \"\";;\n    htmlTables += `\n<table><thead><tr><td colspan=\"2\">V·∫£i ch√≠nh:</td><td>ƒê·ªãnh m·ª©c</td><td>S·ªë m√©t</td><td>S</td><td>M</td><td>L</td><td>XL</td><td>T·ªïng SL</td></tr></thead><tbody><tr><td class=\"cot-1 bentrai\" rowspan=\"2\">${maSKU}</td><td class=\"cot-2\">Y√™u c·∫ßu</td><td class=\"cot-3\"></td><td class=\"cot-4\"></td><td class=\"cot-5\">${sizeS}</td><td class=\"cot-5\">${sizeM}</td><td class=\"cot-5\">${sizeL}</td><td class=\"cot-5\">${sizeXL}</td><td></td></tr><tr><td>Th·ª±c c·∫Øt</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>V·∫£i l√≥t</td><td></td><td></td><td></td><td colspan=\"5\" rowspan=\"3\"></td></tr><tr><td>N√∫t</td><td></td><td></td><td></td></tr><tr><td>Ph·ª• li·ªáu kh√°c</td><td></td><td></td><td></td></tr></tbody></table></br>\n`;\n  }\n}\nhtmlTables += `</div>`;\nreturn {\n  htmlTables: htmlTables\n};\n"},"id":"8bd3d0f5-c857-46f7-b009-5d4063479d9b","name":"Code","type":"n8n-nodes-base.code","typeVersion":1,"position":[840,440]},{"parameters":{"html":"<!DOCTYPE html>\n\n<html>\n<head>\n  <meta charset=\"UTF-8\" />\n  <title>My HTML document</title>\n</head>\n<body>\n  <div class=\"container\">\n    <h1><img src=\"https://theme.hstatic.net/200000561729/1000985167/14/logo.png?v=311\" width=\"18%\"/></h1>\n    <span>  ƒê·ªãa ch·ªâ: 406/2 L√™ VƒÉn S·ªπ, Q3 </span>\n    <h2 style=\"text-align:center;font-size:2em;font-weight:bold;\">ƒê∆†N ƒê·∫∂T H√ÄNG</h2>\n    <p>Th√°ng:</p>\n    {{ $node[\"Code\"].json[\"htmlTables\"] }}\n    \n  </div>\n</body>\n</html>\n\n<style>\n.container {\n  background-color: #ffffff;\n  /*text-align: center;*/\n  padding: 16px;\n  border-radius: 8px;\n}\n\nbody{\n  text-align:left;\n}\nh1 {\n  color: #ff6d5a;\n  font-size: 24px;\n  font-weight: bold;\n  padding: 8px;\n}\n\nh2 {\n  color: #909399;\n  font-size: 18px;\n  font-weight: bold;\n  padding: 8px;\n}\n.table-wrapper {\n    display: flex;\n    flex-direction: column;\n  }\n\n  .table-wrapper table {\n    width: 100%;\n    border-collapse: collapse;\n    font-family: Arial, sans-serif;\n    margin-bottom: 20px;\n  }\n\n  .table-wrapper th,\n  .table-wrapper td {\n    border: 1px solid #ddd;\n    padding: 8px;\n    text-align: center;\n  }\n\n  .table-wrapper th {\n    background-color: #f2f2f2;\n    font-weight: bold;\n  }\n\n  .table-wrapper tbody tr:nth-child(even) {\n    background-color: #f9f9f9;\n  }\n  .bentrai{\n    text-align: left;\n  }\n  .cot-1{\n    width:20%;\n  }\n  .cot-2,.cot-3,.cot-4{\n    width:15%;\n  }\n  .cot-5{\n   width:8%; \n  }\n</style>"},"id":"feee2cc6-0be2-46d6-b9d5-a05f69393c8f","name":"HTML","type":"n8n-nodes-base.html","typeVersion":1,"position":[1020,440]}],"connections":{"Get[MaCha]SP":{"main":[[{"node":"LayTenant","type":"main","index":0}]]},"LayTenant":{"main":[[{"node":"LayInfoDonHang","type":"main","index":0}]]},"LayInfoDonHang":{"main":[[{"node":"Code","type":"main","index":0}]]},"Code":{"main":[[{"node":"HTML","type":"main","index":0}]]},"HTML":{"main":[[]]}},"settings":{},"staticData":null,"pinData":{},"versionId":"3d747ef3-a754-4266-849e-c0a71dfeab78","triggerCount":0,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-05-13T04:12:22.090Z","updatedAt":"2023-05-13T04:30:15.000Z","id":"94","name":"[nucuoimekong.com] Kh√°ch c·∫ßn t∆∞ v·∫•n","active":true,"nodes":[{"parameters":{"httpMethod":"POST","path":"nucuoimekong-tu-van","options":{}},"id":"3de6c9b9-b50e-4115-a9b0-cd20a9de8ae4","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[820,500],"webhookId":"c159fe04-bcf3-4c69-8553-f82ba0aea68a"},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/bot/v2/hook/80c21424-ab2e-4d62-8b07-6f4a9f80877b","sendBody":true,"specifyBody":"json","jsonBody":"={{ JSON.stringify($('Code1').first().json)}}","options":{}},"id":"89ef1e2c-b2a0-46d9-b9ca-0b5ce0fdd39a","name":"HTTP Request","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[1480,500]},{"parameters":{"jsCode":"const data = $('Webhook').first().json.body;\nconst fullname = data.fullname || '-';\nconst phone = data.phone || '-';\nconst source_title = data.source_title;\nconst source_url = data.source_url;\n\nreturn {\n  fullname,\n  phone,\n  source_title,\n  source_url\n}\n\n\n\n"},"id":"f0805d32-3a6d-4dd0-8d37-77fd3dbbe218","name":"Code","type":"n8n-nodes-base.code","typeVersion":1,"position":[1040,500]},{"parameters":{"jsCode":"const data = $(\"Code\").first().json;\n\nlet elements = [];\n\nelements.push({\n    tag: \"div\",\n    fields: [\n        {\n            is_short: true,\n            text: {\n                tag: \"lark_md\",\n                content: `**H·ªç v√† t√™n:** ${data.fullname}`,\n            }\n        },\n        {\n            is_short: true,\n            text: {\n                tag: \"lark_md\",\n                content: `**S·ªë ƒëi·ªán tho·∫°i:** ${data.phone}`,\n            }\n        }\n    ],\n});\n\n// Add action buttons\nelements.push({\n    tag: \"action\",\n    actions: [\n        {\n            tag: \"button\",\n            text: {\n                tag: \"plain_text\",\n                content: \"Chat Zalo c√° nh√¢n\",\n            },\n            url: `https://zalo.me/${data.phone}`,\n            type: \"primary\",\n        },\n        {\n            tag: \"button\",\n            text: {\n                tag: \"plain_text\",\n                content: \"G·ªçi ƒëi·ªán c√° nh√¢n\",\n            },\n            url: `tel:${data.phone}`,\n            type: \"default\",\n        },\n        {\n            tag: \"button\",\n            text: {\n                tag: \"plain_text\",\n                content: \"Xem tr√™n web\",\n            },\n            url: `${data.source_url}`,\n            type: \"default\",\n        }\n    ],\n});\n\n\nlet result = {\n    msg_type: \"interactive\",\n    card: {\n        config: {\n            wide_screen_mode: true,\n        },\n        header: {\n            template: \"green\",\n            title: {\n                content: `Y√™u c·∫ßu t∆∞ v·∫•n ${data.source_title}`,\n                tag: \"plain_text\",\n            },\n        },\n        elements,\n    },\n};\nreturn { json: result };"},"id":"3842630e-15a0-43b8-a3f5-7d0fc0ddd732","name":"Code1","type":"n8n-nodes-base.code","typeVersion":1,"position":[1260,500]}],"connections":{"Webhook":{"main":[[{"node":"Code","type":"main","index":0}]]},"Code":{"main":[[{"node":"Code1","type":"main","index":0}]]},"Code1":{"main":[[{"node":"HTTP Request","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{"Webhook":[{"json":{"headers":{"host":"app.n8n.vn","user-agent":"WordPress/6.1.1; https://nucuoimekong.com","content-length":"281","accept":"*/*","accept-encoding":"deflate, gzip","content-type":"application/json; charset=UTF-8","referer":"https://app.n8n.vn/webhook-test/nucuoimekong-tu-van","x-forwarded-for":"103.175.248.226","x-forwarded-host":"app.n8n.vn","x-forwarded-port":"443","x-forwarded-proto":"https","x-forwarded-server":"422302823b8a","x-real-ip":"103.175.248.226"},"params":{},"query":{},"body":{"fullname":"Tr·∫ßn Thanh Th√°i","phone":"0979234234","source_title":"Tour ch·ª£ n·ªïi C√°i RƒÉng gh√©p ƒëo√†n - Gi√° c·ª±c r·∫ª ch·ªâ v·ªõi 100k","source_url":"https://nucuoimekong.com:443/tour/tour-cho-noi-cai-rang-ghep-doan"}}}]},"versionId":"92d0a126-fc95-42ba-b7d4-309fe98cea5a","triggerCount":1,"tags":[{"createdAt":"2023-05-13T04:12:21.098Z","updatedAt":"2023-05-13T04:12:21.098Z","id":"17","name":"nucuoimekong"}]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-05-14T17:04:58.255Z","updatedAt":"2023-05-14T17:04:58.255Z","id":"95","name":"My workflow 9","active":false,"nodes":[{"parameters":{},"id":"30ca973f-b5bd-4634-8d24-2ef434c34af0","name":"When clicking \"Execute Workflow\"","type":"n8n-nodes-base.manualTrigger","typeVersion":1,"position":[560,300]}],"connections":{},"settings":{},"staticData":null,"pinData":{},"versionId":"260382fc-2222-40bd-b2d2-6687cf62a2d5","triggerCount":0,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-05-16T05:55:49.271Z","updatedAt":"2023-06-01T13:23:35.000Z","id":"97","name":"MieuFlow","active":true,"nodes":[{"parameters":{"httpMethod":"POST","path":"b89bc4bd-a37b-47a3-9f9f-8e2631d1ca96","options":{}},"id":"e05e6e60-a035-485e-91c3-14fbcfb6e0d4","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[-100,360],"webhookId":"4a5c7df8-37fe-4a66-a70b-771d026c8672"},{"parameters":{"jsCode":"let htmlTables = '<div class=\"table-wrapper\">';\nlet tenXuongSX = \"\"; // T√™n X∆∞·ªüng SX\nlet tenSP = \"\"; // T√™n SP\nlet maRap = \"\"; // M√£ R·∫≠p\n\nconst currentDate = new Date();\nconst month = currentDate.getMonth() + 1;\n// L·∫•y ng√†y ƒë·∫∑t h√†ng l√† ng√†y hi·ªán t·∫°i\nconst ngayDatHang = new Date();\n// S·ªë ng√†y l√†m vi·ªác c·∫ßn t√≠nh\nconst soNgayLamViec = 15;\n\n// T√≠nh to√°n ng√†y nh·∫≠n h√†ng d·ª± ki·∫øn\nlet ngayNhanHangDuKien = new Date(ngayDatHang); // Sao ch√©p ng√†y ƒë·∫∑t h√†ng\nlet countNgayLamViec = 0; // Bi·∫øn ƒë·∫øm s·ªë ng√†y l√†m vi·ªác\n\n// Ki·ªÉm tra t·ª´ng ng√†y, n·∫øu l√† ng√†y l√†m vi·ªác (t·ª´ th·ª© 2 ƒë·∫øn th·ª© 6), tƒÉng bi·∫øn ƒë·∫øm\nwhile (countNgayLamViec < soNgayLamViec) {\n  ngayNhanHangDuKien.setDate(ngayNhanHangDuKien.getDate() + 1); // TƒÉng ng√†y l√™n 1\n  const dayOfWeek = ngayNhanHangDuKien.getDay(); // L·∫•y s·ªë th·ª© t·ª± c·ªßa ng√†y trong tu·∫ßn (0: Ch·ªß nh·∫≠t, 1: Th·ª© 2, 2: Th·ª© 3, ..., 6: Th·ª© 7)\n  if (dayOfWeek > 0 && dayOfWeek < 6) { // Ki·ªÉm tra n·∫øu l√† ng√†y l√†m vi·ªác (t·ª´ th·ª© 2 ƒë·∫øn th·ª© 6)\n    countNgayLamViec++;\n  }\n}\n\n// Chu·∫©n b·ªã ƒë·ªãnh d·∫°ng ng√†y/th√°ng/nƒÉm (01/01/2023)\nconst options = { year: 'numeric', month: '2-digit', day: '2-digit' };\nconst ngayNhanHangDuKienFormatted = ngayNhanHangDuKien.toLocaleDateString('vi-VN', options);\nconst ngayDathangFormatted = ngayDatHang.toLocaleDateString('vi-VN', options);\n//xong ph·∫ßn ng√†y r·ªìi ƒë√≥\n\n//ƒë·ªÉ l√†m l·ªánh sx\n\nlet tongsp=0;\nfor (const item of $input.all()) {\n  for (const items of item.json.body.data.items) {\n    tongsp += parseInt(items.fields[\"üìù S\"]) || 0;;\n    tongsp += parseInt(items.fields[\"üìù M\"]) || 0;;\n    tongsp += parseInt(items.fields[\"üìù L\"]) || 0;;\n    tongsp += parseInt(items.fields[\"üìù XL\"]) || 0;;\n    tongsp += parseInt(items.fields[\"üìù FS\"]) || 0;;\n    \n  }\n}\n\n\nfor (const item of $input.all()) {\n  for (const items of item.json.body.data.items) {\n    tenXuongSX = items.fields[\"üìùT√™n X∆∞·ªüng SX\"]|| \"\";\n    tenSP = items.fields[\"T√™n SP Cha\"]?.[0]?.text || \"\";\n    const MaCha = items.fields[\"M√£ cha\"] || \"\";;\n    const maRapArray = items.fields[\"‚õî M√£ R·∫≠p\"];\n    if (Array.isArray(maRapArray) && maRapArray.length > 0) {\n      maRap = maRapArray[0]?.text || \"\";\n    }\n      // L·∫•y hai k√Ω t·ª± cu·ªëi c·ªßa M√£ nh√† cung c·∫•p\nconst maNCC = items.fields[\"M√£ NCC\"][0].text;\nconst kyTuCuoi = maNCC.slice(-2);\nconst dathangne = ngayDatHang.toLocaleDateString(\"vi-VN\", {\n  day: \"2-digit\",\n  month: \"2-digit\",\n  year: \"numeric\"\n});\n\nconst maLenhSX = `${maRap}/${kyTuCuoi}/${dathangne.replace(/\\//g, \"\")}`;\n\n\nhtmlTables += `<p>Th√°ng: ${month}</p><table><thead><tr><th class=\"bentrai bold-big\"><span style=\"color:red; font-weight:bold;\"> ${maRap}</span></th><th colspan=\"2\"><span style=\"color:red; font-weight:bold;\"> ${MaCha}</th> <th><span  class=\"bold-big\">${tenSP}</span></th></tr></thead><tbody><tr><td class=\"bentrai\">X∆∞·ªüng gia c√¥ng</td><td class=\"bold-big maudo\" style=\"color:red; font-weight:bold;\">${tenXuongSX}</td>\n      <td>S·ªë l∆∞·ª£ng SX</td>\n      <td class=\"bold-big\">${tongsp}</td>\n    </tr>\n    <tr>\n      <td class=\"bentrai\">Ng√†y ƒë·∫∑t h√†ng</td>\n      <td style=\"color:red; font-weight:bold;\">${ngayDathangFormatted}</td>\n      <td>L·ªánh SX</td>\n      <td>${maLenhSX}</td>\n    </tr>\n    <tr>\n      <td class=\"bentrai\">Ng√†y giao d·ª± ki·∫øn</td>\n      <td class=\"bold-big\">${ngayNhanHangDuKienFormatted}</td>\n      <td>Lo·∫°i SX</td>\n      <td>M·ªõi</td>\n    </tr>\n  </tbody>\n</table>\n`;\n  break; // Tho√°t kh·ªèi v√≤ng l·∫∑p sau khi l·∫•y gi√° tr·ªã ƒë·∫ßu ti√™n\n  }\n}\nfor (const item of $input.all()) {\n  for (const items of item.json.body.data.items) {\n    const MaVaiChinh = items.fields[\"M√£ V·∫£i Ch√≠nh\"] || \"\";;\n    const sizeS = items.fields[\"üìù S\"] || \"\";;\n    const sizeM = items.fields[\"üìù M\"] || \"\";;\n    const sizeL = items.fields[\"üìù L\"] || \"\";;\n    const sizeXL = items.fields[\"üìù XL\"] || \"\";;\n    const sizeFS = items.fields[\"üìù FS\"] || \"0\";;\n    const DinhMuc = items.fields[\"‚õî ƒê·ªãnh m·ª©c\"] || \"\";;\n    const SoMet = items.fields[\"T·ªïng Slg V·∫£i Ch√≠nh (m)\"] || \"\";;\n    const MaVaiPhu = items.fields[\"üìùM√£ V·∫£i ph·ª•\"] || \"\";;\n    const DinhMucPhu = items.fields[\"‚õî ƒê·ªãnh m·ª©c v·∫£i ph·ª•\"] || \"\";;\n    const TongMetPhu = items.fields[\"T·ªïng Slg V·∫£i ph·ª• (m)\"] || \"\";;  \n    const TongSML = items.fields[\"T·ªïng Slg\"] || \"\";;  \n\n        htmlTables += `\n<table>\n  <thead>\n    <tr>\n      <td colspan=\"2\" class=\"bentrai bold-big\">V·∫£i ch√≠nh:</td>\n      <td class=\"bold-big\">ƒê·ªãnh m·ª©c</td>\n      <td class=\"bold-big\">S·ªë m√©t</td>\n      <td class=\"bold-big\">S</td>\n      <td class=\"bold-big\">M</td>\n      <td class=\"bold-big\">L</td>\n      <td class=\"bold-big\">XL</td>\n      <td class=\"bold-big\">FS</td>\n      <td class=\"bold-big cot-cuoi\">T·ªïng SL</td>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td class=\"cot-1 bentrai bold-big\" rowspan=\"2\">${MaVaiChinh}</td>\n      <td class=\"cot-2\" style=\"font-weight:bold;\">Y√™u c·∫ßu</td>\n      <td class=\"cot-3 bold-big\">${DinhMuc}</td>\n      <td class=\"cot-4 bold-big\">${SoMet}</td>\n      <td class=\"cot-5 bold-big\">${sizeS}</td>\n      <td class=\"cot-5 bold-big\">${sizeM}</td>\n      <td class=\"cot-5 bold-big\">${sizeL}</td>\n      <td class=\"cot-5 bold-big\">${sizeXL}</td>\n      <td class=\"cot-5 bold-big\">${sizeFS}</td>\n      <td class=\"cot-5 bold-big\">${TongSML}</td>\n    </tr>\n    <tr>\n      <td>Th·ª±c c·∫Øt</td>\n      <td></td>\n      <td></td>\n      <td></td>\n      <td></td>\n      <td></td>\n      <td></td>\n      <td></td>\n      <td></td>\n    </tr>\n    <tr>\n      <td class=\"bentrai bold-big\">V·∫£i l√≥t</td>\n      <td>${MaVaiPhu}</td>\n      <td>${DinhMucPhu}</td>\n      <td>${TongMetPhu}</td>\n      <td class=\"ghichu\" colspan=\"3\" rowspan=\"3\">*Ghi ch√∫ n·ªôi b·ªô</td>\n      <td class=\"ghichu\" colspan=\"3\" rowspan=\"3\">*Ghi ch√∫ x∆∞·ªüng</td>\n    </tr>\n    <tr>\n      <td class=\"bentrai bold-big\">N√∫t</td>\n      <td></td>\n      <td></td>\n      <td></td>\n    </tr>\n    <tr>\n      <td class=\"bentrai bold-big\">Ph·ª• li·ªáu kh√°c</td>\n      <td></td>\n      <td></td>\n      <td></td>\n    </tr>\n  </tbody>\n</table></br>\n`;\n  }\n}\n\nhtmlTables += `</div>`;\nreturn {\n  htmlTables: htmlTables\n};"},"id":"61e82a49-2d79-4abe-ac91-83d51ac47d27","name":"Code","type":"n8n-nodes-base.code","typeVersion":1,"position":[560,360]},{"parameters":{"html":"<!DOCTYPE html>\n\n<html>\n<head>\n  <meta charset=\"UTF-8\" />\n  <title>ƒê∆°n ƒë·∫∑t h√†ng Mieu</title>\n</head>\n<body>\n  <div class=\"container\">\n    <h1><img src=\"https://theme.hstatic.net/200000561729/1000985167/14/logo.png?v=311\" width=\"18%\"/></h1>\n    <p>  ƒê·ªãa ch·ªâ: 400/2 L√™ VƒÉn S·ªπ, Q3 </p>\n    <p>  Tel: 0902.303.006 </p>\n    <h2 style=\"text-align:center;font-size:2em;font-weight:bold;\">ƒê∆†N ƒê·∫∂T H√ÄNG</h2>\n    {{ $node[\"Code\"].json[\"htmlTables\"] }}\n    <div class=\"table-wrapper\">\n  <table class=\"bang-luu-y\">\n    <thead>\n      <tr>\n        <th>L∆∞u √Ω ph·ª• li·ªáu</th>\n        <th></th>\n        <th></th>\n        <th></th>\n      </tr>\n    </thead>\n    <tbody>\n      <tr>\n        <td>1/ D√πng keo l·ª•a/tƒÉng ƒë∆° s·∫Øt</td>\n        <td>4/ V·∫Øt s·ªï ch·ªâ Cotton</td>\n        <td></td>\n        <td></td>\n      </tr>\n      <tr>\n        <td>2/ L·∫•y k√©o ƒë·∫ßm 60cm</td>\n        <td>5/ Ch·ªâ, d√¢y k√©o, n√∫t ph·ª• li·ªáu ti·ªáp m√†u v·∫£i</td>\n        <td></td>\n        <td></td>\n      </tr>\n      <tr>\n        <td colspan=\"4\">3/ Mocking tr√™n thun d∆∞·ªõi thun</td>\n      </tr>\n    </tbody>\n  </table>\n</div>\n\n  </div>\n</body>\n</html>\n\n<style>\n.container {\n  background-color: #ffffff;\n  /*text-align: center;*/\n  padding: 16px;\n  border-radius: 8px;\n}\n\nbody{\n  text-align:left;\n}\n  .bentrai{\n  text-align:left!important;    \n  }\nh1 {\n  color: #ff6d5a;\n  font-size: 24px;\n  font-weight: bold;\n  padding: 8px;\n}\n\nh2 {\n  color: #909399;\n  font-size: 18px;\n  font-weight: bold;\n  padding: 8px;\n}\n.table-wrapper {\n    display: flex;\n    flex-direction: column;\n  }\n\n  .table-wrapper table {\n    width: 100%;\n    border-collapse: collapse;\n    font-family: Arial, sans-serif;\n    margin-bottom: 20px;\n  }\n\n  .table-wrapper th,\n  .table-wrapper td {\n    border: 1px solid #ddd;\n    padding: 8px;\n    text-align: center;\n  }\n\n  .table-wrapper th {\n    background-color: #f2f2f2;\n    font-weight: bold;\n  }\n\n  .table-wrapper tbody tr:nth-child(even) {\n    background-color: #f9f9f9;\n  }\n  .bentrai{\n    text-align: left;\n  }\n  .cot-1{\n    width:20%;\n  }\n  .cot-2,.cot-3,.cot-4{\n    width:15%;\n  }\n  .cot-5{\n   width:8%; \n  }\n  .bold-big{\n    text-transform: uppercase;\n    font-weight:bold;\n  }\n  .table-wrapper {\n  width: 100%;\n  overflow-x: auto;\n}\n\n.bang-luu-y {\n  border-collapse: collapse;\n  width: 100%;\n}\n\n.bang-luu-y th,\n.bang-luu-y td {\n  padding: 8px;\n  text-align: left;\n}\n\n.bang-luu-y th {\n  font-weight: bold;\n  background-color: #f2f2f2;\n}\n\n.bang-luu-y td {\n  border-bottom: 1px solid #ddd;\n}\n\n\n\n/* Lo·∫°i b·ªè ƒë∆∞·ªùng vi·ªÅn b·∫£ng */\n.bang-luu-y {\n  border: none;\n}\n\n.bang-luu-y th,\n.bang-luu-y td {\n  border: none;\n  \n}\n  .cot-cuoi{\n    width:20%!important;\n  }\n  .ghichu{\n    vertical-align: top;\n    text-align:left!important;\n  }\n\n</style>"},"id":"15f9b53e-a10e-4945-a3ed-e7a152ac5c01","name":"HTML","type":"n8n-nodes-base.html","typeVersion":1,"position":[800,360]},{"parameters":{"method":"POST","url":"https://hcti.io/v1/image","sendHeaders":true,"headerParameters":{"parameters":[{"name":"authorization","value":"Basic NmZkMTA3YjUtYzIxYy00ZTU4LTk4OGItYzEyMzQ0MDIyYmEyOjcxNGFmYWUxLTkwYzEtNDEwNy05MDgxLWYwOThmNmQ1Y2ZmMg=="}]},"sendBody":true,"contentType":"form-urlencoded","bodyParameters":{"parameters":[{"name":"html","value":"={{ $json[\"html\"] }}"},{"name":"ms_delay","value":"1000"}]},"options":{}},"id":"1394c706-326c-4380-827e-d9dd539e5a17","name":"HTTP Request2","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[1020,360]},{"parameters":{"method":"PUT","url":"=https://open.larksuite.com/open-apis/bitable/v1/apps/QncPb90v9azHZRsiBsMutNctsrY/tables/tbl7pE4Q4B5FwP0m/records/{{ $node[\"Webhook\"].json[\"body\"][\"record_id\"] }}","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $node[\"tenantAccess\"].json[\"body\"][\"tenant_access_token\"] }}"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\"fields\":{\"H√¨nh ƒë∆°n ƒë·∫∑t h√†ng\":{\"link\":\"{{ $json[\"url\"] }}\",\"text\":\"xem h√¨nh\"}}}","options":{"response":{"response":{"fullResponse":true}}}},"id":"b75cc749-08a2-4426-ae90-748765e4ed0b","name":"HTTP Request3","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[1240,360]},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/auth/v3/tenant_access_token/internal","sendBody":true,"bodyParameters":{"parameters":[{"name":"app_id","value":"cli_a4d6c704d9b85009"},{"name":"app_secret","value":"mY1fnsO5t2PvCRhKV6TxLfYuO5Iw57zh"}]},"options":{"response":{"response":{"fullResponse":true}}}},"id":"5c5181a9-dcde-4222-acc5-1dfea2cac222","name":"tenantAccess","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[120,360]},{"parameters":{"url":"https://open.larksuite.com/open-apis/bitable/v1/apps/QncPb90v9azHZRsiBsMutNctsrY/tables/tblhACxIpRdT4oN2/records","sendQuery":true,"queryParameters":{"parameters":[{"name":"filter","value":"=CurrentValue.[‚õî M√£ R·∫≠p]=\"{{ $node[\"Webhook\"].json[\"body\"][\"macha\"] }}\"&&CurrentValue.[T·∫°o phi·∫øu LSX]=1"},{"name":"page_size","value":"20"}]},"sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $json[\"body\"][\"tenant_access_token\"] }}"}]},"options":{"response":{"response":{"fullResponse":true}}}},"id":"65ec3a23-d1d4-40d5-a5fd-4deda9b223e3","name":"GetInfor","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[340,360]}],"connections":{"Webhook":{"main":[[{"node":"tenantAccess","type":"main","index":0}]]},"Code":{"main":[[{"node":"HTML","type":"main","index":0}]]},"HTML":{"main":[[{"node":"HTTP Request2","type":"main","index":0}]]},"HTTP Request2":{"main":[[{"node":"HTTP Request3","type":"main","index":0}]]},"tenantAccess":{"main":[[{"node":"GetInfor","type":"main","index":0}]]},"GetInfor":{"main":[[{"node":"Code","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{"HTTP Request2":[{"json":{"url":"https://hcti.io/v1/image/51ec49c8-6afb-4262-824b-098d019a2a7d"},"pairedItem":{"item":0}}]},"versionId":"768addca-5551-4eae-bc85-778001bbbf68","triggerCount":1,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-05-17T09:53:13.679Z","updatedAt":"2023-05-17T10:47:21.000Z","id":"98","name":"NhanhVN redirect URL","active":true,"nodes":[{"parameters":{"path":"nhanhvn-redirect","options":{"responseData":"KDIGI authorize success!"}},"id":"4f1d54d0-1ad1-4135-876f-d0fd891476a8","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[1080,620],"webhookId":"4e905b23-b54d-4cdb-b3a6-e6bf08f482a4"},{"parameters":{"method":"POST","url":"https://nhanh.vn/oauth/access_token","sendBody":true,"contentType":"multipart-form-data","bodyParameters":{"parameters":[{"name":"version","value":"2.0"},{"name":"appId","value":"73489"},{"name":"secretKey","value":"LKHpYif8ACwSFQ8BG2wz4igX5o6RRTDlnbpNOSIFbfFPNdEPvwrITURW8TE7WfdWLSCO7fGuEa6HUFC7l2vDg4LtEU4mgExSoygDQE5JBjMBnOIu9ZUguupIp8FlpQ7h"},{"name":"accessCode","value":"={{ $node[\"Webhook\"].json[\"query\"][\"accessCode\"] }}"}]},"options":{}},"id":"aeb329d8-f4de-4333-8ce5-1219df9444f2","name":"Get access token","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[1260,620]}],"connections":{"Webhook":{"main":[[{"node":"Get access token","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{"Webhook":[{"json":{"headers":{"host":"app.n8n.vn","user-agent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/112.0.0.0 Safari/537.36 Edg/112.0.1722.68","accept":"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7","accept-encoding":"gzip, deflate, br","accept-language":"en-US,en;q=0.9,vi;q=0.8","cookie":"rl_page_init_referrer=RudderEncrypt%3AU2FsdGVkX1%2BeFaYNRRB%2FgnkW5VTGmORD%2BTzTD0WQBPQ%3D; rl_page_init_referring_domain=RudderEncrypt%3AU2FsdGVkX181gxOHlIDeV5419xSS%2FTLECagxBhgZaaA%3D; n8n-auth=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjA0NjAzMGExLTM3MzEtNDFkZS04ZjBmLTMyNTZkMzIzMDQ3OCIsImVtYWlsIjoia2hvaWxxQGtkaWdpLnZuIiwicGFzc3dvcmQiOiJiYTVhOWVmZGMzYTk2OTk0NjFmZTJiZDk5ZjcyM2VmODM4MzhjMjZiMGY4YzBlY2EwZjNmYTgzZjYwZTVjYjUyIiwiaWF0IjoxNjg0MzE3MTY5LCJleHAiOjE2ODQ5MjE5Njl9.o0CVY3xXj1Cy1fGTxNmEGNmFlm--3hKVMwtuOhAZQ8w; rl_anonymous_id=RudderEncrypt%3AU2FsdGVkX1%2BPVJA9ztoZpMG6avcbuCoEwoVZJfpceJLwxhvJhYxsTOIsdC1k9i3r%2FRIpEHqi7z5fb%2BnxVoSq9w%3D%3D; rl_group_id=RudderEncrypt%3AU2FsdGVkX1%2FLvJ9%2FTNBXIH6I36x34lCc1U7ao63uTGI%3D; rl_group_trait=RudderEncrypt%3AU2FsdGVkX19ZQuLnk9%2BDq9e9jrP00OVzuOPxpgHJk3A%3D; rl_user_id=RudderEncrypt%3AU2FsdGVkX19UYwb9Yv%2BPzNDQj0FHbvvAa3gpxq1Zf%2FSQUDMZ1UaqUkEz6pkCRa7KDGKkdLtQ4%2BXXKuthQNYiflkdFQ6CLbJGddyM2%2F5bUAUyxizTQn4oeZLwrouRUTDeI3FPmeB6YVCmsBkx4TGDUEeub2pSeSQs9ajH0mprnw8%3D; rl_trait=RudderEncrypt%3AU2FsdGVkX1%2FGESP%2FY%2BG6BnJYX54%2BKTfDZIbIDsBSN73HpN4ayXZNDiv4nAq%2BCqdqhZrYtUztZDmuErTVzMaOU8bWUcXbaHNKJiKULvg1ayB1RJMhCGGsk7usd6ac%2Fats%2B3nEeFueGjFZ0okqhW1FUhuExogX1d%2F7kSkPJRbCwUw%3D; ph_phc_4URIAm1uYfJO7j8kWSe0J8lc8IqnstRLS7Jx8NcakHo_posthog=%7B%22%24user_state%22%3A%22identified%22%2C%22%24sesid%22%3A%5B1684319731335%2C%2218829433167fd0-056b0fef1882b5-4f6a1673-384000-18829433168186a%22%2C1684319449447%5D%2C%22distinct_id%22%3A%2264a38b9b44838d7f40e62a857615246be15ea55c65a4232ba8f3a75cd176b811%23046030a1-3731-41de-8f0f-3256d3230478%22%2C%22%24device_id%22%3A%2218601ef75be9cc-0ce6bf713fc2a2-4f681673-1fa400-18601ef75bf11f2%22%2C%22%24user_id%22%3A%2264a38b9b44838d7f40e62a857615246be15ea55c65a4232ba8f3a75cd176b811%23046030a1-3731-41de-8f0f-3256d3230478%22%2C%22%24referrer%22%3A%22%24direct%22%2C%22%24referring_domain%22%3A%22%24direct%22%2C%22%24session_recording_enabled_server_side%22%3Afalse%2C%22%24autocapture_disabled_server_side%22%3Afalse%2C%22%24active_feature_flags%22%3A%5B%22schema-view%22%5D%2C%22%24enabled_feature_flags%22%3A%7B%22schema-view%22%3Atrue%7D%2C%22%24feature_flag_payloads%22%3A%7B%7D%2C%22%24stored_person_properties%22%3A%7B%22instance_id%22%3A%2264a38b9b44838d7f40e62a857615246be15ea55c65a4232ba8f3a75cd176b811%22%2C%22created_at_timestamp%22%3A1672300025973%7D%7D; rl_session=RudderEncrypt%3AU2FsdGVkX1%2B%2FSNKvwzP7AZzjE6Q77c1uKQVWzbMOnjzXEcCnJJ6QWbHaVkhLZz3SabNWAl9hW%2FzqmaPKuG9mt1%2BdxTixYiBgh0pC9d%2Bpkwj2CXCAStjZ52FPCPZ3Y2J%2FHITjKAqW%2BkHs2YXW7u0zQw%3D%3D","dnt":"1","referer":"https://nhanh.vn/","sec-ch-ua":"\"Chromium\";v=\"112\", \"Microsoft Edge\";v=\"112\", \"Not:A-Brand\";v=\"99\"","sec-ch-ua-mobile":"?0","sec-ch-ua-platform":"\"macOS\"","sec-fetch-dest":"document","sec-fetch-mode":"navigate","sec-fetch-site":"cross-site","sec-fetch-user":"?1","upgrade-insecure-requests":"1","x-forwarded-for":"125.235.236.156","x-forwarded-host":"app.n8n.vn","x-forwarded-port":"443","x-forwarded-proto":"https","x-forwarded-server":"422302823b8a","x-real-ip":"125.235.236.156"},"params":{},"query":{"accessCode":"Ptrj1xuHEtYS3q1MZUrMi8j0I9bRPfGd8fg4ToyXamfePrbYhNPrplogC8cCnerl"},"body":{}}}]},"versionId":"025e00d5-2345-4b45-bca1-758af9eda0a3","triggerCount":1,"tags":[{"createdAt":"2023-05-17T10:31:11.667Z","updatedAt":"2023-05-17T10:31:11.667Z","id":"18","name":"nhanhvn"}]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-05-17T10:31:25.156Z","updatedAt":"2023-05-17T10:34:42.000Z","id":"99","name":"Nhanhvn get product","active":false,"nodes":[{"parameters":{"rule":{"interval":[{}]}},"id":"51b002b5-352f-4a2e-9f89-83adbbfedbba","name":"Schedule Trigger","type":"n8n-nodes-base.scheduleTrigger","typeVersion":1,"position":[1080,620]},{"parameters":{"method":"POST","url":"https://nhanh.vn/oauth/access_token","sendBody":true,"contentType":"multipart-form-data","bodyParameters":{"parameters":[{"name":"version","value":"2.0"},{"name":"appId","value":"73489"},{"name":"secretKey","value":"LKHpYif8ACwSFQ8BG2wz4igX5o6RRTDlnbpNOSIFbfFPNdEPvwrITURW8TE7WfdWLSCO7fGuEa6HUFC7l2vDg4LtEU4mgExSoygDQE5JBjMBnOIu9ZUguupIp8FlpQ7h"}]},"options":{}},"id":"1691ffde-9ffb-478b-9e11-117df777fc80","name":"Get temporary access token","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[1300,620]}],"connections":{"Schedule Trigger":{"main":[[{"node":"Get temporary access token","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{},"versionId":"9d117e81-fe2b-4781-8026-b29504b6256f","triggerCount":0,"tags":[{"createdAt":"2023-05-17T10:31:11.667Z","updatedAt":"2023-05-17T10:31:11.667Z","id":"18","name":"nhanhvn"}]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-05-19T12:24:03.831Z","updatedAt":"2023-05-19T12:24:03.831Z","id":"101","name":"g·ª≠i email cho kh√°ch h√†ng","active":false,"nodes":[{"parameters":{},"id":"99dfc2e1-a895-4e94-9aad-e17f332cecb8","name":"When clicking \"Execute Workflow\"","type":"n8n-nodes-base.manualTrigger","typeVersion":1,"position":[860,500]}],"connections":{},"settings":{},"staticData":null,"pinData":{},"versionId":"56b4188f-4dc0-441a-8074-2264d8bee378","triggerCount":0,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-05-20T09:27:27.824Z","updatedAt":"2023-05-20T09:27:27.824Z","id":"102","name":"My workflow 10","active":false,"nodes":[{"parameters":{},"id":"346267d5-fa7b-4014-87eb-2d3abc27685d","name":"When clicking \"Execute Workflow\"","type":"n8n-nodes-base.manualTrigger","typeVersion":1,"position":[640,580]},{"parameters":{"fromEmail":"hello@mail.nucuoimekong.com","toEmail":"khoilq@kdigi.vn","subject":"Xin ch√†o t·ª´ N·ª• C∆∞·ªùi M√™ K√¥ng","emailFormat":"html","html":"<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\">\n<html xmlns=\"http://www.w3.org/1999/xhtml\" xmlns:o=\"urn:schemas-microsoft-com:office:office\">\n\n<head>\n    <meta charset=\"UTF-8\">\n    <meta content=\"width=device-width, initial-scale=1\" name=\"viewport\">\n    <meta name=\"x-apple-disable-message-reformatting\">\n    <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\n    <meta content=\"telephone=no\" name=\"format-detection\">\n    <title></title>\n    <!--[if (mso 16)]>\n    <style type=\"text/css\">\n    a {text-decoration: none;}\n    </style>\n    <![endif]-->\n    <!--[if gte mso 9]><style>sup { font-size: 100% !important; }</style><![endif]-->\n    <!--[if gte mso 9]>\n<xml>\n    <o:OfficeDocumentSettings>\n    <o:AllowPNG></o:AllowPNG>\n    <o:PixelsPerInch>96</o:PixelsPerInch>\n    </o:OfficeDocumentSettings>\n</xml>\n<![endif]-->\n</head>\n\n<body>\n    <div class=\"es-wrapper-color\">\n        <!--[if gte mso 9]>\n\t\t\t<v:background xmlns:v=\"urn:schemas-microsoft-com:vml\" fill=\"t\">\n\t\t\t\t<v:fill type=\"tile\" color=\"#f6f6f6\"></v:fill>\n\t\t\t</v:background>\n\t\t<![endif]-->\n        <table class=\"es-wrapper\" width=\"100%\" cellspacing=\"0\" cellpadding=\"0\">\n            <tbody>\n                <tr>\n                    <td class=\"esd-email-paddings\" valign=\"top\">\n                        <table cellpadding=\"0\" cellspacing=\"0\" class=\"es-content esd-header-popover\" align=\"center\">\n                            <tbody>\n                                <tr>\n                                    <td class=\"esd-stripe\" align=\"center\">\n                                        <table class=\"es-content-body\" width=\"600\" cellspacing=\"0\" cellpadding=\"0\" bgcolor=\"#ffffff\" align=\"center\">\n                                            <tbody>\n                                                <tr>\n                                                    <td class=\"esd-structure es-p15t es-p15b es-p20r es-p20l\" style=\"background-color: #3f4a94;\" bgcolor=\"#3f4a94\" align=\"left\">\n                                                        <!--[if mso]><table width=\"560\" cellpadding=\"0\" cellspacing=\"0\"><tr><td width=\"180\" valign=\"top\"><![endif]-->\n                                                        <table class=\"es-left\" cellspacing=\"0\" cellpadding=\"0\" align=\"left\">\n                                                            <tbody>\n                                                                <tr>\n                                                                    <td class=\"es-m-p0r es-m-p20b esd-container-frame\" width=\"180\" valign=\"top\" align=\"center\">\n                                                                        <table width=\"100%\" cellspacing=\"0\" cellpadding=\"0\">\n                                                                            <tbody>\n                                                                                <tr>\n                                                                                    <td class=\"esd-block-image es-m-txt-c\" align=\"left\" style=\"font-size: 0px;\"><a target=\"_blank\" href=\"https://skyward.vn\"><img src=\"https://gbrois.stripocdn.email/content/guids/CABINET_bf6c6f678bfa57f3c3d76f744cce1e115bbbe8762ed81976fc677bb981193aa5/images/footer_logo.png\" alt=\"Logo Skyward\" style=\"display: block;\" width=\"150\" title=\"Logo Skyward\"></a></td>\n                                                                                </tr>\n                                                                            </tbody>\n                                                                        </table>\n                                                                    </td>\n                                                                </tr>\n                                                            </tbody>\n                                                        </table>\n                                                        <!--[if mso]></td><td width=\"20\"></td><td width=\"360\" valign=\"top\"><![endif]-->\n                                                        <table cellspacing=\"0\" cellpadding=\"0\" align=\"right\">\n                                                            <tbody>\n                                                                <tr>\n                                                                    <td class=\"esd-container-frame\" width=\"360\" align=\"left\">\n                                                                        <table width=\"100%\" cellspacing=\"0\" cellpadding=\"0\">\n                                                                            <tbody>\n                                                                                <tr class=\"es-mobile-hidden\">\n                                                                                    <td class=\"esd-block-social es-p10t es-m-txt-c\" align=\"right\" style=\"font-size: 0px;\">\n                                                                                        <table class=\"es-table-not-adapt es-social\" cellspacing=\"0\" cellpadding=\"0\">\n                                                                                            <tbody>\n                                                                                                <tr>\n                                                                                                    <td class=\"es-p10r\" valign=\"top\" align=\"center\"><a target=\"_blank\" href=\"#\"><img title=\"Facebook\" src=\"https://gbrois.stripocdn.email/content/assets/img/social-icons/circle-black/facebook-circle-black.png\" alt=\"Fb\" width=\"32\"></a></td>\n                                                                                                    <td valign=\"top\" align=\"center\"><a target=\"_blank\" href=\"#\"><img title=\"Youtube\" src=\"https://gbrois.stripocdn.email/content/assets/img/social-icons/circle-black/youtube-circle-black.png\" alt=\"Yt\" width=\"32\"></a></td>\n                                                                                                </tr>\n                                                                                            </tbody>\n                                                                                        </table>\n                                                                                    </td>\n                                                                                </tr>\n                                                                            </tbody>\n                                                                        </table>\n                                                                    </td>\n                                                                </tr>\n                                                            </tbody>\n                                                        </table>\n                                                        <!--[if mso]></td></tr></table><![endif]-->\n                                                    </td>\n                                                </tr>\n                                            </tbody>\n                                        </table>\n                                    </td>\n                                </tr>\n                            </tbody>\n                        </table>\n                        <table class=\"es-header\" cellspacing=\"0\" cellpadding=\"0\" align=\"center\">\n                            <tbody>\n                                <tr>\n                                    <td class=\"esd-stripe\" align=\"center\">\n                                        <table class=\"es-header-body\" width=\"600\" cellspacing=\"0\" cellpadding=\"0\" bgcolor=\"#ffffff\" align=\"center\">\n                                            <tbody>\n                                                <tr>\n                                                    <td class=\"es-p20t es-p20r es-p20l esd-structure\" align=\"left\">\n                                                        <table cellspacing=\"0\" cellpadding=\"0\" width=\"100%\">\n                                                            <tbody>\n                                                                <tr>\n                                                                    <td class=\"es-m-p0r esd-container-frame\" width=\"560\" valign=\"top\" align=\"center\">\n                                                                        <table width=\"100%\" cellspacing=\"0\" cellpadding=\"0\">\n                                                                            <tbody>\n                                                                                <tr>\n                                                                                    <td align=\"center\" class=\"esd-empty-container\" style=\"display: none;\"></td>\n                                                                                </tr>\n                                                                            </tbody>\n                                                                        </table>\n                                                                    </td>\n                                                                </tr>\n                                                            </tbody>\n                                                        </table>\n                                                    </td>\n                                                </tr>\n                                            </tbody>\n                                        </table>\n                                    </td>\n                                </tr>\n                            </tbody>\n                        </table>\n                        <table class=\"es-content\" cellspacing=\"0\" cellpadding=\"0\" align=\"center\">\n                            <tbody>\n                                <tr>\n                                    <td class=\"esd-stripe\" align=\"center\">\n                                        <table class=\"es-content-body\" width=\"600\" cellspacing=\"0\" cellpadding=\"0\" bgcolor=\"#ffffff\" align=\"center\">\n                                            <tbody>\n                                                <tr>\n                                                    <td class=\"esd-structure es-p20t es-p20b es-p20r es-p20l\" align=\"left\">\n                                                        <table cellspacing=\"0\" cellpadding=\"0\" width=\"100%\">\n                                                            <tbody>\n                                                                <tr>\n                                                                    <td class=\"esd-container-frame\" width=\"560\" align=\"left\">\n                                                                        <table width=\"100%\" cellspacing=\"0\" cellpadding=\"0\">\n                                                                            <tbody>\n                                                                                <tr>\n                                                                                    <td align=\"left\" class=\"esd-block-text\">\n                                                                                        <p>Ch√†o [T√™n],</p>\n                                                                                        <p>C·∫£m ∆°n b·∫°n ƒë√£ quan t√¢m ƒë·∫øn v·ªã tr√≠ [V·ªã tr√≠ tuy·ªÉn d·ª•ng]t·∫°i <strong>C√¥ng ty TNHH Th∆∞∆°ng M·∫°i Skyward</strong>.</p>\n                                                                                        <p><br></p>\n                                                                                        <p>Ch√∫ng t√¥i g·ª≠i t·ªõi b·∫°n b√†i Test DISC c·ªßa c√¥ng ty chi ti·∫øt d∆∞·ªõi URL sau:</p>\n                                                                                        <p><b>Link Test DISC</b>:<a href=\"https://congcu.vita-share.com/disc\"> https://congcu.vita-share.com/disc</a></p>\n                                                                                        <p><br></p>\n                                                                                        <p>ƒê√¢y l√† m·ªôt b∆∞·ªõc c·∫ßn thi·∫øt trong qu√° tr√¨nh tuy·ªÉn d·ª•ng ƒë·ªÉ ch√∫ng t√¥i c√≥ th·ªÉ hi·ªÉu h∆°n v·ªÅ b·∫°n v√† gi√∫p cho qu√° tr√¨nh ·ª©ng tuy·ªÉn s·∫Øp t·ªõi c·ªßa ch√∫ng ta di·ªÖn ra thu·∫≠n l·ª£i h∆°n.</p>\n                                                                                        <p>B·∫°n vui l√≤ng ho√†n thi·ªán b√†i Test v√† <b>Upload ·∫£nh ch·ª•p</b> k·∫øt qu·∫£ ph·∫£n h·ªìi theo link d∆∞·ªõi ƒë√¢y ƒë·ªÉ nh·∫≠n ƒë∆∞·ª£c ƒë√°nh gi√° c·ªßa b·ªô ph·∫≠n nh√¢n s·ª± s·ªõm nh·∫•t:</p>\n                                                                                        <p><br></p>\n                                                                                        <p>URL upload k·∫øt qu·∫£: <a target=\"_blank\">[Link]</a></p>\n                                                                                        <p><br></p>\n                                                                                        <p><b>L∆∞u √Ω:</b> Deadline sau <b>48h</b> k·ªÉ t·ª´ khi b·∫°n nh·∫≠n ƒë∆∞·ª£c Email n√†y.</p>\n                                                                                        <p>---</p>\n                                                                                        <p>P/s:</p>\n                                                                                        <p>Th√¥ng tin chi ti·∫øt v·ªÅ c√¥ng ty,&nbsp; B·∫°n c√≥ th·ªÉ tham kh·∫£o t·∫°i:</p>\n                                                                                        <p>Website:<a href=\"https://skyward.vn/\"><b>https://skyward.vn/</b></a></p>\n                                                                                        <p>Facebook:<a href=\"https://www.facebook.com/skywardhr\"> https://www.facebook.com/skywardhr</a></p>\n                                                                                        <p><b>---</b></p>\n                                                                                        <p><b>N·∫øu c√≤n ƒëi·ªÅu g√¨ bƒÉn khoƒÉn, th·∫Øc m·∫Øc, b·∫°n c√≥ th·ªÉ li√™n h·ªá l·∫°i qua email n√†y.</b></p>\n                                                                                        <p>Ch√∫c b·∫°n m·ªôt ng√†y m·ªõi t·ªët l√†nh!</p>\n                                                                                        <p><br></p>\n                                                                                        <p><b>Tr√¢n tr·ªçng,</b></p>\n                                                                                    </td>\n                                                                                </tr>\n                                                                            </tbody>\n                                                                        </table>\n                                                                    </td>\n                                                                </tr>\n                                                            </tbody>\n                                                        </table>\n                                                    </td>\n                                                </tr>\n                                            </tbody>\n                                        </table>\n                                    </td>\n                                </tr>\n                            </tbody>\n                        </table>\n                        <table class=\"esd-footer-popover es-footer\" cellspacing=\"0\" cellpadding=\"0\" align=\"center\">\n                            <tbody>\n                                <tr>\n                                    <td class=\"esd-stripe\" align=\"center\">\n                                        <table class=\"es-footer-body\" width=\"600\" cellspacing=\"0\" cellpadding=\"0\" bgcolor=\"#ffffff\" align=\"center\">\n                                            <tbody>\n                                                <tr>\n                                                    <td class=\"esd-structure es-p15t es-p10b es-p20r es-p20l\" style=\"background-color: transparent;\" bgcolor=\"transparent\" align=\"left\">\n                                                        <table cellspacing=\"0\" cellpadding=\"0\" width=\"100%\">\n                                                            <tbody>\n                                                                <tr>\n                                                                    <td class=\"esd-container-frame\" width=\"560\" valign=\"top\" align=\"center\">\n                                                                        <table width=\"100%\" cellspacing=\"0\" cellpadding=\"0\">\n                                                                            <tbody>\n                                                                                <tr>\n                                                                                    <td align=\"center\" class=\"esd-block-spacer es-p20t es-p10b\" style=\"font-size:0\">\n                                                                                        <table border=\"0\" width=\"100%\" height=\"100%\" cellpadding=\"0\" cellspacing=\"0\">\n                                                                                            <tbody>\n                                                                                                <tr>\n                                                                                                    <td style=\"border-bottom: 1px solid #cccccc; background: unset; height: 1px; width: 100%; margin: 0px;\"></td>\n                                                                                                </tr>\n                                                                                            </tbody>\n                                                                                        </table>\n                                                                                    </td>\n                                                                                </tr>\n                                                                            </tbody>\n                                                                        </table>\n                                                                    </td>\n                                                                </tr>\n                                                                <tr>\n                                                                    <td class=\"esd-container-frame\" width=\"560\" align=\"left\">\n                                                                        <table width=\"100%\" cellspacing=\"0\" cellpadding=\"0\">\n                                                                            <tbody>\n                                                                                <tr>\n                                                                                    <td class=\"esd-block-image es-infoblock es-p5t es-p10b es-p5r es-p5l\" align=\"center\" style=\"font-size: 0px;\"><a target=\"_blank\" href=\"https://skyward.vn\"><img src=\"https://gbrois.stripocdn.email/content/guids/CABINET_bf6c6f678bfa57f3c3d76f744cce1e115bbbe8762ed81976fc677bb981193aa5/images/logo_skyward_long.png\" alt=\"Logo Skyward\" style=\"display: block;\" width=\"168\" title=\"Logo Skyward\" class=\"adapt-img\"></a></td>\n                                                                                </tr>\n                                                                                <tr>\n                                                                                    <td align=\"center\" class=\"esd-block-text\">\n                                                                                        <p style=\"color: #212121; font-size: 12px;\"><strong>SKYWARD TRADING COMPANY LIMITED</strong><br>Tel: (+84) 826203263<br>Email: hi@skyward.vn<br>Website: https://skyward.vn<br>Add:&nbsp;8 Phan Van Truong St, Dich Vong Hau Ward, Cau Giay Dict, Hanoi</p>\n                                                                                    </td>\n                                                                                </tr>\n                                                                            </tbody>\n                                                                        </table>\n                                                                    </td>\n                                                                </tr>\n                                                            </tbody>\n                                                        </table>\n                                                    </td>\n                                                </tr>\n                                                <tr>\n                                                    <td class=\"esd-structure es-p5t es-p20b es-p20r es-p20l\" align=\"left\">\n                                                        <table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\">\n                                                            <tbody>\n                                                                <tr>\n                                                                    <td width=\"560\" class=\"esd-container-frame\" align=\"center\" valign=\"top\">\n                                                                        <table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\">\n                                                                            <tbody>\n                                                                                <tr>\n                                                                                    <td align=\"center\" class=\"esd-block-text\">\n                                                                                        <p style=\"color: #cccccc; font-size: 10px;\">Copyright&nbsp;¬© 2023&nbsp;Skyward,&nbsp;All rights reserved.</p>\n                                                                                    </td>\n                                                                                </tr>\n                                                                            </tbody>\n                                                                        </table>\n                                                                    </td>\n                                                                </tr>\n                                                            </tbody>\n                                                        </table>\n                                                    </td>\n                                                </tr>\n                                                <tr>\n                                                    <td class=\"esd-structure es-p5t es-p20r es-p20l\" align=\"left\">\n                                                        <table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\">\n                                                            <tbody>\n                                                                <tr>\n                                                                    <td width=\"560\" class=\"esd-container-frame\" align=\"center\" valign=\"top\">\n                                                                        <table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\">\n                                                                            <tbody>\n                                                                                <tr>\n                                                                                    <td align=\"center\" class=\"esd-block-text\">\n                                                                                        <p style=\"color: #cccccc; font-size: 12px;\"><br></p>\n                                                                                    </td>\n                                                                                </tr>\n                                                                            </tbody>\n                                                                        </table>\n                                                                    </td>\n                                                                </tr>\n                                                            </tbody>\n                                                        </table>\n                                                    </td>\n                                                </tr>\n                                            </tbody>\n                                        </table>\n                                    </td>\n                                </tr>\n                            </tbody>\n                        </table>\n                    </td>\n                </tr>\n            </tbody>\n        </table>\n    </div>\n</body>\n\n</html>","options":{"replyTo":""}},"id":"e48dfd05-274f-4aa9-9d27-0cb66ff12041","name":"Send Email","type":"n8n-nodes-base.emailSend","typeVersion":2,"position":[860,580],"credentials":{"smtp":{"id":"53","name":"SMTP SES"}}}],"connections":{"When clicking \"Execute Workflow\"":{"main":[[{"node":"Send Email","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{},"versionId":"2a9ec0c0-853b-47f2-a146-6106ffc3cae5","triggerCount":0,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-05-22T10:50:13.490Z","updatedAt":"2023-07-24T10:56:59.000Z","id":"105","name":"Medicar: Push order from Shopify to Nhanh","active":true,"nodes":[{"parameters":{"authentication":"accessToken","topic":"orders/create"},"id":"62885e5f-0b9c-4dc1-9e46-ec4bf83904ee","name":"Shopify Trigger","type":"n8n-nodes-base.shopifyTrigger","typeVersion":1,"position":[460,460],"webhookId":"ea1cf77b-b570-454d-96e2-94c0943955b4","credentials":{"shopifyAccessTokenApi":{"id":"54","name":"Medicar-Vietnam: Shopify Access Token"}}},{"parameters":{"method":"POST","url":"https://open.nhanh.vn/api/order/add","sendBody":true,"contentType":"form-urlencoded","bodyParameters":{"parameters":[{"name":"version","value":"2.0"},{"name":"appId","value":"73499"},{"name":"businessId","value":"112545"},{"name":"accessToken","value":"bAHzqbYptLMywCYGtwLWmtAwC3EeX2WYsf9JzdRzInV1PVXaf8Qf5cxGRr3Rdl6sdR7jPdf0VBBCLxEo2gagmKPqLNCDdjO1UGjvbdm9pMvQwzrvVjDiqbK0ZXGu5CRYDhlyazWR1O0RuS7VsE19EvzTWOiiIXC9mpv8G10qK9jBpKW4EVtzdsQeU8jHlYJb"},{"name":"data","value":"={\"id\":{{ $json[\"order_number\"] }},\n\"customerName\":\"{{ $json[\"billing_address\"][\"name\"] }}\",\n\"customerMobile\":\"{{ $json[\"customerPhone\"] }}\",\n\"customerEmail\":\"{{ $json[\"customer\"][\"email\"] }}\",\n\"customerAddress\":\"{{ $json[\"billing_address\"][\"address1\"] }}\",\n\"customerWardLocationName\":\"{{ $json[\"billing_address\"][\"address2\"] }}\",\n\"customerCityName\":\"{{ $json[\"billing_address\"][\"city\"] }}\",\n\"paymentMethod\":\"{{ $json[\"payment_gateway_names\"][0] }}\",\n\"saleId\": 3100490,\n\"trafficSource\": \"Website\",\n\"status\":\"New\",\n\"moneyTransfer\":\"{{ $node[\"Collect items of Order\"].json[\"orderMoney\"] }}\",\n\"privateDescription\":\"{{ $node[\"Collect items of Order\"].json[\"paymentNote\"] }}\",\n\"productList\":{{ $json[\"products\"] }}}"}]},"options":{}},"id":"fb0f2e65-3280-4474-bc49-ce0a4265e6fe","name":"Push Order to Nhanh","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[900,460],"notes":"{\"id\":{{ $json[\"order_number\"] }},\n\"customerName\":{{ $json[\"billing_address\"][\"name\"] }},\n\"customerMobile\":{{ $json[\"billing_address\"][\"phone\"] }},\n\"customerEmail\":{{ $json[\"customer\"][\"email\"] }},\n\"customerAddress\":{{ $json[\"billing_address\"][\"address1\"] }},\n\"customerWardLocationName\":{{ $json[\"billing_address\"][\"address2\"] }},\n\"customerCityName\":{{ $json[\"billing_address\"][\"city\"] }},\n\"paymentMethod\":{{ $json[\"payment_gateway_names\"][0] }},\n\"status\":\"New\",\n\"productList\":{{ $json[\"products\"] }}}"},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/bot/v2/hook/93bbe2ad-20f4-4ba1-967d-c021dae137c7","sendBody":true,"specifyBody":"json","jsonBody":"={\n    \"msg_type\": \"interactive\",\n    \"card\": {\n        \"config\": {\n            \"wide_screen_mode\": true,\n            \"enable_forward\": true\n        },\n        \"elements\": [\n            {\n                \"tag\": \"div\",\n                \"fields\": [\n                    {\n                        \"is_short\": true,\n                        \"text\": {\n                            \"tag\": \"lark_md\",\n                            \"content\": \"**üè∑ Phone:**\\n {{ $node[\"Collect items of Order\"].json[\"customerPhone\"] }}\"\n                        }\n                    },\n                    {\n                        \"is_short\": true,\n                        \"text\": {\n                            \"tag\": \"lark_md\",\n                            \"content\": \"**üë§ Customer:**\\n {{ $node[\"Shopify Trigger\"].json[\"billing_address\"][\"name\"] }}\"\n                        }\n                    },\n                    {\n                        \"is_short\": true,\n                        \"text\": {\n                            \"tag\": \"lark_md\",\n                            \"content\": \"**üí∞ Total Money:**\\n {{ $node[\"Collect items of Order\"].json[\"orderMoneySt\"] }} VND\"\n                        }\n                    },\n                    {\n                        \"is_short\": true,\n                        \"text\": {\n                            \"tag\": \"lark_md\",\n                            \"content\": \"**üõí Address:**\\n {{ $node[\"Shopify Trigger\"].json[\"billing_address\"][\"city\"] }}\"\n                        }\n                    },\n                    {\n                        \"is_short\": true,\n                        \"text\": {\n                            \"tag\": \"lark_md\",\n                            \"content\": \"**üí∞ Payment Gate:**\\n {{ $node[\"Shopify Trigger\"].json[\"payment_gateway_names\"][0] }}\"\n                        }\n                    },\n                    {\n                        \"is_short\": false,\n                        \"text\": {\n                            \"tag\": \"lark_md\",\n                            \"content\": \"**üì• Order Note:**\\n {{ $node[\"Collect items of Order\"].json[\"paymentNote\"] }}\"\n                        }\n                    }\n                ]\n            }\n        ],\n        \"header\": {\n            \"template\": \"green\",\n            \"title\": {\n                \"content\": \"üéâ Shopify Order: {{ $node[\"Collect items of Order\"].json[\"orderMoneySt\"] }} VND üéâ\",\n                \"tag\": \"plain_text\"\n            }\n        }\n    }\n}","options":{}},"id":"71c259c6-d2ea-40e7-bcfc-f23032f0c466","name":"Push message to Lark","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[1120,460]},{"parameters":{"mode":"runOnceForEachItem","jsCode":"// Add a new field called 'myNewField' to the\n// JSON of the item\n$input.item.json.products = $('Shopify Trigger').item.json.line_items;\n$input.item.json.orderItems = []\nlet pI = 0\nlet orderMoney = 0\nlet pLength = $input.item.json.products.length;\nwhile (pI < pLength) {\n  let person = {\n    id:$input.item.json.products[pI].product_id, \n    quantity:$input.item.json.products[pI].quantity, \n    name:$input.item.json.products[pI].name,\n    //code:$input.item.json.products[pI].sku, \n    //type:$input.item.json.products[pI].title, \n    price:$input.item.json.products[pI].price, \n    //weight:$input.item.json.products[pI].grams\n  };\n  orderMoney += $input.item.json.products[pI].quantity * $input.item.json.products[pI].price\n  $input.item.json.orderItems[pI] = person;\n  pI++;\n}\n$input.item.json.customerPhone = $('Shopify Trigger').item.json.billing_address.phone.replaceAll(\" \",\"\")\n$input.item.json.orderMoney = 0\nif (\"Chuy·ªÉn Kho·∫£n Ng√¢n H√†ng Th·ªß C√¥ng\" == $('Shopify Trigger').item.json.payment_gateway_names || \"Thanh to√°n Alepay ATM,QRCode,Th·∫ª Qu·ªëc t·∫ø,Tr·∫£ g√≥p\" == $('Shopify Trigger').item.json.payment_gateway_names) {\n  $input.item.json.orderMoney = orderMoney;\n  $input.item.json.paymentNote = \"Check chuyen khoan truoc\";\n}\n$input.item.json.orderMoneySt = orderMoney.toLocaleString(\"de-DE\")\n\n$input.item.json.products = JSON.stringify($input.item.json.orderItems)\n\nreturn $input.item.json;"},"id":"1c0794e2-1efc-45f3-8081-d7eb960a96c0","name":"Collect items of Order","type":"n8n-nodes-base.code","typeVersion":1,"position":[680,460],"notes":"\n$input.item.json.order = \"\"\n$input.item.json.order.id = \n$input.item.json.order.customerName = \n$input.item.json.order.customerMobile = \n$input.item.json.order.customerEmail = \n$input.item.json.order.customerAddress = \n$input.item.json.order.customerCityName = \n$input.item.json.order.customerDistrictName = \n$input.item.json.order.customerWardLocationName = \n$input.item.json.order.paymentMethod = \n$input.item.json.order.status = \"New\";\n$input.item.json.order.productList = $input.item.json.orderItems"}],"connections":{"Shopify Trigger":{"main":[[{"node":"Collect items of Order","type":"main","index":0}]]},"Push Order to Nhanh":{"main":[[{"node":"Push message to Lark","type":"main","index":0}]]},"Collect items of Order":{"main":[[{"node":"Push Order to Nhanh","type":"main","index":0}]]}},"settings":{},"staticData":{"node:Shopify Trigger":{"webhookId":1203858014425}},"pinData":{},"versionId":"21651ffd-a74c-4e75-887d-7df4a97efc69","triggerCount":1,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-05-23T19:46:32.643Z","updatedAt":"2023-06-08T01:21:37.000Z","id":"106","name":"ƒê·ªçc ph√¢n t√≠ch Email - Fullerton","active":false,"nodes":[{"parameters":{"options":{"allowUnauthorizedCerts":true}},"name":"IMAP Email","type":"n8n-nodes-base.emailReadImap","position":[380,240],"typeVersion":1,"id":"b54b0716-f9eb-4ce9-b54f-988a4d4c62bb","retryOnFail":false,"alwaysOutputData":false,"credentials":{"imap":{"id":"59","name":"IMAP account 2"}}},{"parameters":{"setAllData":false,"sourceKey":"attachment_0","destinationKey":"xml","options":{"encoding":"utf8","keepSource":false}},"name":"Move Binary Data","type":"n8n-nodes-base.moveBinaryData","position":[540,240],"typeVersion":1,"id":"f12aa28d-b98e-4625-8d89-3144a9a42f1b","disabled":true},{"parameters":{"dataPropertyName":"xml","options":{"explicitRoot":true,"ignoreAttrs":true}},"name":"XML","type":"n8n-nodes-base.xml","position":[730,240],"typeVersion":1,"id":"3e040aa3-e5e0-4368-abc6-ce494a1b8778","disabled":true},{"parameters":{"requestMethod":"POST","url":"http://localhost:5679/api/sales-order","allowUnauthorizedCerts":true,"responseFormat":"string","dataPropertyName":"status","options":{"bodyContentType":"form-urlencoded"},"bodyParametersUi":{"parameter":[{"name":"orderRequest","value":"={{$node[\"Set\"].data}}"}]}},"name":"HTTP Request","type":"n8n-nodes-base.httpRequest","position":[1140,240],"typeVersion":1,"id":"374094a8-e27a-44d9-87b8-d398e172e751"},{"parameters":{"values":{"number":[]},"options":{}},"name":"Set","type":"n8n-nodes-base.set","position":[880,240],"typeVersion":1,"id":"470fd1f6-8711-45fd-a8a0-8dcffd8fbfe3","disabled":true}],"connections":{"Set":{"main":[[{"node":"HTTP Request","type":"main","index":0}]]},"XML":{"main":[[{"node":"Set","type":"main","index":0}]]},"IMAP Email":{"main":[[{"node":"Move Binary Data","type":"main","index":0}]]},"Move Binary Data":{"main":[[{"node":"XML","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{},"versionId":"a3d82e54-96c3-4425-8d2f-6f611ae3a4ab","triggerCount":1,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-05-28T15:16:19.723Z","updatedAt":"2023-05-28T16:05:36.000Z","id":"107","name":"My workflow 11","active":true,"nodes":[{"parameters":{"httpMethod":"POST","path":"7a363e75-c3e3-4ff7-98da-ae327c0365ed","options":{}},"id":"f4002084-65bd-4a47-922d-753191cc01c2","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[840,460],"webhookId":"7a363e75-c3e3-4ff7-98da-ae327c0365ed"},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/bitable/v1/apps/Vjikb3AkUaksGzseJLbuqwBesMg/tables/tblnotJtbHhuoFWK/records","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $node[\"Lay-Tenant-Access\"].json[\"body\"][\"tenant_access_token\"] }}"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\"fields\":{\"address\":\"{{ $node[\"Webhook\"].json[\"body\"][\"address\"] }}\",\"link\":\"{{ $node[\"Webhook\"].json[\"body\"][\"link\"] }} \",\"name\":\"{{ $node[\"Webhook\"].json[\"body\"][\"name\"] }}\",\"phone\":\"{{ $node[\"Webhook\"].json[\"body\"][\"phone\"] }}\"}}","options":{"response":{"response":{"fullResponse":true}}}},"id":"f2d3ae66-76b7-4822-b592-545882395837","name":"BanVaoBase","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[1280,480]},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/auth/v3/tenant_access_token/internal","sendBody":true,"bodyParameters":{"parameters":[{"name":"app_id","value":"cli_a4f9c9053d38d00a"},{"name":"app_secret","value":"TXPLOre84u85udS53VHiycMZl8B18NS1"}]},"options":{"response":{"response":{"fullResponse":true}}}},"id":"54b2ca6f-60d8-4be9-9c3d-33dbe1c1828f","name":"Lay-Tenant-Access","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[1060,460]}],"connections":{"Webhook":{"main":[[{"node":"Lay-Tenant-Access","type":"main","index":0}]]},"Lay-Tenant-Access":{"main":[[{"node":"BanVaoBase","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{},"versionId":"e30d0393-54a9-4292-a3b7-6f707a9e7c2e","triggerCount":1,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-05-30T04:44:54.840Z","updatedAt":"2023-07-16T09:36:57.000Z","id":"109","name":"Confirm_Received CV","active":true,"nodes":[{"parameters":{"httpMethod":"POST","path":"Receive-CV","options":{}},"id":"35cf49ef-8b4d-4ffb-853d-9ab6b42dff68","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[320,240],"webhookId":"26aad44b-ca49-46cb-8870-ec7ad41c6480"},{"parameters":{"fromEmail":"GRGR Tuy·ªÉn D·ª•ng <Tuyendung@grgr.vn>","toEmail":"={{ $json.query.Email }}","subject":"GRGR | X√ÅC NH·∫¨N TH√îNG TIN","emailFormat":"html","html":"<!DOCTYPE html>\n<html>\n<head>\n  <style>\n    body {\n      background-color: #21618C; /* M√†u n·ªÅn */\n      font-family: Arial, sans-serif; /* Font ch·ªØ */\n      color: #ffffff; /* M√†u ch·ªØ */\n    }\n    .container {\n      max-width: 600px;\n      margin: 0 auto;\n      padding: 20px;\n      text-align: center;\n    }\n    h1 {\n      font-size: 24px;\n      color: #ffffff;\n      margin-top: 0;\n    }\n    p {\n      font-size: 16px;\n      color: #ffffff;\n    }\n    .logo {\n      display: block;\n      margin-bottom: 20px;\n    }\n    .button-container {\n      display: flex;\n      justify-content: center;\n      align-items: center;\n    }\n    .button {\n      display: inline-block;\n      background-color: #ffffff;\n      color: #000000;\n      padding: 10px 20px;\n      margin-top: 20px;\n      text-decoration: none;\n      border-radius: 4px;\n    }\n    .contact-info {\n      font-size: 14px;\n      margin-top: 20px;\n    }\n    .contact-info a {\n      color: #ffffff;\n      text-decoration: underline;\n    }\n  </style>\n</head>\n<body>\n  <table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n    <tr>\n      <td align=\"center\" valign=\"top\">\n        <table cellpadding=\"0\" cellspacing=\"0\" border=\"0\" width=\"600\">\n          <tr>\n            <td align=\"center\" bgcolor=\"#21618C\" style=\"padding: 20px;\">\n              <img src=\"http://grgr.vn/Content/img/Logo.png\" alt=\"Logo\" class=\"logo\" width=\"100\" height=\"100\">\n              <h1>·ª®NG TUY·ªÇN TH√ÄNH C√îNG</h1>\n            </td>\n          </tr>\n          <tr>\n            <td bgcolor=\"#21618C\" style=\"padding: 20px;\">\n              <p>Ch√∫ng t√¥i ƒë√£ nh·∫≠n ƒë∆∞·ª£c th√¥ng tin ·ª©ng tuy·ªÉn c·ªßa B·∫°n. ƒê·ªÉ chu·∫©n b·ªã cho v√≤ng Ph·ªèng V·∫•n ti·∫øp theo, vui l√≤ng ho√†n th√†nh b√†i tr·∫Øc nghi·ªám ng·∫Øn d∆∞·ªõi ƒë√¢y</p>\n              \n              <div class=\"button-container\">\n                <a href=\"https://grgrcorp.larksuite.com/share/base/form/shrusbNouPG8Qvo9pUF6NV9cg3Y\" class=\"button\">B√ÄI TR·∫ÆC NGHI·ªÜM</a>\n              </div>\n              \n              <div class=\"contact-info\">\n                <p>Ph√≤ng Nh√¢n S·ª±</p>\n                <p>Cty TNHH GRGR | <a href=\"https://grgr.vn\">Grgr.vn</a> | Hotline: 086 98 908 98 (Anh D≈©ng)</p>\n              </div>\n            </td>\n          </tr>\n        </table>\n      </td>\n    </tr>\n  </table>\n</body>\n</html>","options":{}},"id":"58aee89f-2f42-4165-bc19-2a235b36be9b","name":"Send Email","type":"n8n-nodes-base.emailSend","typeVersion":2,"position":[520,240],"credentials":{"smtp":{"id":"56","name":"SMTP account 6"}}}],"connections":{"Webhook":{"main":[[{"node":"Send Email","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{},"versionId":"da3092f3-e241-4d3c-b69c-3f38c791a0e6","triggerCount":1,"tags":[{"createdAt":"2023-07-14T04:57:09.608Z","updatedAt":"2023-07-14T04:57:09.608Z","id":"24","name":"GRGR_Recruite"}]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-05-31T03:50:43.989Z","updatedAt":"2023-06-01T05:24:35.000Z","id":"110","name":"In phi·∫øu nh√°p Mieu","active":true,"nodes":[{"parameters":{"jsCode":"// Truy c·∫≠p body c·ªßa request\nconst body = items[0].json.body;\n\n// Tr√≠ch xu·∫•t c√°c bi·∫øn t·ª´ body\nconst SKUCha = body.SKUCha;\nconst MaRap = body.MaRap;\nconst MaVaiChinh = body.MaVaiChinh;\nconst TiLeSize = body.TiLeSize;\nconst DinhMuc = body.DinhMucVaiChinh;\nconst currentDate = new Date();\nconst month = currentDate.getMonth() + 1;\n\nlet htmlTables = '<p>Th√°ng: '\n  htmlTables +=`${month}</p><p>M√£ r·∫≠p: ${MaRap}</p><div class=\"table-wrapper\"><table><thead><tr><td colspan=\"2\">V·∫£i ch√≠nh: ${MaVaiChinh}</td><td>ƒê·ªãnh m·ª©c</td><td colspan=\"4\">T·ªâ l·ªá Size</td></tr></thead><tbody><tr><td class=\"cot-1 bentrai\" colspan=\"2\">${SKUCha}</td><td class=\"cot-4\"></td><td class=\"cot-5\" colspan=\"4\">${TiLeSize}</td></tr><tr><td class=\"cot-1\">V·∫£i l√≥t</td><td class=\"cot-2\"></td><td colspan=\"5\" rowspan=\"3\"></td></tr><tr><td>N√∫t</td><td></td></tr><tr><td>Ph·ª• li·ªáu kh√°c</td><td></td></tr></tbody></table></br></div>`;\n\n// Tr·∫£ v·ªÅ JSON m·ªõi\nreturn {\n  htmlTables: htmlTables\n};\n"},"id":"0c3c682b-10ce-4f8b-ab82-d7be7fabb4ca","name":"Code","type":"n8n-nodes-base.code","typeVersion":1,"position":[220,360]},{"parameters":{"html":"<!DOCTYPE html>\n\n<html>\n<head>\n  <meta charset=\"UTF-8\" />\n  <title>Phi·∫øu Nh√°p Mieu</title>\n</head>\n<body>\n  <div class=\"container\">\n    <h1><img src=\"https://theme.hstatic.net/200000561729/1000985167/14/logo.png?v=311\" width=\"18%\"/></h1>\n    <p>  ƒê·ªãa ch·ªâ: 400/2 L√™ VƒÉn S·ªπ, Q3 </p>\n    <p>  Tel: 0902.303.006 </p>\n    <h2 style=\"text-align:center;font-size:2em;font-weight:bold;\">Phi·∫øu Nh√°p Mieu</h2>\n    <p>Th√°ng:</p>\n    {{ $node[\"Code\"].json[\"htmlTables\"] }}\n    \n  </div>\n</body>\n</html>\n\n<style>\n.container {\n  background-color: #ffffff;\n  /*text-align: center;*/\n  padding: 16px;\n  border-radius: 8px;\n}\n\nbody{\n  text-align:left;\n}\nh1 {\n  color: #ff6d5a;\n  font-size: 24px;\n  font-weight: bold;\n  padding: 8px;\n}\n\nh2 {\n  color: #909399;\n  font-size: 18px;\n  font-weight: bold;\n  padding: 8px;\n}\n.table-wrapper {\n    display: flex;\n    flex-direction: column;\n  }\n\n  .table-wrapper table {\n    width: 100%;\n    border-collapse: collapse;\n    font-family: Arial, sans-serif;\n    margin-bottom: 20px;\n  }\n\n  .table-wrapper th,\n  .table-wrapper td {\n    border: 1px solid #ddd;\n    padding: 8px;\n    text-align: center;\n  }\n\n  .table-wrapper th {\n    background-color: #f2f2f2;\n    font-weight: bold;\n  }\n\n  .table-wrapper tbody tr:nth-child(even) {\n    background-color: #f9f9f9;\n  }\n  .bentrai{\n    text-align: left;\n    font-weight:bold;\n  }\n  .cot-1{\n    width:20%;\n  }\n  .cot-2,.cot-3,.cot-4{\n    width:15%;\n  }\n  .cot-5{\n   width:30%; \n  }\n</style>"},"id":"a6798220-712c-41c0-abfd-4b3f6c525b1b","name":"HTML","type":"n8n-nodes-base.html","typeVersion":1,"position":[420,360]},{"parameters":{"method":"PUT","url":"=https://open.larksuite.com/open-apis/bitable/v1/apps/QncPb90v9azHZRsiBsMutNctsrY/tables/tbl6zFuG4NPzXdKv/records/{{ $node[\"NhanLinkDraftMieu\"].json[\"body\"][\"recordsID\"] }}","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $node[\"Tenant\"].json[\"body\"][\"tenant_access_token\"] }}"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\"fields\":{\"Phi·∫øu Draft PO\":{\"link\":\"{{ $json[\"url\"] }}\",\"text\":\"xem h√¨nh\"}}}","options":{"response":{"response":{"fullResponse":true}}}},"id":"77cd77ac-411b-4fc6-8577-d2960dfca3cc","name":"HTTP Request3","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[1240,360]},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/auth/v3/tenant_access_token/internal","sendBody":true,"bodyParameters":{"parameters":[{"name":"app_id","value":"cli_a4d6c704d9b85009"},{"name":"app_secret","value":"mY1fnsO5t2PvCRhKV6TxLfYuO5Iw57zh"}]},"options":{"response":{"response":{"fullResponse":true}}}},"id":"adb5e1a2-a4a7-4353-996f-a3eb5eaabb51","name":"Tenant","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[680,360]},{"parameters":{"method":"POST","url":"https://hcti.io/v1/image","sendHeaders":true,"headerParameters":{"parameters":[{"name":"authorization","value":"Basic NmZkMTA3YjUtYzIxYy00ZTU4LTk4OGItYzEyMzQ0MDIyYmEyOjcxNGFmYWUxLTkwYzEtNDEwNy05MDgxLWYwOThmNmQ1Y2ZmMg=="}]},"sendBody":true,"contentType":"form-urlencoded","bodyParameters":{"parameters":[{"name":"html","value":"={{ $node[\"HTML\"].json[\"html\"] }}"},{"name":"ms_delay","value":"1000"}]},"options":{}},"id":"b5145d4c-10ab-4d01-9bbf-db21c82b1409","name":"ImageCreate","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[1020,360]},{"parameters":{"httpMethod":"POST","path":"b89bc4bd-a37b-47a3-9f9f-8e2631d1ca97","options":{}},"id":"b2b84aa1-51bc-4bbb-8896-85472615b3fc","name":"NhanLinkDraftMieu","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[-100,360],"webhookId":"56947aeb-2b39-4279-a71d-6225fb684aaa"}],"connections":{"Code":{"main":[[{"node":"HTML","type":"main","index":0}]]},"HTML":{"main":[[{"node":"Tenant","type":"main","index":0}]]},"Tenant":{"main":[[{"node":"ImageCreate","type":"main","index":0}]]},"ImageCreate":{"main":[[{"node":"HTTP Request3","type":"main","index":0}]]},"NhanLinkDraftMieu":{"main":[[{"node":"Code","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{},"versionId":"ecc56e92-96ea-4f36-a290-75b97d3e5bdb","triggerCount":1,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-05-31T08:40:31.792Z","updatedAt":"2023-06-01T04:43:30.000Z","id":"111","name":"B·∫Øn aproval l·ªánh sx","active":true,"nodes":[{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/auth/v3/tenant_access_token/internal","sendBody":true,"bodyParameters":{"parameters":[{"name":"app_id","value":"cli_a4d6c704d9b85009"},{"name":"app_secret","value":"mY1fnsO5t2PvCRhKV6TxLfYuO5Iw57zh"}]},"options":{"response":{"response":{"fullResponse":true}}}},"id":"ced292be-dedb-4f31-8991-2a9574963166","name":"Tenant","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[260,360]},{"parameters":{"httpMethod":"POST","path":"b89bc4bd-a37b-47a3-9f9f-8e2631d1ca79","options":{}},"id":"4ef4c428-1682-4e60-be32-719875ca6645","name":"NhanLinkDraftMieu","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[-100,360],"webhookId":"f41ab63e-0f01-40f2-a328-e5e050fd6449"},{"parameters":{"url":"https://open.larksuite.com/open-apis/bitable/v1/apps/QncPb90v9azHZRsiBsMutNctsrY/tables/tbl7pE4Q4B5FwP0m/records","sendQuery":true,"queryParameters":{"parameters":[{"name":"filter","value":"=CurrentValue.[M√£ Sketch_ID]=\"{{ $node[\"NhanLinkDraftMieu\"].json[\"body\"][\"marap\"] }}\""},{"name":"page_size","value":"20"}]},"sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $json[\"body\"][\"tenant_access_token\"] }}"}]},"options":{"response":{"response":{"fullResponse":true}}}},"id":"3a4635a6-3037-46ec-866f-f99f41513549","name":"layrecordsid","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[520,360]},{"parameters":{"method":"PUT","url":"=https://open.larksuite.com/open-apis/bitable/v1/apps/QncPb90v9azHZRsiBsMutNctsrY/tables/tbl7pE4Q4B5FwP0m/records/{{ $node[\"layrecordsid\"].json[\"body\"][\"data\"][\"page_token\"] }}","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $node[\"Tenant\"].json[\"body\"][\"tenant_access_token\"] }}"}]},"sendBody":true,"specifyBody":"json","jsonBody":"{\"fields\":{\"‚õîApproval form status\":\"OK\"}}","options":{"response":{"response":{"fullResponse":true}}}},"id":"d04fd679-a8d2-4187-ab67-5990a2f2cf4f","name":"CapNhatSTT","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[1240,360]}],"connections":{"Tenant":{"main":[[{"node":"layrecordsid","type":"main","index":0}]]},"NhanLinkDraftMieu":{"main":[[{"node":"Tenant","type":"main","index":0}]]},"layrecordsid":{"main":[[{"node":"CapNhatSTT","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{},"versionId":"a22f9ae5-be44-4bbc-b4de-f90646f31aff","triggerCount":1,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-06-05T23:06:11.188Z","updatedAt":"2023-06-08T07:19:39.000Z","id":"114","name":"[DONE]Media Net: Send email Payslip","active":false,"nodes":[{"parameters":{"httpMethod":"POST","path":"medianet-send-payslip","options":{}},"id":"3fdad122-553e-497c-9149-6138c1a18a00","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[180,380],"webhookId":"2630ad25-9d56-4f34-97c4-64b8098c64a8"},{"parameters":{"fromEmail":"=HR - Media Net <payslip@media.net.vn>","toEmail":"={{ $('Webhook').item.json[\"query\"][\"email\"] }}","subject":"= [Media Net]B·∫£ng l∆∞∆°ng th√°ng {{ $('Webhook').item.json[\"query\"][\"month\"] }} - {{ $('Webhook').item.json[\"query\"][\"name\"] }}","html":"=<!DOCTYPE html>\n<html>\n  <head>\n    <title>B·∫£ng l∆∞∆°ng</title>\n    <style>\n      body {\n        background-color: #f5f5f5;\n        font-family: Arial, sans-serif;\n      }\n      h1 {\n        text-align: center;\n        margin-top: 2rem;\n        margin-bottom: 2rem;\n        color: #333;\n        text-shadow: 0 0 10px rgba(0, 0, 0, 0.1);\n      }\n      table {\n        border-collapse: collapse;\n        width: 100%;\n        margin: 0 auto;\n        margin-bottom: 1rem;\n        box-shadow: 0 0 20px rgba(0, 0, 0, 0.15);\n        background: linear-gradient(to bottom, #f2f2f2, #fff);\n      }\n      th,\n      td {\n        padding: 1rem;\n        border: 1px solid #ddd;\n        text-align: center;\n        color: #333;\n      }\n      tr:nth-child(even) {\n        background-color: #e0e0e0;\n      }\n      tr:nth-child(odd) {\n        background-color: #f5f5f5;\n      }\n      .logo {\n        display: block;\n        margin: 0 auto;\n        max-width: 200px;\n      }\n      .container {\n        text-align: center;\n      }\n    </style>\n </head>\n  <body>\n    <div class=\"container\">\n      <img src=\"https://media.net.vn/logo-ngang.png\" alt=\"Logo c√¥ng ty\" class=\"logo\">\n      <h1>B·∫£ng l∆∞∆°ng c·ªßa {{ $('Webhook').item.json[\"query\"][\"name\"] }}</h1>\n      <table>\n        <tbody>\n        {{ $('Code').item.json[\"htmlSalaryFix\"] }}\n        {{ $('Code').item.json[\"htmlSalaryBHXH\"] }}\n        {{ $('Code').item.json[\"htmlTraffic\"] }}\n        {{ $('Code').item.json[\"htmlMultiplier\"] }}\n        {{ $('Code').item.json[\"htmlSalaryKD\"] }}\n        {{ $('Code').item.json[\"htmlSalaryTN\"] }}\n        {{ $('Code').item.json[\"htmlOther\"] }}\n        {{ $('Code').item.json[\"htmlChuyenCan\"] }}\n        {{ $('Code').item.json[\"htmlNote\"] }}\n        {{ $('Code').item.json[\"htmlSalaryTotal\"] }}\n        </tbody>\n      </table>\n    </div>\n  </body>\n</html>","options":{}},"id":"6025016b-f9e6-432a-a93f-e8dfd879e7d1","name":"Send Email1","type":"n8n-nodes-base.emailSend","typeVersion":1,"position":[560,380],"credentials":{"smtp":{"id":"57","name":"Media Net: Payslip"}}},{"parameters":{"mode":"runOnceForEachItem","jsCode":"// Add a new field called 'myNewField' to the JSON of the item\nconst config = { style: 'currency', currency: 'VND'}\n$input.item.json.htmlTraffic = \"\"\nif ($('Webhook').item.json.query.Traffic) {\n  $input.item.json.htmlTraffic = \"<tr><th>Traffic</th><td>\" + new Intl.NumberFormat('vi-VN').format($('Webhook').item.json.query.Traffic) + \"</td></tr>\"\n}\n$input.item.json.htmlMultiplier = \"\"\nif ($('Webhook').item.json.query.multiplier) {\n  $input.item.json.htmlMultiplier = \"<tr><th>H·ªá s·ªë</th><td>\" + $('Webhook').item.json.query.multiplier + \"</td></tr>\"\n}\n$input.item.json.htmlOther = \"\"\nif ($('Webhook').item.json.query.other) {\n  $input.item.json.htmlOther = \"<tr><th>Kh√°c</th><td>\" + new Intl.NumberFormat('vi-VN', config).format($('Webhook').item.json.query.other) + \"</td></tr>\"\n}\n$input.item.json.htmlSalaryKD = \"\"\nif ($('Webhook').item.json.query.salaryKD) {\n  $input.item.json.htmlSalaryKD = \"<tr><th>L∆∞∆°ng Kinh Doanh</th><td>\" + new Intl.NumberFormat('vi-VN', config).format($('Webhook').item.json.query.salaryKD.replaceAll(\"[\",\"\").replaceAll(\"]\",\"\")) + \"</td></tr>\"\n}\n$input.item.json.htmlSalaryTN = \"\"\nif ($('Webhook').item.json.query.salaryTN) {\n  $input.item.json.htmlSalaryTN = \"<tr><th>L∆∞∆°ng Tr√°ch Nhi·ªám</th><td>\" + new Intl.NumberFormat('vi-VN', config).format($('Webhook').item.json.query.salaryTN) + \"</td></tr>\"\n}\n$input.item.json.htmlSalaryBHXH = \"\"\nif ($('Webhook').item.json.query.BHXH) {\n  $input.item.json.htmlSalaryBHXH = \"<tr><th>BHXH</th><td>\" + new Intl.NumberFormat('vi-VN', config).format($('Webhook').item.json.query.BHXH) + \"</td></tr>\"\n}\n$input.item.json.htmlChuyenCan = \"\"\nif ($('Webhook').item.json.query.chuyencan) {\n  $input.item.json.htmlChuyenCan = \"<tr><th>Chuy√™n C·∫ßn</th><td>\" + new Intl.NumberFormat('vi-VN', config).format($('Webhook').item.json.query.chuyencan) + \"</td></tr>\"\n}\n$input.item.json.htmlNote = \"\"\nif ($('Webhook').item.json.query.chuyencan) {\n  $input.item.json.htmlNote = \"<tr><th>Ghi ch√∫</th><td>\" + $('Webhook').item.json.query.note + \"</td></tr>\"\n}\n\n$input.item.json.htmlSalaryFix = \"<tr><th>L∆∞∆°ng c∆° b·∫£n</th><td>\" + new Intl.NumberFormat('vi-VN', config).format($('Webhook').item.json.query.salaryFix) + \"</td></tr>\"\n$input.item.json.htmlSalaryTotal = \"<tr><th>T·ªïng l∆∞∆°ng th·ª±c nh·∫≠n</th><td>\" + new Intl.NumberFormat('vi-VN', config).format($('Webhook').item.json.query.salaryTotal.replaceAll(\"[\",\"\").replaceAll(\"]\",\"\")) + \"</td></tr>\"\n\n\n\nreturn $input.item;"},"id":"a4aef7ac-fa3c-454c-8231-6da09bb6e5bf","name":"Code","type":"n8n-nodes-base.code","typeVersion":1,"position":[360,380]}],"connections":{"Webhook":{"main":[[{"node":"Code","type":"main","index":0}]]},"Code":{"main":[[{"node":"Send Email1","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{},"versionId":"eac1bc89-b2e3-435d-b738-9592f5e53374","triggerCount":1,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-06-08T01:24:16.691Z","updatedAt":"2023-06-08T01:24:16.691Z","id":"115","name":"Receive email updates via IMAP","active":false,"nodes":[{"parameters":{"options":{"allowUnauthorizedCerts":false}},"name":"IMAP Email","type":"n8n-nodes-base.emailReadImap","position":[380,240],"typeVersion":1,"id":"9880c112-5e9b-40e4-8369-2bd83bcd6d37","credentials":{"imap":{"id":"59","name":"IMAP account 2"}}}],"connections":{},"settings":{},"staticData":null,"pinData":{},"versionId":"e3accfee-56af-4c15-9175-e1d76b1e86cb","triggerCount":0,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-06-08T07:18:28.035Z","updatedAt":"2023-06-08T07:18:44.000Z","id":"116","name":"HR send payslip email","active":true,"nodes":[{"parameters":{"httpMethod":"POST","path":"medianet-send-payslip","options":{}},"id":"dcdd9720-2827-4345-ae8e-5375b1e5627f","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[460,460],"webhookId":"2630ad25-9d56-4f34-97c4-64b8098c64a8"},{"parameters":{"fromEmail":"=HR - Media Net <payslip@media.net.vn>","toEmail":"={{ $('Webhook').item.json[\"query\"][\"email\"] }}","subject":"= [Media Net]B·∫£ng l∆∞∆°ng th√°ng {{ $('Webhook').item.json[\"query\"][\"month\"] }} - {{ $('Webhook').item.json[\"query\"][\"name\"] }}","html":"=<!DOCTYPE html>\n<html>\n  <head>\n    <title>B·∫£ng l∆∞∆°ng</title>\n    <style>\n      body {\n        background-color: #f5f5f5;\n        font-family: Arial, sans-serif;\n      }\n      h1 {\n        text-align: center;\n        margin-top: 2rem;\n        margin-bottom: 2rem;\n        color: #333;\n        text-shadow: 0 0 10px rgba(0, 0, 0, 0.1);\n      }\n      table {\n        border-collapse: collapse;\n        width: 100%;\n        margin: 0 auto;\n        margin-bottom: 1rem;\n        box-shadow: 0 0 20px rgba(0, 0, 0, 0.15);\n        background: linear-gradient(to bottom, #f2f2f2, #fff);\n      }\n      th,\n      td {\n        padding: 1rem;\n        border: 1px solid #ddd;\n        text-align: center;\n        color: #333;\n      }\n      tr:nth-child(even) {\n        background-color: #e0e0e0;\n      }\n      tr:nth-child(odd) {\n        background-color: #f5f5f5;\n      }\n      .logo {\n        display: block;\n        margin: 0 auto;\n        max-width: 200px;\n      }\n      .container {\n        text-align: center;\n      }\n    </style>\n </head>\n  <body>\n    <div class=\"container\">\n      <img src=\"https://media.net.vn/logo-ngang.png\" alt=\"Logo c√¥ng ty\" class=\"logo\">\n      <h1>B·∫£ng l∆∞∆°ng c·ªßa {{ $('Webhook').item.json[\"query\"][\"name\"] }}</h1>\n      <table>\n        <tbody>\n        {{ $('Code').item.json[\"htmlSalaryFix\"] }}\n        {{ $('Code').item.json[\"htmlSalaryBHXH\"] }}\n        {{ $('Code').item.json[\"htmlTraffic\"] }}\n        {{ $('Code').item.json[\"htmlMultiplier\"] }}\n        {{ $('Code').item.json[\"htmlSalaryKD\"] }}\n        {{ $('Code').item.json[\"htmlSalaryTN\"] }}\n        {{ $('Code').item.json[\"htmlOther\"] }}\n        {{ $('Code').item.json[\"htmlChuyenCan\"] }}\n        {{ $('Code').item.json[\"htmlNote\"] }}\n        {{ $('Code').item.json[\"htmlSalaryTotal\"] }}\n        </tbody>\n      </table>\n    </div>\n  </body>\n</html>","options":{}},"id":"1d3f2654-c475-40af-ba84-251f247c374d","name":"Send Email1","type":"n8n-nodes-base.emailSend","typeVersion":1,"position":[840,460],"credentials":{"smtp":{"id":"60","name":"Email HR"}}},{"parameters":{"mode":"runOnceForEachItem","jsCode":"// Add a new field called 'myNewField' to the JSON of the item\nconst config = { style: 'currency', currency: 'VND'}\n$input.item.json.htmlTraffic = \"\"\nif ($('Webhook').item.json.query.Traffic) {\n  $input.item.json.htmlTraffic = \"<tr><th>Traffic</th><td>\" + new Intl.NumberFormat('vi-VN').format($('Webhook').item.json.query.Traffic) + \"</td></tr>\"\n}\n$input.item.json.htmlMultiplier = \"\"\nif ($('Webhook').item.json.query.multiplier) {\n  $input.item.json.htmlMultiplier = \"<tr><th>H·ªá s·ªë</th><td>\" + $('Webhook').item.json.query.multiplier + \"</td></tr>\"\n}\n$input.item.json.htmlOther = \"\"\nif ($('Webhook').item.json.query.other) {\n  $input.item.json.htmlOther = \"<tr><th>Kh√°c</th><td>\" + new Intl.NumberFormat('vi-VN', config).format($('Webhook').item.json.query.other) + \"</td></tr>\"\n}\n$input.item.json.htmlSalaryKD = \"\"\nif ($('Webhook').item.json.query.salaryKD) {\n  $input.item.json.htmlSalaryKD = \"<tr><th>L∆∞∆°ng Kinh Doanh</th><td>\" + new Intl.NumberFormat('vi-VN', config).format($('Webhook').item.json.query.salaryKD.replaceAll(\"[\",\"\").replaceAll(\"]\",\"\")) + \"</td></tr>\"\n}\n$input.item.json.htmlSalaryTN = \"\"\nif ($('Webhook').item.json.query.salaryTN) {\n  $input.item.json.htmlSalaryTN = \"<tr><th>L∆∞∆°ng Tr√°ch Nhi·ªám</th><td>\" + new Intl.NumberFormat('vi-VN', config).format($('Webhook').item.json.query.salaryTN) + \"</td></tr>\"\n}\n$input.item.json.htmlSalaryBHXH = \"\"\nif ($('Webhook').item.json.query.BHXH) {\n  $input.item.json.htmlSalaryBHXH = \"<tr><th>BHXH</th><td>\" + new Intl.NumberFormat('vi-VN', config).format($('Webhook').item.json.query.BHXH) + \"</td></tr>\"\n}\n$input.item.json.htmlChuyenCan = \"\"\nif ($('Webhook').item.json.query.chuyencan) {\n  $input.item.json.htmlChuyenCan = \"<tr><th>Chuy√™n C·∫ßn</th><td>\" + new Intl.NumberFormat('vi-VN', config).format($('Webhook').item.json.query.chuyencan) + \"</td></tr>\"\n}\n$input.item.json.htmlNote = \"\"\nif ($('Webhook').item.json.query.chuyencan) {\n  $input.item.json.htmlNote = \"<tr><th>Ghi ch√∫</th><td>\" + $('Webhook').item.json.query.note + \"</td></tr>\"\n}\n\n$input.item.json.htmlSalaryFix = \"<tr><th>L∆∞∆°ng c∆° b·∫£n</th><td>\" + new Intl.NumberFormat('vi-VN', config).format($('Webhook').item.json.query.salaryFix) + \"</td></tr>\"\n$input.item.json.htmlSalaryTotal = \"<tr><th>T·ªïng l∆∞∆°ng th·ª±c nh·∫≠n</th><td>\" + new Intl.NumberFormat('vi-VN', config).format($('Webhook').item.json.query.salaryTotal.replaceAll(\"[\",\"\").replaceAll(\"]\",\"\")) + \"</td></tr>\"\n\n\n\nreturn $input.item;"},"id":"b879b4b0-c78b-4ab2-9043-e78d0b5e8602","name":"Code","type":"n8n-nodes-base.code","typeVersion":1,"position":[640,460]}],"connections":{"Webhook":{"main":[[{"node":"Code","type":"main","index":0}]]},"Code":{"main":[[{"node":"Send Email1","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{},"versionId":"2f5bb8b8-b1ea-4dab-a0c7-11dca4993c5b","triggerCount":1,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-06-08T17:53:46.349Z","updatedAt":"2023-06-12T18:12:21.000Z","id":"117","name":"HR_Talo01 - Email inform result (after TestCV) - OK","active":true,"nodes":[{"parameters":{"httpMethod":"POST","path":"send-email-test","options":{}},"id":"b4f7724d-d93a-427b-8a31-414c2e798a3b","name":"Webhook (get info of Candidate)","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[600,400],"webhookId":"8cad70c2-95e2-428a-bde1-742ccc5643d8"},{"parameters":{"fromEmail":"khangngo@khoingo.net","toEmail":"={{ $json.query.email }}","subject":"=Congratulations {{ $json.query.name }}! Your CV test has PASSED","emailFormat":"html","html":"=<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\">\n<html xmlns=\"http://www.w3.org/1999/xhtml\" xmlns:o=\"urn:schemas-microsoft-com:office:office\" style=\"font-family:arial, 'helvetica neue', helvetica, sans-serif\">\n<head>\n<meta charset=\"UTF-8\">\n<meta content=\"width=device-width, initial-scale=1\" name=\"viewport\">\n<meta name=\"x-apple-disable-message-reformatting\">\n<meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\n<meta content=\"telephone=no\" name=\"format-detection\">\n<title>New message</title><!--[if (mso 16)]>\n<style type=\"text/css\">\na {text-decoration: none;}\n</style>\n<![endif]--><!--[if gte mso 9]><style>sup { font-size: 100% !important; }</style><![endif]--><!--[if gte mso 9]>\n<xml>\n<o:OfficeDocumentSettings>\n<o:AllowPNG></o:AllowPNG>\n<o:PixelsPerInch>96</o:PixelsPerInch>\n</o:OfficeDocumentSettings>\n</xml>\n<![endif]--><!--[if !mso]><!-- -->\n<link href=\"https://fonts.googleapis.com/css2?family=Josefin+Sans&display=swap\" rel=\"stylesheet\"><!--<![endif]-->\n<style type=\"text/css\">\n#outlook a {\npadding:0;\n}\n.es-button {\nmso-style-priority:100!important;\ntext-decoration:none!important;\n}\na[x-apple-data-detectors] {\ncolor:inherit!important;\ntext-decoration:none!important;\nfont-size:inherit!important;\nfont-family:inherit!important;\nfont-weight:inherit!important;\nline-height:inherit!important;\n}\n.es-desk-hidden {\ndisplay:none;\nfloat:left;\noverflow:hidden;\nwidth:0;\nmax-height:0;\nline-height:0;\nmso-hide:all;\n}\n@media only screen and (max-width:600px) {p, ul li, ol li, a { line-height:150%!important } h1, h2, h3, h1 a, h2 a, h3 a { line-height:120% } h1 { font-size:30px!important; text-align:left } h2 { font-size:24px!important; text-align:left } h3 { font-size:20px!important; text-align:left } .es-header-body h1 a, .es-content-body h1 a, .es-footer-body h1 a { font-size:30px!important; text-align:left } .es-header-body h2 a, .es-content-body h2 a, .es-footer-body h2 a { font-size:24px!important; text-align:left } .es-header-body h3 a, .es-content-body h3 a, .es-footer-body h3 a { font-size:20px!important; text-align:left } .es-menu td a { font-size:14px!important } .es-header-body p, .es-header-body ul li, .es-header-body ol li, .es-header-body a { font-size:14px!important } .es-content-body p, .es-content-body ul li, .es-content-body ol li, .es-content-body a { font-size:14px!important } .es-footer-body p, .es-footer-body ul li, .es-footer-body ol li, .es-footer-body a { font-size:14px!important } .es-infoblock p, .es-infoblock ul li, .es-infoblock ol li, .es-infoblock a { font-size:12px!important } *[class=\"gmail-fix\"] { display:none!important } .es-m-txt-c, .es-m-txt-c h1, .es-m-txt-c h2, .es-m-txt-c h3 { text-align:center!important } .es-m-txt-r, .es-m-txt-r h1, .es-m-txt-r h2, .es-m-txt-r h3 { text-align:right!important } .es-m-txt-l, .es-m-txt-l h1, .es-m-txt-l h2, .es-m-txt-l h3 { text-align:left!important } .es-m-txt-r img, .es-m-txt-c img, .es-m-txt-l img { display:inline!important } .es-button-border { display:inline-block!important } a.es-button, button.es-button { font-size:18px!important; display:inline-block!important } .es-adaptive table, .es-left, .es-right { width:100%!important } .es-content table, .es-header table, .es-footer table, .es-content, .es-footer, .es-header { width:100%!important; max-width:600px!important } .es-adapt-td { display:block!important; width:100%!important } .adapt-img { width:100%!important; height:auto!important } .es-m-p0 { padding:0!important } .es-m-p0r { padding-right:0!important } .es-m-p0l { padding-left:0!important } .es-m-p0t { padding-top:0!important } .es-m-p0b { padding-bottom:0!important } .es-m-p20b { padding-bottom:20px!important } .es-mobile-hidden, .es-hidden { display:none!important } tr.es-desk-hidden, td.es-desk-hidden, table.es-desk-hidden { width:auto!important; overflow:visible!important; float:none!important; max-height:inherit!important; line-height:inherit!important } tr.es-desk-hidden { display:table-row!important } table.es-desk-hidden { display:table!important } td.es-desk-menu-hidden { display:table-cell!important } .es-menu td { width:1%!important } table.es-table-not-adapt, .esd-block-html table { width:auto!important } table.es-social { display:inline-block!important } table.es-social td { display:inline-block!important } .es-desk-hidden { display:table-row!important; width:auto!important; overflow:visible!important; max-height:inherit!important } .es-m-p5 { padding:5px!important } .es-m-p5t { padding-top:5px!important } .es-m-p5b { padding-bottom:5px!important } .es-m-p5r { padding-right:5px!important } .es-m-p5l { padding-left:5px!important } .es-m-p10 { padding:10px!important } .es-m-p10t { padding-top:10px!important } .es-m-p10b { padding-bottom:10px!important } .es-m-p10r { padding-right:10px!important } .es-m-p10l { padding-left:10px!important } .es-m-p15 { padding:15px!important } .es-m-p15t { padding-top:15px!important } .es-m-p15b { padding-bottom:15px!important } .es-m-p15r { padding-right:15px!important } .es-m-p15l { padding-left:15px!important } .es-m-p20 { padding:20px!important } .es-m-p20t { padding-top:20px!important } .es-m-p20r { padding-right:20px!important } .es-m-p20l { padding-left:20px!important } .es-m-p25 { padding:25px!important } .es-m-p25t { padding-top:25px!important } .es-m-p25b { padding-bottom:25px!important } .es-m-p25r { padding-right:25px!important } .es-m-p25l { padding-left:25px!important } .es-m-p30 { padding:30px!important } .es-m-p30t { padding-top:30px!important } .es-m-p30b { padding-bottom:30px!important } .es-m-p30r { padding-right:30px!important } .es-m-p30l { padding-left:30px!important } .es-m-p35 { padding:35px!important } .es-m-p35t { padding-top:35px!important } .es-m-p35b { padding-bottom:35px!important } .es-m-p35r { padding-right:35px!important } .es-m-p35l { padding-left:35px!important } .es-m-p40 { padding:40px!important } .es-m-p40t { padding-top:40px!important } .es-m-p40b { padding-bottom:40px!important } .es-m-p40r { padding-right:40px!important } .es-m-p40l { padding-left:40px!important } }\n</style>\n</head>\n<body style=\"width:100%;font-family:arial, 'helvetica neue', helvetica, sans-serif;-webkit-text-size-adjust:100%;-ms-text-size-adjust:100%;padding:0;Margin:0\">\n<div class=\"es-wrapper-color\" style=\"background-color:#E1ECF7\"><!--[if gte mso 9]>\n<v:background xmlns:v=\"urn:schemas-microsoft-com:vml\" fill=\"t\">\n<v:fill type=\"tile\" color=\"#e1ecf7\"></v:fill>\n</v:background>\n<![endif]-->\n<table class=\"es-wrapper\" width=\"100%\" cellspacing=\"0\" cellpadding=\"0\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;padding:0;Margin:0;width:100%;height:100%;background-repeat:repeat;background-position:center top;background-color:#E1ECF7\">\n<tr>\n<td valign=\"top\" style=\"padding:0;Margin:0\">\n<table cellpadding=\"0\" cellspacing=\"0\" class=\"es-header\" align=\"center\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;table-layout:fixed !important;width:100%;background-color:transparent;background-repeat:repeat;background-position:center top\">\n<tr>\n<td align=\"center\" style=\"padding:0;Margin:0\">\n<table bgcolor=\"#ffffff\" class=\"es-header-body\" align=\"center\" cellpadding=\"0\" cellspacing=\"0\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;background-color:#00406C;width:600px\">\n<tr>\n<td align=\"left\" background=\"https://fsswqj.stripocdn.email/content/guids/CABINET_0fa486e736790bd0e3fdb2f0eb814a76/images/hectorjrivas1fxmet2u5duunsplash_1.png\" style=\"padding:40px;Margin:0;background-image:url(https://fsswqj.stripocdn.email/content/guids/CABINET_0fa486e736790bd0e3fdb2f0eb814a76/images/hectorjrivas1fxmet2u5duunsplash_1.png);background-repeat:no-repeat;background-position:center top\"><!--[if mso]><table style=\"width:520px\" cellpadding=\"0\"\ncellspacing=\"0\"><tr><td style=\"width:156px\" valign=\"top\"><![endif]-->\n<table cellpadding=\"0\" cellspacing=\"0\" class=\"es-left\" align=\"left\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;float:left\">\n<tr>\n<td class=\"es-m-p0r es-m-p20b\" valign=\"top\" align=\"center\" style=\"padding:0;Margin:0;width:156px\">\n<table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" role=\"presentation\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\">\n<tr>\n<td align=\"center\" class=\"es-m-txt-c\" style=\"padding:0;Margin:0;padding-bottom:15px;font-size:0px\"><a target=\"_blank\" href=\"https://viewstripo.email\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:underline;color:#F8F9FB;font-size:12px\"><img src=\"https://fsswqj.stripocdn.email/content/guids/CABINET_4685288354889aa92224bd5cf29a8167f7a3aef4efade84ec6cfd54de4cde0aa/images/logopng21000x500chutrang.png\" alt style=\"display:block;border:0;outline:none;text-decoration:none;-ms-interpolation-mode:bicubic\" height=\"60\"></a></td>\n</tr>\n</table></td>\n</tr>\n</table><!--[if mso]></td><td style=\"width:20px\"></td><td style=\"width:344px\" valign=\"top\"><![endif]-->\n<table class=\"es-right\" cellpadding=\"0\" cellspacing=\"0\" align=\"right\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;float:right\">\n<tr>\n<td align=\"left\" style=\"padding:0;Margin:0;width:344px\">\n<table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" role=\"presentation\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\">\n<tr>\n<td align=\"right\" class=\"es-m-txt-c\" style=\"padding:0;Margin:0;padding-top:15px\"><p style=\"Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:'Josefin Sans', helvetica, arial, sans-serif;line-height:18px;color:#F8F9FB;font-size:12px\">(+84)28.665.66468</p></td>\n</tr>\n<tr>\n<td align=\"right\" class=\"es-m-txt-c\" style=\"padding:0;Margin:0;padding-top:10px\"><p style=\"Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:'Josefin Sans', helvetica, arial, sans-serif;line-height:18px;color:#F8F9FB;font-size:12px\">contact@khoingo.net</p></td>\n</tr>\n</table></td>\n</tr>\n</table><!--[if mso]></td></tr></table><![endif]--></td>\n</tr>\n</table></td>\n</tr>\n</table>\n<table cellpadding=\"0\" cellspacing=\"0\" class=\"es-content\" align=\"center\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;table-layout:fixed !important;width:100%\">\n<tr>\n<td align=\"center\" style=\"padding:0;Margin:0\">\n<table bgcolor=\"#ffffff\" class=\"es-content-body\" align=\"center\" cellpadding=\"0\" cellspacing=\"0\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;background-color:#F8F9FB;width:600px\">\n<tr>\n<td class=\"es-m-p0b\" align=\"left\" bgcolor=\"#fefefe\" style=\"Margin:0;padding-bottom:30px;padding-top:40px;padding-left:40px;padding-right:40px;background-color:#fefefe\">\n<table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\">\n<tr>\n<td align=\"left\" style=\"padding:0;Margin:0;width:520px\">\n<table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" role=\"presentation\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\">\n<tr>\n<td align=\"left\" style=\"padding:0;Margin:0\"><h1 style=\"Margin:0;line-height:48px;mso-line-height-rule:exactly;font-family:'Josefin Sans', helvetica, arial, sans-serif;font-size:40px;font-style:normal;font-weight:normal;color:#001523\">Dear {{ $json[\"query\"][\"name\"] }},</h1><p style=\"Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:'Josefin Sans', helvetica, arial, sans-serif;line-height:24px;color:#001523;font-size:16px\"><br>I hope this message finds you well. I am pleased to inform you that you have successfully completed the entrance test for the <strong>{{ $json[\"query\"][\"position\"] }} position</strong> at <strong>our company</strong>. Congratulations! Your performance on the test was impressive and we believe that you have the skills and abilities necessary to excel in this position.</p><p style=\"Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:'Josefin Sans', helvetica, arial, sans-serif;line-height:24px;color:#001523;font-size:16px\"><br></p><p style=\"Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:'Josefin Sans', helvetica, arial, sans-serif;line-height:24px;color:#001523;font-size:16px\">As the next step in our recruitment process, we would like to invite you to participate in an interview with our team. The interview will provide us with an opportunity to learn more about your experience, qualifications, and potential fit within our organization.</p><p style=\"Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:'Josefin Sans', helvetica, arial, sans-serif;line-height:24px;color:#001523;font-size:16px\">We are excited to meet with you and would like to <strong>schedule the interview for {{ $json[\"query\"][\"timeinterview\"] }}</strong>, <u>please confirm by button below</u>. If not, we can arrange for an alternative time that is more convenient. Please let us know if this date and time work for you.</p><p style=\"Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:'Josefin Sans', helvetica, arial, sans-serif;line-height:24px;color:#001523;font-size:16px\"><br></p><p style=\"Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:'Josefin Sans', helvetica, arial, sans-serif;line-height:24px;color:#001523;font-size:16px\">Once again, congratulations on this achievement and we look forward to meeting with you soon.</p><p style=\"Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:'Josefin Sans', helvetica, arial, sans-serif;line-height:24px;color:#001523;font-size:16px\"><br></p><p style=\"Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:'Josefin Sans', helvetica, arial, sans-serif;line-height:24px;color:#001523;font-size:16px\"><br></p></td>\n</tr>\n<tr>\n<td align=\"center\" style=\"padding:0;Margin:0\"><!--[if mso]><a href=\"https://khoingo.net\" target=\"_blank\" hidden>\n<v:roundrect xmlns:v=\"urn:schemas-microsoft-com:vml\" xmlns:w=\"urn:schemas-microsoft-com:office:word\" esdevVmlButton href=\"https://khoingo.net\"\nstyle=\"height:41px; v-text-anchor:middle; width:201px\" arcsize=\"37%\" stroke=\"f\" fillcolor=\"#f4ac32\">\n<w:anchorlock></w:anchorlock>\n<center style='color:#ffffff; font-family:\"Josefin Sans\", helvetica, arial, sans-serif; font-size:15px; font-weight:400; line-height:15px; mso-text-raise:1px'>Confirm Interview</center>\n</v:roundrect></a>\n<![endif]--><!--[if !mso]><!-- --><span class=\"msohide es-button-border\" style=\"border-style:solid;border-color:#2CB543;background:#F4AC32;border-width:0px;display:inline-block;border-radius:15px;width:auto;mso-hide:all\"><a href=\"https://app.n8n.vn/webhook/interview-confirm?RecordID={{$json[\"query\"][\"recordID\"]}}\" class=\"es-button\" target=\"_blank\" style=\"mso-style-priority:100 !important;text-decoration:none;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;color:#FFFFFF;font-size:18px;display:inline-block;background:#F4AC32;border-radius:15px;font-family:'Josefin Sans', helvetica, arial, sans-serif;font-weight:normal;font-style:normal;line-height:22px;width:auto;text-align:center;padding:10px 20px 10px 20px;mso-padding-alt:0;mso-border-alt:10px solid #F4AC32\">Confirm Interview</a></span><!--<![endif]--></td>\n</tr>\n<tr>\n<td align=\"left\" style=\"padding:0;Margin:0\"><p style=\"Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:'Josefin Sans', helvetica, arial, sans-serif;line-height:24px;color:#001523;font-size:16px\"><br></p><p style=\"Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:'Josefin Sans', helvetica, arial, sans-serif;line-height:24px;color:#001523;font-size:16px\">Best regards,</p><p style=\"Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:'Josefin Sans', helvetica, arial, sans-serif;line-height:24px;color:#001523;font-size:16px\"><strong>Khoi Ngo Security</strong></p></td>\n</tr>\n</table></td>\n</tr>\n</table></td>\n</tr>\n</table></td>\n</tr>\n</table>\n<table cellpadding=\"0\" cellspacing=\"0\" class=\"es-content\" align=\"center\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;table-layout:fixed !important;width:100%\">\n<tr>\n<td align=\"center\" style=\"padding:0;Margin:0\">\n<table bgcolor=\"#ffffff\" class=\"es-content-body\" align=\"center\" cellpadding=\"0\" cellspacing=\"0\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;background-color:#F8F9FB;width:600px\">\n<tr>\n<td align=\"left\" style=\"Margin:0;padding-top:20px;padding-bottom:40px;padding-left:40px;padding-right:40px\"><!--[if mso]><table style=\"width:520px\" cellpadding=\"0\" cellspacing=\"0\"><tr><td style=\"width:95px\" valign=\"top\"><![endif]-->\n<table cellpadding=\"0\" cellspacing=\"0\" class=\"es-left\" align=\"left\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;float:left\">\n<tr>\n<td align=\"left\" style=\"padding:0;Margin:0;width:95px\">\n<table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" role=\"presentation\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\">\n<tr>\n<td align=\"right\" class=\"es-m-txt-c\" style=\"padding:0;Margin:0;font-size:0px\"><a target=\"_blank\" href=\"https://viewstripo.email\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:underline;color:#001523;font-size:16px\"><img src=\"https://fsswqj.stripocdn.email/content/guids/CABINET_0fa486e736790bd0e3fdb2f0eb814a76/images/mask_group.png\" alt=\"Cornelia Watson\" style=\"display:block;border:0;outline:none;text-decoration:none;-ms-interpolation-mode:bicubic\" width=\"95\" title=\"Cornelia Watson\"></a></td>\n</tr>\n</table></td>\n</tr>\n</table><!--[if mso]></td><td style=\"width:20px\"></td><td style=\"width:405px\" valign=\"top\"><![endif]-->\n<table cellpadding=\"0\" cellspacing=\"0\" class=\"es-right\" align=\"right\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;float:right\">\n<tr>\n<td align=\"left\" style=\"padding:0;Margin:0;width:405px\">\n<table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" role=\"presentation\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\">\n<tr>\n<td align=\"left\" class=\"es-m-txt-c\" style=\"padding:0;Margin:0\"><h2 style=\"Margin:0;line-height:38px;mso-line-height-rule:exactly;font-family:'Josefin Sans', helvetica, arial, sans-serif;font-size:32px;font-style:normal;font-weight:normal;color:#001523\">Khang Ngo</h2></td>\n</tr>\n<tr>\n<td align=\"left\" class=\"es-m-txt-c\" style=\"padding:0;Margin:0;padding-top:5px\"><p style=\"Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:'Josefin Sans', helvetica, arial, sans-serif;line-height:24px;color:#001523;font-size:16px\">p: (+84)908.130.555</p></td>\n</tr>\n<tr>\n<td align=\"left\" class=\"es-m-txt-c\" style=\"padding:0;Margin:0;padding-top:5px\"><p style=\"Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:'Josefin Sans', helvetica, arial, sans-serif;line-height:24px;color:#001523;font-size:16px\">e: khangngo@khoingo.net</p></td>\n</tr>\n</table></td>\n</tr>\n</table><!--[if mso]></td></tr></table><![endif]--></td>\n</tr>\n</table></td>\n</tr>\n</table>\n<table cellpadding=\"0\" cellspacing=\"0\" class=\"es-footer\" align=\"center\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;table-layout:fixed !important;width:100%;background-color:transparent;background-repeat:repeat;background-position:center top\">\n<tr>\n<td align=\"center\" style=\"padding:0;Margin:0\">\n<table bgcolor=\"#ffffff\" class=\"es-footer-body\" align=\"center\" cellpadding=\"0\" cellspacing=\"0\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;background-color:#00406C;width:600px\">\n<tr>\n<td align=\"left\" background=\"https://fsswqj.stripocdn.email/content/guids/CABINET_0fa486e736790bd0e3fdb2f0eb814a76/images/hectorjrivas1fxmet2u5duunsplash_1.png\" style=\"Margin:0;padding-top:30px;padding-bottom:30px;padding-left:40px;padding-right:40px;background-image:url(https://fsswqj.stripocdn.email/content/guids/CABINET_0fa486e736790bd0e3fdb2f0eb814a76/images/hectorjrivas1fxmet2u5duunsplash_1.png);background-repeat:no-repeat;background-position:center top\"><!--[if mso]><table style=\"width:520px\" cellpadding=\"0\" cellspacing=\"0\"><tr><td style=\"width:194px\" valign=\"top\"><![endif]-->\n<table cellpadding=\"0\" cellspacing=\"0\" align=\"left\" class=\"es-left\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;float:left\">\n<tr>\n<td class=\"es-m-p20b\" align=\"left\" style=\"padding:0;Margin:0;width:194px\">\n<table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" role=\"presentation\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\">\n<tr>\n<td align=\"center\" class=\"es-m-txt-c\" style=\"padding:0;Margin:0;padding-bottom:15px;font-size:0px\"><a target=\"_blank\" href=\"https://viewstripo.email\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:underline;color:#F8F9FB;font-size:12px\"><img src=\"https://fsswqj.stripocdn.email/content/guids/CABINET_4685288354889aa92224bd5cf29a8167f7a3aef4efade84ec6cfd54de4cde0aa/images/logopng21000x500chutrang.png\" alt style=\"display:block;border:0;outline:none;text-decoration:none;-ms-interpolation-mode:bicubic\" height=\"60\"></a></td>\n</tr>\n<tr>\n<td align=\"center\" style=\"padding:0;Margin:0;font-size:0\">\n<table cellpadding=\"0\" cellspacing=\"0\" class=\"es-table-not-adapt es-social\" role=\"presentation\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\">\n<tr>\n<td align=\"center\" valign=\"top\" style=\"padding:0;Margin:0;padding-right:10px\"><a target=\"_blank\" href=\"https://viewstripo.email\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:underline;color:#F8F9FB;font-size:12px\"><img src=\"https://fsswqj.stripocdn.email/content/assets/img/social-icons/rounded-white/facebook-rounded-white.png\" alt=\"Fb\" title=\"Facebook\" height=\"24\" style=\"display:block;border:0;outline:none;text-decoration:none;-ms-interpolation-mode:bicubic\"></a></td>\n<td align=\"center\" valign=\"top\" style=\"padding:0;Margin:0;padding-right:10px\"><a target=\"_blank\" href=\"https://viewstripo.email\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:underline;color:#F8F9FB;font-size:12px\"><img src=\"https://fsswqj.stripocdn.email/content/assets/img/social-icons/rounded-white/twitter-rounded-white.png\" alt=\"Tw\" title=\"Twitter\" height=\"24\" style=\"display:block;border:0;outline:none;text-decoration:none;-ms-interpolation-mode:bicubic\"></a></td>\n<td align=\"center\" valign=\"top\" style=\"padding:0;Margin:0;padding-right:10px\"><a target=\"_blank\" href=\"https://viewstripo.email\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:underline;color:#F8F9FB;font-size:12px\"><img src=\"https://fsswqj.stripocdn.email/content/assets/img/social-icons/rounded-white/instagram-rounded-white.png\" alt=\"Ig\" title=\"Instagram\" height=\"24\" style=\"display:block;border:0;outline:none;text-decoration:none;-ms-interpolation-mode:bicubic\"></a></td>\n<td align=\"center\" valign=\"top\" style=\"padding:0;Margin:0\"><a target=\"_blank\" href=\"https://viewstripo.email\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:underline;color:#F8F9FB;font-size:12px\"><img src=\"https://fsswqj.stripocdn.email/content/assets/img/social-icons/rounded-white/youtube-rounded-white.png\" alt=\"Yt\" title=\"Youtube\" height=\"24\" style=\"display:block;border:0;outline:none;text-decoration:none;-ms-interpolation-mode:bicubic\"></a></td>\n</tr>\n</table></td>\n</tr>\n</table></td>\n</tr>\n</table><!--[if mso]></td><td style=\"width:20px\"></td><td style=\"width:306px\" valign=\"top\"><![endif]-->\n<table cellpadding=\"0\" cellspacing=\"0\" class=\"es-right\" align=\"right\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;float:right\">\n<tr>\n<td align=\"left\" style=\"padding:0;Margin:0;width:306px\">\n<table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" role=\"presentation\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\">\n<tr>\n<td align=\"center\" style=\"padding:0;Margin:0;padding-top:5px;padding-bottom:15px\"><p style=\"Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:'Josefin Sans', helvetica, arial, sans-serif;line-height:18px;color:#F8F9FB;font-size:12px\"><a target=\"_blank\" href=\"https://viewstripo.email\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:underline;color:#F8F9FB;font-size:12px\">My account&nbsp;</a>‚Ä¢ <a target=\"_blank\" href=\"https://viewstripo.email\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:underline;color:#F8F9FB;font-size:12px\">Blog</a>&nbsp;‚Ä¢ <a target=\"_blank\" href=\"https://viewstripo.email\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:underline;color:#F8F9FB;font-size:12px\">Help</a></p></td>\n</tr>\n<tr>\n<td align=\"center\" style=\"padding:0;Margin:0;padding-bottom:5px\"><p style=\"Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:'Josefin Sans', helvetica, arial, sans-serif;line-height:18px;color:#F8F9FB;font-size:12px\">Vestibulum morbi blandit cursus risus at ultrices mi<br><br><a href=\"\" target=\"_blank\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:underline;color:#F8F9FB;font-size:12px\">Unsubscribe</a></p></td>\n</tr>\n</table></td>\n</tr>\n</table><!--[if mso]></td></tr></table><![endif]--></td>\n</tr>\n</table></td>\n</tr>\n</table>\n<table cellpadding=\"0\" cellspacing=\"0\" class=\"es-content\" align=\"center\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;table-layout:fixed !important;width:100%\">\n<tr>\n<td class=\"es-info-area\" align=\"center\" style=\"padding:0;Margin:0\">\n<table class=\"es-content-body\" align=\"center\" cellpadding=\"0\" cellspacing=\"0\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;background-color:transparent;width:600px\">\n<tr>\n<td align=\"left\" style=\"Margin:0;padding-top:30px;padding-bottom:30px;padding-left:40px;padding-right:40px\">\n<table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\">\n<tr>\n<td align=\"center\" valign=\"top\" style=\"padding:0;Margin:0;width:520px\">\n<table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\">\n<tr>\n<td align=\"center\" style=\"padding:0;Margin:0;display:none\"></td>\n</tr>\n</table></td>\n</tr>\n</table></td>\n</tr>\n</table></td>\n</tr>\n</table></td>\n</tr>\n</table>\n</div>\n</body>\n</html>","options":{}},"id":"cc70808c-bcbc-4a94-8d7b-a4521b9a16be","name":"Send Email to Candidate + Link confirm interview","type":"n8n-nodes-base.emailSend","typeVersion":2,"position":[800,400],"credentials":{"smtp":{"id":"61","name":"SMTP account 7"}}}],"connections":{"Webhook (get info of Candidate)":{"main":[[{"node":"Send Email to Candidate + Link confirm interview","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{},"versionId":"82898262-30d4-478a-be3e-13ed95b12931","triggerCount":1,"tags":[{"createdAt":"2023-06-12T18:12:08.363Z","updatedAt":"2023-06-12T18:12:08.363Z","id":"19","name":"HR"}]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-06-09T18:33:56.761Z","updatedAt":"2023-06-12T18:12:09.000Z","id":"120","name":"HR_Talo02 - Update \"Interview Confirm\" after confirming the link button on the email - OK","active":true,"nodes":[{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/auth/v3/app_access_token/internal","sendBody":true,"specifyBody":"json","jsonBody":"{   \"app_id\": \"cli_a4c3e66985f8900a\",   \"app_secret\": \"ZLlDbTSOFGmX37k65jikZfsqEb2VF7jy\" }","options":{}},"id":"6e84a56f-e43f-41cc-b073-739410347bcb","name":"Lark Tenant","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[480,400]},{"parameters":{"path":"interview-confirm","options":{"responseData":"Thank you for confirming the interview schedule. Please arrive for the interview on time."}},"id":"a0e9c213-e979-48c4-8bb5-691bd80d9bc7","name":"Webhook (when click link confirm interview)","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[260,400],"webhookId":"9669169e-54e5-4ef1-85df-c6fc6036961a"},{"parameters":{"method":"PUT","url":"=https://open.larksuite.com/open-apis/bitable/v1/apps/RyEhb4l5IaBHUhsGS1aucjzjsAh/tables/tbllRKm8U4LMQE6j/records/{{$('Webhook (when click link confirm interview)').item.json.query.RecordID}}","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $json[\"app_access_token\"] }}"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\"fields\": {\"Interview Confirm\":\"Yes\"}}","options":{}},"id":"c968a28f-e29d-4223-87c6-08cd88be1567","name":"Update record (field \"Interview confirm\")","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[700,400]}],"connections":{"Lark Tenant":{"main":[[{"node":"Update record (field \"Interview confirm\")","type":"main","index":0}]]},"Webhook (when click link confirm interview)":{"main":[[{"node":"Lark Tenant","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{},"versionId":"9543141f-84ef-4916-947b-b615751668cc","triggerCount":1,"tags":[{"createdAt":"2023-06-12T18:12:08.363Z","updatedAt":"2023-06-12T18:12:08.363Z","id":"19","name":"HR"}]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-06-10T06:51:08.085Z","updatedAt":"2023-06-10T06:51:08.085Z","id":"121","name":"My workflow 12","active":false,"nodes":[{"parameters":{"authentication":"headerAuth","path":"confirm-n8n-email","options":{}},"id":"fc47fe9e-6c52-4bed-a582-044524118dfe","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[580,300],"webhookId":"fde63d39-d572-4d06-afb6-1c9200f05653","credentials":{"httpHeaderAuth":{"id":"27","name":"Header Auth account 2"}}}],"connections":{},"settings":{},"staticData":null,"pinData":{},"versionId":"08ae7a3f-48c9-4667-b7f3-5f34b7ec2dd1","triggerCount":0,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-06-12T16:19:27.286Z","updatedAt":"2023-06-12T16:19:27.286Z","id":"123","name":"My workflow 13","active":false,"nodes":[],"connections":{},"settings":{},"staticData":null,"pinData":{},"versionId":"83c7c8e5-3b9f-45e2-9eb3-f5d84b685af8","triggerCount":0,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-06-13T07:52:39.568Z","updatedAt":"2023-06-19T07:15:39.000Z","id":"124","name":"[Caresoft] Get call logs every hour","active":false,"nodes":[{"parameters":{"rule":{"interval":[{"field":"hours"}]}},"id":"fd76bbcd-bc77-419f-a4d5-9245e48abec3","name":"Schedule Trigger","type":"n8n-nodes-base.scheduleTrigger","typeVersion":1,"position":[140,380]},{"parameters":{"jsCode":"// Loop over input items and add a new field\n// called 'myNewField' to the JSON of each one\nlet startDate = new Date($('Schedule Trigger').first().json.timestamp);\nlet endDate = new Date($('Schedule Trigger').first().json.timestamp);\n\nstartDate.setHours(startDate.getHours() + 6);\n// startDate.setHours(startDate.getHours() - 720); // fetch data previous 30 days\nstartDate.setMinutes(0);\nstartDate.setSeconds(1);\n\nendDate.setHours(endDate.getHours() + 7); // Add 7 hrs to compensate for Caresoft time\n\nreturn {\n  json: {\n    startDate: startDate.toISOString(),\n    endDate: endDate.toISOString(),\n  },\n};"},"id":"465cd94d-9ae8-490d-8235-a1c7d2a31514","name":"Get start time","type":"n8n-nodes-base.code","typeVersion":1,"position":[340,380]},{"parameters":{"url":"https://web11.caresoft.vn/hsvn/api/v1/calls","sendQuery":true,"queryParameters":{"parameters":[{"name":"start_time_since","value":"={{ $node[\"Get start time\"].json.startDate }}"},{"name":"start_time_to","value":"={{ $node[\"Get start time\"].json.endDate }}"},{"name":"count","value":"500"},{"name":"page","value":"1"},{"name":"order_by","value":"start_time"},{"name":"order_type","value":"desc"}]},"sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization"}]},"options":{}},"id":"3ca9065d-0c49-4258-acc8-b95ed6e7d608","name":"Get call log in the last hour","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[520,380]},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/bitable/v1/apps/baslg7TBWBKBB5Bc5vJhovnm3Jc/tables/tbl62BNK4pAYT76F/records/batch_create","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $node[\"Get Lark tenant access token\"].json.tenant_access_token }}"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\"records\":{{ JSON.stringify($('[Call Log] Convert to Lark format').first().json.records) }}}","options":{}},"id":"5262915a-0195-42a3-86d8-9268e14b1351","name":"[Call data] Add records to Bitable","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[1300,500]},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/bitable/v1/apps/baslg7TBWBKBB5Bc5vJhovnm3Jc/tables/tblstCVsQu0Etn5e/records/batch_create","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $node[\"Get Lark tenant access token\"].json.tenant_access_token }}"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\"records\":{{ JSON.stringify($('[Raw call log] Convert to Lark format').first().json.records) }}}","options":{}},"id":"211f3057-995f-4e00-967c-18b60a22b9ac","name":"[Raw call log data] Add records to Bitable","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[1300,280]},{"parameters":{"jsCode":"let input = $('Get call log in the last hour').first().json.calls;\n\n// Get calls data\nlet records = input.map((call) => {\n  let fields = {\n    id: call.id,\n    customer_id: call.customer_id,\n    call_id: call.call_id,\n    path: {\n      text: \"Xem cu·ªôc g·ªçi\",\n      link: call.path\n    },\n    path_download: {\n      text:\"T·∫£i cu·ªôc g·ªçi\",\n      link: call.path_download\n    },\n    caller: call.caller,\n    called: call.called,\n    user_id: call.user_id,\n    agent_id: call.agent_id.split(',').at(-1),\n    agent_log: call.agent_id,\n    group_id: call.group_id,\n    call_type: call.call_type,\n    start_time: new Date(call.start_time).getTime() - 3600000*7, // substract 7hrs\n    call_status: call.call_status,\n    end_time: new Date(call.end_time).getTime() - 3600000*7,\n    wait_time: call.wait_time,\n    hold_time: call.hold_time,\n    talk_time: call.talk_time,\n    end_status: call.end_status,\n    ticket_id: call.ticket_id,\n    last_agent_id: call.last_agent_id,\n    last_user_id: call.last_user_id,\n    call_survey: call.call_survey,\n    call_survey_result: call.call_survey_result,\n    missed_reason: call.missed_reason,\n  };\n  return { fields };\n});\n\nlet result = { json: { records } };\nreturn result;"},"id":"865c559e-4bf8-44db-a81a-afe23890e84c","name":"[Raw call log] Convert to Lark format","type":"n8n-nodes-base.code","typeVersion":1,"position":[1100,280]},{"parameters":{"jsCode":"let input = $('Get call log in the last hour').first().json.calls;\n\n// Get calls data\nlet records = input.map((call) => {\n  let fields = {    \n    \"ID cu·ªôc g·ªçi\": call.call_id,   \n    // customer_id: call.customer_id,\n    // agent_id: call.agent_id,\n    // group_id: call.group_id,    \n    // ticket_id: call.ticket_id,   \n  };\n  return { fields };\n});\n\nlet result = { json: { records } };\nreturn result;"},"id":"bd587dd3-1e8c-42d7-9ecf-2022552759fc","name":"[Call Log] Convert to Lark format","type":"n8n-nodes-base.code","typeVersion":1,"position":[1100,500]},{"parameters":{"url":"=https://open.larksuite.com/open-apis/bitable/v1/apps/{{ $('Set Lark auth').json.appId }}/tables/{{ $('Set Lark auth').json.appId }}/records  ","options":{}},"id":"706450c5-31dc-41b7-aac5-cb0f4f103d2c","name":"Get Lark tenant access token","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[880,380]},{"parameters":{"values":{"string":[{"name":"appId"},{"name":"appSecret"}]},"options":{}},"id":"dbc64b45-4156-4f8f-9e2e-998302399f1a","name":"Set Lark auth","type":"n8n-nodes-base.set","typeVersion":1,"position":[700,380]}],"connections":{"Get start time":{"main":[[{"node":"Get call log in the last hour","type":"main","index":0}]]},"Get call log in the last hour":{"main":[[{"node":"Set Lark auth","type":"main","index":0}]]},"[Raw call log] Convert to Lark format":{"main":[[{"node":"[Raw call log data] Add records to Bitable","type":"main","index":0}]]},"[Call Log] Convert to Lark format":{"main":[[{"node":"[Call data] Add records to Bitable","type":"main","index":0}]]},"Set Lark auth":{"main":[[{"node":"Get Lark tenant access token","type":"main","index":0}]]},"Get Lark tenant access token":{"main":[[{"node":"[Raw call log] Convert to Lark format","type":"main","index":0},{"node":"[Call Log] Convert to Lark format","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{},"versionId":"c618768a-e84a-4397-95dd-d2f01ac74834","triggerCount":0,"tags":[{"createdAt":"2023-02-27T05:42:03.910Z","updatedAt":"2023-02-27T05:42:03.910Z","id":"10","name":"Caresoft"},{"createdAt":"2023-04-13T09:24:58.649Z","updatedAt":"2023-06-13T07:54:39.069Z","id":"14","name":"Template"}]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-06-13T07:53:12.642Z","updatedAt":"2023-06-19T07:16:12.000Z","id":"125","name":"[Caresoft] Get chat every hour","active":false,"nodes":[{"parameters":{"rule":{"interval":[{"field":"hours"}]}},"id":"587b7927-e21e-4cb5-bb17-fae11b0102f3","name":"Schedule Trigger","type":"n8n-nodes-base.scheduleTrigger","typeVersion":1,"position":[0,380]},{"parameters":{"jsCode":"// Loop over input items and add a new field\n// called 'myNewField' to the JSON of each one\nlet startDate = new Date($('Schedule Trigger').first().json.timestamp);\nlet endDate = new Date($('Schedule Trigger').first().json.timestamp);\n\nstartDate.setHours(startDate.getHours() + 6);\n// startDate.setHours(startDate.getHours() - 720); // fetch data previous 30 days\nstartDate.setMinutes(0);\nstartDate.setSeconds(1);\n\nendDate.setHours(endDate.getHours() + 7); // Add 7 hrs to compensate for Caresoft time\n\nreturn {\n  json: {\n    startDate: startDate.toISOString(),\n    endDate: endDate.toISOString(),\n  },\n};"},"id":"5fd9c1a6-902a-4f00-836a-3ee59def51e3","name":"Get start time","type":"n8n-nodes-base.code","typeVersion":1,"position":[180,380]},{"parameters":{"url":"https://web11.caresoft.vn/hsvn/api/v1/chats","sendQuery":true,"queryParameters":{"parameters":[{"name":"start_time_since","value":"={{ $node[\"Get start time\"].json.startDate }}"},{"name":"start_time_to","value":"={{ $node[\"Get start time\"].json.endDate }}"},{"name":"count","value":"500"},{"name":"chat_type","value":"1"},{"name":"page","value":"1"},{"name":"order_by","value":"start_time"},{"name":"order_type","value":"desc"}]},"sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization"}]},"options":{}},"id":"192de21b-8837-4b14-a5c7-9c3a7dda7063","name":"Get chat from agents in the last hour","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[460,300]},{"parameters":{"url":"https://web11.caresoft.vn/hsvn/api/v1/chats","sendQuery":true,"queryParameters":{"parameters":[{"name":"start_time_since","value":"={{ $node[\"Get start time\"].json.startDate }}"},{"name":"start_time_to","value":"={{ $node[\"Get start time\"].json.endDate }}"},{"name":"count","value":"500"},{"name":"chat_type","value":"0"},{"name":"page","value":"1"},{"name":"order_by","value":"start_time"},{"name":"order_type","value":"desc"}]},"sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization"}]},"options":{}},"id":"530d20c0-eed4-4ada-bff9-f6270f196b5b","name":"Get chat from customers in the last hour","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[460,520]},{"parameters":{"jsCode":"let data = $('Get chat from agents in the last hour').first().json\nlet chats = data.chats;\n\n// Get chat data\nchats = chats.map((chat) => {\n  return { ...chat, chat_type: 1 };\n});\n\nreturn chats;\n"},"id":"2654a0f9-57d6-479c-8849-909737868e89","name":"Add chat type for agents","type":"n8n-nodes-base.code","typeVersion":1,"position":[660,300]},{"parameters":{"jsCode":"let data = $('Get chat from customers in the last hour').first().json\nlet chats = data.chats;\n\n// Get chat data\nchats = chats.map((chat) => {\n  return { ...chat, chat_type: 0 };\n});\n\nreturn chats;\n"},"id":"0e4712ac-aecf-4076-b844-2c5f6833d976","name":"Add chat type for customers","type":"n8n-nodes-base.code","typeVersion":1,"position":[660,520]},{"parameters":{"jsCode":"let input1 = $('Add chat type for agents').all();\nlet input2 = $('Add chat type for customers').all();\n\nconst input = [...input1, ...input2];\n\n// Get calls data\nlet records = input.map((chat) => {\n  let fields = {\n    ticket_id: chat.json.ticket_id,\n    ticket_no: chat.json.ticket_no,\n    customer_id: chat.json.customer_id,\n    group_name: chat.json.group_name,\n    conversation_id: chat.json.conversation_id,\n    cus_email: chat.json.cus_email,\n    cus_name: chat.json.cus_name,\n    cus_phone: chat.json.cus_phone,\n    start_time: new Date(chat.json.start_time).getTime() - 3600000*7,\n    end_time: new Date(chat.json.end_time).getTime() - 3600000*7,\n    chat_duration: chat.json.chat_duration,\n    agent_email: chat.json.agent_email,\n    agent_name: chat.json.agent_name,\n    ring_time: chat.json.ring_time && new Date(chat.json.ring_time).getTime() - 3600000*7,\n    meet_time: chat.json.meet_time && new Date(chat.json.meet_time).getTime() - 3600000*7,\n    waitTime: chat.json.waitTime,\n    answer_time: chat.json.answer_time,\n    chat_status: chat.json.chat_status,\n    is_trigger: chat.json.is_trigger,\n    facebook_page_id: chat.json.facebook_page_id,\n    service_id: chat.json.service_id,\n    chat_type: chat.json.chat_type,\n  };\n  return { fields };\n});\n\nlet result = { json: { records } };\nreturn result;\n"},"id":"a67ac33f-5a2f-4aaf-bc35-dc0b405aaa94","name":"[Raw chat] Convert to Lark format","type":"n8n-nodes-base.code","typeVersion":1,"position":[1240,260]},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/bitable/v1/apps/baslg7TBWBKBB5Bc5vJhovnm3Jc/tables/tbli8yYZM1ABVqbO/records/batch_create","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $node[\"Get Lark tenant access token\"].json.tenant_access_token }}"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\"records\":{{ JSON.stringify($('[Raw chat] Convert to Lark format').first().json.records) }}}","options":{}},"id":"b6f75f74-1230-4365-a0c9-8c15ec2f804d","name":"[Raw chat] Add records to Bitable","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[1460,260]},{"parameters":{"jsCode":"let input1 = $('Add chat type for agents').all();\nlet input2 = $('Add chat type for customers').all();\n\nconst input = [...input1, ...input2];\n\nconsole.log(input)\n\n// Get calls data\nlet records = input.map((chat) => {\n  let fields = {\n    \"ID chat\": chat.json.conversation_id,\n  };\n  return { fields };\n});\n\nlet result = { json: { records } };\nreturn result;\n"},"id":"73982cec-fcd8-4b9c-afbc-461ca869dd0e","name":"[Chat] Convert to Lark format","type":"n8n-nodes-base.code","typeVersion":1,"position":[1240,560]},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/bitable/v1/apps/baslg7TBWBKBB5Bc5vJhovnm3Jc/tables/tbl91enKGtCUlweo/records/batch_create","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $node[\"Get Lark tenant access token\"].json.tenant_access_token }}"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\"records\":{{ JSON.stringify($('[Chat] Convert to Lark format').first().json.records) }}}","options":{}},"id":"48610dd9-75a3-4b57-9af3-c9a06bf261bc","name":"[Chat] Add records to Bitable","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[1460,560]},{"parameters":{"url":"=https://open.larksuite.com/open-apis/bitable/v1/apps/{{ $('Set Lark auth').json.appId }}/tables/{{ $('Set Lark auth').json.appId }}/records  ","options":{}},"id":"20b43aa3-484b-4607-9001-23edc025d630","name":"Get Lark tenant access token","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[1040,400]},{"parameters":{"values":{"string":[{"name":"appId"},{"name":"appSecret"}]},"options":{}},"id":"1e12f391-589f-445d-b692-054ac61710ec","name":"Set Lark auth","type":"n8n-nodes-base.set","typeVersion":1,"position":[860,400]}],"connections":{"Get start time":{"main":[[{"node":"Get chat from agents in the last hour","type":"main","index":0},{"node":"Get chat from customers in the last hour","type":"main","index":0}]]},"Get chat from agents in the last hour":{"main":[[{"node":"Add chat type for agents","type":"main","index":0}]]},"Get chat from customers in the last hour":{"main":[[{"node":"Add chat type for customers","type":"main","index":0}]]},"Add chat type for agents":{"main":[[{"node":"Set Lark auth","type":"main","index":0}]]},"Add chat type for customers":{"main":[[{"node":"Set Lark auth","type":"main","index":0}]]},"[Raw chat] Convert to Lark format":{"main":[[{"node":"[Raw chat] Add records to Bitable","type":"main","index":0}]]},"[Chat] Convert to Lark format":{"main":[[{"node":"[Chat] Add records to Bitable","type":"main","index":0}]]},"Set Lark auth":{"main":[[{"node":"Get Lark tenant access token","type":"main","index":0}]]},"Get Lark tenant access token":{"main":[[{"node":"[Raw chat] Convert to Lark format","type":"main","index":0},{"node":"[Chat] Convert to Lark format","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{},"versionId":"98e1390e-d453-4874-b909-001289b5b2d6","triggerCount":0,"tags":[{"createdAt":"2023-02-27T05:42:03.910Z","updatedAt":"2023-02-27T05:42:03.910Z","id":"10","name":"Caresoft"},{"createdAt":"2023-04-13T09:24:58.649Z","updatedAt":"2023-06-13T07:54:39.069Z","id":"14","name":"Template"}]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-06-13T07:53:49.993Z","updatedAt":"2023-06-19T07:13:30.000Z","id":"126","name":"[Caresoft] Get customer (contact) every hour","active":false,"nodes":[{"parameters":{"rule":{"interval":[{"field":"hours"}]}},"id":"177a3657-d480-4af8-88d4-aac33ac22c04","name":"Schedule Trigger","type":"n8n-nodes-base.scheduleTrigger","typeVersion":1,"position":[120,340]},{"parameters":{"jsCode":"// Loop over input items and add a new field\n// called 'myNewField' to the JSON of each one\nlet startDate = new Date($('Schedule Trigger').first().json.timestamp);\nlet endDate = new Date($('Schedule Trigger').first().json.timestamp);\n\nstartDate.setHours(startDate.getHours() - 1);\n// startDate.setHours(startDate.getHours() - 720);\nstartDate.setMinutes(0);\nstartDate.setSeconds(1);\n\nreturn {\n  json: {\n    startDate: startDate.toISOString(),\n    endDate: endDate.toISOString(),\n  },\n};"},"id":"aa5085a7-9392-4de1-ade4-4a68bc458094","name":"Get start time","type":"n8n-nodes-base.code","typeVersion":1,"position":[300,340]},{"parameters":{"jsCode":"let input = $('Get customer in the last hour').first().json.contacts;\n\n// Get calls data\nlet records = input.map((contact) => {\n  let fields = {\n    id: contact.id,\n    username: contact.username,\n    phone_no:contact.phone_no, \n    updated_at: new Date(contact.updated_at).getTime(),\n    created_at: new Date(contact.created_at).getTime(),    \n  };\n  return { fields };\n});\n\nlet result = { json: { records } };\nreturn result;"},"id":"3c383a84-4d00-4007-87d2-d8aea5eed488","name":"Convert to Lark format","type":"n8n-nodes-base.code","typeVersion":1,"position":[680,340]},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/bitable/v1/apps/baslg7TBWBKBB5Bc5vJhovnm3Jc/tables/tbljzeaqj3GQGfGn/records/batch_create","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $node[\"Get Lark tenant access token\"].json.tenant_access_token }}"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\"records\":{{ JSON.stringify($('Convert to Lark format').first().json.records) }}}","options":{}},"id":"5616076b-24ec-46ec-9b43-af7bcbd5a89d","name":"Add records to Bitable","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[1240,340]},{"parameters":{"url":"https://web11.caresoft.vn/hsvn/api/v1/contacts","sendQuery":true,"queryParameters":{"parameters":[{"name":"created_since","value":"={{ $node[\"Get start time\"].json.startDate }}"},{"name":"created_to","value":"={{ $node[\"Get start time\"].json.endDate }}"},{"name":"count","value":"500"},{"name":"page","value":"1"},{"name":"order_by","value":"created_at"},{"name":"order_type","value":"desc"}]},"sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization"}]},"options":{}},"id":"8ea47dc3-0c31-48bf-9001-035b285fb095","name":"Get customer in the last hour","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[480,340]},{"parameters":{"url":"=https://open.larksuite.com/open-apis/bitable/v1/apps/{{ $('Set Lark auth').json.appId }}/tables/{{ $('Set Lark auth').json.appId }}/records  ","options":{}},"id":"dd889737-b7eb-451e-ac74-a01cd11e1f31","name":"Get Lark tenant access token","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[1040,340]},{"parameters":{"values":{"string":[{"name":"appId"},{"name":"appSecret"}]},"options":{}},"id":"30366cd2-4d19-44fd-9216-e39822069a21","name":"Set Lark auth","type":"n8n-nodes-base.set","typeVersion":1,"position":[860,340]}],"connections":{"Schedule Trigger":{"main":[[]]},"Get start time":{"main":[[{"node":"Get customer in the last hour","type":"main","index":0}]]},"Convert to Lark format":{"main":[[{"node":"Set Lark auth","type":"main","index":0}]]},"Get customer in the last hour":{"main":[[{"node":"Convert to Lark format","type":"main","index":0}]]},"Set Lark auth":{"main":[[{"node":"Get Lark tenant access token","type":"main","index":0}]]},"Get Lark tenant access token":{"main":[[{"node":"Add records to Bitable","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{},"versionId":"0c711e54-9490-4a6f-9508-cd8cec85acf6","triggerCount":0,"tags":[{"createdAt":"2023-02-27T05:42:03.910Z","updatedAt":"2023-02-27T05:42:03.910Z","id":"10","name":"Caresoft"},{"createdAt":"2023-04-13T09:24:58.649Z","updatedAt":"2023-06-13T07:54:39.069Z","id":"14","name":"Template"}]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-06-13T07:54:25.974Z","updatedAt":"2023-06-19T07:15:01.000Z","id":"127","name":"[KiotViet] Get new orders every hour","active":false,"nodes":[{"parameters":{"rule":{"interval":[{"field":"hours"}]}},"id":"5dc5e73b-4ecd-4fea-9098-44a6bd2632cc","name":"Schedule Trigger","type":"n8n-nodes-base.scheduleTrigger","typeVersion":1,"position":[-480,440]},{"parameters":{"jsCode":"// Loop over input items and add a new field\n// called 'myNewField' to the JSON of each one\nlet startDate = new Date($('Schedule Trigger').first().json.timestamp);\nlet endDate = new Date($('Schedule Trigger').first().json.timestamp);\n\nstartDate.setHours(startDate.getHours() - 1);\n// startDate.setHours(startDate.getHours() - 960); // fetch data previous 30 days\nstartDate.setMinutes(0);\nstartDate.setSeconds(1);\n\nreturn {\n  json: {\n    startDate: startDate.toISOString(),\n    endDate: endDate.toISOString(),\n  },\n};"},"id":"bb70cd1a-208d-4433-9122-c95e66a8372e","name":"Get start time","type":"n8n-nodes-base.code","typeVersion":1,"position":[-300,440]},{"parameters":{"method":"POST","url":"https://id.kiotviet.vn/connect/token","sendBody":true,"contentType":"form-urlencoded","bodyParameters":{"parameters":[{"name":"scopes","value":"PublicApi.Access"},{"name":"grant_type","value":"client_credentials"},{"name":"client_id"},{"name":"client_secret"}]},"options":{}},"id":"3cc47d1c-de85-4cbd-8abb-f995dd5e0c8b","name":"[KiotViet_HN] Get access token","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[-40,340]},{"parameters":{"method":"POST","url":"https://id.kiotviet.vn/connect/token","sendBody":true,"contentType":"form-urlencoded","bodyParameters":{"parameters":[{"name":"scopes","value":"PublicApi.Access"},{"name":"grant_type","value":"client_credentials"},{"name":"client_id"},{"name":"client_secret"}]},"options":{}},"id":"8286d697-f562-4f24-969e-b715a9920b99","name":"[KiotViet_HCM] Get access token","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[-40,540]},{"parameters":{},"id":"4ba7db9b-b0c2-4a8f-aab1-00e2343f49d9","name":"Merge","type":"n8n-nodes-base.merge","typeVersion":2,"position":[560,440]},{"parameters":{"url":"https://public.kiotapi.com/orders","sendQuery":true,"queryParameters":{"parameters":[{"name":"pageSize","value":"100"},{"name":"currentItem","value":"0"},{"name":"orderBy","value":"purchaseDate"},{"name":"orderDirection","value":"desc"}]},"sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $('[KiotViet_HN] Get access token').first().json.access_token }}"},{"name":"Retailer","value":"hsvn"}]},"options":{}},"id":"ff359532-109f-44bd-ae62-bd55195b4cd8","name":"[KiotViet_HN] Get all orders","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[160,340]},{"parameters":{"url":"https://public.kiotapi.com/orders","sendQuery":true,"queryParameters":{"parameters":[{"name":"pageSize","value":"100"},{"name":"currentItem","value":"0"},{"name":"orderBy","value":"purchaseDate"},{"name":"orderDirection","value":"desc"}]},"sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $('[KiotViet_HCM] Get access token').first().json.access_token }}"},{"name":"Retailer","value":"cnhcm"}]},"options":{}},"id":"30a078b7-c610-4784-ad17-35a948e6de29","name":"[KiotViet_HCM] Get all orders","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[160,540]},{"parameters":{"jsCode":"let timeData = $('Get start time').first().json;\n\nlet data = $('[KiotViet_HN] Get all orders').first().json;\nlet orders = data.data;\n\n// Filter orders from last hour\norders = orders.filter((order) => {\n  let date = new Date(order.purchaseDate);\n  date.setHours(date.getHours() - 7);\n\n  const isoPurchaseDate = date.toISOString();\n  return (\n    timeData.startDate <= isoPurchaseDate && isoPurchaseDate <= timeData.endDate\n  );\n});\n\n// Get orders data\norders = orders.map((order) => {\n  return { ...order, hsvnBranch: 'HN' };\n});\n\nreturn orders;\n"},"id":"d201df6c-64d5-4ffb-a107-3ab209a93875","name":"Filter orders from last hour & Add HSVN branch for HN","type":"n8n-nodes-base.code","typeVersion":1,"position":[340,340]},{"parameters":{"jsCode":"let timeData = $('Get start time').first().json;\n\nlet data = $('[KiotViet_HCM] Get all orders').first().json;\nlet orders = data.data;\n\n// Filter orders from last hour\norders = orders.filter((order) => {\n  let date = new Date(order.purchaseDate);\n  date.setHours(date.getHours() - 7);\n\n  const isoPurchaseDate = date.toISOString();\n  return (\n    timeData.startDate <= isoPurchaseDate && isoPurchaseDate <= timeData.endDate\n  );\n});\n\n// Get orders data\norders = orders.map((order) => {\n  return { ...order, hsvnBranch: 'HCM' };\n});\n\nreturn orders;\n"},"id":"ba717efe-ff96-4f5f-8a67-1e74fe76d744","name":"Filter orders from last hour & Add HSVN branch for HCM","type":"n8n-nodes-base.code","typeVersion":1,"position":[340,540]},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/bitable/v1/apps/baslg7TBWBKBB5Bc5vJhovnm3Jc/tables/tblbAkzrlJSMQ0LN/records/batch_create","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $node[\"Get Lark tenant access token\"].json.tenant_access_token }}"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\"records\":{{ JSON.stringify($('[Raw order] Convert to Lark format').first().json.records) }}}","options":{}},"id":"71ac30c5-fa1f-418e-9106-f762012b5319","name":"[Raw order data] Add records to Bitable","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[1260,220]},{"parameters":{"jsCode":"let input = $('Merge').all();\n\n// Get calls data\nlet records = input.map((order) => {\n  order = order.json;\n  let fields = {\n    id: order.id + '',\n    uuid: order.uuid,\n    code: order.code,\n    purchaseDate: new Date(order.purchaseDate).getTime() - 3600000*7,\n    branchId: order.branchId,\n    branchName: order.branchName,\n    soldById: order.soldById,\n    soldByName: order.soldByName,\n    customerId: order.customerId,\n    customerCode: order.customerCode,\n    customerName: order.customerName,\n    orderId: order.orderId,\n    orderCode: order.orderCode,\n    total: order.total,\n    totalPayment: order.totalPayment,\n    discount: order.discount,\n    status: order.status,\n    statusValue: order.statusValue,\n    description: order.description,\n    usingCod: order.usingCod,\n    createdDate: new Date(order.createdDate).getTime() - 3600000*7,\n    hsvnBranch: order.hsvnBranch,\n  };\n  return { fields };\n});\n\nlet result = { json: { records } };\nreturn result;\n"},"id":"05e8083e-2a8e-4923-aad7-e42aeeecee93","name":"[Raw order] Convert to Lark format","type":"n8n-nodes-base.code","typeVersion":1,"position":[1060,220]},{"parameters":{"jsCode":"let input = $('Merge').all();\n\n// Get calls data\nlet records = input.map((order) => {\n  order = order.json;\n  let fields = {\n    'ID ƒë∆°n h√†ng': order.id+\"\",\n  };\n  return { fields };\n});\n\nlet result = { json: { records } };\nreturn result;\n"},"id":"9e07f00a-0731-48f9-88a1-aacf093de4d6","name":"[Order] Convert to Lark format","type":"n8n-nodes-base.code","typeVersion":1,"position":[1060,440]},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/bitable/v1/apps/baslg7TBWBKBB5Bc5vJhovnm3Jc/tables/tblBk4ORszXYRZna/records/batch_create","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $node[\"Get Lark tenant access token\"].json.tenant_access_token }}"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\"records\":{{ JSON.stringify($('[Order] Convert to Lark format').first().json.records) }}}","options":{}},"id":"6c88860d-fd90-4a56-b6f8-21c9a9d43bd6","name":"[Order data] Add records to Bitable","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[1260,440]},{"parameters":{"jsCode":"let input = $('Merge').all();\n\n// Get calls data\nlet records = input.map((order) => {\n  order = order.json;\n  let fields = {\n    ID: order.id+\"\",\n    type: 'Order',\n    purchaseDate:new Date(order.purchaseDate).getTime() - 3600000*7,\n    createdDate:new Date(order.createdDate).getTime() - 3600000*7,\n  };\n  return { fields };\n});\n\nlet result = { json: { records } };\nreturn result;\n"},"id":"c9b1b123-0740-45cd-ae77-c58a94139932","name":"[Order+Invoice] Convert to Lark format","type":"n8n-nodes-base.code","typeVersion":1,"position":[1060,660]},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/bitable/v1/apps/baslg7TBWBKBB5Bc5vJhovnm3Jc/tables/tbl700SZbgdgShtP/records/batch_create","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $node[\"Get Lark tenant access token\"].json.tenant_access_token }}"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\"records\":{{ JSON.stringify($('[Order+Invoice] Convert to Lark format').first().json.records) }}}","options":{}},"id":"be8620b2-fd12-423e-8636-d3ecdc477e0e","name":"[Order+Invoice data] Add records to Bitable","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[1260,660]},{"parameters":{"url":"=https://open.larksuite.com/open-apis/bitable/v1/apps/{{ $('Set Lark auth').json.appId }}/tables/{{ $('Set Lark auth').json.appId }}/records  ","options":{}},"id":"a9c153f7-fac4-480b-899a-45fc77c2868b","name":"Get Lark tenant access token","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[860,440]},{"parameters":{"values":{"string":[{"name":"appId"},{"name":"appSecret"}]},"options":{}},"id":"b7613d00-dbde-4e5b-aa03-06ce6541ecfc","name":"Set Lark auth","type":"n8n-nodes-base.set","typeVersion":1,"position":[700,440]}],"connections":{"Get start time":{"main":[[{"node":"[KiotViet_HN] Get access token","type":"main","index":0},{"node":"[KiotViet_HCM] Get access token","type":"main","index":0}]]},"[KiotViet_HN] Get access token":{"main":[[{"node":"[KiotViet_HN] Get all orders","type":"main","index":0}]]},"[KiotViet_HCM] Get access token":{"main":[[{"node":"[KiotViet_HCM] Get all orders","type":"main","index":0}]]},"Merge":{"main":[[{"node":"Set Lark auth","type":"main","index":0}]]},"[KiotViet_HN] Get all orders":{"main":[[{"node":"Filter orders from last hour & Add HSVN branch for HN","type":"main","index":0}]]},"[KiotViet_HCM] Get all orders":{"main":[[{"node":"Filter orders from last hour & Add HSVN branch for HCM","type":"main","index":0}]]},"Filter orders from last hour & Add HSVN branch for HN":{"main":[[{"node":"Merge","type":"main","index":0}]]},"Filter orders from last hour & Add HSVN branch for HCM":{"main":[[{"node":"Merge","type":"main","index":1}]]},"[Raw order] Convert to Lark format":{"main":[[{"node":"[Raw order data] Add records to Bitable","type":"main","index":0}]]},"[Order] Convert to Lark format":{"main":[[{"node":"[Order data] Add records to Bitable","type":"main","index":0}]]},"[Order+Invoice] Convert to Lark format":{"main":[[{"node":"[Order+Invoice data] Add records to Bitable","type":"main","index":0}]]},"Set Lark auth":{"main":[[{"node":"Get Lark tenant access token","type":"main","index":0}]]},"Get Lark tenant access token":{"main":[[{"node":"[Raw order] Convert to Lark format","type":"main","index":0},{"node":"[Order] Convert to Lark format","type":"main","index":0},{"node":"[Order+Invoice] Convert to Lark format","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{},"versionId":"dd3d10e3-7063-4f54-b0f1-6f684208a107","triggerCount":0,"tags":[{"createdAt":"2023-03-13T02:38:31.340Z","updatedAt":"2023-03-13T02:38:31.340Z","id":"11","name":"KiotViet"},{"createdAt":"2023-04-13T09:24:58.649Z","updatedAt":"2023-06-13T07:54:39.069Z","id":"14","name":"Template"}]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-06-13T07:56:49.708Z","updatedAt":"2023-06-13T18:03:54.000Z","id":"128","name":"HR_Talo03 - After \"Interview Result\" has PASS, send congratulation email and time start to working","active":true,"nodes":[{"parameters":{"conditions":{"string":[{"value1":"={{ $json.query.interviewresult }}","value2":"Pass"}]}},"id":"0e438dd6-0816-4dd4-aa70-3af6a1c9358c","name":"IF","type":"n8n-nodes-base.if","typeVersion":1,"position":[1040,300]},{"parameters":{"conditions":{"string":[{"value1":"={{ $json.query.interviewresult }}","value2":"Fail"}]}},"id":"e03f0326-89f7-43f8-9341-14c8f6000e50","name":"IF1","type":"n8n-nodes-base.if","typeVersion":1,"position":[1040,480]},{"parameters":{"fromEmail":"khangngo@khoingo.net","toEmail":"={{ $json.query.email }}","subject":"=Congratulations {{ $json.query.name }} has PASS the Interview!","emailFormat":"html","html":"=<!DOCTYPE HTML PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional //EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\">\n<html xmlns=\"http://www.w3.org/1999/xhtml\" xmlns:v=\"urn:schemas-microsoft-com:vml\" xmlns:o=\"urn:schemas-microsoft-com:office:office\">\n\n<head>\n  <!--[if gte mso 9]>\n<xml>\n  <o:OfficeDocumentSettings>\n    <o:AllowPNG/>\n    <o:PixelsPerInch>96</o:PixelsPerInch>\n  </o:OfficeDocumentSettings>\n</xml>\n<![endif]-->\n  <meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\">\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n  <meta name=\"x-apple-disable-message-reformatting\">\n  <!--[if !mso]><!-->\n  <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\n  <!--<![endif]-->\n  <title></title>\n\n  <style type=\"text/css\">\n    @media only screen and (min-width: 620px) {\n      .u-row {\n        width: 600px !important;\n      }\n      .u-row .u-col {\n        vertical-align: top;\n      }\n      .u-row .u-col-100 {\n        width: 600px !important;\n      }\n    }\n    \n    @media (max-width: 620px) {\n      .u-row-container {\n        max-width: 100% !important;\n        padding-left: 0px !important;\n        padding-right: 0px !important;\n      }\n      .u-row .u-col {\n        min-width: 320px !important;\n        max-width: 100% !important;\n        display: block !important;\n      }\n      .u-row {\n        width: 100% !important;\n      }\n      .u-col {\n        width: 100% !important;\n      }\n      .u-col>div {\n        margin: 0 auto;\n      }\n    }\n    \n    body {\n      margin: 0;\n      padding: 0;\n    }\n    \n    table,\n    tr,\n    td {\n      vertical-align: top;\n      border-collapse: collapse;\n    }\n    \n    p {\n      margin: 0;\n    }\n    \n    .ie-container table,\n    .mso-container table {\n      table-layout: fixed;\n    }\n    \n    * {\n      line-height: inherit;\n    }\n    \n    a[x-apple-data-detectors='true'] {\n      color: inherit !important;\n      text-decoration: none !important;\n    }\n    \n    table,\n    td {\n      color: #000000;\n    }\n    \n    #u_body a {\n      color: #0000ee;\n      text-decoration: underline;\n    }\n  </style>\n\n\n\n  <!--[if !mso]><!-->\n  <link href=\"https://fonts.googleapis.com/css?family=Cabin:400,700\" rel=\"stylesheet\" type=\"text/css\">\n  <!--<![endif]-->\n\n</head>\n\n<body class=\"clean-body u_body\" style=\"margin: 0;padding: 0;-webkit-text-size-adjust: 100%;background-color: #f9f9f9;color: #000000\">\n  <!--[if IE]><div class=\"ie-container\"><![endif]-->\n  <!--[if mso]><div class=\"mso-container\"><![endif]-->\n  <table id=\"u_body\" style=\"border-collapse: collapse;table-layout: fixed;border-spacing: 0;mso-table-lspace: 0pt;mso-table-rspace: 0pt;vertical-align: top;min-width: 320px;Margin: 0 auto;background-color: #f9f9f9;width:100%\" cellpadding=\"0\" cellspacing=\"0\">\n    <tbody>\n      <tr style=\"vertical-align: top\">\n        <td style=\"word-break: break-word;border-collapse: collapse !important;vertical-align: top\">\n          <!--[if (mso)|(IE)]><table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\"><tr><td align=\"center\" style=\"background-color: #f9f9f9;\"><![endif]-->\n\n\n          <div class=\"u-row-container\" style=\"padding: 0px;background-color: transparent\">\n            <div class=\"u-row\" style=\"Margin: 0 auto;min-width: 320px;max-width: 600px;overflow-wrap: break-word;word-wrap: break-word;word-break: break-word;background-color: transparent;\">\n              <div style=\"border-collapse: collapse;display: table;width: 100%;height: 100%;background-color: transparent;\">\n                <!--[if (mso)|(IE)]><table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\"><tr><td style=\"padding: 0px;background-color: transparent;\" align=\"center\"><table cellpadding=\"0\" cellspacing=\"0\" border=\"0\" style=\"width:600px;\"><tr style=\"background-color: transparent;\"><![endif]-->\n\n                <!--[if (mso)|(IE)]><td align=\"center\" width=\"600\" style=\"width: 600px;padding: 0px;border-top: 0px solid transparent;border-left: 0px solid transparent;border-right: 0px solid transparent;border-bottom: 0px solid transparent;\" valign=\"top\"><![endif]-->\n                <div class=\"u-col u-col-100\" style=\"max-width: 320px;min-width: 600px;display: table-cell;vertical-align: top;\">\n                  <div style=\"height: 100%;width: 100% !important;\">\n                    <!--[if (!mso)&(!IE)]><!-->\n                    <div style=\"box-sizing: border-box; height: 100%; padding: 0px;border-top: 0px solid transparent;border-left: 0px solid transparent;border-right: 0px solid transparent;border-bottom: 0px solid transparent;\">\n                      <!--<![endif]-->\n\n                      <table style=\"font-family:'Cabin',sans-serif;\" role=\"presentation\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" border=\"0\">\n                        <tbody>\n                          <tr>\n                            <td style=\"overflow-wrap:break-word;word-break:break-word;padding:10px;font-family:'Cabin',sans-serif;\" align=\"left\">\n\n                              <div style=\"font-size: 14px; color: #afb0c7; line-height: 170%; text-align: center; word-wrap: break-word;\">\n                                <p style=\"font-size: 14px; line-height: 170%;\"><span style=\"font-size: 14px; line-height: 23.8px;\">View Email in Browser</span></p>\n                              </div>\n\n                            </td>\n                          </tr>\n                        </tbody>\n                      </table>\n\n                      <!--[if (!mso)&(!IE)]><!-->\n                    </div>\n                    <!--<![endif]-->\n                  </div>\n                </div>\n                <!--[if (mso)|(IE)]></td><![endif]-->\n                <!--[if (mso)|(IE)]></tr></table></td></tr></table><![endif]-->\n              </div>\n            </div>\n          </div>\n\n\n\n          <div class=\"u-row-container\" style=\"padding: 0px;background-color: transparent\">\n            <div class=\"u-row\" style=\"Margin: 0 auto;min-width: 320px;max-width: 600px;overflow-wrap: break-word;word-wrap: break-word;word-break: break-word;background-color: #ffffff;\">\n              <div style=\"border-collapse: collapse;display: table;width: 100%;height: 100%;background-color: transparent;\">\n                <!--[if (mso)|(IE)]><table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\"><tr><td style=\"padding: 0px;background-color: transparent;\" align=\"center\"><table cellpadding=\"0\" cellspacing=\"0\" border=\"0\" style=\"width:600px;\"><tr style=\"background-color: #ffffff;\"><![endif]-->\n\n                <!--[if (mso)|(IE)]><td align=\"center\" width=\"600\" style=\"width: 600px;padding: 0px;border-top: 0px solid transparent;border-left: 0px solid transparent;border-right: 0px solid transparent;border-bottom: 0px solid transparent;\" valign=\"top\"><![endif]-->\n                <div class=\"u-col u-col-100\" style=\"max-width: 320px;min-width: 600px;display: table-cell;vertical-align: top;\">\n                  <div style=\"height: 100%;width: 100% !important;\">\n                    <!--[if (!mso)&(!IE)]><!-->\n                    <div style=\"box-sizing: border-box; height: 100%; padding: 0px;border-top: 0px solid transparent;border-left: 0px solid transparent;border-right: 0px solid transparent;border-bottom: 0px solid transparent;\">\n                      <!--<![endif]-->\n\n                      <table style=\"font-family:'Cabin',sans-serif;\" role=\"presentation\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" border=\"0\">\n                        <tbody>\n                          <tr>\n                            <td style=\"overflow-wrap:break-word;word-break:break-word;padding:20px;font-family:'Cabin',sans-serif;\" align=\"left\">\n\n                              <table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n                                <tr>\n                                  <td style=\"padding-right: 0px;padding-left: 0px;\" align=\"center\">\n\n                                    <img align=\"center\" border=\"0\" src=\"https://cdn.templates.unlayer.com/assets/1597218426091-xx.png\" alt=\"Image\" title=\"Image\" style=\"outline: none;text-decoration: none;-ms-interpolation-mode: bicubic;clear: both;display: inline-block !important;border: none;height: auto;float: none;width: 32%;max-width: 179.2px;\"\n                                      width=\"179.2\" />\n\n                                  </td>\n                                </tr>\n                              </table>\n\n                            </td>\n                          </tr>\n                        </tbody>\n                      </table>\n\n                      <!--[if (!mso)&(!IE)]><!-->\n                    </div>\n                    <!--<![endif]-->\n                  </div>\n                </div>\n                <!--[if (mso)|(IE)]></td><![endif]-->\n                <!--[if (mso)|(IE)]></tr></table></td></tr></table><![endif]-->\n              </div>\n            </div>\n          </div>\n\n\n\n          <div class=\"u-row-container\" style=\"padding: 0px;background-color: transparent\">\n            <div class=\"u-row\" style=\"Margin: 0 auto;min-width: 320px;max-width: 600px;overflow-wrap: break-word;word-wrap: break-word;word-break: break-word;background-color: #003399;\">\n              <div style=\"border-collapse: collapse;display: table;width: 100%;height: 100%;background-color: transparent;\">\n                <!--[if (mso)|(IE)]><table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\"><tr><td style=\"padding: 0px;background-color: transparent;\" align=\"center\"><table cellpadding=\"0\" cellspacing=\"0\" border=\"0\" style=\"width:600px;\"><tr style=\"background-color: #003399;\"><![endif]-->\n\n                <!--[if (mso)|(IE)]><td align=\"center\" width=\"600\" style=\"width: 600px;padding: 0px;border-top: 0px solid transparent;border-left: 0px solid transparent;border-right: 0px solid transparent;border-bottom: 0px solid transparent;\" valign=\"top\"><![endif]-->\n                <div class=\"u-col u-col-100\" style=\"max-width: 320px;min-width: 600px;display: table-cell;vertical-align: top;\">\n                  <div style=\"height: 100%;width: 100% !important;\">\n                    <!--[if (!mso)&(!IE)]><!-->\n                    <div style=\"box-sizing: border-box; height: 100%; padding: 0px;border-top: 0px solid transparent;border-left: 0px solid transparent;border-right: 0px solid transparent;border-bottom: 0px solid transparent;\">\n                      <!--<![endif]-->\n\n                      <table style=\"font-family:'Cabin',sans-serif;\" role=\"presentation\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" border=\"0\">\n                        <tbody>\n                          <tr>\n                            <td style=\"overflow-wrap:break-word;word-break:break-word;padding:40px 10px 10px;font-family:'Cabin',sans-serif;\" align=\"left\">\n\n                              <table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n                                <tr>\n                                  <td style=\"padding-right: 0px;padding-left: 0px;\" align=\"center\">\n\n                                    <img align=\"center\" border=\"0\" src=\"https://cdn.templates.unlayer.com/assets/1597218650916-xxxxc.png\" alt=\"Image\" title=\"Image\" style=\"outline: none;text-decoration: none;-ms-interpolation-mode: bicubic;clear: both;display: inline-block !important;border: none;height: auto;float: none;width: 26%;max-width: 150.8px;\"\n                                      width=\"150.8\" />\n\n                                  </td>\n                                </tr>\n                              </table>\n\n                            </td>\n                          </tr>\n                        </tbody>\n                      </table>\n\n                      <table style=\"font-family:'Cabin',sans-serif;\" role=\"presentation\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" border=\"0\">\n                        <tbody>\n                          <tr>\n                            <td style=\"overflow-wrap:break-word;word-break:break-word;padding:0px 10px 31px;font-family:'Cabin',sans-serif;\" align=\"left\">\n\n                              <div style=\"font-size: 14px; color: #e5eaf5; line-height: 140%; text-align: center; word-wrap: break-word;\">\n                                <p style=\"font-size: 14px; line-height: 140%;\"><span style=\"font-size: 28px; line-height: 39.2px;\"><strong><span style=\"line-height: 39.2px; font-size: 28px;\">Congratulations on Passing the Interview! Let's Begin Your New Journey!</span></strong>\n                                  </span>\n                                </p>\n                              </div>\n\n                            </td>\n                          </tr>\n                        </tbody>\n                      </table>\n\n                      <!--[if (!mso)&(!IE)]><!-->\n                    </div>\n                    <!--<![endif]-->\n                  </div>\n                </div>\n                <!--[if (mso)|(IE)]></td><![endif]-->\n                <!--[if (mso)|(IE)]></tr></table></td></tr></table><![endif]-->\n              </div>\n            </div>\n          </div>\n\n\n\n          <div class=\"u-row-container\" style=\"padding: 0px;background-color: transparent\">\n            <div class=\"u-row\" style=\"Margin: 0 auto;min-width: 320px;max-width: 600px;overflow-wrap: break-word;word-wrap: break-word;word-break: break-word;background-color: #ffffff;\">\n              <div style=\"border-collapse: collapse;display: table;width: 100%;height: 100%;background-color: transparent;\">\n                <!--[if (mso)|(IE)]><table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\"><tr><td style=\"padding: 0px;background-color: transparent;\" align=\"center\"><table cellpadding=\"0\" cellspacing=\"0\" border=\"0\" style=\"width:600px;\"><tr style=\"background-color: #ffffff;\"><![endif]-->\n\n                <!--[if (mso)|(IE)]><td align=\"center\" width=\"600\" style=\"width: 600px;padding: 0px;border-top: 0px solid transparent;border-left: 0px solid transparent;border-right: 0px solid transparent;border-bottom: 0px solid transparent;\" valign=\"top\"><![endif]-->\n                <div class=\"u-col u-col-100\" style=\"max-width: 320px;min-width: 600px;display: table-cell;vertical-align: top;\">\n                  <div style=\"height: 100%;width: 100% !important;\">\n                    <!--[if (!mso)&(!IE)]><!-->\n                    <div style=\"box-sizing: border-box; height: 100%; padding: 0px;border-top: 0px solid transparent;border-left: 0px solid transparent;border-right: 0px solid transparent;border-bottom: 0px solid transparent;\">\n                      <!--<![endif]-->\n\n                      <table style=\"font-family:'Cabin',sans-serif;\" role=\"presentation\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" border=\"0\">\n                        <tbody>\n                          <tr>\n                            <td style=\"overflow-wrap:break-word;word-break:break-word;padding:33px 55px;font-family:'Cabin',sans-serif;\" align=\"left\">\n\n                              <div style=\"font-size: 14px; line-height: 160%; text-align: center; word-wrap: break-word;\">\n                                <p style=\"line-height: 160%; text-align: left;\">Dear <strong>{{ $json.query.name }}</strong>,</p>\n                                <p style=\"line-height: 160%; text-align: left;\">I hope this email finds you in good spirits. I am delighted to inform you that you have successfully passed the interview process for the [Job Position] at [Company Name]. Congratulations on this significant achievement!</p>\n                                <p style=\"line-height: 160%; text-align: left;\">&nbsp;</p>\n                                <p style=\"line-height: 160%; text-align: left;\">Your exceptional qualifications, skills, and experience truly impressed our hiring team. We believe you will be a valuable addition to our company and make a positive impact in your role. We are thrilled to offer you the\n                                  position, and we are excited to have you join our team.</p>\n                                <p style=\"line-height: 160%; text-align: left;\">&nbsp;</p>\n                                <p style=\"line-height: 160%; text-align: left;\">We would like to officially extend an offer for you to start your employment with us on <strong>{{ $json.query.workingtime }}</strong>. We have great confidence in your abilities and are confident that you will quickly\n                                  become an integral part of our organization. Please review the attached employment agreement, which outlines the terms and conditions of your employment.</p>\n                                <p style=\"line-height: 160%; text-align: left;\">&nbsp;</p>\n                                <p style=\"line-height: 160%; text-align: left;\">Before your start date, we kindly request that you complete the necessary paperwork, including signing the employment agreement and providing any additional documents as specified in the offer. This will ensure a smooth\n                                  onboarding process and allow us to prepare for your arrival. If you have any questions or require further information, please feel free to reach out to our HR department, and they will be more than happy to assist you.</p>\n                                <p style=\"line-height: 160%; text-align: left;\">We have a comprehensive orientation program designed to introduce you to our company culture, policies, and procedures. During this time, you will have the opportunity to meet your team members and get acquainted with your\n                                  responsibilities. We believe that this onboarding experience will set you up for success in your new role.</p>\n                                <p style=\"line-height: 160%; text-align: left;\">&nbsp;</p>\n                                <p style=\"line-height: 160%; text-align: left;\">Once again, congratulations on securing the position! We are confident that your skills, knowledge, and enthusiasm will contribute to our continued growth and success. We eagerly await your arrival and look forward to working\n                                  with you.</p>\n                                <p style=\"line-height: 160%; text-align: left;\">If you require any further information or have any questions, please do not hesitate to contact us. We are here to support you throughout this transition.</p>\n                                <p style=\"line-height: 160%; text-align: left;\">&nbsp;</p>\n                                <p style=\"line-height: 160%; text-align: left;\">Please check out this button to confirm that you will start your first working day at: <strong>{{ $json.query.workingtime }}</strong></p>\n                              </div>\n\n                            </td>\n                          </tr>\n                        </tbody>\n                      </table>\n\n                      <table style=\"font-family:'Cabin',sans-serif;\" role=\"presentation\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" border=\"0\">\n                        <tbody>\n                          <tr>\n                            <td style=\"overflow-wrap:break-word;word-break:break-word;padding:10px;font-family:'Cabin',sans-serif;\" align=\"left\">\n\n                              <!--[if mso]><style>.v-button {background: transparent !important;}</style><![endif]-->\n                              <div align=\"center\">\n                                <!--[if mso]><v:roundrect xmlns:v=\"urn:schemas-microsoft-com:vml\" xmlns:w=\"urn:schemas-microsoft-com:office:word\" href=\"https://app.n8n.vn/webhook/working-confirm?recordID={{$json.query.recordID}}\" style=\"height:37px; v-text-anchor:middle; width:221px;\" arcsize=\"11%\"  stroke=\"f\" fillcolor=\"#3598db\"><w:anchorlock/><center style=\"color:#FFFFFF;font-family:'Cabin',sans-serif;\"><![endif]-->\n                                <a href=\"https://app.n8n.vn/webhook/working-confirm?recordID={{$json.query.recordID}}\" target=\"_blank\" class=\"v-button\" style=\"box-sizing: border-box;display: inline-block;font-family:'Cabin',sans-serif;text-decoration: none;-webkit-text-size-adjust: none;text-align: center;color: #FFFFFF; background-color: #3598db; border-radius: 4px;-webkit-border-radius: 4px; -moz-border-radius: 4px; width:auto; max-width:100%; overflow-wrap: break-word; word-break: break-word; word-wrap:break-word; mso-border-alt: none;font-size: 14px;\">\n                                  <span style=\"display:block;padding:10px 20px;line-height:120%;\"><span style=\"line-height: 16.8px;\">CONFIRM MY WORKING TIME</span></span>\n                                </a>\n                                <!--[if mso]></center></v:roundrect><![endif]-->\n                              </div>\n\n                            </td>\n                          </tr>\n                        </tbody>\n                      </table>\n\n                      <table style=\"font-family:'Cabin',sans-serif;\" role=\"presentation\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" border=\"0\">\n                        <tbody>\n                          <tr>\n                            <td style=\"overflow-wrap:break-word;word-break:break-word;padding:33px 55px 60px;font-family:'Cabin',sans-serif;\" align=\"left\">\n\n                              <div style=\"font-size: 14px; line-height: 160%; text-align: center; word-wrap: break-word;\">\n                                <p style=\"line-height: 160%; text-align: left;\">Warmest regards,</p>\n                                <p style=\"line-height: 160%; text-align: left;\">&nbsp;</p>\n                                <p style=\"line-height: 160%; text-align: left;\">[Your Name]</p>\n                                <p style=\"line-height: 160%; text-align: left;\">[Your Position]</p>\n                                <p style=\"line-height: 160%; text-align: left;\">[Company Name]</p>\n                                <p style=\"line-height: 160%; text-align: left;\">[Contact Information]</p>\n                              </div>\n\n                            </td>\n                          </tr>\n                        </tbody>\n                      </table>\n\n                      <!--[if (!mso)&(!IE)]><!-->\n                    </div>\n                    <!--<![endif]-->\n                  </div>\n                </div>\n                <!--[if (mso)|(IE)]></td><![endif]-->\n                <!--[if (mso)|(IE)]></tr></table></td></tr></table><![endif]-->\n              </div>\n            </div>\n          </div>\n\n\n\n          <div class=\"u-row-container\" style=\"padding: 0px;background-color: transparent\">\n            <div class=\"u-row\" style=\"Margin: 0 auto;min-width: 320px;max-width: 600px;overflow-wrap: break-word;word-wrap: break-word;word-break: break-word;background-color: #e5eaf5;\">\n              <div style=\"border-collapse: collapse;display: table;width: 100%;height: 100%;background-color: transparent;\">\n                <!--[if (mso)|(IE)]><table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\"><tr><td style=\"padding: 0px;background-color: transparent;\" align=\"center\"><table cellpadding=\"0\" cellspacing=\"0\" border=\"0\" style=\"width:600px;\"><tr style=\"background-color: #e5eaf5;\"><![endif]-->\n\n                <!--[if (mso)|(IE)]><td align=\"center\" width=\"600\" style=\"width: 600px;padding: 0px;border-top: 0px solid transparent;border-left: 0px solid transparent;border-right: 0px solid transparent;border-bottom: 0px solid transparent;\" valign=\"top\"><![endif]-->\n                <div class=\"u-col u-col-100\" style=\"max-width: 320px;min-width: 600px;display: table-cell;vertical-align: top;\">\n                  <div style=\"height: 100%;width: 100% !important;\">\n                    <!--[if (!mso)&(!IE)]><!-->\n                    <div style=\"box-sizing: border-box; height: 100%; padding: 0px;border-top: 0px solid transparent;border-left: 0px solid transparent;border-right: 0px solid transparent;border-bottom: 0px solid transparent;\">\n                      <!--<![endif]-->\n\n                      <table style=\"font-family:'Cabin',sans-serif;\" role=\"presentation\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" border=\"0\">\n                        <tbody>\n                          <tr>\n                            <td style=\"overflow-wrap:break-word;word-break:break-word;padding:41px 55px 18px;font-family:'Cabin',sans-serif;\" align=\"left\">\n\n                              <div style=\"font-size: 14px; color: #003399; line-height: 160%; text-align: center; word-wrap: break-word;\">\n                                <p style=\"font-size: 14px; line-height: 160%;\"><span style=\"font-size: 20px; line-height: 32px;\"><strong>Get in touch</strong></span></p>\n                                <p style=\"font-size: 14px; line-height: 160%;\"><span style=\"font-size: 16px; line-height: 25.6px; color: #000000;\">+11 111 333 4444</span></p>\n                                <p style=\"font-size: 14px; line-height: 160%;\"><span style=\"font-size: 16px; line-height: 25.6px; color: #000000;\">Info@YourCompany.com</span></p>\n                              </div>\n\n                            </td>\n                          </tr>\n                        </tbody>\n                      </table>\n\n                      <table style=\"font-family:'Cabin',sans-serif;\" role=\"presentation\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" border=\"0\">\n                        <tbody>\n                          <tr>\n                            <td style=\"overflow-wrap:break-word;word-break:break-word;padding:10px 10px 33px;font-family:'Cabin',sans-serif;\" align=\"left\">\n\n                              <div align=\"center\">\n                                <div style=\"display: table; max-width:244px;\">\n                                  <!--[if (mso)|(IE)]><table width=\"244\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\"><tr><td style=\"border-collapse:collapse;\" align=\"center\"><table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\" style=\"border-collapse:collapse; mso-table-lspace: 0pt;mso-table-rspace: 0pt; width:244px;\"><tr><![endif]-->\n\n\n                                  <!--[if (mso)|(IE)]><td width=\"32\" style=\"width:32px; padding-right: 17px;\" valign=\"top\"><![endif]-->\n                                  <table align=\"left\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" width=\"32\" height=\"32\" style=\"width: 32px !important;height: 32px !important;display: inline-block;border-collapse: collapse;table-layout: fixed;border-spacing: 0;mso-table-lspace: 0pt;mso-table-rspace: 0pt;vertical-align: top;margin-right: 17px\">\n                                    <tbody>\n                                      <tr style=\"vertical-align: top\">\n                                        <td align=\"left\" valign=\"middle\" style=\"word-break: break-word;border-collapse: collapse !important;vertical-align: top\">\n                                          <a href=\"https://facebook.com/\" title=\"Facebook\" target=\"_blank\">\n                                            <img src=\"https://cdn.tools.unlayer.com/social/icons/circle-black/facebook.png\" alt=\"Facebook\" title=\"Facebook\" width=\"32\" style=\"outline: none;text-decoration: none;-ms-interpolation-mode: bicubic;clear: both;display: block !important;border: none;height: auto;float: none;max-width: 32px !important\">\n                                          </a>\n                                        </td>\n                                      </tr>\n                                    </tbody>\n                                  </table>\n                                  <!--[if (mso)|(IE)]></td><![endif]-->\n\n                                  <!--[if (mso)|(IE)]><td width=\"32\" style=\"width:32px; padding-right: 17px;\" valign=\"top\"><![endif]-->\n                                  <table align=\"left\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" width=\"32\" height=\"32\" style=\"width: 32px !important;height: 32px !important;display: inline-block;border-collapse: collapse;table-layout: fixed;border-spacing: 0;mso-table-lspace: 0pt;mso-table-rspace: 0pt;vertical-align: top;margin-right: 17px\">\n                                    <tbody>\n                                      <tr style=\"vertical-align: top\">\n                                        <td align=\"left\" valign=\"middle\" style=\"word-break: break-word;border-collapse: collapse !important;vertical-align: top\">\n                                          <a href=\"https://linkedin.com/\" title=\"LinkedIn\" target=\"_blank\">\n                                            <img src=\"https://cdn.tools.unlayer.com/social/icons/circle-black/linkedin.png\" alt=\"LinkedIn\" title=\"LinkedIn\" width=\"32\" style=\"outline: none;text-decoration: none;-ms-interpolation-mode: bicubic;clear: both;display: block !important;border: none;height: auto;float: none;max-width: 32px !important\">\n                                          </a>\n                                        </td>\n                                      </tr>\n                                    </tbody>\n                                  </table>\n                                  <!--[if (mso)|(IE)]></td><![endif]-->\n\n                                  <!--[if (mso)|(IE)]><td width=\"32\" style=\"width:32px; padding-right: 17px;\" valign=\"top\"><![endif]-->\n                                  <table align=\"left\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" width=\"32\" height=\"32\" style=\"width: 32px !important;height: 32px !important;display: inline-block;border-collapse: collapse;table-layout: fixed;border-spacing: 0;mso-table-lspace: 0pt;mso-table-rspace: 0pt;vertical-align: top;margin-right: 17px\">\n                                    <tbody>\n                                      <tr style=\"vertical-align: top\">\n                                        <td align=\"left\" valign=\"middle\" style=\"word-break: break-word;border-collapse: collapse !important;vertical-align: top\">\n                                          <a href=\"https://instagram.com/\" title=\"Instagram\" target=\"_blank\">\n                                            <img src=\"https://cdn.tools.unlayer.com/social/icons/circle-black/instagram.png\" alt=\"Instagram\" title=\"Instagram\" width=\"32\" style=\"outline: none;text-decoration: none;-ms-interpolation-mode: bicubic;clear: both;display: block !important;border: none;height: auto;float: none;max-width: 32px !important\">\n                                          </a>\n                                        </td>\n                                      </tr>\n                                    </tbody>\n                                  </table>\n                                  <!--[if (mso)|(IE)]></td><![endif]-->\n\n                                  <!--[if (mso)|(IE)]><td width=\"32\" style=\"width:32px; padding-right: 17px;\" valign=\"top\"><![endif]-->\n                                  <table align=\"left\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" width=\"32\" height=\"32\" style=\"width: 32px !important;height: 32px !important;display: inline-block;border-collapse: collapse;table-layout: fixed;border-spacing: 0;mso-table-lspace: 0pt;mso-table-rspace: 0pt;vertical-align: top;margin-right: 17px\">\n                                    <tbody>\n                                      <tr style=\"vertical-align: top\">\n                                        <td align=\"left\" valign=\"middle\" style=\"word-break: break-word;border-collapse: collapse !important;vertical-align: top\">\n                                          <a href=\"https://youtube.com/\" title=\"YouTube\" target=\"_blank\">\n                                            <img src=\"https://cdn.tools.unlayer.com/social/icons/circle-black/youtube.png\" alt=\"YouTube\" title=\"YouTube\" width=\"32\" style=\"outline: none;text-decoration: none;-ms-interpolation-mode: bicubic;clear: both;display: block !important;border: none;height: auto;float: none;max-width: 32px !important\">\n                                          </a>\n                                        </td>\n                                      </tr>\n                                    </tbody>\n                                  </table>\n                                  <!--[if (mso)|(IE)]></td><![endif]-->\n\n                                  <!--[if (mso)|(IE)]><td width=\"32\" style=\"width:32px; padding-right: 0px;\" valign=\"top\"><![endif]-->\n                                  <table align=\"left\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" width=\"32\" height=\"32\" style=\"width: 32px !important;height: 32px !important;display: inline-block;border-collapse: collapse;table-layout: fixed;border-spacing: 0;mso-table-lspace: 0pt;mso-table-rspace: 0pt;vertical-align: top;margin-right: 0px\">\n                                    <tbody>\n                                      <tr style=\"vertical-align: top\">\n                                        <td align=\"left\" valign=\"middle\" style=\"word-break: break-word;border-collapse: collapse !important;vertical-align: top\">\n                                          <a href=\"https://email.com/\" title=\"Email\" target=\"_blank\">\n                                            <img src=\"https://cdn.tools.unlayer.com/social/icons/circle-black/email.png\" alt=\"Email\" title=\"Email\" width=\"32\" style=\"outline: none;text-decoration: none;-ms-interpolation-mode: bicubic;clear: both;display: block !important;border: none;height: auto;float: none;max-width: 32px !important\">\n                                          </a>\n                                        </td>\n                                      </tr>\n                                    </tbody>\n                                  </table>\n                                  <!--[if (mso)|(IE)]></td><![endif]-->\n\n\n                                  <!--[if (mso)|(IE)]></tr></table></td></tr></table><![endif]-->\n                                </div>\n                              </div>\n\n                            </td>\n                          </tr>\n                        </tbody>\n                      </table>\n\n                      <!--[if (!mso)&(!IE)]><!-->\n                    </div>\n                    <!--<![endif]-->\n                  </div>\n                </div>\n                <!--[if (mso)|(IE)]></td><![endif]-->\n                <!--[if (mso)|(IE)]></tr></table></td></tr></table><![endif]-->\n              </div>\n            </div>\n          </div>\n\n\n\n          <div class=\"u-row-container\" style=\"padding: 0px;background-color: transparent\">\n            <div class=\"u-row\" style=\"Margin: 0 auto;min-width: 320px;max-width: 600px;overflow-wrap: break-word;word-wrap: break-word;word-break: break-word;background-color: #003399;\">\n              <div style=\"border-collapse: collapse;display: table;width: 100%;height: 100%;background-color: transparent;\">\n                <!--[if (mso)|(IE)]><table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\"><tr><td style=\"padding: 0px;background-color: transparent;\" align=\"center\"><table cellpadding=\"0\" cellspacing=\"0\" border=\"0\" style=\"width:600px;\"><tr style=\"background-color: #003399;\"><![endif]-->\n\n                <!--[if (mso)|(IE)]><td align=\"center\" width=\"600\" style=\"width: 600px;padding: 0px;border-top: 0px solid transparent;border-left: 0px solid transparent;border-right: 0px solid transparent;border-bottom: 0px solid transparent;\" valign=\"top\"><![endif]-->\n                <div class=\"u-col u-col-100\" style=\"max-width: 320px;min-width: 600px;display: table-cell;vertical-align: top;\">\n                  <div style=\"height: 100%;width: 100% !important;\">\n                    <!--[if (!mso)&(!IE)]><!-->\n                    <div style=\"box-sizing: border-box; height: 100%; padding: 0px;border-top: 0px solid transparent;border-left: 0px solid transparent;border-right: 0px solid transparent;border-bottom: 0px solid transparent;\">\n                      <!--<![endif]-->\n\n                      <table style=\"font-family:'Cabin',sans-serif;\" role=\"presentation\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" border=\"0\">\n                        <tbody>\n                          <tr>\n                            <td style=\"overflow-wrap:break-word;word-break:break-word;padding:10px;font-family:'Cabin',sans-serif;\" align=\"left\">\n\n                              <div style=\"font-size: 14px; color: #fafafa; line-height: 180%; text-align: center; word-wrap: break-word;\">\n                                <p style=\"font-size: 14px; line-height: 180%;\"><span style=\"font-size: 16px; line-height: 28.8px;\">Copyrights ¬© Company All Rights Reserved</span></p>\n                              </div>\n\n                            </td>\n                          </tr>\n                        </tbody>\n                      </table>\n\n                      <!--[if (!mso)&(!IE)]><!-->\n                    </div>\n                    <!--<![endif]-->\n                  </div>\n                </div>\n                <!--[if (mso)|(IE)]></td><![endif]-->\n                <!--[if (mso)|(IE)]></tr></table></td></tr></table><![endif]-->\n              </div>\n            </div>\n          </div>\n\n\n          <!--[if (mso)|(IE)]></td></tr></table><![endif]-->\n        </td>\n      </tr>\n    </tbody>\n  </table>\n  <!--[if mso]></div><![endif]-->\n  <!--[if IE]></div><![endif]-->\n</body>\n\n</html>","options":{}},"id":"d7bafc8d-4366-49af-839a-35bd555e4855","name":"Send Email PASS","type":"n8n-nodes-base.emailSend","typeVersion":2,"position":[1240,300],"credentials":{"smtp":{"id":"61","name":"SMTP account 7"}}},{"parameters":{"fromEmail":"khangngo@khoingo.net","toEmail":"={{ $json.query.email }}","subject":"={{ $json.query.name }}: Update Regarding Your Job Application (Interview Result)","emailFormat":"html","html":"=<!DOCTYPE HTML PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional //EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\">\n<html xmlns=\"http://www.w3.org/1999/xhtml\" xmlns:v=\"urn:schemas-microsoft-com:vml\" xmlns:o=\"urn:schemas-microsoft-com:office:office\">\n\n<head>\n  <!--[if gte mso 9]>\n<xml>\n  <o:OfficeDocumentSettings>\n    <o:AllowPNG/>\n    <o:PixelsPerInch>96</o:PixelsPerInch>\n  </o:OfficeDocumentSettings>\n</xml>\n<![endif]-->\n  <meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\">\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n  <meta name=\"x-apple-disable-message-reformatting\">\n  <!--[if !mso]><!-->\n  <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\n  <!--<![endif]-->\n  <title></title>\n\n  <style type=\"text/css\">\n    @media only screen and (min-width: 620px) {\n      .u-row {\n        width: 600px !important;\n      }\n      .u-row .u-col {\n        vertical-align: top;\n      }\n      .u-row .u-col-100 {\n        width: 600px !important;\n      }\n    }\n    \n    @media (max-width: 620px) {\n      .u-row-container {\n        max-width: 100% !important;\n        padding-left: 0px !important;\n        padding-right: 0px !important;\n      }\n      .u-row .u-col {\n        min-width: 320px !important;\n        max-width: 100% !important;\n        display: block !important;\n      }\n      .u-row {\n        width: 100% !important;\n      }\n      .u-col {\n        width: 100% !important;\n      }\n      .u-col>div {\n        margin: 0 auto;\n      }\n    }\n    \n    body {\n      margin: 0;\n      padding: 0;\n    }\n    \n    table,\n    tr,\n    td {\n      vertical-align: top;\n      border-collapse: collapse;\n    }\n    \n    p {\n      margin: 0;\n    }\n    \n    .ie-container table,\n    .mso-container table {\n      table-layout: fixed;\n    }\n    \n    * {\n      line-height: inherit;\n    }\n    \n    a[x-apple-data-detectors='true'] {\n      color: inherit !important;\n      text-decoration: none !important;\n    }\n    \n    table,\n    td {\n      color: #000000;\n    }\n    \n    #u_body a {\n      color: #0000ee;\n      text-decoration: underline;\n    }\n  </style>\n\n\n\n  <!--[if !mso]><!-->\n  <link href=\"https://fonts.googleapis.com/css?family=Cabin:400,700\" rel=\"stylesheet\" type=\"text/css\">\n  <!--<![endif]-->\n\n</head>\n\n<body class=\"clean-body u_body\" style=\"margin: 0;padding: 0;-webkit-text-size-adjust: 100%;background-color: #f9f9f9;color: #000000\">\n  <!--[if IE]><div class=\"ie-container\"><![endif]-->\n  <!--[if mso]><div class=\"mso-container\"><![endif]-->\n  <table id=\"u_body\" style=\"border-collapse: collapse;table-layout: fixed;border-spacing: 0;mso-table-lspace: 0pt;mso-table-rspace: 0pt;vertical-align: top;min-width: 320px;Margin: 0 auto;background-color: #f9f9f9;width:100%\" cellpadding=\"0\" cellspacing=\"0\">\n    <tbody>\n      <tr style=\"vertical-align: top\">\n        <td style=\"word-break: break-word;border-collapse: collapse !important;vertical-align: top\">\n          <!--[if (mso)|(IE)]><table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\"><tr><td align=\"center\" style=\"background-color: #f9f9f9;\"><![endif]-->\n\n\n          <div class=\"u-row-container\" style=\"padding: 0px;background-color: transparent\">\n            <div class=\"u-row\" style=\"Margin: 0 auto;min-width: 320px;max-width: 600px;overflow-wrap: break-word;word-wrap: break-word;word-break: break-word;background-color: transparent;\">\n              <div style=\"border-collapse: collapse;display: table;width: 100%;height: 100%;background-color: transparent;\">\n                <!--[if (mso)|(IE)]><table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\"><tr><td style=\"padding: 0px;background-color: transparent;\" align=\"center\"><table cellpadding=\"0\" cellspacing=\"0\" border=\"0\" style=\"width:600px;\"><tr style=\"background-color: transparent;\"><![endif]-->\n\n                <!--[if (mso)|(IE)]><td align=\"center\" width=\"600\" style=\"width: 600px;padding: 0px;border-top: 0px solid transparent;border-left: 0px solid transparent;border-right: 0px solid transparent;border-bottom: 0px solid transparent;\" valign=\"top\"><![endif]-->\n                <div class=\"u-col u-col-100\" style=\"max-width: 320px;min-width: 600px;display: table-cell;vertical-align: top;\">\n                  <div style=\"height: 100%;width: 100% !important;\">\n                    <!--[if (!mso)&(!IE)]><!-->\n                    <div style=\"box-sizing: border-box; height: 100%; padding: 0px;border-top: 0px solid transparent;border-left: 0px solid transparent;border-right: 0px solid transparent;border-bottom: 0px solid transparent;\">\n                      <!--<![endif]-->\n\n                      <table style=\"font-family:'Cabin',sans-serif;\" role=\"presentation\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" border=\"0\">\n                        <tbody>\n                          <tr>\n                            <td style=\"overflow-wrap:break-word;word-break:break-word;padding:10px;font-family:'Cabin',sans-serif;\" align=\"left\">\n\n                              <div style=\"font-size: 14px; color: #afb0c7; line-height: 170%; text-align: center; word-wrap: break-word;\">\n                                <p style=\"font-size: 14px; line-height: 170%;\"><span style=\"font-size: 14px; line-height: 23.8px;\">View Email in Browser</span></p>\n                              </div>\n\n                            </td>\n                          </tr>\n                        </tbody>\n                      </table>\n\n                      <!--[if (!mso)&(!IE)]><!-->\n                    </div>\n                    <!--<![endif]-->\n                  </div>\n                </div>\n                <!--[if (mso)|(IE)]></td><![endif]-->\n                <!--[if (mso)|(IE)]></tr></table></td></tr></table><![endif]-->\n              </div>\n            </div>\n          </div>\n\n\n\n          <div class=\"u-row-container\" style=\"padding: 0px;background-color: transparent\">\n            <div class=\"u-row\" style=\"Margin: 0 auto;min-width: 320px;max-width: 600px;overflow-wrap: break-word;word-wrap: break-word;word-break: break-word;background-color: #ffffff;\">\n              <div style=\"border-collapse: collapse;display: table;width: 100%;height: 100%;background-color: transparent;\">\n                <!--[if (mso)|(IE)]><table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\"><tr><td style=\"padding: 0px;background-color: transparent;\" align=\"center\"><table cellpadding=\"0\" cellspacing=\"0\" border=\"0\" style=\"width:600px;\"><tr style=\"background-color: #ffffff;\"><![endif]-->\n\n                <!--[if (mso)|(IE)]><td align=\"center\" width=\"600\" style=\"width: 600px;padding: 0px;border-top: 0px solid transparent;border-left: 0px solid transparent;border-right: 0px solid transparent;border-bottom: 0px solid transparent;\" valign=\"top\"><![endif]-->\n                <div class=\"u-col u-col-100\" style=\"max-width: 320px;min-width: 600px;display: table-cell;vertical-align: top;\">\n                  <div style=\"height: 100%;width: 100% !important;\">\n                    <!--[if (!mso)&(!IE)]><!-->\n                    <div style=\"box-sizing: border-box; height: 100%; padding: 0px;border-top: 0px solid transparent;border-left: 0px solid transparent;border-right: 0px solid transparent;border-bottom: 0px solid transparent;\">\n                      <!--<![endif]-->\n\n                      <table style=\"font-family:'Cabin',sans-serif;\" role=\"presentation\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" border=\"0\">\n                        <tbody>\n                          <tr>\n                            <td style=\"overflow-wrap:break-word;word-break:break-word;padding:20px;font-family:'Cabin',sans-serif;\" align=\"left\">\n\n                              <table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n                                <tr>\n                                  <td style=\"padding-right: 0px;padding-left: 0px;\" align=\"center\">\n\n                                    <img align=\"center\" border=\"0\" src=\"https://cdn.templates.unlayer.com/assets/1597218426091-xx.png\" alt=\"Image\" title=\"Image\" style=\"outline: none;text-decoration: none;-ms-interpolation-mode: bicubic;clear: both;display: inline-block !important;border: none;height: auto;float: none;width: 32%;max-width: 179.2px;\"\n                                      width=\"179.2\" />\n\n                                  </td>\n                                </tr>\n                              </table>\n\n                            </td>\n                          </tr>\n                        </tbody>\n                      </table>\n\n                      <!--[if (!mso)&(!IE)]><!-->\n                    </div>\n                    <!--<![endif]-->\n                  </div>\n                </div>\n                <!--[if (mso)|(IE)]></td><![endif]-->\n                <!--[if (mso)|(IE)]></tr></table></td></tr></table><![endif]-->\n              </div>\n            </div>\n          </div>\n\n\n\n          <div class=\"u-row-container\" style=\"padding: 0px;background-color: transparent\">\n            <div class=\"u-row\" style=\"Margin: 0 auto;min-width: 320px;max-width: 600px;overflow-wrap: break-word;word-wrap: break-word;word-break: break-word;background-color: #003399;\">\n              <div style=\"border-collapse: collapse;display: table;width: 100%;height: 100%;background-color: transparent;\">\n                <!--[if (mso)|(IE)]><table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\"><tr><td style=\"padding: 0px;background-color: transparent;\" align=\"center\"><table cellpadding=\"0\" cellspacing=\"0\" border=\"0\" style=\"width:600px;\"><tr style=\"background-color: #003399;\"><![endif]-->\n\n                <!--[if (mso)|(IE)]><td align=\"center\" width=\"600\" style=\"width: 600px;padding: 0px;border-top: 0px solid transparent;border-left: 0px solid transparent;border-right: 0px solid transparent;border-bottom: 0px solid transparent;\" valign=\"top\"><![endif]-->\n                <div class=\"u-col u-col-100\" style=\"max-width: 320px;min-width: 600px;display: table-cell;vertical-align: top;\">\n                  <div style=\"height: 100%;width: 100% !important;\">\n                    <!--[if (!mso)&(!IE)]><!-->\n                    <div style=\"box-sizing: border-box; height: 100%; padding: 0px;border-top: 0px solid transparent;border-left: 0px solid transparent;border-right: 0px solid transparent;border-bottom: 0px solid transparent;\">\n                      <!--<![endif]-->\n\n                      <table style=\"font-family:'Cabin',sans-serif;\" role=\"presentation\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" border=\"0\">\n                        <tbody>\n                          <tr>\n                            <td style=\"overflow-wrap:break-word;word-break:break-word;padding:40px 10px 10px;font-family:'Cabin',sans-serif;\" align=\"left\">\n\n                              <table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n                                <tr>\n                                  <td style=\"padding-right: 0px;padding-left: 0px;\" align=\"center\">\n\n                                    <img align=\"center\" border=\"0\" src=\"https://cdn.templates.unlayer.com/assets/1597218650916-xxxxc.png\" alt=\"Image\" title=\"Image\" style=\"outline: none;text-decoration: none;-ms-interpolation-mode: bicubic;clear: both;display: inline-block !important;border: none;height: auto;float: none;width: 26%;max-width: 150.8px;\"\n                                      width=\"150.8\" />\n\n                                  </td>\n                                </tr>\n                              </table>\n\n                            </td>\n                          </tr>\n                        </tbody>\n                      </table>\n\n                      <table style=\"font-family:'Cabin',sans-serif;\" role=\"presentation\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" border=\"0\">\n                        <tbody>\n                          <tr>\n                            <td style=\"overflow-wrap:break-word;word-break:break-word;padding:0px 10px 31px;font-family:'Cabin',sans-serif;\" align=\"left\">\n\n                              <div style=\"font-size: 14px; color: #e5eaf5; line-height: 140%; text-align: center; word-wrap: break-word;\">\n                                <p style=\"font-size: 14px; line-height: 140%;\"><span style=\"font-size: 28px; line-height: 39.2px;\"><strong><span style=\"line-height: 39.2px; font-size: 28px;\">Interview Result</span></strong>\n                                  </span>\n                                </p>\n                              </div>\n\n                            </td>\n                          </tr>\n                        </tbody>\n                      </table>\n\n                      <!--[if (!mso)&(!IE)]><!-->\n                    </div>\n                    <!--<![endif]-->\n                  </div>\n                </div>\n                <!--[if (mso)|(IE)]></td><![endif]-->\n                <!--[if (mso)|(IE)]></tr></table></td></tr></table><![endif]-->\n              </div>\n            </div>\n          </div>\n\n\n\n          <div class=\"u-row-container\" style=\"padding: 0px;background-color: transparent\">\n            <div class=\"u-row\" style=\"Margin: 0 auto;min-width: 320px;max-width: 600px;overflow-wrap: break-word;word-wrap: break-word;word-break: break-word;background-color: #ffffff;\">\n              <div style=\"border-collapse: collapse;display: table;width: 100%;height: 100%;background-color: transparent;\">\n                <!--[if (mso)|(IE)]><table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\"><tr><td style=\"padding: 0px;background-color: transparent;\" align=\"center\"><table cellpadding=\"0\" cellspacing=\"0\" border=\"0\" style=\"width:600px;\"><tr style=\"background-color: #ffffff;\"><![endif]-->\n\n                <!--[if (mso)|(IE)]><td align=\"center\" width=\"600\" style=\"width: 600px;padding: 0px;border-top: 0px solid transparent;border-left: 0px solid transparent;border-right: 0px solid transparent;border-bottom: 0px solid transparent;\" valign=\"top\"><![endif]-->\n                <div class=\"u-col u-col-100\" style=\"max-width: 320px;min-width: 600px;display: table-cell;vertical-align: top;\">\n                  <div style=\"height: 100%;width: 100% !important;\">\n                    <!--[if (!mso)&(!IE)]><!-->\n                    <div style=\"box-sizing: border-box; height: 100%; padding: 0px;border-top: 0px solid transparent;border-left: 0px solid transparent;border-right: 0px solid transparent;border-bottom: 0px solid transparent;\">\n                      <!--<![endif]-->\n\n                      <table style=\"font-family:'Cabin',sans-serif;\" role=\"presentation\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" border=\"0\">\n                        <tbody>\n                          <tr>\n                            <td style=\"overflow-wrap:break-word;word-break:break-word;padding:33px 55px;font-family:'Cabin',sans-serif;\" align=\"left\">\n\n                              <div style=\"font-size: 14px; line-height: 160%; text-align: center; word-wrap: break-word;\">\n                                <p style=\"line-height: 160%; text-align: left;\">Subject: Update Regarding Your Job Application at [Company Name]</p>\n                                <p style=\"line-height: 160%; text-align: left;\">&nbsp;</p>\n                                <p style=\"line-height: 160%; text-align: left;\">Dear <strong>{{ $json.query.name }}</strong>,</p>\n                                <p style=\"line-height: 160%; text-align: left;\">&nbsp;</p>\n                                <p style=\"line-height: 160%; text-align: left;\">I hope this email finds you well. I wanted to personally reach out to you regarding your recent job interview for the <strong>{{ $json.query.position}}</strong>&nbsp;at our company. After careful consideration and evaluation,\n                                  we regret to inform you that your application has not been successful on this occasion.</p>\n                                <p style=\"line-height: 160%; text-align: left;\">&nbsp;</p>\n                                <p style=\"line-height: 160%; text-align: left;\">Please know that our decision was not an easy one, as we had the opportunity to meet many talented individuals throughout the interview process. We sincerely appreciate the time and effort you invested in applying for the\n                                  position and participating in the interview.</p>\n                                <p style=\"line-height: 160%; text-align: left;\">&nbsp;</p>\n                                <p style=\"line-height: 160%; text-align: left;\">We want to emphasize that the outcome of this particular application should not discourage you from pursuing other opportunities. We recognize that each candidate brings unique strengths and experiences, and our decision\n                                  is solely based on the specific requirements of this position and the competitive nature of the selection process.</p>\n                                <p style=\"line-height: 160%; text-align: left;\">&nbsp;</p>\n                                <p style=\"line-height: 160%; text-align: left;\">We encourage you to continue exploring other avenues and applying for positions that align with your skills and career aspirations. We genuinely hope that you find the perfect opportunity that allows you to showcase your\n                                  talents and contribute to an organization that appreciates your potential.</p>\n                                <p style=\"line-height: 160%; text-align: left;\">&nbsp;</p>\n                                <p style=\"line-height: 160%; text-align: left;\">We appreciate your interest in our company and thank you for considering us as a potential employer. We wish you all the best in your future endeavors and hope that you find success in your professional journey.</p>\n                                <p style=\"line-height: 160%; text-align: left;\">&nbsp;</p>\n                                <p style=\"line-height: 160%; text-align: left;\">If you have any questions or require feedback regarding your application or interview process, please feel free to reach out to us. We are more than willing to provide you with constructive feedback to assist you in your\n                                  career development.</p>\n                                <p style=\"line-height: 160%; text-align: left;\">Once again, thank you for your time and effort. We wish you the very best for your future endeavors, and we hope our paths may cross again under different circumstances.</p>\n                                <p style=\"line-height: 160%; text-align: left;\">&nbsp;</p>\n                                <p style=\"line-height: 160%; text-align: left;\">Sincerely,</p>\n                              </div>\n\n                            </td>\n                          </tr>\n                        </tbody>\n                      </table>\n\n                      <table style=\"font-family:'Cabin',sans-serif;\" role=\"presentation\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" border=\"0\">\n                        <tbody>\n                          <tr>\n                            <td style=\"overflow-wrap:break-word;word-break:break-word;padding:33px 55px 60px;font-family:'Cabin',sans-serif;\" align=\"left\">\n\n                              <div style=\"font-size: 14px; line-height: 160%; text-align: center; word-wrap: break-word;\">\n                                <p style=\"line-height: 160%; text-align: left;\">[Your Name]</p>\n                                <p style=\"line-height: 160%; text-align: left;\">[Your Position]</p>\n                                <p style=\"line-height: 160%; text-align: left;\">[Company Name]</p>\n                                <p style=\"line-height: 160%; text-align: left;\">[Contact Information]</p>\n                              </div>\n\n                            </td>\n                          </tr>\n                        </tbody>\n                      </table>\n\n                      <!--[if (!mso)&(!IE)]><!-->\n                    </div>\n                    <!--<![endif]-->\n                  </div>\n                </div>\n                <!--[if (mso)|(IE)]></td><![endif]-->\n                <!--[if (mso)|(IE)]></tr></table></td></tr></table><![endif]-->\n              </div>\n            </div>\n          </div>\n\n\n\n          <div class=\"u-row-container\" style=\"padding: 0px;background-color: transparent\">\n            <div class=\"u-row\" style=\"Margin: 0 auto;min-width: 320px;max-width: 600px;overflow-wrap: break-word;word-wrap: break-word;word-break: break-word;background-color: #e5eaf5;\">\n              <div style=\"border-collapse: collapse;display: table;width: 100%;height: 100%;background-color: transparent;\">\n                <!--[if (mso)|(IE)]><table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\"><tr><td style=\"padding: 0px;background-color: transparent;\" align=\"center\"><table cellpadding=\"0\" cellspacing=\"0\" border=\"0\" style=\"width:600px;\"><tr style=\"background-color: #e5eaf5;\"><![endif]-->\n\n                <!--[if (mso)|(IE)]><td align=\"center\" width=\"600\" style=\"width: 600px;padding: 0px;border-top: 0px solid transparent;border-left: 0px solid transparent;border-right: 0px solid transparent;border-bottom: 0px solid transparent;\" valign=\"top\"><![endif]-->\n                <div class=\"u-col u-col-100\" style=\"max-width: 320px;min-width: 600px;display: table-cell;vertical-align: top;\">\n                  <div style=\"height: 100%;width: 100% !important;\">\n                    <!--[if (!mso)&(!IE)]><!-->\n                    <div style=\"box-sizing: border-box; height: 100%; padding: 0px;border-top: 0px solid transparent;border-left: 0px solid transparent;border-right: 0px solid transparent;border-bottom: 0px solid transparent;\">\n                      <!--<![endif]-->\n\n                      <table style=\"font-family:'Cabin',sans-serif;\" role=\"presentation\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" border=\"0\">\n                        <tbody>\n                          <tr>\n                            <td style=\"overflow-wrap:break-word;word-break:break-word;padding:41px 55px 18px;font-family:'Cabin',sans-serif;\" align=\"left\">\n\n                              <div style=\"font-size: 14px; color: #003399; line-height: 160%; text-align: center; word-wrap: break-word;\">\n                                <p style=\"font-size: 14px; line-height: 160%;\"><span style=\"font-size: 20px; line-height: 32px;\"><strong>Get in touch</strong></span></p>\n                                <p style=\"font-size: 14px; line-height: 160%;\"><span style=\"font-size: 16px; line-height: 25.6px; color: #000000;\">+11 111 333 4444</span></p>\n                                <p style=\"font-size: 14px; line-height: 160%;\"><span style=\"font-size: 16px; line-height: 25.6px; color: #000000;\">Info@YourCompany.com</span></p>\n                              </div>\n\n                            </td>\n                          </tr>\n                        </tbody>\n                      </table>\n\n                      <table style=\"font-family:'Cabin',sans-serif;\" role=\"presentation\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" border=\"0\">\n                        <tbody>\n                          <tr>\n                            <td style=\"overflow-wrap:break-word;word-break:break-word;padding:10px 10px 33px;font-family:'Cabin',sans-serif;\" align=\"left\">\n\n                              <div align=\"center\">\n                                <div style=\"display: table; max-width:244px;\">\n                                  <!--[if (mso)|(IE)]><table width=\"244\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\"><tr><td style=\"border-collapse:collapse;\" align=\"center\"><table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\" style=\"border-collapse:collapse; mso-table-lspace: 0pt;mso-table-rspace: 0pt; width:244px;\"><tr><![endif]-->\n\n\n                                  <!--[if (mso)|(IE)]><td width=\"32\" style=\"width:32px; padding-right: 17px;\" valign=\"top\"><![endif]-->\n                                  <table align=\"left\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" width=\"32\" height=\"32\" style=\"width: 32px !important;height: 32px !important;display: inline-block;border-collapse: collapse;table-layout: fixed;border-spacing: 0;mso-table-lspace: 0pt;mso-table-rspace: 0pt;vertical-align: top;margin-right: 17px\">\n                                    <tbody>\n                                      <tr style=\"vertical-align: top\">\n                                        <td align=\"left\" valign=\"middle\" style=\"word-break: break-word;border-collapse: collapse !important;vertical-align: top\">\n                                          <a href=\"https://facebook.com/\" title=\"Facebook\" target=\"_blank\">\n                                            <img src=\"https://cdn.tools.unlayer.com/social/icons/circle-black/facebook.png\" alt=\"Facebook\" title=\"Facebook\" width=\"32\" style=\"outline: none;text-decoration: none;-ms-interpolation-mode: bicubic;clear: both;display: block !important;border: none;height: auto;float: none;max-width: 32px !important\">\n                                          </a>\n                                        </td>\n                                      </tr>\n                                    </tbody>\n                                  </table>\n                                  <!--[if (mso)|(IE)]></td><![endif]-->\n\n                                  <!--[if (mso)|(IE)]><td width=\"32\" style=\"width:32px; padding-right: 17px;\" valign=\"top\"><![endif]-->\n                                  <table align=\"left\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" width=\"32\" height=\"32\" style=\"width: 32px !important;height: 32px !important;display: inline-block;border-collapse: collapse;table-layout: fixed;border-spacing: 0;mso-table-lspace: 0pt;mso-table-rspace: 0pt;vertical-align: top;margin-right: 17px\">\n                                    <tbody>\n                                      <tr style=\"vertical-align: top\">\n                                        <td align=\"left\" valign=\"middle\" style=\"word-break: break-word;border-collapse: collapse !important;vertical-align: top\">\n                                          <a href=\"https://linkedin.com/\" title=\"LinkedIn\" target=\"_blank\">\n                                            <img src=\"https://cdn.tools.unlayer.com/social/icons/circle-black/linkedin.png\" alt=\"LinkedIn\" title=\"LinkedIn\" width=\"32\" style=\"outline: none;text-decoration: none;-ms-interpolation-mode: bicubic;clear: both;display: block !important;border: none;height: auto;float: none;max-width: 32px !important\">\n                                          </a>\n                                        </td>\n                                      </tr>\n                                    </tbody>\n                                  </table>\n                                  <!--[if (mso)|(IE)]></td><![endif]-->\n\n                                  <!--[if (mso)|(IE)]><td width=\"32\" style=\"width:32px; padding-right: 17px;\" valign=\"top\"><![endif]-->\n                                  <table align=\"left\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" width=\"32\" height=\"32\" style=\"width: 32px !important;height: 32px !important;display: inline-block;border-collapse: collapse;table-layout: fixed;border-spacing: 0;mso-table-lspace: 0pt;mso-table-rspace: 0pt;vertical-align: top;margin-right: 17px\">\n                                    <tbody>\n                                      <tr style=\"vertical-align: top\">\n                                        <td align=\"left\" valign=\"middle\" style=\"word-break: break-word;border-collapse: collapse !important;vertical-align: top\">\n                                          <a href=\"https://instagram.com/\" title=\"Instagram\" target=\"_blank\">\n                                            <img src=\"https://cdn.tools.unlayer.com/social/icons/circle-black/instagram.png\" alt=\"Instagram\" title=\"Instagram\" width=\"32\" style=\"outline: none;text-decoration: none;-ms-interpolation-mode: bicubic;clear: both;display: block !important;border: none;height: auto;float: none;max-width: 32px !important\">\n                                          </a>\n                                        </td>\n                                      </tr>\n                                    </tbody>\n                                  </table>\n                                  <!--[if (mso)|(IE)]></td><![endif]-->\n\n                                  <!--[if (mso)|(IE)]><td width=\"32\" style=\"width:32px; padding-right: 17px;\" valign=\"top\"><![endif]-->\n                                  <table align=\"left\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" width=\"32\" height=\"32\" style=\"width: 32px !important;height: 32px !important;display: inline-block;border-collapse: collapse;table-layout: fixed;border-spacing: 0;mso-table-lspace: 0pt;mso-table-rspace: 0pt;vertical-align: top;margin-right: 17px\">\n                                    <tbody>\n                                      <tr style=\"vertical-align: top\">\n                                        <td align=\"left\" valign=\"middle\" style=\"word-break: break-word;border-collapse: collapse !important;vertical-align: top\">\n                                          <a href=\"https://youtube.com/\" title=\"YouTube\" target=\"_blank\">\n                                            <img src=\"https://cdn.tools.unlayer.com/social/icons/circle-black/youtube.png\" alt=\"YouTube\" title=\"YouTube\" width=\"32\" style=\"outline: none;text-decoration: none;-ms-interpolation-mode: bicubic;clear: both;display: block !important;border: none;height: auto;float: none;max-width: 32px !important\">\n                                          </a>\n                                        </td>\n                                      </tr>\n                                    </tbody>\n                                  </table>\n                                  <!--[if (mso)|(IE)]></td><![endif]-->\n\n                                  <!--[if (mso)|(IE)]><td width=\"32\" style=\"width:32px; padding-right: 0px;\" valign=\"top\"><![endif]-->\n                                  <table align=\"left\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" width=\"32\" height=\"32\" style=\"width: 32px !important;height: 32px !important;display: inline-block;border-collapse: collapse;table-layout: fixed;border-spacing: 0;mso-table-lspace: 0pt;mso-table-rspace: 0pt;vertical-align: top;margin-right: 0px\">\n                                    <tbody>\n                                      <tr style=\"vertical-align: top\">\n                                        <td align=\"left\" valign=\"middle\" style=\"word-break: break-word;border-collapse: collapse !important;vertical-align: top\">\n                                          <a href=\"https://email.com/\" title=\"Email\" target=\"_blank\">\n                                            <img src=\"https://cdn.tools.unlayer.com/social/icons/circle-black/email.png\" alt=\"Email\" title=\"Email\" width=\"32\" style=\"outline: none;text-decoration: none;-ms-interpolation-mode: bicubic;clear: both;display: block !important;border: none;height: auto;float: none;max-width: 32px !important\">\n                                          </a>\n                                        </td>\n                                      </tr>\n                                    </tbody>\n                                  </table>\n                                  <!--[if (mso)|(IE)]></td><![endif]-->\n\n\n                                  <!--[if (mso)|(IE)]></tr></table></td></tr></table><![endif]-->\n                                </div>\n                              </div>\n\n                            </td>\n                          </tr>\n                        </tbody>\n                      </table>\n\n                      <!--[if (!mso)&(!IE)]><!-->\n                    </div>\n                    <!--<![endif]-->\n                  </div>\n                </div>\n                <!--[if (mso)|(IE)]></td><![endif]-->\n                <!--[if (mso)|(IE)]></tr></table></td></tr></table><![endif]-->\n              </div>\n            </div>\n          </div>\n\n\n\n          <div class=\"u-row-container\" style=\"padding: 0px;background-color: transparent\">\n            <div class=\"u-row\" style=\"Margin: 0 auto;min-width: 320px;max-width: 600px;overflow-wrap: break-word;word-wrap: break-word;word-break: break-word;background-color: #003399;\">\n              <div style=\"border-collapse: collapse;display: table;width: 100%;height: 100%;background-color: transparent;\">\n                <!--[if (mso)|(IE)]><table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\"><tr><td style=\"padding: 0px;background-color: transparent;\" align=\"center\"><table cellpadding=\"0\" cellspacing=\"0\" border=\"0\" style=\"width:600px;\"><tr style=\"background-color: #003399;\"><![endif]-->\n\n                <!--[if (mso)|(IE)]><td align=\"center\" width=\"600\" style=\"width: 600px;padding: 0px;border-top: 0px solid transparent;border-left: 0px solid transparent;border-right: 0px solid transparent;border-bottom: 0px solid transparent;\" valign=\"top\"><![endif]-->\n                <div class=\"u-col u-col-100\" style=\"max-width: 320px;min-width: 600px;display: table-cell;vertical-align: top;\">\n                  <div style=\"height: 100%;width: 100% !important;\">\n                    <!--[if (!mso)&(!IE)]><!-->\n                    <div style=\"box-sizing: border-box; height: 100%; padding: 0px;border-top: 0px solid transparent;border-left: 0px solid transparent;border-right: 0px solid transparent;border-bottom: 0px solid transparent;\">\n                      <!--<![endif]-->\n\n                      <table style=\"font-family:'Cabin',sans-serif;\" role=\"presentation\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" border=\"0\">\n                        <tbody>\n                          <tr>\n                            <td style=\"overflow-wrap:break-word;word-break:break-word;padding:10px;font-family:'Cabin',sans-serif;\" align=\"left\">\n\n                              <div style=\"font-size: 14px; color: #fafafa; line-height: 180%; text-align: center; word-wrap: break-word;\">\n                                <p style=\"font-size: 14px; line-height: 180%;\"><span style=\"font-size: 16px; line-height: 28.8px;\">Copyrights ¬© Company All Rights Reserved</span></p>\n                              </div>\n\n                            </td>\n                          </tr>\n                        </tbody>\n                      </table>\n\n                      <!--[if (!mso)&(!IE)]><!-->\n                    </div>\n                    <!--<![endif]-->\n                  </div>\n                </div>\n                <!--[if (mso)|(IE)]></td><![endif]-->\n                <!--[if (mso)|(IE)]></tr></table></td></tr></table><![endif]-->\n              </div>\n            </div>\n          </div>\n\n\n          <!--[if (mso)|(IE)]></td></tr></table><![endif]-->\n        </td>\n      </tr>\n    </tbody>\n  </table>\n  <!--[if mso]></div><![endif]-->\n  <!--[if IE]></div><![endif]-->\n</body>\n\n</html>","options":{}},"id":"4da57ec2-3a90-4acf-bca9-fbde9653134f","name":"Send Email FAIL","type":"n8n-nodes-base.emailSend","typeVersion":2,"position":[1240,480],"credentials":{"smtp":{"id":"61","name":"SMTP account 7"}}},{"parameters":{"httpMethod":"POST","path":"interview-result","options":{}},"id":"7394fc96-a7c3-4224-b059-fd212ca48bd6","name":"Get candidate Interview info","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[820,400],"webhookId":"43690323-8539-4c21-9b5a-374cc750ed5b"}],"connections":{"IF":{"main":[[{"node":"Send Email PASS","type":"main","index":0}]]},"IF1":{"main":[[{"node":"Send Email FAIL","type":"main","index":0}]]},"Get candidate Interview info":{"main":[[{"node":"IF","type":"main","index":0},{"node":"IF1","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{},"versionId":"125a4632-52ff-426c-9688-9b79f07509cb","triggerCount":1,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-06-13T11:11:53.604Z","updatedAt":"2023-06-21T09:44:48.000Z","id":"129","name":"Flow gui email copy (1)","active":true,"nodes":[{"parameters":{"httpMethod":"POST","path":"send-email-doanhthu1","options":{}},"id":"dbaf6794-18aa-4ba6-8f70-7bf22c6619bc","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[700,380],"webhookId":"27edc58a-931c-481e-8e5d-4cfb055fed3a"},{"parameters":{"fromEmail":"MIXUE <long@mixuevn.com>","toEmail":"={{ $json[\"body\"][\"email\"] }}\n\n","subject":"=H·∫†CH TO√ÅN DOANH THU C·ª¨A H√ÄNG","text":"=Dear {{ $json.body.cdt }}!\n1) Vui l√≤ng xem doanh thu c·ª≠a h√†ng: {{ $json[\"body\"][\"cua_hang_1\"] }} theo file ƒë√≠nh k√®m: {{ $json[\"body\"][\"link_1\"] }}.\n2) Vui l√≤ng xem doanh thu c·ª≠a h√†ng: {{ $json[\"body\"][\"cua_hang_2\"] }} theo file ƒë√≠nh k√®m: {{ $json[\"body\"][\"link_2\"] }}.\n3) Vui l√≤ng xem doanh thu c·ª≠a h√†ng: {{ $json[\"body\"][\"cua_hang_3\"] }} theo file ƒë√≠nh k√®m: {{ $json[\"body\"][\"link_3\"] }}.\n4) Vui l√≤ng xem doanh thu c·ª≠a h√†ng: {{ $json[\"body\"][\"cua_hang_4\"] }} theo file ƒë√≠nh k√®m: {{ $json[\"body\"][\"link_4\"] }}.\n5) Vui l√≤ng xem doanh thu c·ª≠a h√†ng: {{ $json[\"body\"][\"cua_hang_5\"] }} theo file ƒë√≠nh k√®m: {{ $json[\"body\"][\"link_5\"] }}.\n6) Vui l√≤ng xem doanh thu c·ª≠a h√†ng: {{ $json[\"body\"][\"cua_hang_6\"] }} theo file ƒë√≠nh k√®m: {{ $json[\"body\"][\"link_6\"] }}.\n7) Vui l√≤ng xem doanh thu c·ª≠a h√†ng: {{ $json[\"body\"][\"cua_hang_7\"] }} theo file ƒë√≠nh k√®m: {{ $json[\"body\"][\"link_7\"] }}.\n8) Vui l√≤ng xem doanh thu c·ª≠a h√†ng: {{ $json[\"body\"][\"cua_hang_8\"] }} theo file ƒë√≠nh k√®m: {{ $json[\"body\"][\"link_8\"] }}.\n9) Vui l√≤ng xem doanh thu c·ª≠a h√†ng: {{ $json[\"body\"][\"cua_hang_9\"] }} theo file ƒë√≠nh k√®m: {{ $json[\"body\"][\"link_9\"] }}.\n10) Vui l√≤ng xem doanh thu c·ª≠a h√†ng: {{ $json[\"body\"][\"cua_hang_10\"] }} theo file ƒë√≠nh k√®m: {{ $json[\"body\"][\"link_10\"] }}.\n11) Vui l√≤ng xem doanh thu c·ª≠a h√†ng: {{ $json[\"body\"][\"cua_hang_11\"] }} theo file ƒë√≠nh k√®m: {{ $json[\"body\"][\"link_11\"] }}.\n12) Vui l√≤ng xem doanh thu c·ª≠a h√†ng: {{ $json[\"body\"][\"cua_hang_12\"] }} theo file ƒë√≠nh k√®m: {{ $json[\"body\"][\"link_12\"] }}.\n13) Vui l√≤ng xem doanh thu c·ª≠a h√†ng: {{ $json[\"body\"][\"cua_hang_13\"] }} theo file ƒë√≠nh k√®m: {{ $json[\"body\"][\"link_13\"] }}.\nXin l∆∞u √Ω: Link download file ch·ªâ t·ªìn t·∫°i trong 24h, vui l√≤ng download tr∆∞·ªõc khi link h·∫øt h·∫°n!\nN·∫øu c√≥ th·∫Øc m·∫Øc vui l√≤ng li√™n h·ªá v·ªõi L∆∞u Ho√†ng Long, sƒët: 0912.398.152\nTr√¢n tr·ªçng c·∫£m ∆°n!\n ","options":{}},"id":"0edb4c25-f7b6-41b4-b70f-47694ed158e2","name":"Send Email","type":"n8n-nodes-base.emailSend","typeVersion":2,"position":[920,380],"credentials":{"smtp":{"id":"30","name":"SMTP account 4"}}}],"connections":{"Webhook":{"main":[[{"node":"Send Email","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{},"versionId":"eefdb904-3fab-4e04-ab95-078d7f982ebe","triggerCount":1,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-06-13T11:38:06.902Z","updatedAt":"2023-06-13T17:39:00.000Z","id":"130","name":"HR_Talo05 Create new user Larksuite (Lark b·ªã l·ªói ko l√†m ƒë∆∞·ª£c)","active":false,"nodes":[{"parameters":{"httpMethod":"POST","path":"create-user","options":{}},"id":"04f016f4-92a1-496b-8d24-89dad55f0dbb","name":"Get user info","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[580,320],"webhookId":"05d4a245-11a0-4799-a9e4-31616e1dde08"},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/auth/v3/app_access_token/internal","sendBody":true,"specifyBody":"json","jsonBody":"{   \"app_id\": \"cli_a4c3e66985f8900a\",   \"app_secret\": \"ZLlDbTSOFGmX37k65jikZfsqEb2VF7jy\" }","options":{}},"id":"07e8d87f-5af9-4beb-b270-52ac2cc4ec64","name":"Lark Tenant","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[780,320]},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/contact/v3/users","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $json[\"app_access_token\"] }}"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\n    \"name\": \"John\",\n    \"en_name\": \"San Zhang\",\n    \"nickname\": \"Alex Zhang\",\n    \"email\": \"zhangsan1@gmail.com\",\n    \"mobile\": \"+41446681800\",\n    \"gender\": 1,\n    \"employee_type\": 1,\n    \"department_ids\": [\n        \"7217372441436225542\"\n    ],\n    \"leader_user_id\": \"921ee7e2\",\n    \"city\": \"HCM\",\n    \"country\": \"VN\"\n}","options":{}},"id":"1b8df576-af0a-42eb-ad4b-e9202e6ab023","name":"HTTP Request","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[980,320]}],"connections":{"Get user info":{"main":[[{"node":"Lark Tenant","type":"main","index":0}]]},"Lark Tenant":{"main":[[{"node":"HTTP Request","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{},"versionId":"a0109b04-fcb3-4a10-8661-82ffa490a455","triggerCount":0,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-06-13T17:40:53.410Z","updatedAt":"2023-06-13T17:59:33.000Z","id":"131","name":"HR_Talo04 - Update \"Working Confirm\" after confirming the link button on the email Interview has PASS","active":true,"nodes":[{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/auth/v3/app_access_token/internal","sendBody":true,"specifyBody":"json","jsonBody":"{   \"app_id\": \"cli_a4c3e66985f8900a\",   \"app_secret\": \"ZLlDbTSOFGmX37k65jikZfsqEb2VF7jy\" }","options":{}},"id":"4c681da4-76c6-4269-aa62-573a44e7ae4a","name":"Lark Tenant","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[480,400]},{"parameters":{"path":"working-confirm","options":{"responseData":"Thank you for confirming the working star time. Please arrive for the fist working day!"}},"id":"4a6e7180-0cc8-44ef-a77c-2b017774e184","name":"Webhook (when click link confirm interview)","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[260,400],"webhookId":"6cb69a29-5c4f-490e-b05c-a94af51c2513"},{"parameters":{"method":"PUT","url":"=https://open.larksuite.com/open-apis/bitable/v1/apps/RyEhb4l5IaBHUhsGS1aucjzjsAh/tables/tbllRKm8U4LMQE6j/records/{{$('Webhook (when click link confirm interview)').item.json.query.recordID}}","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $json[\"app_access_token\"] }}"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\"fields\": {\"Working Confirm\":\"Yes\"}}","options":{}},"id":"cb979bf1-8c1a-4bb3-b483-821559231cc3","name":"Update record (field \"Working Confirm\")","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[700,400]}],"connections":{"Lark Tenant":{"main":[[{"node":"Update record (field \"Working Confirm\")","type":"main","index":0}]]},"Webhook (when click link confirm interview)":{"main":[[{"node":"Lark Tenant","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{},"versionId":"0201ab6a-a0d3-4233-91a8-6eafa50675f4","triggerCount":1,"tags":[{"createdAt":"2023-06-12T18:12:08.363Z","updatedAt":"2023-06-12T18:12:08.363Z","id":"19","name":"HR"}]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-06-14T06:51:24.885Z","updatedAt":"2023-06-14T07:08:07.000Z","id":"132","name":"[MaiLinh.express] Kh√°ch c·∫ßn t∆∞ v·∫•n v√© t√†u cao t·ªëc","active":true,"nodes":[{"parameters":{"httpMethod":"POST","path":"mailinhexpress","options":{}},"id":"9d3f8caa-211d-4639-bd29-088fedadc57e","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[820,500],"webhookId":"6e5da7f2-db4c-45a0-bc5c-2f06d4b927a1"},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/bot/v2/hook/8af563f0-2196-410f-8aea-2284ebf3ff6c","sendBody":true,"specifyBody":"json","jsonBody":"={{ JSON.stringify($('Code1').first().json)}}","options":{}},"id":"b0f09484-5818-4fc9-bd89-8ffc0c32c333","name":"HTTP Request","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[1480,500]},{"parameters":{"jsCode":"const data = $('Webhook').first().json.body;\n\nlet ten_ve = \"V√© t√†u cao t·ªëc \" + data.tuyen + \" h√£ng Mai Linh Express\";\nten_ve = ten_ve.replace(/\\n/g, \", \");\n\nlet fullname = data.fullname || '-';\nfullname = fullname.replace(/\\n/g, \", \");\n\nlet phone = data.phone || '-';\nphone = phone.replace(/\\n/g, \", \");\n\nlet sdtZalo = '84' + phone.slice(1);\n\nlet nhieu_thong_tin = false;\nif (data.nhieu_thong_tin !== '') nhieu_thong_tin = true;\n\nlet so_chieu = 2;\nif (data.so_chieu == 'M·ªôt chi·ªÅu') so_chieu = 1;\n\nlet ngay_khoi_hanh = (data.ngay_khoi_hanh === '') ? '-' : new Date(data.ngay_khoi_hanh).toLocaleDateString('en-GB');\n\nlet ngay_tro_ve = (data.ngay_tro_ve === '') ? '-' : new Date(data.ngay_tro_ve).toLocaleDateString('en-GB');\n\nlet so_luong_khach = data.so_luong_khach || 0;\n\nhang = \"Mai Linh Express\";\n\nlet noi_khoi_hanh = data.tuyen.slice(0, data.tuyen.indexOf('-')) || '-';\nnoi_khoi_hanh = noi_khoi_hanh.replace(/\\n/g, \", \");\n\nlet diem_den = data.tuyen.slice(data.tuyen.indexOf('-')+1, data.tuyen.length) || '-';\ndiem_den = diem_den.replace(/\\n/g, \", \");\n\nlet chatcode = Math.floor(Math.random() * 101);\n\nconst source_title = data.source_title;\nconst source_url = data.source_url;\n\nif (nhieu_thong_tin === false) {\n  ngay_khoi_hanh = '-';\n  ngay_tro_ve = '-';\n  hang = '-';\n  so_chieu = '-';\n  so_luong_khach = '-';\n  noi_khoi_hanh = '-';\n  diem_den = '-';\n}\n\nif (so_chieu === 1) {\n  ngay_tro_ve = '-';\n}\nreturn {\n  chatcode,\n  fullname,\n  phone,\n  sdtZalo,\n  nhieu_thong_tin,\n  ten_ve,\n  so_chieu,\n  ngay_khoi_hanh,\n  ngay_tro_ve,\n  so_luong_khach,\n  hang,\n  noi_khoi_hanh,\n  diem_den,\n  source_title,\n  source_url\n}\n\n\n\n"},"id":"d5bf6666-ff64-4320-9715-383fd370ed03","name":"Code","type":"n8n-nodes-base.code","typeVersion":1,"position":[1040,500]},{"parameters":{"jsCode":"const data = $(\"Code\").first().json;\n\nlet elements = [];\n\nelements.push({\n    tag: \"div\",\n    fields: [\n        {\n            is_short: true,\n            text: {\n                tag: \"lark_md\",\n                content: `**H·ªç v√† t√™n:** ${data.fullname}`,\n            },\n        },\n        {\n            is_short: true,\n            text: {\n                tag: \"lark_md\",\n                content: `**S·ªë ƒëi·ªán tho·∫°i:** ${data.phone}`,\n            },\n        },\n        {\n            is_short: true,\n            text: {\n                tag: \"lark_md\",\n                content: `**M√£ ƒë·∫∑t v√©:** ${data.chatcode}`,\n            },\n        },\n        {\n            is_short: true,\n            text: {\n                tag: \"lark_md\",\n                content: `**H√£ng:** ${data.hang}`,\n            },\n        },\n        {\n            is_short: true,\n            text: {\n                tag: \"lark_md\",\n                content: `**N∆°i kh·ªüi h√†nh:** ${data.noi_khoi_hanh}`,\n            },\n        },\n        {\n            is_short: true,\n            text: {\n                tag: \"lark_md\",\n                content: `**N∆°i ƒë·∫øn:** ${data.diem_den}`,\n            },\n        },\n        {\n            is_short: true,\n            text: {\n                tag: \"lark_md\",\n                content: `**Ng√†y kh·ªüi h√†nh:** ${data.ngay_khoi_hanh}`,\n            },\n        },\n        {\n            is_short: true,\n            text: {\n                tag: \"lark_md\",\n                content: `**Ng√†y tr·ªü v·ªÅ:** ${data.ngay_tro_ve}`,\n            },\n        },\n        {\n            is_short: true,\n            text: {\n                tag: \"lark_md\",\n                content: `**S·ªë chi·ªÅu:** ${data.so_chieu}`,\n            },\n        },\n        {\n            is_short: true,\n            text: {\n                tag: \"lark_md\",\n                content: `**S·ªë kh√°ch:** ${data.so_luong_khach}`,\n            },\n        },\n    ],\n});\n\n// Add action buttons\nelements.push({\n    tag: \"action\",\n    actions: [\n        {\n            tag: \"button\",\n            text: {\n                tag: \"plain_text\",\n                content: \"Chat Zalo c√° nh√¢n\",\n            },\n            url: `https://zalo.me/${data.phone}`,\n            type: \"primary\",\n        },\n        {\n            tag: \"button\",\n            text: {\n                tag: \"plain_text\",\n                content: \"G·ªçi ƒëi·ªán c√° nh√¢n\",\n            },\n            url: `tel:${data.phone}`,\n            type: \"default\",\n        },\n        {\n            tag: \"button\",\n            text: {\n                tag: \"plain_text\",\n                content: \"Xem tr√™n web\",\n            },\n            url: `${data.source_url}`,\n            type: \"default\",\n        }\n    ],\n});\n\n\nlet result = {\n    msg_type: \"interactive\",\n    card: {\n        config: {\n            wide_screen_mode: true,\n        },\n        header: {\n            template: \"green\",\n            title: {\n                content: `Y√™u c·∫ßu t∆∞ v·∫•n ${data.source_title}`,\n                tag: \"plain_text\",\n            },\n        },\n        elements,\n    },\n};\nreturn { json: result };"},"id":"27ddfe74-1b62-408a-bcad-62a28c925e4d","name":"Code1","type":"n8n-nodes-base.code","typeVersion":1,"position":[1260,500]},{"parameters":{"conditions":{"string":[{"value1":"={{ $json.msg }}","value2":"success"}]}},"id":"6ecbbaec-c4e6-4739-add1-461f6e8154fb","name":"IF","type":"n8n-nodes-base.if","typeVersion":1,"position":[1700,500]},{"parameters":{"conditions":{"boolean":[{"value1":"={{ $node.Code.json.nhieu_thong_tin }}","value2":"={{ true }}"}]}},"id":"c850e714-aa0f-44f9-a162-8d91e2832f58","name":"IF1","type":"n8n-nodes-base.if","typeVersion":1,"position":[1880,360]},{"parameters":{"application":{"__rl":true,"value":"appg7xGBQYqUYbJAr","mode":"id"},"table":{"__rl":true,"value":"tblWAtHbJemABDvCG","mode":"id"},"id":"recqr9eRsaI69jq2D"},"id":"d10176d8-0eb6-4b91-b429-17a2b6185cf8","name":"Airtable","type":"n8n-nodes-base.airtable","typeVersion":1,"position":[2100,360],"credentials":{"airtableApi":{"id":"20","name":"Airtable: lekhoi456@gmail.com"}}},{"parameters":{"method":"POST","url":"https://business.openapi.zalo.me/message/template","sendHeaders":true,"headerParameters":{"parameters":[{"name":"access_token","value":"={{ $node.Airtable.json.fields.access_token }}"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\n    \"phone\": \"{{$node[\"Code\"].json[\"sdtZalo\"]}}\",\n    \"template_id\": \"259151\",\n    \"template_data\": {\n        \"loai_ve\": \"{{$node[\"Webhook\"].json[\"body\"][\"so_chieu\"]}}\",\n        \"ngay_tro_ve\": \"{{$node[\"Code\"].json[\"ngay_tro_ve\"]}}\",\n        \"diem_den\": \"{{$node[\"Code\"].json[\"diem_den\"]}}\",\n        \"hang\": \"{{$node[\"Code\"].json[\"hang\"]}}\",\n        \"ngay_khoi_hanh\": \"{{$node[\"Code\"].json[\"ngay_khoi_hanh\"]}}\",\n        \"ma_dat_ve\": \"{{$node[\"Code\"].json[\"chatcode\"]}}\",\n        \"ten_ve\": \"{{$node[\"Code\"].json[\"ten_ve\"]}}\",\n        \"noi_khoi_hanh\": \"{{$node[\"Code\"].json[\"noi_khoi_hanh\"]}}\",\n        \"trang_thai\": \"ƒêang ki·ªÉm tra v√©\",\n        \"so_luong_khach\": {{$node[\"Code\"].json[\"so_luong_khach\"]}},\n        \"ho_va_ten\": \"{{$node[\"Code\"].json[\"fullname\"]}}\"\n    },\n    \"tracking_id\": \"ncmk_phong_ve_khach_de_lai_thong_tin\"\n}","options":{}},"id":"b5569fe0-7f10-42de-b076-c50e67b7a539","name":"HTTP Request1","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[2540,160]},{"parameters":{"conditions":{"number":[{"value1":"={{ $node.Code.json.so_chieu }}","operation":"equal","value2":2}]}},"id":"2876e988-92e7-4077-85c2-d729bb815d8c","name":"IF2","type":"n8n-nodes-base.if","typeVersion":1,"position":[2320,360]},{"parameters":{"method":"POST","url":"https://business.openapi.zalo.me/message/template","sendHeaders":true,"headerParameters":{"parameters":[{"name":"access_token","value":"={{ $node.Airtable.json.fields.access_token }}"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\n    \"phone\": \"{{$node[\"Code\"].json[\"sdtZalo\"]}}\",\n    \"template_id\": \"259152\",\n    \"template_data\": {\n        \"loai_ve\": \"{{$node[\"Webhook\"].json[\"body\"][\"so_chieu\"]}}\",\n        \"diem_den\": \"{{$node[\"Code\"].json[\"diem_den\"]}}\",\n        \"hang\": \"{{$node[\"Code\"].json[\"hang\"]}}\",\n        \"ngay_khoi_hanh\": \"{{$node[\"Code\"].json[\"ngay_khoi_hanh\"]}}\",\n        \"ma_dat_ve\": \"{{$node[\"Code\"].json[\"chatcode\"]}}\",\n        \"ten_ve\": \"{{$node[\"Code\"].json[\"ten_ve\"]}}\",\n        \"noi_khoi_hanh\": \"{{$node[\"Code\"].json[\"noi_khoi_hanh\"]}}\",\n        \"trang_thai\": \"ƒêang ki·ªÉm tra v√©\",\n        \"so_luong_khach\": {{$node[\"Code\"].json[\"so_luong_khach\"]}},\n        \"ho_va_ten\": \"{{$node[\"Code\"].json[\"fullname\"]}}\"\n    },\n    \"tracking_id\": \"ncmk_phong_ve_khach_de_lai_thong_tin\"\n}","options":{}},"id":"5f96acb9-aef2-4410-bb3f-4e2d835a6638","name":"HTTP Request2","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[2540,380]}],"connections":{"Webhook":{"main":[[{"node":"Code","type":"main","index":0}]]},"Code":{"main":[[{"node":"Code1","type":"main","index":0}]]},"Code1":{"main":[[{"node":"HTTP Request","type":"main","index":0}]]},"HTTP Request":{"main":[[{"node":"IF","type":"main","index":0}]]},"IF":{"main":[[{"node":"IF1","type":"main","index":0}]]},"IF1":{"main":[[{"node":"Airtable","type":"main","index":0}]]},"Airtable":{"main":[[{"node":"IF2","type":"main","index":0}]]},"IF2":{"main":[[{"node":"HTTP Request1","type":"main","index":0}],[{"node":"HTTP Request2","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{"Webhook":[{"json":{"headers":{"host":"app.n8n.vn","user-agent":"WordPress/6.2.2; https://mailinh.local","content-length":"480","accept":"*/*","accept-encoding":"deflate, gzip, br, zstd","content-type":"application/json; charset=UTF-8","x-forwarded-for":"125.235.236.200","x-forwarded-host":"app.n8n.vn","x-forwarded-port":"443","x-forwarded-proto":"https","x-forwarded-server":"ba8c3a24b3d5","x-real-ip":"125.235.236.200"},"params":{},"query":{},"body":{"tuyen":"C·∫ßn Th∆° - C√¥n ƒê·∫£o","fullname":"Le Quoc Khoi","phone":"0333111868","nhieu_thong_tin":["T√¥i s·∫Ω cung c·∫•p nhi·ªÅu th√¥ng tin h∆°n"],"so_chieu":"Kh·ª© h·ªìi","ngay_khoi_hanh":"2023-06-15","ngay_tro_ve":"2023-06-16","so_luong_khach":"2","source_title":"T√†u cao t·ªëc Mai Linh Express - V√© t√†u C·∫ßn Th∆° - C√¥n ƒê·∫£o gi√° r·∫ª","source_url":"https://mailinh.local:10164/"}},"pairedItem":{"item":0}}]},"versionId":"abd44646-2527-48a7-b45c-6a98a47535f0","triggerCount":1,"tags":[{"createdAt":"2023-05-09T11:00:16.326Z","updatedAt":"2023-05-09T11:00:16.326Z","id":"16","name":"vere"}]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-06-19T04:12:17.359Z","updatedAt":"2023-07-20T15:01:27.000Z","id":"133","name":"[Preorder √°o] Send email x√°c nh·∫≠n ƒë∆°n h√†ng","active":true,"nodes":[{"parameters":{"httpMethod":"POST","path":"/dcgr/preorder2023/email-xac-nhan-don-hang","responseMode":"responseNode","options":{}},"id":"895d2c5b-0fe7-4946-a09b-344833e1da6d","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[900,520],"webhookId":"f19f7e0d-4200-4fa0-959a-b27e09c173c1"},{"parameters":{"jsCode":"const data = $('Webhook').first().json.body\nlet price = Number(data.price).toLocaleString(\"en-US\") + \" VND\"\nlet amount = Number(data.amount)\nlet total = Number(data.total).toLocaleString(\"en-US\") + \" VND\"\nlet url_payment = `https://img.vietqr.io/image/VCB-6681888888-compact.png?amount=${Number(data.total)}&addInfo=${data.order_id}&accountName=Le%20Quoc%20Khoi`\nlet url_img\nif (data.style === 'M·∫´u 1') {\n  url_img = 'https://s3.kdigi.app/dcgr/mau-1.jpg'\n} else if (data.style === 'M·∫´u 2') {\n  url_img = 'https://s3.kdigi.app/dcgr/mau-2.jpg'\n} else {\n  url_img = 'https://s3.kdigi.app/dcgr/mau-3.jpg'\n}\nreturn {\n  price,\n  amount,\n  total,\n  url_payment,\n  url_img\n}"},"id":"f8196fdd-b705-496f-98d1-9dc391258a20","name":"Code","type":"n8n-nodes-base.code","typeVersion":1,"position":[1100,520]},{"parameters":{"fromEmail":"DC Group <no-reply@dcmedia.vn>","toEmail":"={{ $('Webhook').item.json.body.email }}","subject":"=DCGR -  X√°c nh·∫≠n Pre-order #{{ $('Webhook').item.json.body.order_id }}","emailFormat":"html","html":"=\n    <!doctype html>\n    <html xmlns=\"http://www.w3.org/1999/xhtml\" xmlns:v=\"urn:schemas-microsoft-com:vml\" xmlns:o=\"urn:schemas-microsoft-com:office:office\">\n      <head>\n        <title>\n          \n        </title>\n        <!--[if !mso]><!-->\n        <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\n        <!--<![endif]-->\n        <meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\">\n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\n        <style type=\"text/css\">\n          #outlook a { padding:0; }\n          body { margin:0;padding:0;-webkit-text-size-adjust:100%;-ms-text-size-adjust:100%; }\n          table, td { border-collapse:collapse;mso-table-lspace:0pt;mso-table-rspace:0pt; }\n          img { border:0;height:auto;line-height:100%; outline:none;text-decoration:none;-ms-interpolation-mode:bicubic; }\n          p { display:block;margin:13px 0; }\n        </style>\n        <!--[if mso]>\n        <noscript>\n        <xml>\n        <o:OfficeDocumentSettings>\n          <o:AllowPNG/>\n          <o:PixelsPerInch>96</o:PixelsPerInch>\n        </o:OfficeDocumentSettings>\n        </xml>\n        </noscript>\n        <![endif]-->\n        <!--[if lte mso 11]>\n        <style type=\"text/css\">\n          .mj-outlook-group-fix { width:100% !important; }\n        </style>\n        <![endif]-->\n        \n      <!--[if !mso]><!-->\n        <link href=\"https://fonts.googleapis.com/css?family=Roboto:300,400,500,700\" rel=\"stylesheet\" type=\"text/css\">\n        <style type=\"text/css\">\n          @import url(https://fonts.googleapis.com/css?family=Roboto:300,400,500,700);\n        </style>\n      <!--<![endif]-->\n\n    \n        \n    <style type=\"text/css\">\n      @media only screen and (min-width:480px) {\n        .mj-column-px-250 { width:250px !important; max-width: 250px; }\n.mj-column-per-100 { width:100% !important; max-width: 100%; }\n.mj-column-per-50 { width:50% !important; max-width: 50%; }\n      }\n    </style>\n    <style media=\"screen and (min-width:480px)\">\n      .moz-text-html .mj-column-px-250 { width:250px !important; max-width: 250px; }\n.moz-text-html .mj-column-per-100 { width:100% !important; max-width: 100%; }\n.moz-text-html .mj-column-per-50 { width:50% !important; max-width: 50%; }\n    </style>\n  \n        <style type=\"text/css\">\n        \n        \n\n    @media only screen and (max-width:480px) {\n      table.mj-full-width-mobile { width: 100% !important; }\n      td.mj-full-width-mobile { width: auto !important; }\n    }\n  \n        </style>\n        \n        \n      </head>\n      <body style=\"word-spacing:normal;background-color:#eeeeee;\">\n        \n        \n      <div\n         style=\"background-color:#eeeeee;\"\n      >\n        \n      \n      <!--[if mso | IE]><table align=\"center\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" class=\"\" style=\"width:600px;\" width=\"600\" ><tr><td style=\"line-height:0px;font-size:0px;mso-line-height-rule:exactly;\"><v:rect style=\"width:600px;\" xmlns:v=\"urn:schemas-microsoft-com:vml\" fill=\"true\" stroke=\"false\"><v:fill origin=\"0.5, 0\" position=\"0.5, 0\" src=\"https://s3.kdigi.app/dcgr/dc-abstract.jpeg\" type=\"tile\" /><v:textbox style=\"mso-fit-shape-to-text:true\" inset=\"0,0,0,0\"><![endif]-->\n          \n      <div  style=\"background:url(https://s3.kdigi.app/dcgr/dc-abstract.jpeg) center top / auto repeat;background-position:center top;background-repeat:repeat;background-size:auto;margin:0px auto;max-width:600px;\">\n        <div  style=\"line-height:0;font-size:0;\">\n        <table\n           align=\"center\" background=\"https://s3.kdigi.app/dcgr/dc-abstract.jpeg\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\" style=\"background:url(https://s3.kdigi.app/dcgr/dc-abstract.jpeg) center top / auto repeat;background-position:center top;background-repeat:repeat;background-size:auto;width:100%;\"\n        >\n          <tbody>\n            <tr>\n              <td\n                 style=\"direction:ltr;font-size:0px;padding:20px;text-align:center;\"\n              >\n                <!--[if mso | IE]><table role=\"presentation\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"><tr><td class=\"\" style=\"vertical-align:top;width:250px;\" ><![endif]-->\n            \n      <div\n         class=\"mj-column-px-250 mj-outlook-group-fix\" style=\"font-size:0px;text-align:left;direction:ltr;display:inline-block;vertical-align:top;width:100%;\"\n      >\n        \n      <table\n         border=\"0\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\" style=\"vertical-align:top;\" width=\"100%\"\n      >\n        <tbody>\n          \n              <tr>\n                <td\n                   align=\"center\" style=\"font-size:0px;padding:10px 25px;word-break:break-word;\"\n                >\n                  \n      <table\n         border=\"0\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\" style=\"border-collapse:collapse;border-spacing:0px;\"\n      >\n        <tbody>\n          <tr>\n            <td  style=\"width:200px;\">\n              \n      <img\n         height=\"auto\" src=\"https://s3.kdigi.app/dcgr/logo-dc-media.png\" style=\"border:0;display:block;outline:none;text-decoration:none;height:auto;width:100%;font-size:13px;\" width=\"200\"\n      />\n    \n            </td>\n          </tr>\n        </tbody>\n      </table>\n    \n                </td>\n              </tr>\n            \n        </tbody>\n      </table>\n    \n      </div>\n    \n          <!--[if mso | IE]></td></tr></table><![endif]-->\n              </td>\n            </tr>\n          </tbody>\n        </table>\n        </div>\n      </div>\n    \n        <!--[if mso | IE]></v:textbox></v:rect></td></tr></table><table align=\"center\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" class=\"\" style=\"width:600px;\" width=\"600\" bgcolor=\"#ffffff\" ><tr><td style=\"line-height:0px;font-size:0px;mso-line-height-rule:exactly;\"><![endif]-->\n    \n      \n      <div  style=\"background:#ffffff;background-color:#ffffff;margin:0px auto;max-width:600px;\">\n        \n        <table\n           align=\"center\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\" style=\"background:#ffffff;background-color:#ffffff;width:100%;\"\n        >\n          <tbody>\n            <tr>\n              <td\n                 style=\"direction:ltr;font-size:0px;padding:0px 0px;text-align:center;\"\n              >\n                <!--[if mso | IE]><table role=\"presentation\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"><tr><td class=\"\" style=\"vertical-align:top;width:600px;\" ><![endif]-->\n            \n      <div\n         class=\"mj-column-per-100 mj-outlook-group-fix\" style=\"font-size:0px;text-align:left;direction:ltr;display:inline-block;vertical-align:top;width:100%;\"\n      >\n        \n      <table\n         border=\"0\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\" style=\"vertical-align:top;\" width=\"100%\"\n      >\n        <tbody>\n          \n              <tr>\n                <td\n                   align=\"center\" style=\"font-size:0px;padding:0px 25px;word-break:break-word;\"\n                >\n                  \n      <div\n         style=\"font-family:Roboto, Helvetica Neue, Helvetica, Arial, sans-serif;font-size:13px;line-height:1;text-align:center;color:#000000;\"\n      ><h1>X√°c nh·∫≠n ƒë∆°n h√†ng</h1></div>\n    \n                </td>\n              </tr>\n            \n              <tr>\n                <td\n                   align=\"left\" style=\"font-size:0px;padding:10px 25px;word-break:break-word;\"\n                >\n                  \n      <div\n         style=\"font-family:Roboto, Helvetica Neue, Helvetica, Arial, sans-serif;font-size:13px;line-height:1;text-align:left;color:#000000;\"\n      ><div><font face=\"Roboto\" size=\"3\"><span>Xin ch√†o <b>{{ $('Webhook').item.json[\"body\"][\"name\"] }}</b>, ch√∫ng t√¥i</span><span style=\"background-color: transparent;\">&nbsp;r·∫•t vui th√¥ng b√°o ƒë∆°n h√†ng #{{ $('Webhook').item.json[\"body\"][\"order_id\"] }} c·ªßa qu√Ω kh√°ch ƒë√£ ƒë∆∞·ª£c ti·∫øp nh·∫≠n.</span></font></div></div>\n    \n                </td>\n              </tr>\n            \n        </tbody>\n      </table>\n    \n      </div>\n    \n          <!--[if mso | IE]></td></tr></table><![endif]-->\n              </td>\n            </tr>\n          </tbody>\n        </table>\n        \n      </div>\n    \n      \n      <!--[if mso | IE]></td></tr></table><table align=\"center\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" class=\"\" style=\"width:600px;\" width=\"600\" bgcolor=\"#ffffff\" ><tr><td style=\"line-height:0px;font-size:0px;mso-line-height-rule:exactly;\"><![endif]-->\n    \n      \n      <div  style=\"background:#ffffff;background-color:#ffffff;margin:0px auto;max-width:600px;\">\n        \n        <table\n           align=\"center\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\" style=\"background:#ffffff;background-color:#ffffff;width:100%;\"\n        >\n          <tbody>\n            <tr>\n              <td\n                 style=\"direction:ltr;font-size:0px;padding:0px;text-align:center;\"\n              >\n                <!--[if mso | IE]><table role=\"presentation\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"><tr><td class=\"\" style=\"vertical-align:top;width:600px;\" ><![endif]-->\n            \n      <div\n         class=\"mj-column-per-100 mj-outlook-group-fix\" style=\"font-size:0px;text-align:left;direction:ltr;display:inline-block;vertical-align:top;width:100%;\"\n      >\n        \n      <table\n         border=\"0\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\" style=\"vertical-align:top;\" width=\"100%\"\n      >\n        <tbody>\n          \n              <tr>\n                <td\n                   align=\"center\" style=\"font-size:0px;padding:10px 25px;word-break:break-word;\"\n                >\n                  \n      <table\n         border=\"0\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\" style=\"border-collapse:collapse;border-spacing:0px;\"\n      >\n        <tbody>\n          <tr>\n            <td  style=\"width:550px;\">\n              \n      <img\n         height=\"auto\" src=\"{{ $('Code').item.json[\"url_img\"] }}\" style=\"border:0;border-radius:8px;display:block;outline:none;text-decoration:none;height:auto;width:100%;font-size:13px;\" width=\"550\"\n      />\n    \n            </td>\n          </tr>\n        </tbody>\n      </table>\n    \n                </td>\n              </tr>\n            \n        </tbody>\n      </table>\n    \n      </div>\n    \n          <!--[if mso | IE]></td></tr></table><![endif]-->\n              </td>\n            </tr>\n          </tbody>\n        </table>\n        \n      </div>\n    \n      \n      <!--[if mso | IE]></td></tr></table><table align=\"center\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" class=\"\" style=\"width:600px;\" width=\"600\" bgcolor=\"#ffffff\" ><tr><td style=\"line-height:0px;font-size:0px;mso-line-height-rule:exactly;\"><![endif]-->\n    \n      \n      <div  style=\"background:#ffffff;background-color:#ffffff;margin:0px auto;max-width:600px;\">\n        \n        <table\n           align=\"center\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\" style=\"background:#ffffff;background-color:#ffffff;width:100%;\"\n        >\n          <tbody>\n            <tr>\n              <td\n                 style=\"direction:ltr;font-size:0px;padding:0px 0px;text-align:center;\"\n              >\n                <!--[if mso | IE]><table role=\"presentation\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"><tr><td class=\"\" style=\"vertical-align:top;width:300px;\" ><![endif]-->\n            \n      <div\n         class=\"mj-column-per-50 mj-outlook-group-fix\" style=\"font-size:0px;text-align:left;direction:ltr;display:inline-block;vertical-align:top;width:100%;\"\n      >\n        \n      <table\n         border=\"0\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\" style=\"vertical-align:top;\" width=\"100%\"\n      >\n        <tbody>\n          \n              <tr>\n                <td\n                   align=\"left\" style=\"font-size:0px;padding:0px 25px;word-break:break-word;\"\n                >\n                  \n      <div\n         style=\"font-family:Roboto, Helvetica Neue, Helvetica, Arial, sans-serif;font-size:13px;line-height:1;text-align:left;color:#000000;\"\n      ><h2>Th√¥ng tin ƒë∆°n h√†ng</h2></div>\n    \n                </td>\n              </tr>\n            \n              <tr>\n                <td\n                   align=\"left\" style=\"font-size:0px;padding:10px 25px;word-break:break-word;\"\n                >\n                  \n      <div\n         style=\"font-family:Roboto, Helvetica Neue, Helvetica, Arial, sans-serif;font-size:13px;line-height:1;text-align:left;color:#000000;\"\n      ><b><font size=\"3\">√Åo DCGR 2023</font></b><div><font size=\"3\"><b>M·∫´u:</b> {{ $('Webhook').item.json[\"body\"][\"style\"] }}</font></div><div><font size=\"3\"><b>K√≠ch c·ª°: </b>Size {{ $('Webhook').item.json[\"body\"][\"size\"] }}</font></div><div><font size=\"3\"><b>Gi√° Pre-order:</b> {{ $('Code').item.json[\"price\"] }}</font></div><div><font size=\"3\"><b>S·ªë l∆∞·ª£ng:</b> {{ $('Webhook').item.json[\"body\"][\"amount\"] }}</font></div><div><font size=\"3\"><b>Th√†nh ti·ªÅn:</b> {{ $('Code').item.json[\"total\"] }}</font></div></div>\n    \n                </td>\n              </tr>\n            \n        </tbody>\n      </table>\n    \n      </div>\n    \n          <!--[if mso | IE]></td><td class=\"\" style=\"vertical-align:top;width:300px;\" ><![endif]-->\n            \n      <div\n         class=\"mj-column-per-50 mj-outlook-group-fix\" style=\"font-size:0px;text-align:left;direction:ltr;display:inline-block;vertical-align:top;width:100%;\"\n      >\n        \n      <table\n         border=\"0\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\" style=\"vertical-align:top;\" width=\"100%\"\n      >\n        <tbody>\n          \n              <tr>\n                <td\n                   align=\"left\" style=\"font-size:0px;padding:0px 25px;word-break:break-word;\"\n                >\n                  \n      <div\n         style=\"font-family:Roboto, Helvetica Neue, Helvetica, Arial, sans-serif;font-size:13px;line-height:1;text-align:left;color:#000000;\"\n      ><h2 style=\"color: rgb(0, 0, 0); text-transform: none;\">ƒê·ªãa ch·ªâ giao h√†ng</h2></div>\n    \n                </td>\n              </tr>\n            \n              <tr>\n                <td\n                   align=\"left\" style=\"font-size:0px;padding:10px 25px;word-break:break-word;\"\n                >\n                  \n      <div\n         style=\"font-family:Roboto, Helvetica Neue, Helvetica, Arial, sans-serif;font-size:13px;line-height:1;text-align:left;color:#000000;\"\n      ><div><font size=\"3\"><b>T√™n ng∆∞·ªùi nh·∫≠n:</b> {{ $('Webhook').item.json[\"body\"][\"name\"] }}</font></div><div><font size=\"3\"><b>S·ªë ƒëi·ªán tho·∫°i:</b> {{ $('Webhook').item.json[\"body\"][\"phone\"] }}</font></div><div><font size=\"3\"><b>ƒê·ªãa ch·ªâ:</b> {{ $('Webhook').item.json[\"body\"][\"address\"] }}</font></div><div><font size=\"3\"><br></font></div><div><span style=\"background-color: transparent;\"><font size=\"3\">Th·ªùi gian d·ª± ki·∫øn nh·∫≠n h√†ng: t·ª´ 2-4 ng√†y</font></span></div></div>\n    \n                </td>\n              </tr>\n            \n        </tbody>\n      </table>\n    \n      </div>\n    \n          <!--[if mso | IE]></td></tr></table><![endif]-->\n              </td>\n            </tr>\n          </tbody>\n        </table>\n        \n      </div>\n    \n      \n      <!--[if mso | IE]></td></tr></table><table align=\"center\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" class=\"\" style=\"width:600px;\" width=\"600\" bgcolor=\"#ffffff\" ><tr><td style=\"line-height:0px;font-size:0px;mso-line-height-rule:exactly;\"><![endif]-->\n    \n      \n      <div  style=\"background:#ffffff;background-color:#ffffff;margin:0px auto;max-width:600px;\">\n        \n        <table\n           align=\"center\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\" style=\"background:#ffffff;background-color:#ffffff;width:100%;\"\n        >\n          <tbody>\n            <tr>\n              <td\n                 style=\"direction:ltr;font-size:0px;padding:0px 0px;text-align:center;\"\n              >\n                <!--[if mso | IE]><table role=\"presentation\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"><tr><td class=\"\" style=\"vertical-align:top;width:300px;\" ><![endif]-->\n            \n      <div\n         class=\"mj-column-per-50 mj-outlook-group-fix\" style=\"font-size:0px;text-align:left;direction:ltr;display:inline-block;vertical-align:top;width:100%;\"\n      >\n        \n      <table\n         border=\"0\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\" style=\"vertical-align:top;\" width=\"100%\"\n      >\n        <tbody>\n          \n              <tr>\n                <td\n                   align=\"left\" style=\"font-size:0px;padding:0px 25px;word-break:break-word;\"\n                >\n                  \n      <div\n         style=\"font-family:Roboto, Helvetica Neue, Helvetica, Arial, sans-serif;font-size:13px;line-height:1;text-align:left;color:#000000;\"\n      ><h2>Th√¥ng tin thanh to√°n</h2></div>\n    \n                </td>\n              </tr>\n            \n              <tr>\n                <td\n                   align=\"left\" style=\"font-size:0px;padding:10px 25px;word-break:break-word;\"\n                >\n                  \n      <div\n         style=\"font-family:Roboto, Helvetica Neue, Helvetica, Arial, sans-serif;font-size:13px;line-height:1;text-align:left;color:#000000;\"\n      ><div><font size=\"3\">Vui l√≤ng chuy·ªÉn kho·∫£n theo th√¥ng tin d∆∞·ªõi ƒë√¢y:</font></div><div><font size=\"3\"><b>Ng√¢n h√†ng:</b> Vietcombank</font></div><div><font size=\"3\"><b>S·ªë t√†i kho·∫£n:</b> 6681888888</font></div><div><font size=\"3\"><b>T√™n t√†i kho·∫£n:</b> L√™ Qu·ªëc Kh√¥i</font></div><div><font size=\"3\"><b>S·ªë ti·ªÅn:</b> {{ $('Code').item.json[\"total\"] }}</font></div><div><font size=\"3\"><b>N·ªôi dung:</b> <span style=\"background-color: rgb(251, 255, 0);\">{{ $('Webhook').item.json[\"body\"][\"order_id\"] }}</span></font></div><div><font size=\"3\"><br></font></div><div><font size=\"3\">L∆∞u √Ω: ƒê∆°n h√†ng n√†y ƒë∆∞·ª£c x√°c nh·∫≠n t·ª± ƒë·ªông. Vui l√≤ng chuy·ªÉn kho·∫£n ƒë√∫ng n·ªôi dung v√† s·ªë ti·ªÅn ƒë·ªÉ ƒë∆°n h√†ng ƒë∆∞·ª£c x·ª≠ l√Ω nhanh nh·∫•t.</font></div></div>\n    \n                </td>\n              </tr>\n            \n        </tbody>\n      </table>\n    \n      </div>\n    \n          <!--[if mso | IE]></td><td class=\"\" style=\"vertical-align:top;width:300px;\" ><![endif]-->\n            \n      <div\n         class=\"mj-column-per-50 mj-outlook-group-fix\" style=\"font-size:0px;text-align:left;direction:ltr;display:inline-block;vertical-align:top;width:100%;\"\n      >\n        \n      <table\n         border=\"0\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\" style=\"vertical-align:top;\" width=\"100%\"\n      >\n        <tbody>\n          \n              <tr>\n                <td\n                   align=\"center\" style=\"font-size:0px;padding:10px 25px;word-break:break-word;\"\n                >\n                  \n      <table\n         border=\"0\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\" style=\"border-collapse:collapse;border-spacing:0px;\"\n      >\n        <tbody>\n          <tr>\n            <td  style=\"width:250px;\">\n              \n      <img\n         height=\"auto\" src=\"{{ $('Code').item.json[\"url_payment\"] }}\" style=\"border:0;display:block;outline:none;text-decoration:none;height:auto;width:100%;font-size:13px;\" width=\"250\"\n      />\n    \n            </td>\n          </tr>\n        </tbody>\n      </table>\n    \n                </td>\n              </tr>\n            \n        </tbody>\n      </table>\n    \n      </div>\n    \n          <!--[if mso | IE]></td></tr></table><![endif]-->\n              </td>\n            </tr>\n          </tbody>\n        </table>\n        \n      </div>\n    \n      \n      <!--[if mso | IE]></td></tr></table><table align=\"center\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" class=\"\" style=\"width:600px;\" width=\"600\" bgcolor=\"#ffffff\" ><tr><td style=\"line-height:0px;font-size:0px;mso-line-height-rule:exactly;\"><![endif]-->\n    \n      \n      <div  style=\"background:#ffffff;background-color:#ffffff;margin:0px auto;max-width:600px;\">\n        \n        <table\n           align=\"center\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\" style=\"background:#ffffff;background-color:#ffffff;width:100%;\"\n        >\n          <tbody>\n            <tr>\n              <td\n                 style=\"direction:ltr;font-size:0px;padding:0px 0px;text-align:center;\"\n              >\n                <!--[if mso | IE]><table role=\"presentation\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"><tr><td class=\"\" style=\"vertical-align:top;width:600px;\" ><![endif]-->\n            \n      <div\n         class=\"mj-column-per-100 mj-outlook-group-fix\" style=\"font-size:0px;text-align:left;direction:ltr;display:inline-block;vertical-align:top;width:100%;\"\n      >\n        \n      <table\n         border=\"0\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\" style=\"vertical-align:top;\" width=\"100%\"\n      >\n        <tbody>\n          \n              <tr>\n                <td\n                   align=\"left\" style=\"font-size:0px;padding:20px 25px;word-break:break-word;\"\n                >\n                  \n      <div\n         style=\"font-family:Roboto, Helvetica Neue, Helvetica, Arial, sans-serif;font-size:13px;line-height:1;text-align:left;color:#000000;\"\n      ><div><span><b><font size=\"3\">DC MEDIA</font></b></span></div><div><font size=\"3\">H·ªó tr·ª£: 0333111868</font></div></div>\n    \n                </td>\n              </tr>\n            \n              <tr>\n                <td\n                   align=\"center\" style=\"font-size:0px;padding:0px;word-break:break-word;\"\n                >\n                  \n      <p\n         style=\"border-top:solid 4px #2980b9;font-size:1px;margin:0px auto;width:100%;\"\n      >\n      </p>\n      \n      <!--[if mso | IE]><table align=\"center\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" style=\"border-top:solid 4px #2980b9;font-size:1px;margin:0px auto;width:600px;\" role=\"presentation\" width=\"600px\" ><tr><td style=\"height:0;line-height:0;\"> &nbsp;\n</td></tr></table><![endif]-->\n    \n    \n                </td>\n              </tr>\n            \n        </tbody>\n      </table>\n    \n      </div>\n    \n          <!--[if mso | IE]></td></tr></table><![endif]-->\n              </td>\n            </tr>\n          </tbody>\n        </table>\n        \n      </div>\n    \n      \n      <!--[if mso | IE]></td></tr></table><![endif]-->\n    \n    \n      </div>\n    \n      </body>\n    </html>\n  ","options":{}},"id":"c9019a4d-2710-4fe8-ba80-db036d0b7cf5","name":"Send Email","type":"n8n-nodes-base.emailSend","typeVersion":2,"position":[1320,520],"credentials":{"smtp":{"id":"62","name":"SMTP no-reply@dcmedia.vn"}}},{"parameters":{"respondWith":"json","responseBody":"={\n\"email_response\": \"{{ $json[\"response\"] }}\"\n}","options":{}},"id":"89243d91-8d24-45ed-9220-56b3ca8e00bb","name":"Respond to Webhook","type":"n8n-nodes-base.respondToWebhook","typeVersion":1,"position":[1540,520]}],"connections":{"Webhook":{"main":[[{"node":"Code","type":"main","index":0}]]},"Code":{"main":[[{"node":"Send Email","type":"main","index":0}]]},"Send Email":{"main":[[{"node":"Respond to Webhook","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{},"versionId":"7e62f22b-332b-4bd6-87c3-33b08dfba956","triggerCount":1,"tags":[{"createdAt":"2023-07-14T18:38:08.838Z","updatedAt":"2023-07-14T18:38:08.838Z","id":"26","name":"dcgr"}]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-06-19T06:13:47.369Z","updatedAt":"2023-07-20T16:43:31.000Z","id":"134","name":"[Preorder √°o] Khi nh·∫≠n ƒë∆∞·ª£c thanh to√°n","active":true,"nodes":[{"parameters":{"httpMethod":"POST","path":"/dcgr/preorder2023/nhan-chuyen-khoan","options":{}},"id":"ebc7e8a7-f7a4-40fc-a154-e3892768a8fd","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[700,340],"webhookId":"9a277f0a-b949-4995-9e42-1076d9f3b44d"},{"parameters":{"conditions":{"boolean":[{"value1":"={{ $json.isValidRecordId }}","value2":"={{ true }}"}]}},"id":"60aecf3a-2d18-4617-8a25-2510c6129b18","name":"check_found_order","type":"n8n-nodes-base.if","typeVersion":1,"position":[2440,320]},{"parameters":{"conditions":{"number":[{"value1":"={{ $json.moneyPayment }}","operation":"largerEqual","value2":"={{ $json.moneyTotal }}"}]}},"id":"1c02b750-6c88-4b34-91ab-ae67e6629537","name":"check-full-payment","type":"n8n-nodes-base.if","typeVersion":1,"position":[2700,-380]},{"parameters":{"method":"POST","url":"https://app.n8n.vn/webhook/dcgr/preorder2023/email-thanh-toan-full","sendBody":true,"specifyBody":"json","jsonBody":"={\n    \"order_id\": \"{{ $('check_found_order').item.json[\"order_id\"] }}\",\n    \"moneyReceive\": {{ $('check_found_order').item.json[\"moneyReceive\"] }},\n    \"moneyPayment\": {{ $('check_found_order').item.json[\"moneyPayment\"] }},\n    \"moneyRest\": {{ $('check_found_order').item.json[\"moneyRest\"] }},\n    \"moneyTotal\": {{ $('check_found_order').item.json[\"moneyTotal\"] }},\n    \"price\": {{ $('check_found_order').item.json[\"price\"] }},\n    \"amount\": {{ $('check_found_order').item.json[\"amount\"] }},\n    \"total\": {{ $('check_found_order').item.json[\"total\"] }},\n    \"email\": \"{{ $('check_found_order').item.json[\"email\"] }}\",\n    \"name\": \"{{ $('check_found_order').item.json[\"name\"] }}\",\n    \"phone\": \"{{ $('check_found_order').item.json[\"phone\"] }}\",\n    \"address\": \"{{ $('check_found_order').item.json[\"address\"] }}\",\n    \"size\": \"{{ $('check_found_order').item.json[\"size\"] }}\",\n    \"style\": \"{{ $('check_found_order').item.json[\"style\"] }}\",\n    \"status\": \"{{ $('check_found_order').item.json[\"statusPayment\"] }}\"\n}","options":{}},"id":"5dfc8d66-3614-4c39-b12a-e3d6ee612de5","name":"send_email_thanh_toan_full","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[2980,-540]},{"parameters":{"jsCode":"const data = $('Webhook').first().json.body\nlet order_id\nlet is_true_tx = false\nlet regex = /DCGR\\d{5}/\nlet match = data.description.match(regex)\n\nconst bankAccount = '6681888888'\nconst isBankAccount = data.bank_sub_acc_id == bankAccount ? true: false\nif (match && isBankAccount) {\n  is_true_tx = true\n  order_id = match[0]\n}\n\nlet total_receive = data.amount\nreturn {\n  is_true_tx,\n  order_id,\n  total_receive\n}"},"id":"d371d9d2-682e-470c-8a20-670305112629","name":"get_order_id_from_tx","type":"n8n-nodes-base.code","typeVersion":1,"position":[920,340]},{"parameters":{"conditions":{"boolean":[{"value1":"={{ $json.is_true_tx }}","value2":"={{ true }}"}]}},"id":"04de5d40-6e88-4be5-9fb2-1feb14cdcf2f","name":"check_is_true_tx","type":"n8n-nodes-base.if","typeVersion":1,"position":[1140,340]},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/auth/v3/tenant_access_token/internal/","sendBody":true,"bodyParameters":{"parameters":[{"name":"app_id","value":"cli_a4054c355978d009"},{"name":"app_secret","value":"gIBdgOBBQVCQeRpQw1y7Zencd2sOqigf"}]},"options":{}},"id":"9d16e868-e764-4cd7-9a7c-70edc2cff299","name":"get_access_token","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[1420,320]},{"parameters":{"url":"={{ $('config_url_get_list').first().json.url }}","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $('get_access_token').item.json.tenant_access_token }}"}]},"options":{}},"id":"58f2cbf3-55e2-4498-ba73-7d2fb6b10ba4","name":"get_list_record","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[1920,320]},{"parameters":{"conditions":{"boolean":[{"value1":"={{ $('get_list_record').item.json.data.has_more }}","value2":true}]}},"id":"4155531d-0429-41fe-8fa0-56250d6a1897","name":"if_has_more_list","type":"n8n-nodes-base.if","typeVersion":1,"position":[2880,400]},{"parameters":{"jsCode":"const dataFromBase = $('get_list_record').first().json.data\nconst tx = $('get_order_id_from_tx').first().json\n\n// l·∫•y order object b·∫±ng order_id\nconst order = dataFromBase.items.find(forItem => forItem.fields.order_id === tx.order_id)\n\nlet isValidRecordId = !!order\n\n// n·∫øu kh√¥ng c√≥ order th√¨ return false\nif (!order) return {isValidRecordId}\n\n// l·∫•y order_id t·ª´ order object\nlet order_id = order?.fields.order_id\n\n// l·∫•y record_id b·∫£ng ghi t·ª´ order object\nlet record_id = order?.record_id\n\n// l·∫•y email kh√°ch h√†ng\nlet email = order?.fields.email\n\n// l·∫•y t·ªïng gi√° tr·ªã ƒë∆°n h√†ng\nlet moneyTotal = order?.fields.total\n\n// l·∫•y s·ªë ti·ªÅn kh√°ch h√†ng ƒë√£ thanh to√°n\nlet rest = order?.fields.rest\n\n// l·∫•y s·ªë ti·ªÅn c√≤n l·∫°i c·∫ßn thanh to√°n\n// let rest = order?.fields.rest\n\n// l·∫•y s·ªë ti·ªÅn v·ª´a nh·∫≠n ƒë∆∞·ª£c\nlet moneyReceive = tx.total_receive\n\n// t√≠nh s·ªë ti·ªÅn c√≤n l·∫°i c·∫ßn thanh to√°n l·∫ßn n√†y: (s·ªë ti·ªÅn c√≤n l·∫°i c·∫ßn thanh to√°n) - (s·ªë ti·ªÅn nh·∫≠n ƒë∆∞·ª£c)\nlet moneyRest = rest - moneyReceive\n\n// t√≠nh s·ªë ti·ªÅn ƒë√£ thanh to√°n\nlet moneyPayment = moneyTotal - moneyRest\n\n// l·∫•y price t·ª´ order object\nlet price = order?.fields.price[0]\n\n// l·∫•y amount t·ª´ order object\nlet amount = order?.fields.amount\n\n// l·∫•y total t·ª´ order object\nlet total = order?.fields.total\n\n// l·∫•y name t·ª´ order object\nlet name = order?.fields.name\n\n// l·∫•y phone t·ª´ order object\nlet phone = order?.fields.phone\n\n// l·∫•y address t·ª´ order object\nlet address = order?.fields.address\n\n// l·∫•y size t·ª´ order object\nlet size = order?.fields.size\n\n// l·∫•y style t·ª´ order object\nlet style = order?.fields.style\n\n// t√¨nh tr·∫°ng thanh to√°n\nlet statusPayment = ''\nif (moneyRest === 0) {\n  statusPayment = 'completed'\n} else if (moneyRest < 0) {\n  statusPayment = 'overpayment'\n} else {\n  statusPayment = 'on-hold'\n}\n\nreturn {\n  isValidRecordId,\n  record_id,\n  order_id,\n  moneyReceive,\n  moneyPayment,\n  moneyRest,\n  moneyTotal,\n  price,\n  amount,\n  total,\n  email,\n  name,\n  phone,\n  address,\n  size,\n  style,\n  statusPayment,\n  order_data: order?.fields\n}"},"id":"c5bf3005-9a55-44ca-acae-3101bc4fea64","name":"handle_record_id","type":"n8n-nodes-base.code","typeVersion":1,"position":[2180,320]},{"parameters":{"jsCode":"if (items[0].json?.pageToken){\n  return {\n    url: `https://open.larksuite.com/open-apis/bitable/v1/apps/JxmFbMji9a8sGHs8KrfuAkkfsgf/tables/tblNSWaikG3Anktj/records?page_size=10&page_token=${items[0].json?.pageToken}&sort=%5B%22created_at+DESC%22%5D`\n  }\n}\n\nreturn {\n  url: 'https://open.larksuite.com/open-apis/bitable/v1/apps/JxmFbMji9a8sGHs8KrfuAkkfsgf/tables/tblNSWaikG3Anktj/records?page_size=5&sort=%5B%22created_at+DESC%22%5D'\n}"},"id":"60dd73be-9f1b-4703-b2bc-57a0141e94be","name":"config_url_get_list","type":"n8n-nodes-base.code","typeVersion":1,"position":[1660,320]},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/bot/v2/hook/d6f7a37d-123f-4e99-bba6-04ab8110e166","sendBody":true,"specifyBody":"json","jsonBody":"={{ JSON.stringify($('prepare_json_bot').first().json)}}","options":{}},"id":"c245e58d-2b2c-4b6c-a408-626a7c3b61ab","name":"send_message_to_lark_group","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[3220,200]},{"parameters":{"jsCode":"const data = $(\"check_found_order\").first().json;\nconst orders = [data.order_data];\nconsole.log(orders);\n\nlet elements = [];\n\n// Add products\norders.forEach((order) => {\n    elements.push({\n        tag: \"div\",\n        fields: [\n            {\n                is_short: true,\n                text: {\n                    tag: \"lark_md\",\n                    content: `**M·∫´u √°o:** ${order.style}`,\n                },\n            },\n            {\n                is_short: true,\n                text: {\n                    tag: \"lark_md\",\n                    content: `**Size √°o:** ${order.size}`,\n                },\n            },\n            {\n                is_short: true,\n                text: {\n                    tag: \"lark_md\",\n                    content: `**S·ªë l∆∞·ª£ng:** ${order.amount}`,\n                },\n            },\n            {\n                is_short: true,\n                text: {\n                    tag: \"lark_md\",\n                    content: `**ƒê∆°n gi√°:** ${\n                        order.price[0].toLocaleString(\"en-US\") + \" VND\"\n                    }`,\n                },\n            },\n            {\n                is_short: false,\n                text: {\n                    tag: \"lark_md\",\n                    content: `**Gi√° tr·ªã ƒë∆°n h√†ng:** ${\n                        order.total.toLocaleString(\"en-US\") + \" VND\"\n                    }`,\n                },\n            },\n        ],\n    });\n    elements.push({\n        tag: \"hr\",\n    });\n});\n\n// Add Order Info\nelements.push({\n    tag: \"div\",\n    fields: [\n        {\n            is_short: true,\n            text: {\n                tag: \"lark_md\",\n                content: `**M√£ ƒë∆°n h√†ng:** ${data.order_id}`,\n            },\n        },\n        {\n            is_short: true,\n            text: {\n                tag: \"lark_md\",\n                content: `**Tr·∫°ng th√°i thanh to√°n:** ${data.statusPayment}`,\n            },\n        },\n        {\n            is_short: true,\n            text: {\n                tag: \"lark_md\",\n                content: `**T·ªïng ti·ªÅn ƒë√£ thanh to√°n:** ${\n                    data.moneyPayment.toLocaleString(\"en-US\") + \" VND\"\n                }`,\n            },\n        },\n        {\n            is_short: true,\n            text: {\n                tag: \"lark_md\",\n                content: `**T·ªïng ti·ªÅn c√≤n l·∫°i:** ${\n                    data.moneyRest.toLocaleString(\"en-US\") + \" VND\"\n                }`,\n            },\n        },\n    ],\n});\nelements.push({\n    tag: \"hr\",\n});\n\n// Add customer info\nelements.push({\n    tag: \"div\",\n    fields: [\n        {\n            is_short: true,\n            text: {\n                tag: \"lark_md\",\n                content: `**H·ªç v√† t√™n:** ${data.order_data.name}`,\n            },\n        },\n        {\n            is_short: true,\n            text: {\n                tag: \"lark_md\",\n                content: `**S·ªë ƒëi·ªán tho·∫°i:** ${data.order_data.phone}`,\n            },\n        },\n        {\n            is_short: false,\n            text: {\n                tag: \"lark_md\",\n                content: `**Email:** ${data.order_data.email}`,\n            },\n        },\n        {\n            is_short: false,\n            text: {\n                tag: \"lark_md\",\n                content: `**ƒê·ªãa ch·ªâ:** ${data.order_data.address}`,\n            },\n        },\n    ],\n});\n\nlet result = {\n    msg_type: \"interactive\",\n    card: {\n        config: {\n            wide_screen_mode: true,\n        },\n        header: {\n            template: \"blue\",\n            title: {\n                content: `üõí  M·ªòT C·∫¨P NH·∫¨T T·ª™ PRE-ORDER √ÅO DCGR - ${data.order_id}`,\n                tag: \"plain_text\",\n            },\n        },\n        elements,\n    },\n};\n\nreturn { json: result };\n"},"id":"d7a6a63c-a195-43a0-8fd6-36e8661deae3","name":"prepare_json_bot","type":"n8n-nodes-base.code","typeVersion":1,"position":[3020,200]},{"parameters":{"values":{"string":[{"name":"pageToken","value":"={{ $('get_list_record').item.json.data.page_token }}"}]},"options":{}},"id":"dbd357d0-e3c4-4ca0-b90d-f50c62450ba8","name":"set_page_token","type":"n8n-nodes-base.set","typeVersion":2,"position":[3120,380]},{"parameters":{"method":"PUT","url":"=https://open.larksuite.com/open-apis/bitable/v1/apps/JxmFbMji9a8sGHs8KrfuAkkfsgf/tables/tblNSWaikG3Anktj/records/{{ $('check_found_order').item.json.record_id }}","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $('get_access_token').item.json.tenant_access_token }}"}]},"sendBody":true,"contentType":"raw","rawContentType":"application/json","body":"={{JSON.stringify( $('prepare_base').item.json )}}","options":{}},"id":"648e644d-5283-4cd8-a99a-7b1d98deba76","name":"change_status_in_base","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[2960,-20]},{"parameters":{"jsCode":"const data = $('check_found_order').first().json\nreturn {\n  fields: {\n    status_payment: data.statusPayment,\n    payment: data.moneyPayment\n  }\n}"},"id":"dc984775-5af6-4f57-ac01-f312e3c34aca","name":"prepare_base","type":"n8n-nodes-base.code","typeVersion":1,"position":[2720,-20]},{"parameters":{"method":"POST","url":"https://app.n8n.vn/webhook/dcgr/preorder2023/email-thanh-toan-mot-phan","sendBody":true,"specifyBody":"json","jsonBody":"={\n    \"order_id\": \"{{ $('check_found_order').item.json[\"order_id\"] }}\",\n    \"moneyReceive\": {{ $('check_found_order').item.json[\"moneyReceive\"] }},\n    \"moneyPayment\": {{ $('check_found_order').item.json[\"moneyPayment\"] }},\n    \"moneyRest\": {{ $('check_found_order').item.json[\"moneyRest\"] }},\n    \"moneyTotal\": {{ $('check_found_order').item.json[\"moneyTotal\"] }},\n    \"price\": {{ $('check_found_order').item.json[\"price\"] }},\n    \"amount\": {{ $('check_found_order').item.json[\"amount\"] }},\n    \"email\": \"{{ $('check_found_order').item.json[\"email\"] }}\",\n    \"name\": \"{{ $('check_found_order').item.json[\"name\"] }}\",\n    \"phone\": \"{{ $('check_found_order').item.json[\"phone\"] }}\",\n    \"address\": \"{{ $('check_found_order').item.json[\"address\"] }}\",\n    \"size\": \"{{ $('check_found_order').item.json[\"size\"] }}\",\n    \"style\": \"{{ $('check_found_order').item.json[\"style\"] }}\",\n    \"status\": \"{{ $('check_found_order').item.json[\"statusPayment\"] }}\"\n}","options":{}},"id":"a60bd823-0de7-4241-98d7-8edee37f8916","name":"send_email_thanh_toan_1_phan","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[2980,-320]}],"connections":{"Webhook":{"main":[[{"node":"get_order_id_from_tx","type":"main","index":0}]]},"check_found_order":{"main":[[{"node":"check-full-payment","type":"main","index":0},{"node":"prepare_json_bot","type":"main","index":0},{"node":"prepare_base","type":"main","index":0}],[{"node":"if_has_more_list","type":"main","index":0}]]},"check-full-payment":{"main":[[{"node":"send_email_thanh_toan_full","type":"main","index":0}],[{"node":"send_email_thanh_toan_1_phan","type":"main","index":0}]]},"get_order_id_from_tx":{"main":[[{"node":"check_is_true_tx","type":"main","index":0}]]},"check_is_true_tx":{"main":[[{"node":"get_access_token","type":"main","index":0}]]},"get_access_token":{"main":[[{"node":"config_url_get_list","type":"main","index":0}]]},"get_list_record":{"main":[[{"node":"handle_record_id","type":"main","index":0}]]},"if_has_more_list":{"main":[[{"node":"set_page_token","type":"main","index":0}]]},"handle_record_id":{"main":[[{"node":"check_found_order","type":"main","index":0}]]},"config_url_get_list":{"main":[[{"node":"get_list_record","type":"main","index":0}]]},"prepare_json_bot":{"main":[[{"node":"send_message_to_lark_group","type":"main","index":0}]]},"set_page_token":{"main":[[{"node":"config_url_get_list","type":"main","index":0}]]},"prepare_base":{"main":[[{"node":"change_status_in_base","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{"Webhook":[{"json":{"headers":{"host":"app.n8n.vn","user-agent":"axios/0.21.4","content-length":"168","accept":"application/json,text/html,application/xhtml+xml,application/xml,text/*;q=0.9, image/*;q=0.8, */*;q=0.7","content-type":"application/json","x-forwarded-for":"172.23.0.1","x-forwarded-host":"app.n8n.vn","x-forwarded-port":"443","x-forwarded-proto":"https","x-forwarded-server":"f2605f992776","x-real-ip":"172.23.0.1","accept-encoding":"gzip"},"params":{},"query":{},"body":{"bankName":"vietcombank","bank_sub_acc_id":"6681888888","amount":10000,"cusum_balance":23191071,"description":"836878.200723.124651.test","when":"12:46:52, 20/7/2023"}},"pairedItem":{"item":0}}]},"versionId":"09b70562-9dcf-496f-a5c1-d91ca96137a5","triggerCount":1,"tags":[{"createdAt":"2023-07-14T18:38:08.838Z","updatedAt":"2023-07-14T18:38:08.838Z","id":"26","name":"dcgr"}]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-06-19T06:21:37.610Z","updatedAt":"2023-06-24T19:36:36.000Z","id":"135","name":"[DC Media] Sync 1 minutes bank","active":false,"nodes":[{"parameters":{"rule":{"interval":[{"field":"minutes","minutesInterval":1}]}},"id":"43126594-a58f-45da-ac9d-ae61cd9ea194","name":"Schedule Trigger","type":"n8n-nodes-base.scheduleTrigger","typeVersion":1,"position":[900,520]},{"parameters":{"method":"POST","url":"https://oauth.casso.vn/v2/sync","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"Apikey AK_CS.c2c126d00e6811eea22691cc9656b394.fQ8T9I3mYfeinMllb7WBEmrF9W7tH8axGsDKj5h60Y8IisE9KxxnSXAm1HgvPVK4bEPXOl1e"}]},"sendBody":true,"bodyParameters":{"parameters":[{"name":"bank_acc_id","value":"6681888888"}]},"options":{}},"id":"384a137c-b095-4b63-87d6-b96375dd9d1f","name":"HTTP Request","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[1120,520]}],"connections":{"Schedule Trigger":{"main":[[{"node":"HTTP Request","type":"main","index":0}]]}},"settings":{},"staticData":{"node:Schedule Trigger":{"recurrencyRules":[]}},"pinData":{},"versionId":"342faff5-a23f-4786-9baf-4882e979fd26","triggerCount":1,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-06-19T06:55:36.939Z","updatedAt":"2023-06-19T07:21:55.000Z","id":"136","name":"Set up Lark auth","active":false,"nodes":[{"parameters":{"method":"POST","url":"=https://open.larksuite.com/open-apis/auth/v3/tenant_access_token/internal/","sendBody":true,"specifyBody":"json","jsonBody":"={ \"app_id\" : \"{{ $('Set Lark auth data').item.json[\"appId\"] }}\", \"app_secret\" : \"{{ $('Set Lark auth data').item.json[\"appSecret\"] }}\" }","options":{}},"id":"3751f13d-eb83-49db-8a8f-1b3ba1dd15c1","name":"Get Lark tenant access token","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[1140,440]},{"parameters":{},"id":"a3cfaec1-e54e-496e-8db5-dbc04041b438","name":"When clicking \"Execute Workflow\"","type":"n8n-nodes-base.manualTrigger","typeVersion":1,"position":[760,440]},{"parameters":{"values":{"string":[{"name":"appId","value":"cli_a36a65082eb85009"},{"name":"appSecret","value":"n6EEtyICEiK2IoQGXLAFtedQTGY0Z5Sk"}]},"options":{}},"id":"60e3b0cc-d38a-4f38-a043-47caccae88d7","name":"Set Lark auth data","type":"n8n-nodes-base.set","typeVersion":1,"position":[960,440]}],"connections":{"When clicking \"Execute Workflow\"":{"main":[[{"node":"Set Lark auth data","type":"main","index":0}]]},"Set Lark auth data":{"main":[[{"node":"Get Lark tenant access token","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{"Set Lark auth data":[{"json":{"appId":"cli_a36a65082eb85009","appSecret":"n6EEtyICEiK2IoQGXLAFtedQTGY0Z5Sk"},"pairedItem":{"item":0}}]},"versionId":"3a2d0113-33cd-4442-a264-208e463ab2dd","triggerCount":0,"tags":[{"createdAt":"2023-04-13T09:24:58.649Z","updatedAt":"2023-06-13T07:54:39.069Z","id":"14","name":"Template"}]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-06-19T07:30:05.373Z","updatedAt":"2023-06-20T08:05:40.000Z","id":"137","name":"[DC Media] Thanh to√°n 1 ph·∫ßn c≈©","active":false,"nodes":[{"parameters":{"httpMethod":"POST","path":"dcmedia-thanh-toan-mot-phan","options":{}},"id":"b5885812-92c7-46c7-9d50-72e5b03b988f","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[620,600],"webhookId":"07fbde78-9d49-49f4-a7e7-4cb0701bef25"},{"parameters":{"fromEmail":"DC Media <no-reply@dcmedia.vn>","toEmail":"={{ $('Webhook').item.json.body.email }}","subject":"[DC Media] X√°c nh·∫≠n Thanh to√°n Pre-order √Åo DCME","emailFormat":"html","html":"=X√°c nh·∫≠n thanh to√°n pre-order √°o #{{ $('Webhook').item.json[\"body\"][\"order_id\"] }}:<br/>\nCh√∫ng t√¥i ƒë√£ nh·∫≠n ƒë∆∞·ª£c m·ªôt kho·∫£n thanh to√°n: {{ $('Code').item.json[\"moneyReceive\"] }}<br/>\nT·ªïng gi√° tr·ªã ƒë∆°n h√†ng: {{$('Code').item.json[\"moneyTotal\"] }}<br/>\nQu√Ω kh√°ch vui l√≤ng thanh to√°n th√™m: {{ $('Code').item.json[\"moneyRest\"] }}<br/>\n<br/>\nVui l√≤ng chuy·ªÉn kho·∫£n theo th√¥ng tin d∆∞·ªõi ƒë√¢y:<br/>\nNg√¢n h√†ng: Vietcombank<br/>\nS·ªë t√†i kho·∫£n: 6681888888<br/>\nT√™n t√†i kho·∫£n: L√™ Qu·ªëc Kh√¥i<br/>\nN·ªôi dung: {{ $('Webhook').item.json[\"body\"][\"order_id\"] }}<br/>\nQR Code:<br/>\n<img src=\"https://img.vietqr.io/image/VCB-6681888888-compact.png?amount={{ $('Webhook').item.json[\"body\"][\"moneyRest\"] }}&addInfo={{ $('Webhook').item.json[\"body\"][\"order_id\"] }}&accountName=Le%20Quoc%20Khoi\"/>","options":{}},"id":"8d005599-7aeb-448b-8039-1d6695b5ca2b","name":"Send Email1","type":"n8n-nodes-base.emailSend","typeVersion":2,"position":[1040,600],"credentials":{"smtp":{"id":"62","name":"SMTP no-reply@dcmedia.vn"}}},{"parameters":{"jsCode":"const data = $('Webhook').first().json.body\nlet moneyReceive = data.moneyReceive.toLocaleString(\"en-US\") + \" VND\"\nlet moneyTotal = data.moneyTotal.toLocaleString(\"en-US\") + \" VND\"\nlet moneyRest = data.moneyRest.toLocaleString(\"en-US\") + \" VND\"\nreturn {\n  moneyReceive,\n  moneyTotal,\n  moneyRest\n}"},"id":"0f5cd8e7-41f1-4d43-9612-d0569a14074a","name":"Code","type":"n8n-nodes-base.code","typeVersion":1,"position":[840,600]}],"connections":{"Webhook":{"main":[[{"node":"Code","type":"main","index":0}]]},"Code":{"main":[[{"node":"Send Email1","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{"Webhook":[{"json":{"headers":{"host":"app.n8n.vn","user-agent":"axios/0.21.4","content-length":"185","accept":"application/json,text/html,application/xhtml+xml,application/xml,text/*;q=0.9, image/*;q=0.8, */*;q=0.7","content-type":"application/json","x-forwarded-for":"172.23.0.1","x-forwarded-host":"app.n8n.vn","x-forwarded-port":"443","x-forwarded-proto":"https","x-forwarded-server":"ba8c3a24b3d5","x-real-ip":"172.23.0.1","accept-encoding":"gzip"},"params":{},"query":{},"body":{"record_id":"recxjOG5HM","order_id":"DCME00014","moneyReceive":500,"moneyTotal":500000,"moneyRest":499500,"statusPayment":"ƒê√£ thanh to√°n m·ªôt ph·∫ßn","email":"lekhoi456@gmail.com"}},"pairedItem":{"item":0}}],"Code":[{"json":{"moneyReceive":"500 VND","moneyTotal":"500,000 VND","moneyRest":"499,500 VND"},"pairedItem":{"item":0}}]},"versionId":"b1efe15e-6d5a-4a38-a63b-3ac378162e40","triggerCount":1,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-06-19T08:05:38.291Z","updatedAt":"2023-07-20T14:53:58.000Z","id":"138","name":"[Preorder √°o] Send email thanh to√°n full","active":true,"nodes":[{"parameters":{"httpMethod":"POST","path":"/dcgr/preorder2023/email-thanh-toan-full","options":{}},"id":"8c94d735-92f5-47c5-8f0a-8c7d1575bd4f","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[620,600],"webhookId":"de1169eb-5b69-4ade-a16a-2d7c047b813c"},{"parameters":{"jsCode":"const data = $('Webhook').first().json.body\nlet moneyReceive = data.moneyReceive.toLocaleString(\"en-US\") + \" VND\"\nlet moneyPayment = data.moneyPayment.toLocaleString(\"en-US\") + \" VND\"\nlet moneyTotal = data.moneyTotal.toLocaleString(\"en-US\") + \" VND\"\nlet moneyRest = data.moneyRest.toLocaleString(\"en-US\") + \" VND\"\nlet status = data.status == \"completed\" ? \"ƒê√£ thanh to√°n ƒë·ªß\": \"ƒê√£ thanh to√°n m·ªôt ph·∫ßn\"\nif (data.style === 'M·∫´u 1') {\n  url_img = 'https://s3.kdigi.app/dcgr/mau-1.jpg'\n} else if (data.style === 'M·∫´u 2') {\n  url_img = 'https://s3.kdigi.app/dcgr/mau-2.jpg'\n} else {\n  url_img = 'https://s3.kdigi.app/dcgr/mau-3.jpg'\n}\nreturn {\n  moneyReceive,\n  moneyPayment,\n  moneyTotal,\n  moneyRest,\n  status,\n  url_img\n}"},"id":"1efbb075-91db-475c-be68-7daa42a25633","name":"Code","type":"n8n-nodes-base.code","typeVersion":1,"position":[840,600]},{"parameters":{"fromEmail":"DC Media <no-reply@dcmedia.vn>","toEmail":"={{ $('Webhook').item.json.body.email }}","subject":"=[DC Media] X√°c nh·∫≠n ƒê∆°n h√†ng #{{ $('Webhook').item.json.body.order_id }}","emailFormat":"html","html":"=\n    <!doctype html>\n    <html xmlns=\"http://www.w3.org/1999/xhtml\" xmlns:v=\"urn:schemas-microsoft-com:vml\" xmlns:o=\"urn:schemas-microsoft-com:office:office\">\n      <head>\n        <title>\n          \n        </title>\n        <!--[if !mso]><!-->\n        <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\n        <!--<![endif]-->\n        <meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\">\n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\n        <style type=\"text/css\">\n          #outlook a { padding:0; }\n          body { margin:0;padding:0;-webkit-text-size-adjust:100%;-ms-text-size-adjust:100%; }\n          table, td { border-collapse:collapse;mso-table-lspace:0pt;mso-table-rspace:0pt; }\n          img { border:0;height:auto;line-height:100%; outline:none;text-decoration:none;-ms-interpolation-mode:bicubic; }\n          p { display:block;margin:13px 0; }\n        </style>\n        <!--[if mso]>\n        <noscript>\n        <xml>\n        <o:OfficeDocumentSettings>\n          <o:AllowPNG/>\n          <o:PixelsPerInch>96</o:PixelsPerInch>\n        </o:OfficeDocumentSettings>\n        </xml>\n        </noscript>\n        <![endif]-->\n        <!--[if lte mso 11]>\n        <style type=\"text/css\">\n          .mj-outlook-group-fix { width:100% !important; }\n        </style>\n        <![endif]-->\n        \n      <!--[if !mso]><!-->\n        <link href=\"https://fonts.googleapis.com/css?family=Roboto:300,400,500,700\" rel=\"stylesheet\" type=\"text/css\">\n        <style type=\"text/css\">\n          @import url(https://fonts.googleapis.com/css?family=Roboto:300,400,500,700);\n        </style>\n      <!--<![endif]-->\n\n    \n        \n    <style type=\"text/css\">\n      @media only screen and (min-width:480px) {\n        .mj-column-px-250 { width:250px !important; max-width: 250px; }\n.mj-column-per-100 { width:100% !important; max-width: 100%; }\n.mj-column-per-50 { width:50% !important; max-width: 50%; }\n      }\n    </style>\n    <style media=\"screen and (min-width:480px)\">\n      .moz-text-html .mj-column-px-250 { width:250px !important; max-width: 250px; }\n.moz-text-html .mj-column-per-100 { width:100% !important; max-width: 100%; }\n.moz-text-html .mj-column-per-50 { width:50% !important; max-width: 50%; }\n    </style>\n  \n        <style type=\"text/css\">\n        \n        \n\n    @media only screen and (max-width:480px) {\n      table.mj-full-width-mobile { width: 100% !important; }\n      td.mj-full-width-mobile { width: auto !important; }\n    }\n  \n        </style>\n        \n        \n      </head>\n      <body style=\"word-spacing:normal;\">\n        \n        \n      <div\n         style=\"\"\n      >\n        \n      \n      <!--[if mso | IE]><table align=\"center\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" class=\"\" style=\"width:600px;\" width=\"600\" ><tr><td style=\"line-height:0px;font-size:0px;mso-line-height-rule:exactly;\"><v:rect style=\"width:600px;\" xmlns:v=\"urn:schemas-microsoft-com:vml\" fill=\"true\" stroke=\"false\"><v:fill origin=\"0.5, 0\" position=\"0.5, 0\" src=\"https://s3.kdigi.app/dcgr/dc-abstract.jpeg\" type=\"tile\" /><v:textbox style=\"mso-fit-shape-to-text:true\" inset=\"0,0,0,0\"><![endif]-->\n          \n      <div  style=\"background:url(https://s3.kdigi.app/dcgr/dc-abstract.jpeg) center top / auto repeat;background-position:center top;background-repeat:repeat;background-size:auto;margin:0px auto;max-width:600px;\">\n        <div  style=\"line-height:0;font-size:0;\">\n        <table\n           align=\"center\" background=\"https://s3.kdigi.app/dcgr/dc-abstract.jpeg\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\" style=\"background:url(https://s3.kdigi.app/dcgr/dc-abstract.jpeg) center top / auto repeat;background-position:center top;background-repeat:repeat;background-size:auto;width:100%;\"\n        >\n          <tbody>\n            <tr>\n              <td\n                 style=\"direction:ltr;font-size:0px;padding:20px;text-align:center;\"\n              >\n                <!--[if mso | IE]><table role=\"presentation\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"><tr><td class=\"\" style=\"vertical-align:top;width:250px;\" ><![endif]-->\n            \n      <div\n         class=\"mj-column-px-250 mj-outlook-group-fix\" style=\"font-size:0px;text-align:left;direction:ltr;display:inline-block;vertical-align:top;width:100%;\"\n      >\n        \n      <table\n         border=\"0\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\" style=\"vertical-align:top;\" width=\"100%\"\n      >\n        <tbody>\n          \n              <tr>\n                <td\n                   align=\"center\" style=\"font-size:0px;padding:10px 25px;word-break:break-word;\"\n                >\n                  \n      <table\n         border=\"0\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\" style=\"border-collapse:collapse;border-spacing:0px;\"\n      >\n        <tbody>\n          <tr>\n            <td  style=\"width:200px;\">\n              \n      <img\n         height=\"auto\" src=\"https://s3.kdigi.app/dcgr/logo-dc-media.png\" style=\"border:0;display:block;outline:none;text-decoration:none;height:auto;width:100%;font-size:13px;\" width=\"200\"\n      />\n    \n            </td>\n          </tr>\n        </tbody>\n      </table>\n    \n                </td>\n              </tr>\n            \n        </tbody>\n      </table>\n    \n      </div>\n    \n          <!--[if mso | IE]></td></tr></table><![endif]-->\n              </td>\n            </tr>\n          </tbody>\n        </table>\n        </div>\n      </div>\n    \n        <!--[if mso | IE]></v:textbox></v:rect></td></tr></table><table align=\"center\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" class=\"\" style=\"width:600px;\" width=\"600\" ><tr><td style=\"line-height:0px;font-size:0px;mso-line-height-rule:exactly;\"><![endif]-->\n    \n      \n      <div  style=\"margin:0px auto;max-width:600px;\">\n        \n        <table\n           align=\"center\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\" style=\"width:100%;\"\n        >\n          <tbody>\n            <tr>\n              <td\n                 style=\"direction:ltr;font-size:0px;padding:0px 0px;text-align:center;\"\n              >\n                <!--[if mso | IE]><table role=\"presentation\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"><tr><td class=\"\" style=\"vertical-align:top;width:600px;\" ><![endif]-->\n            \n      <div\n         class=\"mj-column-per-100 mj-outlook-group-fix\" style=\"font-size:0px;text-align:left;direction:ltr;display:inline-block;vertical-align:top;width:100%;\"\n      >\n        \n      <table\n         border=\"0\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\" style=\"vertical-align:top;\" width=\"100%\"\n      >\n        <tbody>\n          \n              <tr>\n                <td\n                   align=\"center\" style=\"font-size:0px;padding:0px 25px;word-break:break-word;\"\n                >\n                  \n      <div\n         style=\"font-family:Roboto, Helvetica Neue, Helvetica, Arial, sans-serif;font-size:13px;line-height:1;text-align:center;color:#000000;\"\n      ><h1>X√°c nh·∫≠n thanh to√°n ƒë∆°n h√†ng</h1></div>\n    \n                </td>\n              </tr>\n            \n              <tr>\n                <td\n                   align=\"left\" style=\"font-size:0px;padding:0px 25px;word-break:break-word;\"\n                >\n                  \n      <div\n         style=\"font-family:Roboto, Helvetica Neue, Helvetica, Arial, sans-serif;font-size:13px;line-height:1;text-align:left;color:#000000;\"\n      ><div><font face=\"Roboto\" size=\"3\"><span>Xin ch√†o {{ $('Webhook').item.json[\"body\"][\"name\"] }}, ch√∫ng t√¥i</span><span style=\"background-color: transparent;\">&nbsp;v·ª´a nh·∫≠n ƒë∆∞·ª£c m·ªôt kho·∫£n thanh to√°n cho ƒë∆°n h√†ng #{{ $('Webhook').item.json[\"body\"][\"order_id\"] }} c·ªßa b·∫°n.</span></font></div></div>\n    \n                </td>\n              </tr>\n            \n        </tbody>\n      </table>\n    \n      </div>\n    \n          <!--[if mso | IE]></td></tr></table><![endif]-->\n              </td>\n            </tr>\n          </tbody>\n        </table>\n        \n      </div>\n    \n      \n      <!--[if mso | IE]></td></tr></table><table align=\"center\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" class=\"\" style=\"width:600px;\" width=\"600\" ><tr><td style=\"line-height:0px;font-size:0px;mso-line-height-rule:exactly;\"><![endif]-->\n    \n      \n      <div  style=\"margin:0px auto;max-width:600px;\">\n        \n        <table\n           align=\"center\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\" style=\"width:100%;\"\n        >\n          <tbody>\n            <tr>\n              <td\n                 style=\"direction:ltr;font-size:0px;padding:10px 150px;text-align:center;\"\n              >\n                <!--[if mso | IE]><table role=\"presentation\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"><tr><td class=\"\" style=\"vertical-align:top;width:300px;\" ><![endif]-->\n            \n      <div\n         class=\"mj-column-per-100 mj-outlook-group-fix\" style=\"font-size:0px;text-align:left;direction:ltr;display:inline-block;vertical-align:top;width:100%;\"\n      >\n        \n      <table\n         border=\"0\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\" style=\"vertical-align:top;\" width=\"100%\"\n      >\n        <tbody>\n          \n              <tr>\n                <td\n                   align=\"left\" style=\"font-size:0px;padding:10px 25px;word-break:break-word;\"\n                >\n                  \n      <div\n         style=\"font-family:Roboto, Helvetica Neue, Helvetica, Arial, sans-serif;font-size:13px;line-height:1;text-align:left;color:#000000;\"\n      ><font size=\"3\"><b>Nh·∫≠n thanh to√°n:</b> {{ $('Code').item.json[\"moneyReceive\"] }}</font><div><font size=\"3\"><b>Gi√° tr·ªã ƒë∆°n h√†ng:</b> {{ $('Code').item.json[\"moneyTotal\"] }}</font></div><div><font size=\"3\"><b>ƒê√£ thanh to√°n:</b> {{ $('Code').item.json[\"moneyPayment\"] }}</font></div><div><font size=\"3\"><b>C√≤n l·∫°i:</b> {{ $('Code').item.json[\"moneyRest\"] }}</font></div><div><font size=\"3\"><b>Tr·∫°ng th√°i:</b> {{ $('Code').item.json[\"status\"] }}</font></div></div>\n    \n                </td>\n              </tr>\n            \n        </tbody>\n      </table>\n    \n      </div>\n    \n          <!--[if mso | IE]></td></tr></table><![endif]-->\n              </td>\n            </tr>\n          </tbody>\n        </table>\n        \n      </div>\n    \n      \n      <!--[if mso | IE]></td></tr></table><table align=\"center\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" class=\"\" style=\"width:600px;\" width=\"600\" ><tr><td style=\"line-height:0px;font-size:0px;mso-line-height-rule:exactly;\"><![endif]-->\n    \n      \n      <div  style=\"margin:0px auto;max-width:600px;\">\n        \n        <table\n           align=\"center\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\" style=\"width:100%;\"\n        >\n          <tbody>\n            <tr>\n              <td\n                 style=\"direction:ltr;font-size:0px;padding:0px;text-align:center;\"\n              >\n                <!--[if mso | IE]><table role=\"presentation\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"><tr><td class=\"\" style=\"vertical-align:top;width:600px;\" ><![endif]-->\n            \n      <div\n         class=\"mj-column-per-100 mj-outlook-group-fix\" style=\"font-size:0px;text-align:left;direction:ltr;display:inline-block;vertical-align:top;width:100%;\"\n      >\n        \n      <table\n         border=\"0\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\" style=\"vertical-align:top;\" width=\"100%\"\n      >\n        <tbody>\n          \n              <tr>\n                <td\n                   align=\"center\" style=\"font-size:0px;padding:10px 25px;word-break:break-word;\"\n                >\n                  \n      <table\n         border=\"0\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\" style=\"border-collapse:collapse;border-spacing:0px;\"\n      >\n        <tbody>\n          <tr>\n            <td  style=\"width:550px;\">\n              \n      <img\n         height=\"auto\" src=\"{{ $('Code').item.json[\"url_img\"] }}\" style=\"border:0;border-radius:8px;display:block;outline:none;text-decoration:none;height:auto;width:100%;font-size:13px;\" width=\"550\"\n      />\n    \n            </td>\n          </tr>\n        </tbody>\n      </table>\n    \n                </td>\n              </tr>\n            \n        </tbody>\n      </table>\n    \n      </div>\n    \n          <!--[if mso | IE]></td></tr></table><![endif]-->\n              </td>\n            </tr>\n          </tbody>\n        </table>\n        \n      </div>\n    \n      \n      <!--[if mso | IE]></td></tr></table><table align=\"center\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" class=\"\" style=\"width:600px;\" width=\"600\" ><tr><td style=\"line-height:0px;font-size:0px;mso-line-height-rule:exactly;\"><![endif]-->\n    \n      \n      <div  style=\"margin:0px auto;max-width:600px;\">\n        \n        <table\n           align=\"center\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\" style=\"width:100%;\"\n        >\n          <tbody>\n            <tr>\n              <td\n                 style=\"direction:ltr;font-size:0px;padding:0px 0px;text-align:center;\"\n              >\n                <!--[if mso | IE]><table role=\"presentation\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"><tr><td class=\"\" style=\"vertical-align:top;width:300px;\" ><![endif]-->\n            \n      <div\n         class=\"mj-column-per-50 mj-outlook-group-fix\" style=\"font-size:0px;text-align:left;direction:ltr;display:inline-block;vertical-align:top;width:100%;\"\n      >\n        \n      <table\n         border=\"0\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\" style=\"vertical-align:top;\" width=\"100%\"\n      >\n        <tbody>\n          \n              <tr>\n                <td\n                   align=\"left\" style=\"font-size:0px;padding:0px 25px;word-break:break-word;\"\n                >\n                  \n      <div\n         style=\"font-family:Roboto, Helvetica Neue, Helvetica, Arial, sans-serif;font-size:13px;line-height:1;text-align:left;color:#000000;\"\n      ><h2>Th√¥ng tin ƒë∆°n h√†ng</h2></div>\n    \n                </td>\n              </tr>\n            \n              <tr>\n                <td\n                   align=\"left\" style=\"font-size:0px;padding:10px 25px;word-break:break-word;\"\n                >\n                  \n      <div\n         style=\"font-family:Roboto, Helvetica Neue, Helvetica, Arial, sans-serif;font-size:13px;line-height:1;text-align:left;color:#000000;\"\n      ><b><font size=\"3\">√Åo DCGR 2023</font></b><div><font size=\"3\"><b>M·∫´u:</b> {{ $('Webhook').item.json[\"body\"][\"style\"] }}</font></div><div><font size=\"3\"><b>K√≠ch c·ª°: </b>Size {{ $('Webhook').item.json[\"body\"][\"size\"] }}</font></div><div><font size=\"3\"><b>Gi√° Pre-order:</b> {{ $('Webhook').item.json[\"body\"][\"price\"] }}</font></div><div><font size=\"3\"><b>S·ªë l∆∞·ª£ng:</b> {{ $('Webhook').item.json[\"body\"][\"amount\"] }}</font></div><div><font size=\"3\"><b>Th√†nh ti·ªÅn:</b> {{ $('Webhook').item.json[\"body\"][\"total\"] }}</font></div></div>\n    \n                </td>\n              </tr>\n            \n        </tbody>\n      </table>\n    \n      </div>\n    \n          <!--[if mso | IE]></td><td class=\"\" style=\"vertical-align:top;width:300px;\" ><![endif]-->\n            \n      <div\n         class=\"mj-column-per-50 mj-outlook-group-fix\" style=\"font-size:0px;text-align:left;direction:ltr;display:inline-block;vertical-align:top;width:100%;\"\n      >\n        \n      <table\n         border=\"0\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\" style=\"vertical-align:top;\" width=\"100%\"\n      >\n        <tbody>\n          \n              <tr>\n                <td\n                   align=\"left\" style=\"font-size:0px;padding:0px 25px;word-break:break-word;\"\n                >\n                  \n      <div\n         style=\"font-family:Roboto, Helvetica Neue, Helvetica, Arial, sans-serif;font-size:13px;line-height:1;text-align:left;color:#000000;\"\n      ><h2 style=\"color: rgb(0, 0, 0); text-transform: none;\">ƒê·ªãa ch·ªâ giao h√†ng</h2></div>\n    \n                </td>\n              </tr>\n            \n              <tr>\n                <td\n                   align=\"left\" style=\"font-size:0px;padding:10px 25px;word-break:break-word;\"\n                >\n                  \n      <div\n         style=\"font-family:Roboto, Helvetica Neue, Helvetica, Arial, sans-serif;font-size:13px;line-height:1;text-align:left;color:#000000;\"\n      ><div><font size=\"3\"><b>T√™n ng∆∞·ªùi nh·∫≠n:</b> {{ $('Webhook').item.json[\"body\"][\"name\"] }}</font></div><div><font size=\"3\"><b>S·ªë ƒëi·ªán tho·∫°i:</b> {{ $('Webhook').item.json[\"body\"][\"phone\"] }}</font></div><div><font size=\"3\"><b>ƒê·ªãa ch·ªâ:</b> {{ $('Webhook').item.json[\"body\"][\"address\"] }}</font></div><div><font size=\"3\"><br></font></div><div><span style=\"background-color: transparent;\"><font size=\"3\">Th·ªùi gian d·ª± ki·∫øn nh·∫≠n h√†ng: t·ª´ 2-4 ng√†y</font></span></div></div>\n    \n                </td>\n              </tr>\n            \n        </tbody>\n      </table>\n    \n      </div>\n    \n          <!--[if mso | IE]></td></tr></table><![endif]-->\n              </td>\n            </tr>\n          </tbody>\n        </table>\n        \n      </div>\n    \n      \n      <!--[if mso | IE]></td></tr></table><table align=\"center\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" class=\"\" style=\"width:600px;\" width=\"600\" ><tr><td style=\"line-height:0px;font-size:0px;mso-line-height-rule:exactly;\"><![endif]-->\n    \n      \n      <div  style=\"margin:0px auto;max-width:600px;\">\n        \n        <table\n           align=\"center\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\" style=\"width:100%;\"\n        >\n          <tbody>\n            <tr>\n              <td\n                 style=\"direction:ltr;font-size:0px;padding:20px 0;text-align:center;\"\n              >\n                <!--[if mso | IE]><table role=\"presentation\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"><tr><td class=\"\" style=\"vertical-align:top;width:600px;\" ><![endif]-->\n            \n      <div\n         class=\"mj-column-per-100 mj-outlook-group-fix\" style=\"font-size:0px;text-align:left;direction:ltr;display:inline-block;vertical-align:top;width:100%;\"\n      >\n        \n      <table\n         border=\"0\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\" style=\"vertical-align:top;\" width=\"100%\"\n      >\n        <tbody>\n          \n              <tr>\n                <td\n                   align=\"left\" style=\"font-size:0px;padding:10px 25px;word-break:break-word;\"\n                >\n                  \n      <div\n         style=\"font-family:Roboto, Helvetica Neue, Helvetica, Arial, sans-serif;font-size:13px;line-height:1;text-align:left;color:#000000;\"\n      ><div><span><b><font size=\"3\">DC MEDIA</font></b></span></div><div><font size=\"3\">H·ªó tr·ª£: 0333111868</font></div></div>\n    \n                </td>\n              </tr>\n            \n              <tr>\n                <td\n                   align=\"center\" style=\"font-size:0px;padding:10px 0px;word-break:break-word;\"\n                >\n                  \n      <p\n         style=\"border-top:solid 4px #2980b9;font-size:1px;margin:0px auto;width:100%;\"\n      >\n      </p>\n      \n      <!--[if mso | IE]><table align=\"center\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" style=\"border-top:solid 4px #2980b9;font-size:1px;margin:0px auto;width:600px;\" role=\"presentation\" width=\"600px\" ><tr><td style=\"height:0;line-height:0;\"> &nbsp;\n</td></tr></table><![endif]-->\n    \n    \n                </td>\n              </tr>\n            \n        </tbody>\n      </table>\n    \n      </div>\n    \n          <!--[if mso | IE]></td></tr></table><![endif]-->\n              </td>\n            </tr>\n          </tbody>\n        </table>\n        \n      </div>\n    \n      \n      <!--[if mso | IE]></td></tr></table><![endif]-->\n    \n    \n      </div>\n    \n      </body>\n    </html>\n  ","options":{}},"id":"13918023-d64b-479c-8318-72f9fce61ccc","name":"Send Email","type":"n8n-nodes-base.emailSend","typeVersion":2,"position":[1040,600],"credentials":{"smtp":{"id":"62","name":"SMTP no-reply@dcmedia.vn"}}}],"connections":{"Webhook":{"main":[[{"node":"Code","type":"main","index":0}]]},"Code":{"main":[[{"node":"Send Email","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{"Webhook":[{"json":{"headers":{"host":"app.n8n.vn","user-agent":"axios/0.21.4","content-length":"395","accept":"application/json,text/html,application/xhtml+xml,application/xml,text/*;q=0.9, image/*;q=0.8, */*;q=0.7","content-type":"application/json","x-forwarded-for":"172.23.0.1","x-forwarded-host":"app.n8n.vn","x-forwarded-port":"443","x-forwarded-proto":"https","x-forwarded-server":"f2605f992776","x-real-ip":"172.23.0.1","accept-encoding":"gzip"},"params":{},"query":{},"body":{"order_id":"DCGR00036","moneyReceive":1490,"moneyPayment":1490,"moneyRest":0,"moneyTotal":1490,"price":1490,"amount":1,"total":1490,"email":"lekhoi456@gmail.com","name":"L√™ Qu·ªëc Ng√¥","phone":"0333111868","address":"C√¥ng Ty ƒê·∫ßu T∆∞ C√¥ng Ngh·ªá KDIGIÔºå69 ƒë∆∞·ªùng 8C2, KDC H∆∞ng Ph√∫ 1, P. H∆∞ng Ph√∫ C√°i RƒÉng Can Tho City, 900000","size":"XL","style":"M·∫´u 3","status":"completed"}},"pairedItem":{"item":0}}]},"versionId":"f6a1cd92-1aa9-4f50-b4d4-6da1a2d16e04","triggerCount":1,"tags":[{"createdAt":"2023-07-14T18:38:08.838Z","updatedAt":"2023-07-14T18:38:08.838Z","id":"26","name":"dcgr"}]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-06-19T09:49:38.453Z","updatedAt":"2023-06-19T10:04:05.000Z","id":"139","name":"[DC Media] Th√¥ng b√°o chuy·ªÉn ti·ªÅn copy","active":false,"nodes":[{"parameters":{"httpMethod":"POST","path":"dcmedia-chuyen-khoan","options":{}},"id":"b22f8bbe-bad8-4e23-a720-f21762771251","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[900,520],"webhookId":"8da527b3-4a03-4961-8c0a-c59684409774"},{"parameters":{"conditions":{"boolean":[{"value1":"={{ $json.isValidRecordId }}","value2":"={{ true }}"}]}},"id":"9c6967db-91e3-47fc-a4b1-3e9542290f9a","name":"check_found_order","type":"n8n-nodes-base.if","typeVersion":1,"position":[2440,320]},{"parameters":{"conditions":{"number":[{"value1":"={{ $json.moneyReceive }}","operation":"largerEqual","value2":"={{ $json.moneyTotal }}"}]}},"id":"c9aaf870-0688-4785-90b3-c73e1f21679c","name":"check-full-payment","type":"n8n-nodes-base.if","typeVersion":1,"position":[2780,-80]},{"parameters":{"method":"POST","url":"https://app.n8n.vn/webhook/dcmedia-thanh-toan-mot-phan","sendBody":true,"specifyBody":"json","jsonBody":"={\n\"record_id\": \"{{ $('handle_record_id').item.json[\"record_id\"] }}\",\n\"order_id\": \"{{ $('handle_record_id').item.json[\"order_id\"] }}\",\n\"moneyReceive\":{{ $('handle_record_id').item.json[\"moneyReceive\"] }},\n\"moneyTotal\": {{ $('handle_record_id').item.json[\"moneyTotal\"] }},\n\"moneyRest\": {{ $('handle_record_id').item.json[\"moneyRest\"] }},\n\"statusPayment\": \"{{ $('handle_record_id').item.json[\"statusPayment\"] }}\",\n\"email\": \"{{ $('handle_record_id').item.json[\"email\"] }}\"\n}","options":{}},"id":"a093989d-1535-497e-91b5-927a838788e2","name":"send_email_thanh_toan_mot_phan","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[3000,-80]},{"parameters":{"method":"POST","url":"https://app.n8n.vn/webhook/dcmedia-thanh-toan-full","sendBody":true,"specifyBody":"json","jsonBody":"={\n\"record_id\": \"{{ $('handle_record_id').item.json[\"record_id\"] }}\",\n\"order_id\": \"{{ $('handle_record_id').item.json[\"order_id\"] }}\",\n\"moneyReceive\":{{ $('handle_record_id').item.json[\"moneyReceive\"] }},\n\"moneyTotal\": {{ $('handle_record_id').item.json[\"moneyTotal\"] }},\n\"moneyRest\": {{ $('handle_record_id').item.json[\"moneyRest\"] }},\n\"statusPayment\": \"{{ $('handle_record_id').item.json[\"statusPayment\"] }}\",\n\"email\": \"{{ $('handle_record_id').item.json[\"email\"] }}\"\n}","options":{}},"id":"5f061597-edaa-4d08-84ce-39b26cc7ce7c","name":"send_email_thanh_toan_full","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[3000,-440]},{"parameters":{"jsCode":"const data = $(\"check_found_order\").first().json;\nconst products = [data.order_data];\n\nlet elements = [];\n\n// Add products\nproducts.forEach((product) => {\n    elements.push({\n        tag: \"div\",\n        fields: [\n            {\n                is_short: false,\n                text: {\n                    tag: \"lark_md\",\n                    content: `**M·∫´u √°o:** ${product['M·∫´u √°o']}`,\n                },\n            },\n            {\n                is_short: true,\n                text: {\n                    tag: \"lark_md\",\n                    content: `**Size √°o:** ${product['Size √°o']}`,\n                },\n            },\n          {\n                is_short: true,\n                text: {\n                    tag: \"lark_md\",\n                    content: `**M√†u:** ${product['M√†u']}`,\n                },\n            },\n          {\n                is_short: true,\n                text: {\n                    tag: \"lark_md\",\n                    content: `**S·ªë l∆∞·ª£ng:** ${product['S·ªë l∆∞·ª£ng']}`,\n                },\n            },\n            {\n                is_short: true,\n                text: {\n                    tag: \"lark_md\",\n                    content: `**ƒê∆°n gi√°:** ${product['ƒê∆°n gi√°'][0].toLocaleString(\"en-US\") + \" VND\"}`,\n                },\n            },\n            {\n                is_short: false,\n                text: {\n                    tag: \"lark_md\",\n                    content: `**T·∫°m t√≠nh:** ${product['Th√†nh ti·ªÅn'].toLocaleString(\"en-US\") + \" VND\"}`,\n                },\n            },\n        ],\n    });\n    elements.push({\n        tag: \"hr\",\n    });\n});\n\n// Add Order Info\nelements.push({\n    tag: \"div\",\n    fields: [\n        {\n            is_short: true,\n            text: {\n                tag: \"lark_md\",\n                content: `**M√£ ƒë∆°n h√†ng:** ${data.order_id}`,\n            },\n        },\n        {\n            is_short: true,\n            text: {\n                tag: \"lark_md\",\n                content: `**Tr·∫°ng th√°i thanh to√°n:** ${data.statusPayment}`,\n            },\n        },\n        {\n            is_short: true,\n            text: {\n                tag: \"lark_md\",\n                content: `**T·ªïng ti·ªÅn ƒë√£ thanh to√°n:** ${data.moneyReceive.toLocaleString(\"en-US\") + \" VND\"}`,\n            },\n        },\n      {\n            is_short: true,\n            text: {\n                tag: \"lark_md\",\n                content: `**T·ªïng ti·ªÅn c√≤n l·∫°i:** ${data.moneyRest.toLocaleString(\"en-US\") + \" VND\"}`,\n            },\n        },\n    ],\n});\nelements.push({\n    tag: \"hr\",\n});\n\n// Add customer info\nelements.push({\n    tag: \"div\",\n    fields: [\n        {\n            is_short: true,\n            text: {\n                tag: \"lark_md\",\n                content: `**H·ªç v√† t√™n:** ${data.order_data['H·ªç v√† T√™n']}`,\n            },\n        },\n        {\n            is_short: true,\n            text: {\n                tag: \"lark_md\",\n                content: `**S·ªë ƒëi·ªán tho·∫°i:** ${data.order_data['S·ªë ƒëi·ªán tho·∫°i']}`,\n            },\n        },\n        {\n            is_short: false,\n            text: {\n                tag: \"lark_md\",\n                content: `**Email:** ${data.order_data['Email']}`,\n            },\n        },\n        {\n            is_short: false,\n            text: {\n                tag: \"lark_md\",\n                content: `**ƒê·ªãa ch·ªâ:** ${data.order_data['ƒê·ªãa ch·ªâ nh·∫≠n h√†ng'].full_address}`,\n            },\n        }\n      \n    ],\n});\n\nlet result = {\n    msg_type: \"interactive\",\n    card: {\n        config: {\n            wide_screen_mode: true,\n        },\n        header: {\n            template: \"blue\",\n            title: {\n                content: `üõí M·ªòT C·∫¨P NH·∫¨T T·ª™ Pre-order √Åo DCME - ${data.order_id}`,\n                tag: \"plain_text\",\n            },\n        },\n        elements,\n    },\n};\n\nreturn { json: result };"},"id":"ae3ae453-414b-4887-bca9-defa2a90743f","name":"Format data","type":"n8n-nodes-base.code","typeVersion":1,"position":[2800,200]},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/bot/v2/hook/d6f7a37d-123f-4e99-bba6-04ab8110e166","sendBody":true,"specifyBody":"json","jsonBody":"={{ JSON.stringify($('Format data').first().json)}}","options":{}},"id":"58e40a47-e26d-4bce-b99d-b4d242be4bc4","name":"Send message to group","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[3000,200]},{"parameters":{"jsCode":"const data = $('Webhook').first().json.body.data[0]\nlet is_true_tx = !!data.description.indexOf('DCME')\nlet indexOfDCME = data.description.indexOf('DCME')\nlet tempText = data.description.slice(indexOfDCME,data.description.length)\nlet order_id = tempText.slice(0, data.description.indexOf(' ')+1 ? data.description.indexOf(' ') : data.description.length)\nlet total_receive = data.amount\nreturn {\n  is_true_tx,\n  order_id,\n  total_receive\n}"},"id":"6aaf7a8e-92df-4148-9ef9-712d7916436d","name":"get_order_id_from_tx","type":"n8n-nodes-base.code","typeVersion":1,"position":[1120,520]},{"parameters":{"conditions":{"boolean":[{"value1":"={{ $json.is_true_tx }}","value2":"={{ true }}"}]}},"id":"39026c9a-22a0-4c9e-aa71-364192d79eb6","name":"check_is_true_tx","type":"n8n-nodes-base.if","typeVersion":1,"position":[1340,520]},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/auth/v3/tenant_access_token/internal/","sendBody":true,"bodyParameters":{"parameters":[{"name":"app_id","value":"cli_a4054c355978d009"},{"name":"app_secret","value":"gIBdgOBBQVCQeRpQw1y7Zencd2sOqigf"}]},"options":{}},"id":"46266662-a89d-45a9-b6c6-93fcdd50a963","name":"get_access_token","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[1440,320]},{"parameters":{"url":"={{ $('Config Url').first().json.url }}","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $('get_access_token').item.json.tenant_access_token }}"}]},"sendBody":true,"bodyParameters":{"parameters":[{}]},"options":{}},"id":"a1b658fd-2205-4623-9b43-b47434a8e8ab","name":"get_list_record","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[2000,320]},{"parameters":{"conditions":{"boolean":[{"value1":"={{ $('get_list_record').item.json.data.has_more }}","value2":true}]}},"id":"8a5104f3-99de-461f-bd14-e328612f40c0","name":"if_has_more_list","type":"n8n-nodes-base.if","typeVersion":1,"position":[2640,400]},{"parameters":{"jsCode":"const data = $('get_list_record').first().json.data\nconst order = data.items.find(forItem => forItem.fields.order_id === $('get_order_id_from_tx').first().json.order_id)\nlet isValidRecordId = !!order?.record_id\nif (!order) return {isValidRecordId}\nlet order_id = order?.fields.order_id\nlet record_id = order?.record_id\nlet moneyReceive = $('get_order_id_from_tx').first().json.total_receive\nconsole.log(moneyReceive)\nlet moneyTotal = order?.fields.total\n// th·∫±ng chuy·ªÉn nhi·ªÅu ti·ªÅn h∆°n orderTotal\nlet moneyRest = (moneyTotal-moneyReceive)>0 ? moneyTotal-moneyReceive : moneyTotal-moneyReceive\nlet statusPayment = $('check_is_true_tx').first().json.total_receive === moneyTotal?'ƒê√£ thanh to√°n ƒë·ªß':'ƒê√£ thanh to√°n m·ªôt ph·∫ßn'\nconsole.log(order)\nlet email = order?.fields.email\nreturn {\n  isValidRecordId,\n  email,\n  statusPayment,\n  moneyReceive,\n  moneyTotal,\n  moneyRest,\n  record_id,\n  order_id,\n  order_data: order?.fields\n}"},"id":"937f9969-4a95-4ea0-b0c9-5c41917a36ae","name":"handle_record_id","type":"n8n-nodes-base.code","typeVersion":1,"position":[2180,320]},{"parameters":{"jsCode":"if (items[0].json?.pageToken){\n  return {\n    url: `https://open.larksuite.com/open-apis/bitable/v1/apps/JxmFbMji9a8sGHs8KrfuAkkfsgf/tables/tblNSWaikG3Anktj/records?page_size=5&page_token=${items[0].json?.pageToken}&sort=%5B%22created_at+DESC%22%5D`\n  }\n}\n\nreturn {\n  url: 'https://open.larksuite.com/open-apis/bitable/v1/apps/JxmFbMji9a8sGHs8KrfuAkkfsgf/tables/tblNSWaikG3Anktj/records?page_size=5&sort=%5B%22created_at+DESC%22%5D'\n}"},"id":"8349aaff-4238-46e0-893d-625a10086558","name":"Config Url","type":"n8n-nodes-base.code","typeVersion":1,"position":[1720,320]},{"parameters":{"values":{"string":[{"name":"pageToken","value":"={{ $('get_list_record').item.json.data.page_token}}"}]},"options":{}},"id":"782060c7-ffed-47cc-86f6-0a884f00aa42","name":"Set","type":"n8n-nodes-base.set","typeVersion":2,"position":[2000,560]}],"connections":{"Webhook":{"main":[[{"node":"get_order_id_from_tx","type":"main","index":0}]]},"check_found_order":{"main":[[{"node":"check-full-payment","type":"main","index":0},{"node":"Format data","type":"main","index":0}],[{"node":"if_has_more_list","type":"main","index":0}]]},"check-full-payment":{"main":[[{"node":"send_email_thanh_toan_full","type":"main","index":0}],[{"node":"send_email_thanh_toan_mot_phan","type":"main","index":0}]]},"Format data":{"main":[[{"node":"Send message to group","type":"main","index":0}]]},"get_order_id_from_tx":{"main":[[{"node":"check_is_true_tx","type":"main","index":0}]]},"check_is_true_tx":{"main":[[{"node":"get_access_token","type":"main","index":0}]]},"get_access_token":{"main":[[{"node":"Config Url","type":"main","index":0}]]},"get_list_record":{"main":[[{"node":"handle_record_id","type":"main","index":0}]]},"if_has_more_list":{"main":[[{"node":"Set","type":"main","index":0}]]},"handle_record_id":{"main":[[{"node":"check_found_order","type":"main","index":0}]]},"Config Url":{"main":[[{"node":"get_list_record","type":"main","index":0}]]},"Set":{"main":[[{"node":"Config Url","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{"Webhook":[{"json":{"headers":{"host":"app.n8n.vn","user-agent":"axios/0.21.4","content-length":"419","accept":"application/json, text/plain, */*","content-type":"application/json","secure-token":"null","x-forwarded-for":"3.1.211.20","x-forwarded-host":"app.n8n.vn","x-forwarded-port":"443","x-forwarded-proto":"https","x-forwarded-server":"ba8c3a24b3d5","x-real-ip":"3.1.211.20","accept-encoding":"gzip"},"params":{},"query":{},"body":{"error":0,"data":[{"id":3390751,"tid":"5213 - 78587","description":"795887.190623.133058.DCME00014","amount":500,"cusum_balance":7354463,"when":"2023-06-19 13:30:59","bank_sub_acc_id":"6681888888","subAccId":"6681888888","bankName":"Vietcombank","bankAbbreviation":"VCB","virtualAccount":"","virtualAccountName":"","corresponsiveName":"","corresponsiveAccount":"","corresponsiveBankId":"","corresponsiveBankName":""}]}}}],"get_order_id_from_tx":[{"json":{"is_true_tx":true,"order_id":"DCME00014","total_receive":500},"pairedItem":{"item":0}}],"get_access_token":[{"json":{"code":0,"expire":7200,"msg":"ok","tenant_access_token":"t-g2056j9XZUSWD3ZFTNWZYO6NYF672QGM3GBEPRST"},"pairedItem":{"item":0}}]},"versionId":"642204cc-a724-46fd-a836-2b11d8324ab5","triggerCount":1,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-06-19T10:13:49.365Z","updatedAt":"2023-06-19T10:14:57.000Z","id":"140","name":"Lark base pagination","active":false,"nodes":[{"parameters":{"conditions":{"boolean":[{"value1":"={{ $json.isValidRecordId }}","value2":"={{ true }}"}]}},"id":"86dfb37e-c91b-4a99-942d-cb693f967053","name":"check_found_order","type":"n8n-nodes-base.if","typeVersion":1,"position":[2040,440]},{"parameters":{"url":"={{ $('Config Url').first().json.url }}","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $('Get Lark tenant access token').item.json.tenant_access_token }}"}]},"sendBody":true,"bodyParameters":{"parameters":[{}]},"options":{}},"id":"3f2e4cd3-a974-4a3d-8e43-ce742b5132bd","name":"get_list_record","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[1580,440]},{"parameters":{"conditions":{"boolean":[{"value1":"={{ $('get_list_record').item.json.data.has_more }}","value2":true}]}},"id":"440a2de5-00ac-464e-922c-ac055100e153","name":"if_has_more_list","type":"n8n-nodes-base.if","typeVersion":1,"position":[2040,660]},{"parameters":{"jsCode":"const data = $('get_list_record').first().json.data\nconst order = data.items.find(forItem => forItem.fields.order_id === $('get_order_id_from_tx').first().json.order_id)\nlet isValidRecordId = !!order?.record_id\nif (!order) return {isValidRecordId}\nlet order_id = order?.fields.order_id\nlet record_id = order?.record_id\nlet moneyReceive = $('get_order_id_from_tx').first().json.total_receive\nconsole.log(moneyReceive)\nlet moneyTotal = order?.fields.total\n// th·∫±ng chuy·ªÉn nhi·ªÅu ti·ªÅn h∆°n orderTotal\nlet moneyRest = (moneyTotal-moneyReceive)>0 ? moneyTotal-moneyReceive : moneyTotal-moneyReceive\nlet statusPayment = $('check_is_true_tx').first().json.total_receive === moneyTotal?'ƒê√£ thanh to√°n ƒë·ªß':'ƒê√£ thanh to√°n m·ªôt ph·∫ßn'\nconsole.log(order)\nlet email = order?.fields.email\nreturn {\n  isValidRecordId,\n  email,\n  statusPayment,\n  moneyReceive,\n  moneyTotal,\n  moneyRest,\n  record_id,\n  order_id,\n  order_data: order?.fields\n}"},"id":"3298e9f3-c739-41a8-8324-d6b7944b7af9","name":"handle_record_id","type":"n8n-nodes-base.code","typeVersion":1,"position":[1780,440]},{"parameters":{"jsCode":"if (items[0].json?.pageToken){\n  return {\n    url: `https://open.larksuite.com/open-apis/bitable/v1/apps/JxmFbMji9a8sGHs8KrfuAkkfsgf/tables/tblNSWaikG3Anktj/records?page_size=5&page_token=${items[0].json?.pageToken}&sort=%5B%22created_at+DESC%22%5D`\n  }\n}\n\nreturn {\n  url: 'https://open.larksuite.com/open-apis/bitable/v1/apps/JxmFbMji9a8sGHs8KrfuAkkfsgf/tables/tblNSWaikG3Anktj/records?page_size=5&sort=%5B%22created_at+DESC%22%5D'\n}"},"id":"5f4817fa-5194-4ed6-aeb6-ce4da47dd0d6","name":"Config Url","type":"n8n-nodes-base.code","typeVersion":1,"position":[1400,440]},{"parameters":{"values":{"string":[{"name":"pageToken","value":"={{ $('get_list_record').item.json.data.page_token}}"}]},"options":{}},"id":"74a390f1-a95c-4d0b-857b-740d270a5afe","name":"Set","type":"n8n-nodes-base.set","typeVersion":2,"position":[1600,820]},{"parameters":{},"id":"b3cce1da-1757-4388-8401-10c75b9fb0e1","name":"When clicking \"Execute Workflow\"","type":"n8n-nodes-base.manualTrigger","typeVersion":1,"position":[680,440]},{"parameters":{"method":"POST","url":"=https://open.larksuite.com/open-apis/auth/v3/tenant_access_token/internal/","sendBody":true,"specifyBody":"json","jsonBody":"={ \"app_id\" : \"{{ $('Set Lark auth data').item.json[\"appId\"] }}\", \"app_secret\" : \"{{ $('Set Lark auth data').item.json[\"appSecret\"] }}\" }","options":{}},"id":"d86faddb-08b4-466d-a5ea-7a344b1c4a5a","name":"Get Lark tenant access token","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[1180,440]},{"parameters":{"values":{"string":[{"name":"appId","value":"cli_a36a65082eb85009"},{"name":"appSecret","value":"n6EEtyICEiK2IoQGXLAFtedQTGY0Z5Sk"}]},"options":{}},"id":"d87a0ac3-2c38-4070-abe6-ca3b46182cd2","name":"Set Lark auth data","type":"n8n-nodes-base.set","typeVersion":1,"position":[940,440]}],"connections":{"check_found_order":{"main":[[],[{"node":"if_has_more_list","type":"main","index":0}]]},"get_list_record":{"main":[[{"node":"handle_record_id","type":"main","index":0}]]},"if_has_more_list":{"main":[[{"node":"Set","type":"main","index":0}]]},"handle_record_id":{"main":[[{"node":"check_found_order","type":"main","index":0}]]},"Config Url":{"main":[[{"node":"get_list_record","type":"main","index":0}]]},"Set":{"main":[[{"node":"Config Url","type":"main","index":0}]]},"When clicking \"Execute Workflow\"":{"main":[[{"node":"Set Lark auth data","type":"main","index":0}]]},"Set Lark auth data":{"main":[[{"node":"Get Lark tenant access token","type":"main","index":0}]]},"Get Lark tenant access token":{"main":[[{"node":"Config Url","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{},"versionId":"892b6518-90d5-4ca1-9fd8-882c8a37fc1c","triggerCount":0,"tags":[{"createdAt":"2023-04-13T09:24:58.649Z","updatedAt":"2023-06-13T07:54:39.069Z","id":"14","name":"Template"}]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-06-20T07:58:08.620Z","updatedAt":"2023-07-20T14:38:11.000Z","id":"141","name":"[DC Media] Thanh to√°n 1 ph·∫ßn c≈©","active":false,"nodes":[{"parameters":{"httpMethod":"POST","path":"dcmedia-thanh-toan-1-phan","options":{}},"id":"5276b493-46e1-4a50-8c93-e8bb3caca829","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[620,600],"webhookId":"f0c0d34e-6285-4e99-b22c-9242b92f5f4f"},{"parameters":{"fromEmail":"DC Media <no-reply@dcmedia.vn>","toEmail":"={{ $('Webhook').item.json.body.email }}","subject":"=[DC Media] X√°c nh·∫≠n ƒê∆°n h√†ng #{{ $('Webhook').item.json.body.order_id }}","emailFormat":"html","html":"=<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\">\n<html xmlns=\"http://www.w3.org/1999/xhtml\" xmlns:o=\"urn:schemas-microsoft-com:office:office\" style=\"width:100%;-webkit-text-size-adjust:100%;-ms-text-size-adjust:100%;padding:0;Margin:0\">\n <head>\n  <meta charset=\"UTF-8\">\n  <meta content=\"width=device-width, initial-scale=1\" name=\"viewport\">\n  <meta name=\"x-apple-disable-message-reformatting\">\n  <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\n  <meta content=\"telephone=no\" name=\"format-detection\">\n  <title>New message 2</title><!--[if (mso 16)]>\n    <style type=\"text/css\">\n    a {text-decoration: none;}\n    </style>\n    <![endif]--><!--[if gte mso 9]><style>sup { font-size: 100% !important; }</style><![endif]--><!--[if gte mso 9]>\n<xml>\n    <o:OfficeDocumentSettings>\n    <o:AllowPNG></o:AllowPNG>\n    <o:PixelsPerInch>96</o:PixelsPerInch>\n    </o:OfficeDocumentSettings>\n</xml>\n<![endif]-->\n  <style type=\"text/css\">\n#outlook a {\n\tpadding:0;\n}\n.ExternalClass {\n\twidth:100%;\n}\n.ExternalClass,\n.ExternalClass p,\n.ExternalClass span,\n.ExternalClass font,\n.ExternalClass td,\n.ExternalClass div {\n\tline-height:100%;\n}\n.es-button {\n\tmso-style-priority:100!important;\n\ttext-decoration:none!important;\n}\na[x-apple-data-detectors] {\n\tcolor:inherit!important;\n\ttext-decoration:none!important;\n\tfont-size:inherit!important;\n\tfont-family:inherit!important;\n\tfont-weight:inherit!important;\n\tline-height:inherit!important;\n}\n.es-desk-hidden {\n\tdisplay:none;\n\tfloat:left;\n\toverflow:hidden;\n\twidth:0;\n\tmax-height:0;\n\tline-height:0;\n\tmso-hide:all;\n}\n@media only screen and (max-width:600px) {p, ul li, ol li, a { line-height:150%!important } h1, h2, h3, h1 a, h2 a, h3 a { line-height:120%!important } h1 { font-size:30px!important; text-align:center } h2 { font-size:26px!important; text-align:center } h3 { font-size:20px!important; text-align:center } .es-header-body h1 a, .es-content-body h1 a, .es-footer-body h1 a { font-size:30px!important } .es-header-body h2 a, .es-content-body h2 a, .es-footer-body h2 a { font-size:26px!important } .es-header-body h3 a, .es-content-body h3 a, .es-footer-body h3 a { font-size:20px!important } .es-header-body p, .es-header-body ul li, .es-header-body ol li, .es-header-body a { font-size:16px!important } .es-content-body p, .es-content-body ul li, .es-content-body ol li, .es-content-body a { font-size:16px!important } .es-footer-body p, .es-footer-body ul li, .es-footer-body ol li, .es-footer-body a { font-size:16px!important } .es-infoblock p, .es-infoblock ul li, .es-infoblock ol li, .es-infoblock a { font-size:12px!important } *[class=\"gmail-fix\"] { display:none!important } .es-m-txt-c, .es-m-txt-c h1, .es-m-txt-c h2, .es-m-txt-c h3 { text-align:center!important } .es-m-txt-r, .es-m-txt-r h1, .es-m-txt-r h2, .es-m-txt-r h3 { text-align:right!important } .es-m-txt-l, .es-m-txt-l h1, .es-m-txt-l h2, .es-m-txt-l h3 { text-align:left!important } .es-m-txt-r img, .es-m-txt-c img, .es-m-txt-l img { display:inline!important } .es-button-border { display:block!important } a.es-button, button.es-button { font-size:20px!important; display:block!important; padding:10px 20px 10px 20px!important } .es-btn-fw { border-width:10px 0px!important; text-align:center!important } .es-adaptive table, .es-btn-fw, .es-btn-fw-brdr, .es-left, .es-right { width:100%!important } .es-content table, .es-header table, .es-footer table, .es-content, .es-footer, .es-header { width:100%!important; max-width:600px!important } .es-adapt-td { display:block!important; width:100%!important } .adapt-img { width:100%!important; height:auto!important } .es-m-p0 { padding:0px!important } .es-m-p0r { padding-right:0px!important } .es-m-p0l { padding-left:0px!important } .es-m-p0t { padding-top:0px!important } .es-m-p0b { padding-bottom:0!important } .es-m-p20b { padding-bottom:20px!important } .es-mobile-hidden, .es-hidden { display:none!important } tr.es-desk-hidden, td.es-desk-hidden, table.es-desk-hidden { width:auto!important; overflow:visible!important; float:none!important; max-height:inherit!important; line-height:inherit!important } tr.es-desk-hidden { display:table-row!important } table.es-desk-hidden { display:table!important } td.es-desk-menu-hidden { display:table-cell!important } .es-menu td { width:1%!important } table.es-table-not-adapt, .esd-block-html table { width:auto!important } table.es-social { display:inline-block!important } table.es-social td { display:inline-block!important } .es-desk-hidden { display:table-row!important; width:auto!important; overflow:visible!important; max-height:inherit!important } }\n</style>\n </head>\n <body data-new-gr-c-s-loaded=\"14.1110.0\" style=\"width:100%;-webkit-text-size-adjust:100%;-ms-text-size-adjust:100%;font-family:Arial, sans-serif;padding:0;Margin:0\">\n    <div class=\"es-wrapper-color\">\n        <!--[if gte mso 9]>\n\t\t\t<v:background xmlns:v=\"urn:schemas-microsoft-com:vml\" fill=\"t\">\n\t\t\t\t<v:fill type=\"tile\" color=\"#555555\"></v:fill>\n\t\t\t</v:background>\n\t\t<![endif]-->\n        <table class=\"es-wrapper\" width=\"100%\" cellspacing=\"0\" cellpadding=\"0\">\n            <tbody>\n                <tr>\n                    <td class=\"esd-email-paddings\" valign=\"top\">\n                        <table class=\"es-content esd-header-popover\" cellspacing=\"0\" cellpadding=\"0\" align=\"center\">\n                            <tbody>\n                                <tr>\n                                    <td class=\"esd-stripe\" align=\"center\">\n                                        <table class=\"es-content-body\" width=\"600\" cellspacing=\"0\" cellpadding=\"0\" align=\"center\">\n                                            <tbody>\n                                                <tr>\n                                                    <td class=\"esd-structure es-p20t es-p20b es-p10r es-p10l\" style=\"background-color: #191919;\" esd-general-paddings-checked=\"false\" bgcolor=\"#191919\" align=\"left\">\n                                                        <table width=\"100%\" cellspacing=\"0\" cellpadding=\"0\">\n                                                            <tbody>\n                                                                <tr>\n                                                                    <td class=\"esd-container-frame\" width=\"580\" valign=\"top\" align=\"center\">\n                                                                        <table width=\"100%\" cellspacing=\"0\" cellpadding=\"0\">\n                                                                            <tbody>\n                                                                                <tr>\n                                                                                    <td class=\"esd-block-image\" align=\"center\" style=\"font-size: 0px;\"><a target=\"_blank\" href=\"https://dcmedia.vn\"><img class=\"adapt-img\" src=\"https://s3.kdigi.app/dcgr/logo-dc-media.png\" alt width=\"200\" style=\"display: block;\"></a></td>\n                                                                                </tr>\n                                                                            </tbody>\n                                                                        </table>\n                                                                    </td>\n                                                                </tr>\n                                                            </tbody>\n                                                        </table>\n                                                    </td>\n                                                </tr>\n                                                <tr>\n                                                    <td class=\"esd-structure es-p20t es-p20b es-p20r es-p20l\" esd-general-paddings-checked=\"false\" style=\"background-color: #a5cff1;\" bgcolor=\"#a5cff1\" align=\"left\">\n                                                        <table width=\"100%\" cellspacing=\"0\" cellpadding=\"0\">\n                                                            <tbody>\n                                                                <tr>\n                                                                    <td class=\"esd-container-frame\" width=\"560\" valign=\"top\" align=\"center\">\n                                                                        <table width=\"100%\" cellspacing=\"0\" cellpadding=\"0\">\n                                                                            <tbody>\n                                                                                <tr>\n                                                                                    <td class=\"esd-block-text es-p15t es-p15b\" align=\"center\">\n                                                                                        <div class=\"esd-text\">\n                                                                                            <h2 style=\"color: #242424; font-size: 24px;\"><b>X√°c nh·∫≠n thanh to√°n</b></h2>\n                                                                                        </div>\n                                                                                    </td>\n                                                                                </tr>\n                                                                                <tr>\n                                                                                    <td class=\"esd-block-text es-p10l\" align=\"center\">\n                                                                                        <p style=\"color: #242424;\">Xin ch√†o,&nbsp;DC Media&nbsp;v·ª´a nh·∫≠n ƒë∆∞·ª£c kho·∫£n thanh to√°n {{ $('Code').item.json[\"moneyReceive\"] }} cho ƒë∆°n h√†ng&nbsp;<b>#{{$('Webhook').item.json[\"body\"][\"order_id\"]}}&nbsp;</b>c·ªßa qu√Ω kh√°ch.</p>\n                                                                                    </td>\n                                                                                </tr>\n                                                                            </tbody>\n                                                                        </table>\n                                                                    </td>\n                                                                </tr>\n                                                            </tbody>\n                                                        </table>\n                                                    </td>\n                                                </tr>\n                                                <tr>\n                                                    <td class=\"esd-structure es-p10t es-p30b es-p20r es-p20l\" esd-general-paddings-checked=\"false\" style=\"background-color: #eeeeee;\" bgcolor=\"#eeeeee\" align=\"left\">\n                                                        <table cellspacing=\"0\" cellpadding=\"0\" width=\"100%\">\n                                                            <tbody>\n                                                                <tr>\n                                                                    <td class=\"esd-container-frame\" width=\"560\" align=\"left\">\n                                                                        <table width=\"100%\" cellspacing=\"0\" cellpadding=\"0\">\n                                                                            <tbody>\n                                                                                <tr>\n                                                                                    <td class=\"esd-block-text es-p10t es-p10b\" align=\"center\">\n                                                                                        <h3 style=\"color: #242424;\">Th√¥ng tin chi ti·∫øt</h3>\n                                                                                    </td>\n                                                                                </tr>\n                                                                                <tr>\n                                                                                    <td class=\"esd-block-text es-p15b\" align=\"center\">\n                                                                                        <table class=\"cke_show_border\" width=\"240\" height=\"101\" cellspacing=\"1\" cellpadding=\"1\" border=\"0\">\n                                                                                            <tbody>\n                                                                                                <tr>\n                                                                                                    <td>\n                                                                                                        <p><strong>Nh·∫≠n thanh to√°n:</strong></p>\n                                                                                                    </td>\n                                                                                                    <td style=\"text-align: right;\">\n                                                                                                        <p>{{$('Code').item.json[\"moneyReceive\"]}}</p>\n                                                                                                    </td>\n                                                                                                </tr>\n                                                                                                <tr>\n                                                                                                    <td>\n                                                                                                        <p><strong>Gi√° tr·ªã ƒë∆°n h√†ng:</strong></p>\n                                                                                                    </td>\n                                                                                                    <td style=\"text-align: right;\">\n                                                                                                        <p>{{$('Code').item.json[\"moneyTotal\"]}}</p>\n                                                                                                    </td>\n                                                                                                </tr>\n                                                                                                <tr>\n                                                                                                    <td>\n                                                                                                        <p><strong>ƒê√£ chuy·ªÉn kho·∫£n:</strong></p>\n                                                                                                    </td>\n                                                                                                    <td style=\"text-align: right;\">\n                                                                                                        <p>{{$('Code').item.json[\"moneyPayment\"]}}</p>\n                                                                                                    </td>\n                                                                                                </tr>\n                                                                                                <tr>\n                                                                                                    <td style=\"font-size: 18px; line-height: 200%;\">\n                                                                                                        <p><strong>C√≤n l·∫°i:</strong></p>\n                                                                                                    </td>\n                                                                                                    <td style=\"text-align: right; font-size: 18px; line-height: 200%;\">\n                                                                                                        <p><b>{{$('Code').item.json[\"moneyRest\"]}}</b></p>\n                                                                                                    </td>\n                                                                                                </tr>\n                                                                                            </tbody>\n                                                                                        </table>\n                                                                                    </td>\n                                                                                </tr>\n                                                                            </tbody>\n                                                                        </table>\n                                                                    </td>\n                                                                </tr>\n                                                            </tbody>\n                                                        </table>\n                                                    </td>\n                                                </tr>\n                                                <tr>\n                                                    <td class=\"esd-structure es-p15t es-p10b es-p10r es-p10l\" style=\"background-color: #eeeeee;\" esd-general-paddings-checked=\"false\" bgcolor=\"#eeeeee\" align=\"left\">\n                                                        <table width=\"100%\" cellspacing=\"0\" cellpadding=\"0\">\n                                                            <tbody>\n                                                                <tr>\n                                                                    <td class=\"esd-container-frame\" width=\"580\" valign=\"top\" align=\"center\">\n                                                                        <table width=\"100%\" cellspacing=\"0\" cellpadding=\"0\">\n                                                                            <tbody>\n                                                                                <tr>\n                                                                                    <td class=\"esd-block-text\" align=\"center\">\n                                                                                        <h2 style=\"color: #191919;\"><strong>Th√¥ng tin thanh to√°n</strong></h2>\n                                                                                    </td>\n                                                                                </tr>\n                                                                            </tbody>\n                                                                        </table>\n                                                                    </td>\n                                                                </tr>\n                                                            </tbody>\n                                                        </table>\n                                                    </td>\n                                                </tr>\n                                                <tr>\n                                                    <td class=\"esd-structure es-p10t es-p30b es-p20r es-p20l\" esd-general-paddings-checked=\"false\" style=\"background-color: #eeeeee;\" bgcolor=\"#eeeeee\" align=\"left\">\n                                                        <!--[if mso]><table width=\"560\" cellpadding=\"0\" cellspacing=\"0\"><tr><td width=\"270\" valign=\"top\"><![endif]-->\n                                                        <table class=\"es-left\" cellspacing=\"0\" cellpadding=\"0\" align=\"left\">\n                                                            <tbody>\n                                                                <tr>\n                                                                    <td class=\"es-m-p20b esd-container-frame\" width=\"270\" align=\"left\">\n                                                                        <table width=\"100%\" cellspacing=\"0\" cellpadding=\"0\">\n                                                                            <tbody>\n                                                                                <tr>\n                                                                                    <td class=\"esd-block-text\" align=\"left\">\n                                                                                        <p>Vui l√≤ng chuy·ªÉn kho·∫£n theo th√¥ng tin d∆∞·ªõi ƒë√¢y:<br><strong>Ng√¢n h√†ng: </strong>Vietcombank<br><strong>S·ªë t√†i kho·∫£n:</strong> 6681888888<br><strong>T√™n t√†i kho·∫£n: </strong>L√™ Qu·ªëc Kh√¥i</p>\n                                                                                        <p><strong>S·ªë ti·ªÅn: </strong>{{$('Code').item.json[\"moneyRest\"]}}<br><strong>N·ªôi dung: </strong><span style=\"background-color:#FFFF00;\">{{$('Webhook').item.json[\"body\"][\"order_id\"]}}</span></p>\n                                                                                        <p>L∆∞u √Ω: ƒê∆°n h√†ng n√†y ƒë∆∞·ª£c x√°c nh·∫≠n t·ª± ƒë·ªông. Vui l√≤ng chuy·ªÉn kho·∫£n ƒë√∫ng n·ªôi dung v√† s·ªë ti·ªÅn ƒë·ªÉ ƒë∆°n h√†ng ƒë∆∞·ª£c x·ª≠ l√Ω nhanh nh·∫•t.</p>\n                                                                                    </td>\n                                                                                </tr>\n                                                                            </tbody>\n                                                                        </table>\n                                                                    </td>\n                                                                </tr>\n                                                            </tbody>\n                                                        </table>\n                                                        <!--[if mso]></td><td width=\"20\"></td><td width=\"270\" valign=\"top\"><![endif]-->\n                                                        <table class=\"es-right\" cellspacing=\"0\" cellpadding=\"0\" align=\"right\">\n                                                            <tbody>\n                                                                <tr>\n                                                                    <td class=\"esd-container-frame\" width=\"270\" align=\"left\">\n                                                                        <table width=\"100%\" cellspacing=\"0\" cellpadding=\"0\">\n                                                                            <tbody>\n                                                                                <tr>\n                                                                                    <td align=\"center\" class=\"esd-block-image\" style=\"font-size: 0px;\"><a target=\"_blank\"><img class=\"adapt-img\" src=\"{{$('Code').item.json[\"url_payment\"]}}\" alt style=\"display: block;\" width=\"270\"></a></td>\n                                                                                </tr>\n                                                                            </tbody>\n                                                                        </table>\n                                                                    </td>\n                                                                </tr>\n                                                            </tbody>\n                                                        </table>\n                                                        <!--[if mso]></td></tr></table><![endif]-->\n                                                    </td>\n                                                </tr>\n                                            </tbody>\n                                        </table>\n                                    </td>\n                                </tr>\n                            </tbody>\n                        </table>\n                        <table cellpadding=\"0\" cellspacing=\"0\" class=\"es-footer esd-footer-popover\" align=\"center\">\n                            <tbody>\n                                <tr>\n                                    <td class=\"esd-stripe\" align=\"center\">\n                                        <table class=\"es-footer-body\" width=\"600\" cellspacing=\"0\" cellpadding=\"0\" align=\"center\">\n                                            <tbody>\n                                                <tr>\n                                                    <td class=\"esd-structure es-p20\" esd-general-paddings-checked=\"false\" align=\"left\">\n                                                        <table width=\"100%\" cellspacing=\"0\" cellpadding=\"0\">\n                                                            <tbody>\n                                                                <tr>\n                                                                    <td class=\"esd-container-frame\" width=\"560\" valign=\"top\" align=\"center\">\n                                                                        <table width=\"100%\" cellspacing=\"0\" cellpadding=\"0\">\n                                                                            <tbody>\n                                                                                <tr>\n                                                                                    <td class=\"esd-block-social es-p10t es-p20b\" align=\"center\" style=\"font-size:0\">\n                                                                                        <table class=\"es-table-not-adapt es-social\" cellspacing=\"0\" cellpadding=\"0\">\n                                                                                            <tbody>\n                                                                                                <tr>\n                                                                                                    <td class=\"es-p15r\" valign=\"top\" align=\"center\"><a href=\"#\"><img title=\"Facebook\" src=\"https://qejvez.stripocdn.email/content/assets/img/social-icons/circle-gray/facebook-circle-gray.png\" alt=\"Fb\" width=\"32\" height=\"32\"></a></td>\n                                                                                                    <td valign=\"top\" align=\"center\" esd-tmp-icon-type=\"tiktok\"><a href=\"#\" target=\"_blank\"><img title=\"TikTok\" src=\"https://qejvez.stripocdn.email/content/assets/img/social-icons/circle-gray/tiktok-circle-gray.png\" alt=\"Tt\" width=\"32\" height=\"32\"></a></td>\n                                                                                                </tr>\n                                                                                            </tbody>\n                                                                                        </table>\n                                                                                    </td>\n                                                                                </tr>\n                                                                                <tr>\n                                                                                    <td align=\"center\" class=\"esd-block-text es-p20t es-p20b\">\n                                                                                        <p style=\"line-height: 120%;\">DC Media</p>\n                                                                                        <p style=\"line-height: 120%;\">0333111868</p>\n                                                                                        <p style=\"line-height: 120%;\">support@dcmedia.vn</p>\n                                                                                    </td>\n                                                                                </tr>\n                                                                                <tr>\n                                                                                    <td class=\"esd-block-text es-p10t es-p10b\" align=\"center\">\n                                                                                        <p><em><span style=\"font-size: 11px; line-height: 150%;\">B·∫°n nh·∫≠n ƒë∆∞·ª£c email n√†y v√¨ ƒë√£ ƒë·ªÉ l·∫°i th√¥ng tin c√° nh√¢n c·ªßa b·∫°n cho ch√∫ng t√¥i.</span></em></p>\n                                                                                    </td>\n                                                                                </tr>\n                                                                            </tbody>\n                                                                        </table>\n                                                                    </td>\n                                                                </tr>\n                                                            </tbody>\n                                                        </table>\n                                                    </td>\n                                                </tr>\n                                            </tbody>\n                                        </table>\n                                    </td>\n                                </tr>\n                            </tbody>\n                        </table>\n                    </td>\n                </tr>\n            </tbody>\n        </table>\n    </div>\n </body>\n</html>","options":{}},"id":"e3983bfd-aea4-4c47-a2d1-8f38f8c45d96","name":"Send Email1","type":"n8n-nodes-base.emailSend","typeVersion":2,"position":[1040,600],"credentials":{"smtp":{"id":"62","name":"SMTP no-reply@dcmedia.vn"}}},{"parameters":{"jsCode":"const data = $('Webhook').first().json.body\nlet moneyReceive = data.moneyReceive.toLocaleString(\"en-US\") + \" VNƒê\"\nlet moneyPayment = data.moneyPayment.toLocaleString(\"en-US\") + \" VNƒê\"\nlet moneyTotal = data.moneyTotal.toLocaleString(\"en-US\") + \" VNƒê\"\nlet moneyRest = data.moneyRest.toLocaleString(\"en-US\") + \" VNƒê\"\nlet url_payment = `https://img.vietqr.io/image/VCB-6681888888-compact.png?amount=${data.moneyRest}&addInfo=${data.order_id}&accountName=Le%20Quoc%20Khoi`\nreturn {\n  moneyReceive,\n  moneyPayment,\n  moneyTotal,\n  moneyRest,\n  url_payment\n}"},"id":"61b2007f-9953-4f6b-999d-71e23064c50e","name":"Code","type":"n8n-nodes-base.code","typeVersion":1,"position":[840,600]}],"connections":{"Webhook":{"main":[[{"node":"Code","type":"main","index":0}]]},"Code":{"main":[[{"node":"Send Email1","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{"Webhook":[{"json":{"headers":{"host":"app.n8n.vn","user-agent":"axios/0.21.4","content-length":"179","accept":"application/json,text/html,application/xhtml+xml,application/xml,text/*;q=0.9, image/*;q=0.8, */*;q=0.7","content-type":"application/json","x-forwarded-for":"172.23.0.1","x-forwarded-host":"app.n8n.vn","x-forwarded-port":"443","x-forwarded-proto":"https","x-forwarded-server":"586292a87aa4","x-real-ip":"172.23.0.1","accept-encoding":"gzip"},"params":{},"query":{},"body":{"record_id":"rec4X9gzwr","order_id":"DCME00031","moneyReceive":5000,"moneyPayment":5000,"moneyTotal":5000,"moneyRest":0,"statusPayment":"completed","email":"lekhoi456@gmail.com"}},"pairedItem":{"item":0}}]},"versionId":"401df3a9-c74a-4f56-b065-00c8fd1b69fb","triggerCount":1,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-06-21T16:28:17.381Z","updatedAt":"2023-06-30T13:13:43.000Z","id":"142","name":"Send an booking email via training.BeeGrowth","active":false,"nodes":[{"parameters":{"fromEmail":"BeeGrowth Training<training.beegrowth@mieu.vn>","toEmail":"={{ $json[\"query\"][\"email\"] }}","subject":"[BeeGrowth] Email X√°c nh·∫≠n ƒëƒÉng k√Ω tham gia Workshop","html":"=<!DOCTYPE html>\n<html xmlns=\"http://www.w3.org/1999/xhtml\" xmlns:o=\"urn:schemas-microsoft-com:office:office\" style=\"font-family: 'Futura', Arial, 'Helvetica Neue', Helvetica, sans-serif;\">\n<head>\n<meta charset=\"UTF-8\">\n<meta content=\"width=device-width, initial-scale=1\" name=\"viewport\">\n<meta name=\"x-apple-disable-message-reformatting\">\n<meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\n<meta content=\"telephone=no\" name=\"format-detection\">\n<style type=\"text/css\">\na {text-decoration: none;}\np {font-family: 'Futura', Arial, 'Helvetica Neue', Helvetica, sans-serif;}\n</style>\n<!--[endif]--><!--[if gte mso 9]><style>sup { font-size: 100% !important; }</style><![endif]--><!--[if gte mso 9]>\n<xml>\n<o:OfficeDocumentSettings>\n<o:AllowPNG></o:AllowPNG>\n<o:PixelsPerInch>96</o:PixelsPerInch>\n</o:OfficeDocumentSettings>\n</xml>\n<![endif]--><!--[if !mso]><!-- -->\n<link href=\"https://fonts.googleapis.com/css2?family=Imprima&display=swap\" rel=\"stylesheet\"><!--<![endif]-->\n<style type=\"text/css\">\n#outlook a {\npadding:0;\n}\n.es-button {\nmso-style-priority:100!important;\ntext-decoration:none!important;\n}\na[x-apple-data-detectors] {\ncolor:inherit!important;\ntext-decoration:none!important;\nfont-size:inherit!important;\nfont-family:inherit!important;\nfont-weight:inherit!important;\nline-height:inherit!important;\n}\n.es-desk-hidden {\ndisplay:none;\nfloat:left;\noverflow:hidden;\nwidth:0;\nmax-height:0;\nline-height:0;\nmso-hide:all;\n}\n.btn-link {\n    border: none;\n    outline: none;\n    background: none;\n    cursor: pointer;\n    color: #0000EE;\n    padding: 0;\n    text-decoration: underline;\n    font-family: inherit;\n    font-size: inherit;\n}\n@media only screen and (max-width:600px) {p, ul li, ol li, a { line-height:150%!important } h1, h2, h3, h1 a, h2 a, h3 a { line-height:120% } h1 { font-size:30px!important; text-align:left } h2 { font-size:24px!important; text-align:left } h3 { font-size:20px!important; text-align:left } .es-header-body h1 a, .es-content-body h1 a, .es-footer-body h1 a { font-size:30px!important; text-align:left } .es-header-body h2 a, .es-content-body h2 a, .es-footer-body h2 a { font-size:24px!important; text-align:left } .es-header-body h3 a, .es-content-body h3 a, .es-footer-body h3 a { font-size:20px!important; text-align:left } .es-menu td a { font-size:14px!important } .es-header-body p, .es-header-body ul li, .es-header-body ol li, .es-header-body a { font-size:14px!important } .es-content-body p, .es-content-body ul li, .es-content-body ol li, .es-content-body a { font-size:14px!important } .es-footer-body p, .es-footer-body ul li, .es-footer-body ol li.\n</style>\n</head>\n<body data-new-gr-c-s-loaded=\"14.1101.0\" style=\"width:100%;font-family:arial, 'helvetica neue', helvetica, sans-serif;-webkit-text-size-adjust:100%;-ms-text-size-adjust:100%;padding:0;Margin:0\">\n<div class=\"es-wrapper-color\" style=\"background-color:#FFFFFF\"><!--[if gte mso 9]>\n<v:background xmlns:v=\"urn:schemas-microsoft-com:vml\" fill=\"t\">\n<v:fill type=\"tile\" color=\"#ffffff\"></v:fill>\n</v:background>\n<![endif]-->\n<table class=\"es-wrapper\" width=\"100%\" cellspacing=\"0\" cellpadding=\"0\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;padding:0;Margin:0;width:100%;height:100%;background-repeat:repeat;background-position:center top;background-color:#FFFFFF\">\n<tr>\n<td valign=\"top\" style=\"padding:0;Margin:0\">\n<table cellpadding=\"0\" cellspacing=\"0\" class=\"es-content\" align=\"center\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;table-layout:fixed !important;width:100%\">\n<tr>\n<td align=\"center\" style=\"padding:0;Margin:0\">\n<table bgcolor=\"#efefef\" class=\"es-content-body\" align=\"center\" cellpadding=\"0\" cellspacing=\"0\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;background-color:#EFEFEF;border-radius:20px 20px 0 0;width:600px\">\n<tr>\n<td align=\"left\" style=\"padding:0;Margin:0;padding-top:40px;padding-left:40px;padding-right:40px\">\n<table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\">\n<tr>\n<td align=\"center\" valign=\"top\" style=\"padding:0;Margin:0;width:520px\">\n<table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" role=\"presentation\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\">\n<tr>\n<td align=\"center\" style=\"padding:0;Margin:0;font-size:0px\"><a target=\"_blank\" href=\"https://www.mieu.vn\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:underline;color:#2D3142;font-size:18px\"><a href=\"https://ibb.co/5rczw4F\">\n  <img src=\"https://i.ibb.co/Stv1Gyr/BEEGROWTH-LOGO-1.png\" alt=\"BEEGROWTH-LOGO-1\" border=\"0\" style=\"width: 60%; height: auto;\">\n  \n</a>\n </tr>\n  \n</table></td>\n</tr>\n</table></td>\n</tr>\n<tr>\n<td align=\"left\" style=\"padding:20px;Margin:0;font-family:Futura, Arial, sans-serif;\">\n  <br><br> <h3 style=\"Margin:0;line-height:34px;mso-line-height-rule:exactly;font-size:28px;font-style:normal;font-weight:bold;color:#2D3142\">Welcome {{ $json[\"query\"][\"name\"] }},</h3>\n  <p style=\"Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;line-height:27px;color:#2D3142;font-size:18px\"><br><br>Ch√∫c m·ª´ng b·∫°n ƒë√£ ƒëƒÉng k√Ω th√†nh c√¥ng workshop <strong>\"L·∫≠p K·∫ø Ho·∫°ch JBP tr√™n E-commerce\"</strong> c·ªßa ch√∫ng t√¥i. Ch√∫ng t√¥i r·∫•t vui khi b·∫°n quan t√¢m t·ªõi kh√≥a h·ªçc n√†y v√† mong mu·ªën chia s·∫ª nh·ªØng ki·∫øn th·ª©c v√† kinh nghi·ªám v·ªõi b·∫°n.<br><br>ƒê·ªÉ ho√†n t·∫•t qu√° tr√¨nh ƒëƒÉng k√Ω v√† x√°c nh·∫≠n ch·ªó c·ªßa b·∫°n, b·∫°n vui l√≤ng th·ª±c hi·ªán thanh to√°n theo th√¥ng tin chuy·ªÉn kho·∫£n sau:<br><br>Ch·ªß t√†i kho·∫£n: <strong>Cao √Ånh Tuy·∫øt</strong>.\n<br> S·ªë t√†i kho·∫£n: <strong>19024701228021</strong>\n<br> Ng√¢n H√†ng: <strong>K·ªπ th∆∞∆°ng Vi·ªát Nam - Techcombank</strong>\n<br>N·ªôi dung: <strong>{{ $json[\"query\"][\"name\"] }}_{{ $json[\"query\"][\"phone\"] }}_JBP</strong>\n<br><br>Sau khi ch√∫ng t√¥i nh·∫≠n ƒë∆∞·ª£c th√¥ng tin thanh to√°n c·ªßa b·∫°n, ch√∫ng t√¥i s·∫Ω g·ª≠i email x√°c nh·∫≠n ƒë·∫øn b·∫°n v√† x√°c nh·∫≠n ch·ªó c·ªßa b·∫°n trong Workshop.\n <br>N·∫øu b·∫°n c√≥ b·∫•t k·ª≥ c√¢u h·ªèi ho·∫∑c th·∫Øc m·∫Øc n√†o, vui l√≤ng li√™n h·ªá v·ªõi ch√∫ng t√¥i qua email ƒë∆∞·ª£c cung c·∫•p d∆∞·ªõi ƒë√¢y.\n  <br><br>\n L·∫ßn n·ªØa c·∫£m ∆°n b·∫°n ƒë√£ ƒëƒÉng k√Ω kh√≥a h·ªçc c·ªßa ch√∫ng t√¥i v√† hy v·ªçng s·ªõm g·∫∑p l·∫°i b·∫°n trong l·ªõp h·ªçc.\n  <br><br>\n    <t align=\"left\" style=\"padding:20px;Margin:0;font-family:Futura, Arial, sans-serif;\">\n  <h3 style=\"Margin:0;line-height:34px;mso-line-height-rule:exactly;font-size:28px;font-style:normal;font-weight:bold;color:#2D3142\">Thank you and see you there...</h3>\n \n</table></td>\n</tr>\n</table></td>\n</tr>\n</table>\n<table cellpadding=\"0\" cellspacing=\"0\" class=\"es-content\" align=\"center\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;table-layout:fixed !important;width:100%\">\n<tr>\n<td align=\"center\" style=\"padding:0;Margin:0\">\n<table bgcolor=\"#efefef\" class=\"es-content-body\" align=\"center\" cellpadding=\"0\" cellspacing=\"0\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;background-color:#EFEFEF;width:600px\">\n<tr>\n<td align=\"left\" style=\"Margin:0;padding-top:30px;padding-bottom:40px;padding-left:40px;padding-right:40px\">\n<table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\">\n<tr>\n<td align=\"center\" valign=\"top\" style=\"padding:0;Margin:0;width:520px\">\n<table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" role=\"presentation\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\">\n<tr>\n<td align=\"center\" style=\"padding:0;Margin:0\"><!--[if mso]><a href=\"\" target=\"_blank\" hidden>\n<v:roundrect xmlns:v=\"urn:schemas-microsoft-com:vml\" xmlns:w=\"urn:schemas-microsoft-com:office:word\" esdevVmlButton href=\"\"\nstyle=\"height:56px; v-text-anchor:middle; width:520px\" arcsize=\"50%\" stroke=\"f\" fillcolor=\"#7630f3\">\n<w:anchorlock></w:anchorlock>\n<center style='color:#ffffff; font-family:Futura, Arial, sans-serif; font-size:22px; font-weight:700; line-height:22px; mso-text-raise:1px'>Take a Test</center>\n</v:roundrect></a>\n<![endif]--><!--[if !mso]><!-- -->\n  \n</form>\n<!--<![endif]--></td>\n</tr>\n</table></td>\n</tr>\n</table></td>\n</tr>\n</table>\n<table cellpadding=\"0\" cellspacing=\"0\" class=\"es-content\" align=\"center\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;table-layout:fixed !important;width:100%\">\n<tr>\n<td align=\"center\" style=\"padding:0;Margin:0\">\n<table bgcolor=\"#efefef\" class=\"es-content-body\" align=\"center\" cellpadding=\"0\" cellspacing=\"0\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;background-color:#EFEFEF;border-radius:0 0 20px 20px;width:600px\">\n<tr>\n<td class=\"esdev-adapt-off\" align=\"left\" style=\"Margin:0;padding-top:20px;padding-bottom:20px;padding-left:40px;padding-right:40px\">\n<table cellpadding=\"0\" cellspacing=\"0\" class=\"esdev-mso-table\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;width:520px\">\n<tr>\n<td class=\"esdev-mso-td\" valign=\"top\" style=\"padding:0;Margin:0\">\n<table cellpadding=\"0\" cellspacing=\"0\" align=\"left\" class=\"es-left\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;float:left\">\n<tr>\n<td align=\"center\" valign=\"top\" style=\"padding:0;Margin:0;width:47px\">\n<table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" role=\"presentation\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\">\n<tr>\n<td align=\"center\" class=\"es-m-txt-l\" style=\"padding:0;Margin:0;font-size:0px\"><a target=\"_blank\" href=\"https://viewstripo.email\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:underline;color:#2D3142;font-size:18px\"><img src=\"https://dnsfnr.stripocdn.email/content/guids/CABINET_ee77850a5a9f3068d9355050e69c76d26d58c3ea2927fa145f0d7a894e624758/images/group_4076325.png\" alt=\"Demo\" style=\"display:block;border:0;outline:none;text-decoration:none;-ms-interpolation-mode:bicubic\" width=\"37\" title=\"Demo\"></a></td>\n</tr>\n</table></td>\n</tr>\n</table></td>\n<td style=\"padding:0;Margin:0;width:20px\"></td>\n<td class=\"esdev-mso-td\" valign=\"top\" style=\"padding:0;Margin:0\">\n<table cellpadding=\"0\" cellspacing=\"0\" class=\"es-right\" align=\"right\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;float:right\">\n<tr>\n<td align=\"center\" valign=\"top\" style=\"padding:0;Margin:0;width:453px\">\n<table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" role=\"presentation\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\">\n<tr>\n<td align=\"left\" style=\"padding:0;Margin:0\"><p style=\"Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family::Futura, Arial, sans-serif;line-height:32px;color:#2D3142;font-size:16px\">If you have any questions, contact us via any channel below!</p></td>\n</tr>\n</table></td>\n</tr>\n</table></td>\n</tr>\n</table></td>\n</tr>\n</table></td>\n</tr>\n</table>\n<table cellpadding=\"0\" cellspacing=\"0\" class=\"es-footer\" align=\"center\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;table-layout:fixed !important;width:100%;background-color:transparent;background-repeat:repeat;background-position:center top\">\n<tr>\n<td align=\"center\" style=\"padding:0;Margin:0\">\n<table bgcolor=\"#bcb8b1\" class=\"es-footer-body\" align=\"center\" cellpadding=\"0\" cellspacing=\"0\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;background-color:#FFFFFF;width:600px\">\n<tr>\n<td align=\"left\" style=\"Margin:0;padding-left:20px;padding-right:20px;padding-bottom:30px;padding-top:40px\">\n<table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\">\n<tr>\n<td align=\"left\" style=\"padding:0;Margin:0;width:560px\">\n<table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" role=\"presentation\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\">\n<tr>\n<td align=\"center\" class=\"es-m-txt-c\" style=\"padding:0;Margin:0;padding-top:10px;padding-bottom:20px;font-size:0\">\n<table cellpadding=\"0\" cellspacing=\"0\" class=\"es-table-not-adapt es-social\" role=\"presentation\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\">\n<tr>\n<td align=\"center\" valign=\"top\" style=\"padding:0;Margin:0\"><a target=\"_blank\" href=\"https://www.facebook.com/mieu.vn\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:underline;color:#2D3142;font-size:14px\"><img src=\"https://dnsfnr.stripocdn.email/content/assets/img/social-icons/logo-black/facebook-logo-black.png\" alt=\"Fb\" title=\"Facebook\" height=\"24\" style=\"display:block;border:0;outline:none;text-decoration:none;-ms-interpolation-mode:bicubic\"></a></td>\n<td align=\"center\" valign=\"top\" style=\"padding:0;Margin:0\"><a target=\"_blank\" href=\"mailto:training.beegrowth@mieu.vn?subject=Get%20Support%20from%20Test%20Invited\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:underline;color:#2D3142;font-size:14px\"><img src=\"https://dnsfnr.stripocdn.email/content/assets/img/other-icons/logo-black/mail-logo-black.png\" alt=\"Email\" title=\"Email\" height=\"24\" style=\"display:block;border:0;outline:none;text-decoration:none;-ms-interpolation-mode:bicubic\"></a></td>\n<td align=\"center\" valign=\"top\" style=\"padding:0;Margin:0\"><a target=\"_blank\" href=\"https://goo.gl/maps/RLUQ3G8dHg35Bfto8\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:underline;color:#2D3142;font-size:14px\"><img src=\"https://dnsfnr.stripocdn.email/content/assets/img/other-icons/logo-black/location-logo-black.png\" alt=\"Map Marker\" title=\"Map Marker\" height=\"24\" style=\"display:block;border:0;outline:none;text-decoration:none;-ms-interpolation-mode:bicubic\"></a></td>\n<td align=\"center\" valign=\"top\" style=\"padding:0;Margin:0\"><a target=\"_blank\" href=\"tel:0905033554\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:underline;color:#2D3142;font-size:14px\"><img src=\"https://dnsfnr.stripocdn.email/content/assets/img/other-icons/logo-black/phone-logo-black.png\" alt=\"Phone\" title=\"Phone\" height=\"24\" style=\"display:block;border:0;outline:none;text-decoration:none;-ms-interpolation-mode:bicubic\"></a></td>\n<td align=\"center\" valign=\"top\" style=\"padding:0;Margin:0\"><a target=\"_blank\" href=\"https://goo.gl/maps/RLUQ3G8dHg35Bfto8\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:underline;color:#2D3142;font-size:14px\"><img src=\"https://dnsfnr.stripocdn.email/content/assets/img/other-icons/logo-black/googlebusiness-logo-black.png\" alt=\"Google Business\" title=\"Google Business\" height=\"24\" style=\"display:block;border:0;outline:none;text-decoration:none;-ms-interpolation-mode:bicubic\"></a></td>\n</tr>\n</table></td>\n</tr>\n<tr>\n<td align=\"center\" style=\"padding:0;Margin:0\"><p style=\"Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:Futura, Arial, sans-serif; font-size:22px; font-weight:700; line-height:22px; mso-text-raise:1px;color:#2D3142;font-size:13px\"><a target=\"_blank\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:none;color:#2D3142;font-size:14px\" href=\"\"></a><a target=\"_blank\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:none;color:#2D3142;font-size:14px\" href=\"\">Privacy Policy</a><a target=\"_blank\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:none;color:#2D3142;font-size:13px\" href=\"\"></a> ‚Ä¢ <a target=\"_blank\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:none;color:#2D3142;font-size:14px\" href=\"\">Unsubscribe</a></p></td>\n</tr>\n<tr>\n<td align=\"center\" style=\"padding:0;Margin:0;padding-top:20px\"><p style=\"Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:Futura, Arial, sans-serif;line-height:21px;color:#2D3142;font-size:14px\"><a target=\"_blank\" href=\"\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:underline;color:#2D3142;font-size:14px\"></a>Copyright ¬© BeeGrowth 2023&nbsp <a target=\"_blank\" href=\"\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:underline;color:#2D3142;font-size:14px\"></a></p></td>\n</tr>\n</table></td>\n</tr>\n</table></td>\n</tr>\n</table></td>\n</tr>\n</table></td>\n</tr>\n</table>\n</div>\n</body>\n</html>\n\n\n","options":{"allowUnauthorizedCerts":false}},"name":"Send Email","type":"n8n-nodes-base.emailSend","position":[640,320],"typeVersion":1,"id":"0710590b-c47c-4f1b-8842-56fb22bcb0a1","credentials":{"smtp":{"id":"63","name":"Training.beegrowth@mieu.vn"}}},{"parameters":{"httpMethod":"POST","path":"send-email","options":{}},"id":"5ba7f160-bd81-4b63-8ea5-33f60590a574","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[480,320],"webhookId":"cdf7024b-7b32-4814-bef7-f6b10ad331ef"}],"connections":{"Webhook":{"main":[[{"node":"Send Email","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{},"versionId":"28287f8f-effa-4f2c-85a8-3d0047a34137","triggerCount":1,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-06-22T07:26:57.343Z","updatedAt":"2023-06-22T08:13:51.000Z","id":"144","name":"[nucuoimekong.vn] Y√™u c·∫ßu t∆∞ v·∫•n","active":false,"nodes":[{"parameters":{"httpMethod":"POST","path":"ncmkvn-yeu-cau-tu-van","options":{}},"id":"ee9e4b89-c343-44d8-adad-d05266342ab0","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[820,500],"webhookId":"e322ca29-945d-4d39-814a-fbab345a849d"},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/bot/v2/hook/9ce47bf6-b00a-436e-9d9e-0c8f4028e9ac","sendBody":true,"specifyBody":"json","jsonBody":"={\n    \"msg_type\": \"post\",\n    \"content\": {\n        \"post\": {\n            \"en_us\": {\n                \"title\": \"[nucuoimekong.vn] {{ $node[\"Webhook\"].json[\"body\"][\"fullname\"] }} y√™u c·∫ßn t∆∞ v·∫•n\",\n                \"content\": [\n                    [                      \n                        {\n                            \"tag\": \"a\",\n                            \"text\": \"{{ $node[\"Webhook\"].json[\"body\"][\"source_title\"] }}\\n\",\n                            \"href\": \"{{ $node[\"Webhook\"].json[\"body\"][\"source_url\"] }}\"\n                        },\n                        {\n                            \"tag\": \"text\",\n                            \"text\": \"S·ªë ƒëi·ªán tho·∫°i: {{$node[\"Webhook\"].json[\"body\"][\"phone\"]}}\"\n                        },\n                        {\n                            \"tag\": \"a\",\n                            \"text\": \"\\nNh·∫Øn Zalo c√° nh√¢n cho kh√°ch\",\n                            \"href\": \"https://zalo.me/{{ $node[\"Webhook\"].json[\"body\"][\"phone\"] }}\"\n                        }\n                    ]\n                ]\n            }\n        }\n    }\n}","options":{}},"id":"477dd947-7e2f-4345-8a31-31f44559a792","name":"HTTP Request","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[1040,500]},{"parameters":{"conditions":{"string":[{"value1":"={{ $json.StatusMessage }}","value2":"success"}]}},"id":"0fc9c13e-f572-4867-b4de-d6cea50de748","name":"IF","type":"n8n-nodes-base.if","typeVersion":1,"position":[1260,500]},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/bot/v2/hook/12319b57-14ab-4066-ae74-2837f7c98e50","sendBody":true,"specifyBody":"json","jsonBody":"={\n    \"msg_type\": \"post\",\n    \"content\": {\n        \"post\": {\n            \"en_us\": {\n                \"title\": \"[nucuoimekong.vn] C√≥ l·ªói khi g·ª≠i th√¥ng tin kh√°ch c·∫ßn t∆∞ v·∫•n\",\n                \"content\": [\n                    [                      \n                        {\n                            \"tag\": \"a\",\n                            \"text\": \"{{ $node[\"Webhook\"].json[\"body\"][\"source_title\"] }}\\n\",\n                            \"href\": \"{{ $node[\"Webhook\"].json[\"body\"][\"source_url\"] }}\"\n                        },\n                        {\n                            \"tag\": \"text\",\n                            \"text\": \"Vui l√≤ng ki·ªÉm tra\"\n                        }\n                    ]\n                ]\n            }\n        }\n    }\n}","options":{}},"id":"11fea8f2-eea5-4257-9d1a-49b4c5186e06","name":"HTTP Request1","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[1480,580]}],"connections":{"Webhook":{"main":[[{"node":"HTTP Request","type":"main","index":0}]]},"HTTP Request":{"main":[[{"node":"IF","type":"main","index":0}]]},"IF":{"main":[[],[{"node":"HTTP Request1","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{"Webhook":[{"json":{"headers":{"host":"app.n8n.vn","user-agent":"WordPress/6.2; https://vere.me","content-length":"291","accept":"*/*","accept-encoding":"deflate, gzip, br","content-type":"application/json; charset=UTF-8","x-forwarded-for":"103.175.248.236","x-forwarded-host":"app.n8n.vn","x-forwarded-port":"443","x-forwarded-proto":"https","x-forwarded-server":"422302823b8a","x-real-ip":"103.175.248.236"},"params":{},"query":{},"body":{"fullname":"Khoi Le Quoc","phone":"0333111868","source_title":"V√© t√†u cao t·ªëc C·∫ßn Th∆° ƒëi C√¥n ƒê·∫£o gi√° r·∫ª - T√†u cao t·ªëc Mai Linh Express","source_url":"https://vere.me:443/ve-tau-cao-toc/can-tho-con-dao-mai-linh-express-2"}}}]},"versionId":"8fb00c8c-422f-4012-9396-d4501a856d6a","triggerCount":1,"tags":[{"createdAt":"2023-06-22T07:26:00.820Z","updatedAt":"2023-06-22T07:26:00.820Z","id":"20","name":"nucuoimekong.vn"}]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-06-22T08:14:12.573Z","updatedAt":"2023-06-22T08:19:41.000Z","id":"145","name":"[nucuoimekong.vn] Kh√°ch c·∫ßn t∆∞ v·∫•n new","active":true,"nodes":[{"parameters":{"httpMethod":"POST","path":"ncmk-tu-van","options":{}},"id":"36b74532-e596-4b05-b3a1-28df992b27d5","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[820,500],"webhookId":"22536222-9340-4ba0-85c5-af2a7a17b14e"},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/bot/v2/hook/9ce47bf6-b00a-436e-9d9e-0c8f4028e9ac","sendBody":true,"specifyBody":"json","jsonBody":"={{ JSON.stringify($('Code1').first().json)}}","options":{}},"id":"80f91df6-73f7-43f4-a5b9-043679aa7bc8","name":"HTTP Request","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[1480,500]},{"parameters":{"jsCode":"const data = $('Webhook').first().json.body;\nconst fullname = data.fullname || '-';\nconst phone = data.phone || '-';\nconst source_title = data.source_title;\nconst source_url = data.source_url;\nconst message = data.message;\n\nreturn {\n  fullname,\n  phone,\n  message,\n  source_title,\n  source_url\n}\n\n\n\n"},"id":"ec0f8835-ace1-4a3e-919c-a1a8c3eff6e3","name":"Code","type":"n8n-nodes-base.code","typeVersion":1,"position":[1040,500]},{"parameters":{"jsCode":"const data = $(\"Code\").first().json;\n\nlet elements = [];\n\nelements.push({\n    tag: \"div\",\n    fields: [\n        {\n            is_short: true,\n            text: {\n                tag: \"lark_md\",\n                content: `**H·ªç v√† t√™n:** ${data.fullname}`,\n            }\n        },\n        {\n            is_short: true,\n            text: {\n                tag: \"lark_md\",\n                content: `**S·ªë ƒëi·ªán tho·∫°i:** ${data.phone}`,\n            }\n        },\n        {\n            is_short: false,\n            text: {\n                tag: \"lark_md\",\n                content: `**L·ªùi nh·∫Øn:** ${data.message}`,\n            }\n        }\n    ],\n});\n\n// Add action buttons\nelements.push({\n    tag: \"action\",\n    actions: [\n        {\n            tag: \"button\",\n            text: {\n                tag: \"plain_text\",\n                content: \"Chat Zalo c√° nh√¢n\",\n            },\n            url: `https://zalo.me/${data.phone}`,\n            type: \"primary\",\n        },\n        {\n            tag: \"button\",\n            text: {\n                tag: \"plain_text\",\n                content: \"G·ªçi ƒëi·ªán c√° nh√¢n\",\n            },\n            url: `tel:${data.phone}`,\n            type: \"default\",\n        },\n        {\n            tag: \"button\",\n            text: {\n                tag: \"plain_text\",\n                content: \"Xem tr√™n web\",\n            },\n            url: `${data.source_url}`,\n            type: \"default\",\n        }\n    ],\n});\n\n\nlet result = {\n    msg_type: \"interactive\",\n    card: {\n        config: {\n            wide_screen_mode: true,\n        },\n        header: {\n            template: \"green\",\n            title: {\n                content: `Y√™u c·∫ßu t∆∞ v·∫•n ${data.source_title}`,\n                tag: \"plain_text\",\n            },\n        },\n        elements,\n    },\n};\nreturn { json: result };"},"id":"48b57175-3847-4545-820d-18e8a93cf151","name":"Code1","type":"n8n-nodes-base.code","typeVersion":1,"position":[1260,500]}],"connections":{"Webhook":{"main":[[{"node":"Code","type":"main","index":0}]]},"Code":{"main":[[{"node":"Code1","type":"main","index":0}]]},"Code1":{"main":[[{"node":"HTTP Request","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{"Webhook":[{"json":{"headers":{"host":"app.n8n.vn","user-agent":"WordPress/6.2.2; https://devv2.nucuoimekong.vn","content-length":"359","accept":"*/*","accept-encoding":"deflate, gzip, br","content-type":"application/json; charset=UTF-8","x-forwarded-for":"103.175.248.236","x-forwarded-host":"app.n8n.vn","x-forwarded-port":"443","x-forwarded-proto":"https","x-forwarded-server":"586292a87aa4","x-real-ip":"103.175.248.236"},"params":{},"query":{},"body":{"fullname":"L√™ Qu·ªëc Kh√¥i","phone":"0333111868","message":"ƒê√¢y l√† l·ªùi nh·∫Øn d√†i thi·ªát d√†i","source_title":"Tour Ch·ª£ N·ªïi C√°i RƒÉng gh√©p ƒëo√†n kh·ªüi h√†nh h·∫±ng ng√†y","source_url":"https://devv2.nucuoimekong.vn:443/tour/tour-cho-noi-cai-rang-ghep-doan"}},"pairedItem":{"item":0}}]},"versionId":"188f27fa-7b58-493e-bc37-653829da168f","triggerCount":1,"tags":[{"createdAt":"2023-06-22T07:26:00.820Z","updatedAt":"2023-06-22T07:26:00.820Z","id":"20","name":"nucuoimekong.vn"}]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-06-22T08:26:16.742Z","updatedAt":"2023-06-22T10:08:06.000Z","id":"146","name":"Add new record","active":true,"nodes":[{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/auth/v3/tenant_access_token/internal","sendBody":true,"bodyParameters":{"parameters":[{"name":"app_id","value":"cli_a4cc02cf28b8900a"},{"name":"app_secret","value":"pePaQtC2jGkf0hnIXVdebfaWSQTeEYnR"}]},"options":{"response":{"response":{"fullResponse":true}}}},"id":"6aef0366-af44-4113-ad50-067b81998af9","name":"Tenant","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[300,360]},{"parameters":{"path":"CASSO","options":{}},"id":"08efff00-6962-46c5-91cc-5dfa5156bb44","name":"Hungdata tu casso","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[60,360],"webhookId":"4fba380b-3d01-4602-b012-a53ff9ae0543"},{"parameters":{"method":"PUT","url":"='https://open.larksuite.com/open-apis/bitable/v1/apps/SAtPbyVUnaNxLPsEPVVuzMGdshh/tables/tblk3C5Yj1oYWlTc/records'","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $node[\"Tenant\"].json[\"body\"][\"tenant_access_token\"] }}"}]},"sendBody":true,"bodyParameters":{"parameters":[{"name":"Multiline","value":"="}]},"options":{"response":{"response":{"fullResponse":true}}}},"id":"7ad5656a-4fdd-4c1e-b730-285ecec095ce","name":"GHI BASE","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[560,360]}],"connections":{"Tenant":{"main":[[{"node":"GHI BASE","type":"main","index":0}]]},"Hungdata tu casso":{"main":[[{"node":"Tenant","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{},"versionId":"e9d4f481-71fa-4427-8f5e-41a683923e3e","triggerCount":1,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-06-22T10:43:58.193Z","updatedAt":"2023-06-30T13:13:41.000Z","id":"147","name":"Send payment confirm email via training.BeeGrowth","active":false,"nodes":[{"parameters":{"fromEmail":"BeeGrowth Training<training.beegrowth@mieu.vn>","toEmail":"={{ $json[\"query\"][\"email\"] }}","subject":"[BeeGrowth] Payment Confirmed cho Workshop","html":"=<!DOCTYPE html>\n<html xmlns=\"http://www.w3.org/1999/xhtml\" xmlns:o=\"urn:schemas-microsoft-com:office:office\" style=\"font-family: 'Futura', Arial, 'Helvetica Neue', Helvetica, sans-serif;\">\n<head>\n<meta charset=\"UTF-8\">\n<meta content=\"width=device-width, initial-scale=1\" name=\"viewport\">\n<meta name=\"x-apple-disable-message-reformatting\">\n<meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\n<meta content=\"telephone=no\" name=\"format-detection\">\n<style type=\"text/css\">\na {text-decoration: none;}\np {font-family: 'Futura', Arial, 'Helvetica Neue', Helvetica, sans-serif;}\n</style>\n<!--[endif]--><!--[if gte mso 9]><style>sup { font-size: 100% !important; }</style><![endif]--><!--[if gte mso 9]>\n<xml>\n<o:OfficeDocumentSettings>\n<o:AllowPNG></o:AllowPNG>\n<o:PixelsPerInch>96</o:PixelsPerInch>\n</o:OfficeDocumentSettings>\n</xml>\n<![endif]--><!--[if !mso]><!-- -->\n<link href=\"https://fonts.googleapis.com/css2?family=Imprima&display=swap\" rel=\"stylesheet\"><!--<![endif]-->\n<style type=\"text/css\">\n#outlook a {\npadding:0;\n}\n.es-button {\nmso-style-priority:100!important;\ntext-decoration:none!important;\n}\na[x-apple-data-detectors] {\ncolor:inherit!important;\ntext-decoration:none!important;\nfont-size:inherit!important;\nfont-family:inherit!important;\nfont-weight:inherit!important;\nline-height:inherit!important;\n}\n.es-desk-hidden {\ndisplay:none;\nfloat:left;\noverflow:hidden;\nwidth:0;\nmax-height:0;\nline-height:0;\nmso-hide:all;\n}\n.btn-link {\n    border: none;\n    outline: none;\n    background: none;\n    cursor: pointer;\n    color: #0000EE;\n    padding: 0;\n    text-decoration: underline;\n    font-family: inherit;\n    font-size: inherit;\n}\n@media only screen and (max-width:600px) {p, ul li, ol li, a { line-height:150%!important } h1, h2, h3, h1 a, h2 a, h3 a { line-height:120% } h1 { font-size:30px!important; text-align:left } h2 { font-size:24px!important; text-align:left } h3 { font-size:20px!important; text-align:left } .es-header-body h1 a, .es-content-body h1 a, .es-footer-body h1 a { font-size:30px!important; text-align:left } .es-header-body h2 a, .es-content-body h2 a, .es-footer-body h2 a { font-size:24px!important; text-align:left } .es-header-body h3 a, .es-content-body h3 a, .es-footer-body h3 a { font-size:20px!important; text-align:left } .es-menu td a { font-size:14px!important } .es-header-body p, .es-header-body ul li, .es-header-body ol li, .es-header-body a { font-size:14px!important } .es-content-body p, .es-content-body ul li, .es-content-body ol li, .es-content-body a { font-size:14px!important } .es-footer-body p, .es-footer-body ul li, .es-footer-body ol li.\n</style>\n</head>\n<body data-new-gr-c-s-loaded=\"14.1101.0\" style=\"width:100%;font-family:arial, 'helvetica neue', helvetica, sans-serif;-webkit-text-size-adjust:100%;-ms-text-size-adjust:100%;padding:0;Margin:0\">\n<div class=\"es-wrapper-color\" style=\"background-color:#FFFFFF\"><!--[if gte mso 9]>\n<v:background xmlns:v=\"urn:schemas-microsoft-com:vml\" fill=\"t\">\n<v:fill type=\"tile\" color=\"#ffffff\"></v:fill>\n</v:background>\n<![endif]-->\n<table class=\"es-wrapper\" width=\"100%\" cellspacing=\"0\" cellpadding=\"0\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;padding:0;Margin:0;width:100%;height:100%;background-repeat:repeat;background-position:center top;background-color:#FFFFFF\">\n<tr>\n<td valign=\"top\" style=\"padding:0;Margin:0\">\n<table cellpadding=\"0\" cellspacing=\"0\" class=\"es-content\" align=\"center\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;table-layout:fixed !important;width:100%\">\n<tr>\n<td align=\"center\" style=\"padding:0;Margin:0\">\n<table bgcolor=\"#efefef\" class=\"es-content-body\" align=\"center\" cellpadding=\"0\" cellspacing=\"0\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;background-color:#EFEFEF;border-radius:20px 20px 0 0;width:600px\">\n<tr>\n<td align=\"left\" style=\"padding:0;Margin:0;padding-top:40px;padding-left:40px;padding-right:40px\">\n<table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\">\n<tr>\n<td align=\"center\" valign=\"top\" style=\"padding:0;Margin:0;width:520px\">\n<table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" role=\"presentation\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\">\n<tr>\n<td align=\"center\" style=\"padding:0;Margin:0;font-size:0px\"><a target=\"_blank\" href=\"https://www.mieu.vn\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:underline;color:#2D3142;font-size:18px\"><a href=\"https://ibb.co/5rczw4F\">\n  <img src=\"https://i.ibb.co/Stv1Gyr/BEEGROWTH-LOGO-1.png\" alt=\"BEEGROWTH-LOGO-1\" border=\"0\" style=\"width: 60%; height: auto;\">\n  \n</a>\n </tr>\n  \n</table></td>\n</tr>\n</table></td>\n</tr>\n<tr>\n<td align=\"left\" style=\"padding:20px;Margin:0;font-family:Futura, Arial, sans-serif;\">\n  <br><br> <h3 style=\"Margin:0;line-height:34px;mso-line-height-rule:exactly;font-size:28px;font-style:normal;font-weight:bold;color:#2D3142\">Congratulation {{ $json[\"query\"][\"name\"] }},</h3>\n  <p style=\"Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;line-height:27px;color:#2D3142;font-size:18px\"><br><br> Email n√†y ƒë·ªÉ x√°c nh·∫≠n r·∫±ng thanh to√°n c·ªßa b·∫°n cho kh√≥a h·ªçc <strong>\"L·∫≠p K·∫ø Ho·∫°ch JBP tr√™n E-commerce\"</strong> ƒë√£ ƒë∆∞·ª£c x·ª≠ l√Ω th√†nh c√¥ng. Ch√∫ng t√¥i r·∫•t vui m·ª´ng v√¨ b·∫°n ƒë√£ ƒëƒÉng k√Ω tham gia kh√≥a h·ªçc c·ªßa ch√∫ng t√¥i v√† ƒë√£ tin t∆∞·ªüng v√†o ch·∫•t l∆∞·ª£ng d·ªãch v·ª• c·ªßa ch√∫ng t√¥i.\n  <br><br>\n L·∫ßn n·ªØa c·∫£m ∆°n b·∫°n ƒë√£ ƒëƒÉng k√Ω kh√≥a h·ªçc c·ªßa ch√∫ng t√¥i v√† hy v·ªçng s·ªõm g·∫∑p l·∫°i b·∫°n trong l·ªõp h·ªçc.\n  <br><br>\n    <t align=\"left\" style=\"padding:20px;Margin:0;font-family:Futura, Arial, sans-serif;\">\n  <h3 style=\"Margin:0;line-height:34px;mso-line-height-rule:exactly;font-size:28px;font-style:normal;font-weight:bold;color:#2D3142\">Thank you and see you there...</h3>\n \n</table></td>\n</tr>\n</table></td>\n</tr>\n</table>\n<table cellpadding=\"0\" cellspacing=\"0\" class=\"es-content\" align=\"center\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;table-layout:fixed !important;width:100%\">\n<tr>\n<td align=\"center\" style=\"padding:0;Margin:0\">\n<table bgcolor=\"#efefef\" class=\"es-content-body\" align=\"center\" cellpadding=\"0\" cellspacing=\"0\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;background-color:#EFEFEF;width:600px\">\n<tr>\n<td align=\"left\" style=\"Margin:0;padding-top:30px;padding-bottom:40px;padding-left:40px;padding-right:40px\">\n<table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\">\n<tr>\n<td align=\"center\" valign=\"top\" style=\"padding:0;Margin:0;width:520px\">\n<table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" role=\"presentation\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\">\n<tr>\n<td align=\"center\" style=\"padding:0;Margin:0\"><!--[if mso]><a href=\"\" target=\"_blank\" hidden>\n<v:roundrect xmlns:v=\"urn:schemas-microsoft-com:vml\" xmlns:w=\"urn:schemas-microsoft-com:office:word\" esdevVmlButton href=\"\"\nstyle=\"height:56px; v-text-anchor:middle; width:520px\" arcsize=\"50%\" stroke=\"f\" fillcolor=\"#7630f3\">\n<w:anchorlock></w:anchorlock>\n<center style='color:#ffffff; font-family:Futura, Arial, sans-serif; font-size:22px; font-weight:700; line-height:22px; mso-text-raise:1px'>Take a Test</center>\n</v:roundrect></a>\n<![endif]--><!--[if !mso]><!-- -->\n  \n</form>\n<!--<![endif]--></td>\n</tr>\n</table></td>\n</tr>\n</table></td>\n</tr>\n</table>\n<table cellpadding=\"0\" cellspacing=\"0\" class=\"es-content\" align=\"center\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;table-layout:fixed !important;width:100%\">\n<tr>\n<td align=\"center\" style=\"padding:0;Margin:0\">\n<table bgcolor=\"#efefef\" class=\"es-content-body\" align=\"center\" cellpadding=\"0\" cellspacing=\"0\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;background-color:#EFEFEF;border-radius:0 0 20px 20px;width:600px\">\n<tr>\n<td class=\"esdev-adapt-off\" align=\"left\" style=\"Margin:0;padding-top:20px;padding-bottom:20px;padding-left:40px;padding-right:40px\">\n<table cellpadding=\"0\" cellspacing=\"0\" class=\"esdev-mso-table\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;width:520px\">\n<tr>\n<td class=\"esdev-mso-td\" valign=\"top\" style=\"padding:0;Margin:0\">\n<table cellpadding=\"0\" cellspacing=\"0\" align=\"left\" class=\"es-left\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;float:left\">\n<tr>\n<td align=\"center\" valign=\"top\" style=\"padding:0;Margin:0;width:47px\">\n<table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" role=\"presentation\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\">\n<tr>\n<td align=\"center\" class=\"es-m-txt-l\" style=\"padding:0;Margin:0;font-size:0px\"><a target=\"_blank\" href=\"https://viewstripo.email\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:underline;color:#2D3142;font-size:18px\"><img src=\"https://dnsfnr.stripocdn.email/content/guids/CABINET_ee77850a5a9f3068d9355050e69c76d26d58c3ea2927fa145f0d7a894e624758/images/group_4076325.png\" alt=\"Demo\" style=\"display:block;border:0;outline:none;text-decoration:none;-ms-interpolation-mode:bicubic\" width=\"37\" title=\"Demo\"></a></td>\n</tr>\n</table></td>\n</tr>\n</table></td>\n<td style=\"padding:0;Margin:0;width:20px\"></td>\n<td class=\"esdev-mso-td\" valign=\"top\" style=\"padding:0;Margin:0\">\n<table cellpadding=\"0\" cellspacing=\"0\" class=\"es-right\" align=\"right\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;float:right\">\n<tr>\n<td align=\"center\" valign=\"top\" style=\"padding:0;Margin:0;width:453px\">\n<table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" role=\"presentation\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\">\n<tr>\n<td align=\"left\" style=\"padding:0;Margin:0\"><p style=\"Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family::Futura, Arial, sans-serif;line-height:32px;color:#2D3142;font-size:16px\">If you have any questions, contact us via any channel below!</p></td>\n</tr>\n</table></td>\n</tr>\n</table></td>\n</tr>\n</table></td>\n</tr>\n</table></td>\n</tr>\n</table>\n<table cellpadding=\"0\" cellspacing=\"0\" class=\"es-footer\" align=\"center\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;table-layout:fixed !important;width:100%;background-color:transparent;background-repeat:repeat;background-position:center top\">\n<tr>\n<td align=\"center\" style=\"padding:0;Margin:0\">\n<table bgcolor=\"#bcb8b1\" class=\"es-footer-body\" align=\"center\" cellpadding=\"0\" cellspacing=\"0\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;background-color:#FFFFFF;width:600px\">\n<tr>\n<td align=\"left\" style=\"Margin:0;padding-left:20px;padding-right:20px;padding-bottom:30px;padding-top:40px\">\n<table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\">\n<tr>\n<td align=\"left\" style=\"padding:0;Margin:0;width:560px\">\n<table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" role=\"presentation\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\">\n<tr>\n<td align=\"center\" class=\"es-m-txt-c\" style=\"padding:0;Margin:0;padding-top:10px;padding-bottom:20px;font-size:0\">\n<table cellpadding=\"0\" cellspacing=\"0\" class=\"es-table-not-adapt es-social\" role=\"presentation\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\">\n<tr>\n<td align=\"center\" valign=\"top\" style=\"padding:0;Margin:0\"><a target=\"_blank\" href=\"https://www.facebook.com/mieu.vn\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:underline;color:#2D3142;font-size:14px\"><img src=\"https://dnsfnr.stripocdn.email/content/assets/img/social-icons/logo-black/facebook-logo-black.png\" alt=\"Fb\" title=\"Facebook\" height=\"24\" style=\"display:block;border:0;outline:none;text-decoration:none;-ms-interpolation-mode:bicubic\"></a></td>\n<td align=\"center\" valign=\"top\" style=\"padding:0;Margin:0\"><a target=\"_blank\" href=\"mailto:training.beegrowth@mieu.vn?subject=Get%20Support%20from%20Test%20Invited\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:underline;color:#2D3142;font-size:14px\"><img src=\"https://dnsfnr.stripocdn.email/content/assets/img/other-icons/logo-black/mail-logo-black.png\" alt=\"Email\" title=\"Email\" height=\"24\" style=\"display:block;border:0;outline:none;text-decoration:none;-ms-interpolation-mode:bicubic\"></a></td>\n<td align=\"center\" valign=\"top\" style=\"padding:0;Margin:0\"><a target=\"_blank\" href=\"https://goo.gl/maps/RLUQ3G8dHg35Bfto8\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:underline;color:#2D3142;font-size:14px\"><img src=\"https://dnsfnr.stripocdn.email/content/assets/img/other-icons/logo-black/location-logo-black.png\" alt=\"Map Marker\" title=\"Map Marker\" height=\"24\" style=\"display:block;border:0;outline:none;text-decoration:none;-ms-interpolation-mode:bicubic\"></a></td>\n<td align=\"center\" valign=\"top\" style=\"padding:0;Margin:0\"><a target=\"_blank\" href=\"tel:0905033554\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:underline;color:#2D3142;font-size:14px\"><img src=\"https://dnsfnr.stripocdn.email/content/assets/img/other-icons/logo-black/phone-logo-black.png\" alt=\"Phone\" title=\"Phone\" height=\"24\" style=\"display:block;border:0;outline:none;text-decoration:none;-ms-interpolation-mode:bicubic\"></a></td>\n<td align=\"center\" valign=\"top\" style=\"padding:0;Margin:0\"><a target=\"_blank\" href=\"https://goo.gl/maps/RLUQ3G8dHg35Bfto8\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:underline;color:#2D3142;font-size:14px\"><img src=\"https://dnsfnr.stripocdn.email/content/assets/img/other-icons/logo-black/googlebusiness-logo-black.png\" alt=\"Google Business\" title=\"Google Business\" height=\"24\" style=\"display:block;border:0;outline:none;text-decoration:none;-ms-interpolation-mode:bicubic\"></a></td>\n</tr>\n</table></td>\n</tr>\n<tr>\n<td align=\"center\" style=\"padding:0;Margin:0\"><p style=\"Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:Futura, Arial, sans-serif; font-size:22px; font-weight:700; line-height:22px; mso-text-raise:1px;color:#2D3142;font-size:13px\"><a target=\"_blank\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:none;color:#2D3142;font-size:14px\" href=\"\"></a><a target=\"_blank\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:none;color:#2D3142;font-size:14px\" href=\"\">Privacy Policy</a><a target=\"_blank\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:none;color:#2D3142;font-size:13px\" href=\"\"></a> ‚Ä¢ <a target=\"_blank\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:none;color:#2D3142;font-size:14px\" href=\"\">Unsubscribe</a></p></td>\n</tr>\n<tr>\n<td align=\"center\" style=\"padding:0;Margin:0;padding-top:20px\"><p style=\"Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:Futura, Arial, sans-serif;line-height:21px;color:#2D3142;font-size:14px\"><a target=\"_blank\" href=\"\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:underline;color:#2D3142;font-size:14px\"></a>Copyright ¬© BeeGrowth 2023&nbsp <a target=\"_blank\" href=\"\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:underline;color:#2D3142;font-size:14px\"></a></p></td>\n</tr>\n</table></td>\n</tr>\n</table></td>\n</tr>\n</table></td>\n</tr>\n</table></td>\n</tr>\n</table>\n</div>\n</body>\n</html>\n\n\n","options":{"allowUnauthorizedCerts":false}},"name":"Send Email","type":"n8n-nodes-base.emailSend","position":[640,320],"typeVersion":1,"id":"08ae4f1d-7a19-4cce-9b6b-92210efb7bba","credentials":{"smtp":{"id":"63","name":"Training.beegrowth@mieu.vn"}}},{"parameters":{"httpMethod":"POST","path":"confirmed-email","options":{}},"id":"c01488ac-71e9-4b22-8636-48cc990a3381","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[480,320],"webhookId":"c954e651-e306-42a7-b864-5a7b85539987"}],"connections":{"Webhook":{"main":[[{"node":"Send Email","type":"main","index":0}]]},"Send Email":{"main":[[]]}},"settings":{},"staticData":null,"pinData":{},"versionId":"40902ce9-2cf8-4ac1-ba51-3750ef5a0adf","triggerCount":1,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-06-26T06:58:28.676Z","updatedAt":"2023-06-27T15:20:06.000Z","id":"148","name":"My workflow 14","active":false,"nodes":[{"parameters":{"rule":{"interval":[{"field":"minutes","minutesInterval":15}]}},"id":"6823f21a-4111-4dce-b8d8-a8753aaef76d","name":"Schedule Trigger","type":"n8n-nodes-base.scheduleTrigger","typeVersion":1.1,"position":[620,440]},{"parameters":{"collection":"messages","options":{}},"id":"ad7805ac-41c1-4855-8634-333ae1edcc82","name":"MongoDB","type":"n8n-nodes-base.mongoDb","typeVersion":1,"position":[900,640],"credentials":{"mongoDb":{"id":"64","name":"MongoDB account"}}},{"parameters":{"authentication":"serviceAccount","projectId":{"__rl":true,"value":"med247-353607","mode":"list","cachedResultName":"med247","cachedResultUrl":"https://console.cloud.google.com/bigquery?project=med247-353607"},"sqlQuery":"=#standardSQL\nSELECT * FROM test.messages","options":{"location":"asia-southeast1"}},"id":"a3f4bd96-7449-4fcb-bf47-8bdf41418de8","name":"Google BigQuery1","type":"n8n-nodes-base.googleBigQuery","typeVersion":2,"position":[900,440],"executeOnce":false,"credentials":{"googleApi":{"id":"65","name":"Google BigQuery account"}}},{"parameters":{"authentication":"serviceAccount","projectId":{"__rl":true,"value":"med247-353607","mode":"list","cachedResultName":"med247","cachedResultUrl":"https://console.cloud.google.com/bigquery?project=med247-353607"},"sqlQuery":"=#standardSQL\nINSERT INTO test.messages VALUES (  '{{ $json._id }}', '{{ $json.status }}', '{{ $json.phone }}', '''{{ $json.content }}''', PARSE_JSON('{{JSON.stringify($json.context) }}'), '{{ $json.template }}', '{{ $json.sender }}', PARSE_JSON('{{JSON.stringify( $json.provider)}}'), '{{ $json.createdAt }}', '{{ $json.updatedAt }}', '{{ $json.__v }}' )","options":{"location":"asia-southeast1"}},"id":"248ae5f1-7a29-4f9e-bbb4-f13617adf54a","name":"Google BigQuery2","type":"n8n-nodes-base.googleBigQuery","typeVersion":2,"position":[1640,200],"executeOnce":false,"credentials":{"googleApi":{"id":"65","name":"Google BigQuery account"}}},{"parameters":{"authentication":"serviceAccount","projectId":{"__rl":true,"value":"med247-353607","mode":"list","cachedResultName":"med247","cachedResultUrl":"https://console.cloud.google.com/bigquery?project=med247-353607"},"sqlQuery":"#standardSQL\nCREATE OR REPLACE TABLE test.messages (\n  _id STRING,\n  status STRING,\n  phone STRING,\n  content STRING,\n  context JSON,\n  template STRING,\n  sender STRING,\n  provider JSON,\n  createdAt STRING,\n  updateAt STRING,\n  __v STRING\n);\n","options":{"location":"asia-southeast1"}},"id":"e47b8763-7c3e-48f3-b8b6-216d782c0293","name":"Google BigQuery3","type":"n8n-nodes-base.googleBigQuery","typeVersion":2,"position":[1820,320],"executeOnce":false,"credentials":{"googleApi":{"id":"65","name":"Google BigQuery account"}}},{"parameters":{"amount":15,"unit":"seconds"},"id":"cd1bdf4f-c98e-42c6-8920-8156a6f6db93","name":"Wait1","type":"n8n-nodes-base.wait","typeVersion":1,"position":[1980,320],"webhookId":"249de388-7cfd-455f-b04d-92ca3d24a8c7"},{"parameters":{"mode":"combine","mergeByFields":{"values":[{"field1":"={{ $('MongoDB').item.json[\"_id\"] }}","field2":"={{ $('Google BigQuery1').item.json[\"_id\"] }}"}]},"options":{}},"id":"23968b7b-41dd-494c-a1a0-0b684a591d15","name":"Merge","type":"n8n-nodes-base.merge","typeVersion":2.1,"position":[1180,660],"alwaysOutputData":true},{"parameters":{"authentication":"serviceAccount","operation":"insert","projectId":{"__rl":true,"value":"med247-353607","mode":"list","cachedResultName":"med247","cachedResultUrl":"https://console.cloud.google.com/bigquery?project=med247-353607"},"datasetId":{"__rl":true,"value":"test","mode":"list","cachedResultName":"test"},"tableId":{"__rl":true,"value":"messages","mode":"list","cachedResultName":"messages"},"options":{}},"id":"f908d482-a4dc-4c6a-9eb3-6cc91129aecb","name":"Google BigQuery","type":"n8n-nodes-base.googleBigQuery","typeVersion":2,"position":[1420,440],"executeOnce":false,"credentials":{"googleApi":{"id":"65","name":"Google BigQuery account"}}},{"parameters":{"mode":"combine","mergeByFields":{"values":[{"field1":"={{ $('MongoDB').item.json[\"_id\"] }}","field2":"={{ $('Google BigQuery1').item.json[\"_id\"] }}"}]},"options":{}},"id":"1f6925e9-f84a-467e-a571-e44d0e3d5d81","name":"Merge1","type":"n8n-nodes-base.merge","typeVersion":2.1,"position":[1180,420],"alwaysOutputData":true},{"parameters":{"authentication":"serviceAccount","projectId":{"__rl":true,"value":"med247-353607","mode":"list","cachedResultName":"med247","cachedResultUrl":"https://console.cloud.google.com/bigquery?project=med247-353607"},"sqlQuery":"=UPDATE test.messages  SET\n  status    = '{{ $json.status    }}',\n  phone     = '{{ $json.phone     }}',\n  content   = '''{{ $json.content   }}''',\n  context   = PARSE_JSON('{{JSON.stringify($json.context) }}'),\n  template  = '{{ $json.template  }}',\n  sender    = '{{ $json.sender    }}',\n  provider  = PARSE_JSON('{{JSON.stringify( $json.provider)}}'),\n  createdAt = '{{ $json.createdAt }}',\n  updateAt  = '{{ $json.updateAt  }}',\n  __v       = '{{ $json.__v       }}'\n  WHERE \n  _id = '{{ $json._id       }}'","options":{}},"id":"b3875517-56c3-4685-a960-46702e42738f","name":"Google BigQuery4","type":"n8n-nodes-base.googleBigQuery","typeVersion":2,"position":[1420,660],"credentials":{"googleApi":{"id":"65","name":"Google BigQuery account"}}},{"parameters":{"collection":"messages","options":{}},"id":"db51314e-0af9-4f51-9357-e517216f0b6d","name":"MongoDB1","type":"n8n-nodes-base.mongoDb","typeVersion":1,"position":[700,200],"credentials":{"mongoDb":{"id":"64","name":"MongoDB account"}},"disabled":true},{"parameters":{"authentication":"serviceAccount","operation":"insert","projectId":{"__rl":true,"value":"med247-353607","mode":"list","cachedResultName":"med247","cachedResultUrl":"https://console.cloud.google.com/bigquery?project=med247-353607"},"datasetId":{"__rl":true,"value":"test","mode":"list","cachedResultName":"test"},"tableId":{"__rl":true,"value":"messages","mode":"list","cachedResultName":"messages"},"options":{}},"id":"f797809e-faa1-4959-be07-64688a9c9e71","name":"Google BigQuery5","type":"n8n-nodes-base.googleBigQuery","typeVersion":2,"position":[1180,200],"executeOnce":false,"credentials":{"googleApi":{"id":"65","name":"Google BigQuery account"}},"disabled":true},{"parameters":{"rule":{"interval":[{"field":"minutes","minutesInterval":15}]}},"id":"4ca9d070-19b5-46f2-9923-0f4c375b6477","name":"Schedule Trigger1","type":"n8n-nodes-base.scheduleTrigger","typeVersion":1.1,"position":[460,160]},{"parameters":{"conditions":{"string":[{"value1":"={{ $json._id }}","value2":"639be5661a1228001c7ee819"}]}},"id":"bce88543-fdf3-4560-b63b-62bd72fbb94f","name":"Filter","type":"n8n-nodes-base.filter","typeVersion":1,"position":[860,220],"disabled":true}],"connections":{"Schedule Trigger":{"main":[[{"node":"Google BigQuery1","type":"main","index":0},{"node":"MongoDB","type":"main","index":0}]]},"MongoDB":{"main":[[{"node":"Merge","type":"main","index":0},{"node":"Merge1","type":"main","index":0}]]},"Google BigQuery1":{"main":[[{"node":"Merge1","type":"main","index":1},{"node":"Merge","type":"main","index":1}]]},"Merge":{"main":[[{"node":"Google BigQuery","type":"main","index":0}]]},"Merge1":{"main":[[{"node":"Google BigQuery4","type":"main","index":0}]]},"MongoDB1":{"main":[[{"node":"Filter","type":"main","index":0}]]},"Schedule Trigger1":{"main":[[{"node":"MongoDB1","type":"main","index":0}]]},"Filter":{"main":[[{"node":"Google BigQuery5","type":"main","index":0}]]}},"settings":{},"staticData":{"node:Schedule Trigger":{"recurrencyRules":[]}},"pinData":{},"versionId":"e93a76cf-3dc4-4d03-af83-9c168f30c6af","triggerCount":1,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-06-27T08:24:23.663Z","updatedAt":"2023-06-27T08:24:23.663Z","id":"149","name":"My workflow 15","active":false,"nodes":[{"parameters":{"pollTimes":{"item":[{"mode":"everyMinute"}]},"documentId":{"__rl":true,"mode":"list","value":""},"sheetName":{"__rl":true,"mode":"list","value":""},"event":"rowAdded","options":{}},"id":"88ed506e-4923-4213-8486-d32834276eab","name":"Google Sheets Trigger","type":"n8n-nodes-base.googleSheetsTrigger","typeVersion":1,"position":[880,420]},{"parameters":{"jiraVersion":"server","project":{"__rl":true,"mode":"list","value":""},"issueType":{"__rl":true,"mode":"list","value":""},"additionalFields":{}},"id":"f1b28b4a-b722-4012-8fcd-30d7fd7cc82a","name":"Jira Software","type":"n8n-nodes-base.jira","typeVersion":1,"position":[1100,420],"credentials":{"jiraSoftwareServerApi":{"id":"67","name":"Jira SW Server account"}}}],"connections":{"Google Sheets Trigger":{"main":[[{"node":"Jira Software","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{},"versionId":"031765d3-d61e-4255-aaa6-b50d4f5396b3","triggerCount":0,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-06-27T10:25:18.563Z","updatedAt":"2023-06-27T10:25:18.563Z","id":"150","name":"My workflow 16","active":false,"nodes":[{"parameters":{"rule":{"interval":[{}]}},"id":"ca267470-eb00-4bd5-8df1-8c0c3ed55fb9","name":"Schedule Trigger","type":"n8n-nodes-base.scheduleTrigger","typeVersion":1.1,"position":[880,380]},{"parameters":{"authentication":"serviceAccount","projectId":{"__rl":true,"value":"med247-353607","mode":"list","cachedResultName":"med247","cachedResultUrl":"https://console.cloud.google.com/bigquery?project=med247-353607"},"sqlQuery":"DELETE test.messages where 1=1;","options":{"location":"asia-southeast1"}},"id":"0ce8910e-29e1-40de-8219-99bc13fdb420","name":"Google BigQuery","type":"n8n-nodes-base.googleBigQuery","typeVersion":2,"position":[1100,380],"credentials":{"googleApi":{"id":"65","name":"Google BigQuery account"}}},{"parameters":{"collection":"messages","options":{}},"id":"00c98d5d-f018-4711-9257-a390b4d81a4e","name":"MongoDB","type":"n8n-nodes-base.mongoDb","typeVersion":1,"position":[1300,380],"credentials":{"mongoDb":{"id":"64","name":"MongoDB account"}}},{"parameters":{"authentication":"serviceAccount","projectId":{"__rl":true,"value":"med247-353607","mode":"list","cachedResultName":"med247","cachedResultUrl":"https://console.cloud.google.com/bigquery?project=med247-353607"},"sqlQuery":"CREATE OR REPLACE TABLE your_dataset.your_table (\n  _id STRING,\n  status STRING,\n  phone STRING,\n  content STRING,\n  context JSON,\n  template STRING,\n  sender STRING,\n  provider JSON,\n  createdAt STRING,\n  updateAt STRING,\n  __v STRING\n);\n","options":{}},"id":"e323631e-b65a-4c6a-877d-8fcbe627dc21","name":"Google BigQuery1","type":"n8n-nodes-base.googleBigQuery","typeVersion":2,"position":[1520,380],"credentials":{"googleApi":{"id":"65","name":"Google BigQuery account"}}},{"parameters":{"authentication":"serviceAccount","operation":"insert","projectId":{"__rl":true,"value":"med247-353607","mode":"list","cachedResultName":"med247","cachedResultUrl":"https://console.cloud.google.com/bigquery?project=med247-353607"},"datasetId":{"__rl":true,"value":"test","mode":"list","cachedResultName":"test"},"tableId":{"__rl":true,"value":"messages","mode":"list","cachedResultName":"messages"},"options":{}},"id":"c2bfcfa0-6e9b-423e-86d9-00514557c9a8","name":"Google BigQuery2","type":"n8n-nodes-base.googleBigQuery","typeVersion":2,"position":[1920,380],"credentials":{"googleApi":{"id":"65","name":"Google BigQuery account"}}},{"parameters":{"amount":30,"unit":"seconds"},"id":"cd451a42-28f8-41f7-b7d9-51f11e4a0bac","name":"Wait","type":"n8n-nodes-base.wait","typeVersion":1,"position":[1720,380],"webhookId":"4d5c8d28-8a25-4bba-9028-a97ef999ef54"}],"connections":{"Schedule Trigger":{"main":[[{"node":"Google BigQuery","type":"main","index":0}]]},"Google BigQuery":{"main":[[{"node":"MongoDB","type":"main","index":0}]]},"MongoDB":{"main":[[{"node":"Google BigQuery1","type":"main","index":0}]]},"Google BigQuery1":{"main":[[{"node":"Wait","type":"main","index":0}]]},"Google BigQuery2":{"main":[[]]},"Wait":{"main":[[{"node":"Google BigQuery2","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{},"versionId":"e78ee753-29d7-4df5-8cfa-252abd55a15b","triggerCount":0,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-06-28T02:14:04.578Z","updatedAt":"2023-07-01T05:39:31.000Z","id":"151","name":"My workflow 14 copy","active":false,"nodes":[{"parameters":{"rule":{"interval":[{"field":"minutes","minutesInterval":15}]}},"id":"f18dbfa7-9368-4e00-9b03-71b026676e6d","name":"Schedule Trigger","type":"n8n-nodes-base.scheduleTrigger","typeVersion":1.1,"position":[640,640]},{"parameters":{"collection":"messages","options":{}},"id":"70951740-1333-4dce-879f-c8dfbbd1697b","name":"MongoDB","type":"n8n-nodes-base.mongoDb","typeVersion":1,"position":[900,640],"credentials":{"mongoDb":{"id":"64","name":"MongoDB account"}}},{"parameters":{"authentication":"serviceAccount","projectId":{"__rl":true,"value":"med247-353607","mode":"list","cachedResultName":"med247","cachedResultUrl":"https://console.cloud.google.com/bigquery?project=med247-353607"},"sqlQuery":"=#standardSQL\nINSERT INTO test.messages VALUES (  '{{ $json._id }}', '{{ $json.status }}', '{{ $json.phone }}', '''{{ $json.content }}''', PARSE_JSON('{{JSON.stringify($json.context) }}'), '{{ $json.template }}', '{{ $json.sender }}', PARSE_JSON('{{JSON.stringify( $json.provider)}}'), '{{ $json.createdAt }}', '{{ $json.updatedAt }}', '{{ $json.__v }}' )","options":{"location":"asia-southeast1"}},"id":"08c84bf2-ccf5-4798-8748-5c4007e237fc","name":"Google BigQuery2","type":"n8n-nodes-base.googleBigQuery","typeVersion":2,"position":[1640,200],"executeOnce":false,"credentials":{"googleApi":{"id":"65","name":"Google BigQuery account"}}},{"parameters":{"authentication":"serviceAccount","projectId":{"__rl":true,"value":"med247-353607","mode":"list","cachedResultName":"med247","cachedResultUrl":"https://console.cloud.google.com/bigquery?project=med247-353607"},"sqlQuery":"#standardSQL\nCREATE OR REPLACE TABLE test.messages (\n  _id STRING,\n  status STRING,\n  phone STRING,\n  content STRING,\n  context JSON,\n  template STRING,\n  sender STRING,\n  provider JSON,\n  createdAt STRING,\n  updateAt STRING,\n  __v STRING\n);\n","options":{"location":"asia-southeast1"}},"id":"72ad518a-8776-4ca1-bfd6-adf0645f8ac2","name":"Google BigQuery3","type":"n8n-nodes-base.googleBigQuery","typeVersion":2,"position":[1820,320],"executeOnce":false,"credentials":{"googleApi":{"id":"65","name":"Google BigQuery account"}}},{"parameters":{"amount":15,"unit":"seconds"},"id":"fafed1b5-adfd-4c54-89a0-4cb627f3d2d2","name":"Wait1","type":"n8n-nodes-base.wait","typeVersion":1,"position":[1980,320],"webhookId":"91096d18-619f-4db9-a525-8b3b417d993f"},{"parameters":{"mode":"combine","mergeByFields":{"values":[{"field1":"={{ $('MongoDB').item.json[\"_id\"] }}","field2":"=SELECT _id from {{ $('Google BigQuery1') }}"}]},"joinMode":"keepNonMatches","outputDataFrom":"=both","options":{}},"id":"b4d455ce-d709-4073-b4b2-434b8af07a3f","name":"Merge","type":"n8n-nodes-base.merge","typeVersion":2.1,"position":[1180,660],"alwaysOutputData":true},{"parameters":{"authentication":"serviceAccount","operation":"insert","projectId":{"__rl":true,"value":"med247-353607","mode":"list","cachedResultName":"med247","cachedResultUrl":"https://console.cloud.google.com/bigquery?project=med247-353607"},"datasetId":{"__rl":true,"value":"test","mode":"list","cachedResultName":"test"},"tableId":{"__rl":true,"value":"messages","mode":"list","cachedResultName":"messages"},"options":{}},"id":"c802ebd6-6f76-4cf8-b072-1843911f8c93","name":"Google BigQuery","type":"n8n-nodes-base.googleBigQuery","typeVersion":2,"position":[1420,440],"executeOnce":false,"credentials":{"googleApi":{"id":"65","name":"Google BigQuery account"}}},{"parameters":{"mode":"combine","combinationMode":"multiplex","options":{}},"id":"9f48ffea-ab52-49fc-8106-d7b8b1294482","name":"Merge1","type":"n8n-nodes-base.merge","typeVersion":2.1,"position":[1180,420],"alwaysOutputData":true},{"parameters":{"authentication":"serviceAccount","projectId":{"__rl":true,"value":"med247-353607","mode":"list","cachedResultName":"med247","cachedResultUrl":"https://console.cloud.google.com/bigquery?project=med247-353607"},"sqlQuery":"=UPDATE test.messages  SET\n  status    = '{{ $json.status    }}',\n  phone     = '{{ $json.phone     }}',\n  content   = '''{{ $json.content   }}''',\n  context   = PARSE_JSON('{{JSON.stringify($json.context) }}'),\n  template  = '{{ $json.template  }}',\n  sender    = '{{ $json.sender    }}',\n  provider  = PARSE_JSON('{{JSON.stringify( $json.provider)}}'),\n  createdAt = '{{ $json.createdAt }}',\n  updateAt  = '{{ $json.updateAt  }}',\n  __v       = '{{ $json.__v       }}'\n  WHERE \n  _id = '{{ $json._id       }}'","options":{}},"id":"8be0658c-4c61-4b27-ab44-0e4d1955e008","name":"Google BigQuery4","type":"n8n-nodes-base.googleBigQuery","typeVersion":2,"position":[1420,660],"credentials":{"googleApi":{"id":"65","name":"Google BigQuery account"}}},{"parameters":{"collection":"messages","options":{}},"id":"363b9b9b-63ee-45f4-a122-2dc65abc485c","name":"MongoDB1","type":"n8n-nodes-base.mongoDb","typeVersion":1,"position":[700,200],"credentials":{"mongoDb":{"id":"64","name":"MongoDB account"}},"disabled":true},{"parameters":{"authentication":"serviceAccount","operation":"insert","projectId":{"__rl":true,"value":"med247-353607","mode":"list","cachedResultName":"med247","cachedResultUrl":"https://console.cloud.google.com/bigquery?project=med247-353607"},"datasetId":{"__rl":true,"value":"test","mode":"list","cachedResultName":"test"},"tableId":{"__rl":true,"value":"messages_copy","mode":"list","cachedResultName":"messages_copy"},"options":{}},"id":"4a00f66b-7fc3-40c5-b033-1a93b768d92b","name":"Google BigQuery5","type":"n8n-nodes-base.googleBigQuery","typeVersion":2,"position":[1180,200],"executeOnce":false,"credentials":{"googleApi":{"id":"65","name":"Google BigQuery account"}},"disabled":true},{"parameters":{"rule":{"interval":[{"field":"minutes","minutesInterval":15}]}},"id":"5a656073-3a1a-4122-a77a-99ee81de0704","name":"Schedule Trigger1","type":"n8n-nodes-base.scheduleTrigger","typeVersion":1.1,"position":[460,200]},{"parameters":{"conditions":{"string":[{"value1":"={{ $('MongoDB1').item.json[\"_id\"] }}","value2":"639be5661a1228001c7ee819"}]}},"id":"004621a4-d232-44e6-ae62-56f86fd1b3af","name":"Filter","type":"n8n-nodes-base.filter","typeVersion":1,"position":[880,200],"disabled":true},{"parameters":{"authentication":"serviceAccount","projectId":{"__rl":true,"value":"med247-353607","mode":"list","cachedResultName":"med247","cachedResultUrl":"https://console.cloud.google.com/bigquery?project=med247-353607"},"sqlQuery":"#standardSQL\nSELECT * FROM test.messages","options":{"location":"asia-southeast1"}},"id":"c80c22f4-25e6-41d8-b023-e730b2b3bb84","name":"Google BigQuery1","type":"n8n-nodes-base.googleBigQuery","typeVersion":2,"position":[900,420],"executeOnce":false,"credentials":{"googleApi":{"id":"65","name":"Google BigQuery account"}}}],"connections":{"Schedule Trigger":{"main":[[{"node":"MongoDB","type":"main","index":0}]]},"MongoDB":{"main":[[{"node":"Merge","type":"main","index":0},{"node":"Merge1","type":"main","index":0}]]},"Merge":{"main":[[{"node":"Google BigQuery","type":"main","index":0}]]},"Merge1":{"main":[[{"node":"Google BigQuery4","type":"main","index":0}]]},"MongoDB1":{"main":[[{"node":"Filter","type":"main","index":0}]]},"Schedule Trigger1":{"main":[[{"node":"MongoDB1","type":"main","index":0}]]},"Filter":{"main":[[{"node":"Google BigQuery5","type":"main","index":0}]]},"Google BigQuery1":{"main":[[{"node":"Merge","type":"main","index":1},{"node":"Merge1","type":"main","index":1}]]}},"settings":{},"staticData":{"node:Schedule Trigger":{"recurrencyRules":[]}},"pinData":{},"versionId":"e2899267-ad36-4982-9631-f8d7f083c552","triggerCount":1,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-06-29T01:38:34.963Z","updatedAt":"2023-06-30T13:13:54.000Z","id":"152","name":"Send Confirmation Venue+ timing email via training.Beegrowth","active":false,"nodes":[{"parameters":{"fromEmail":"BeeGrowth Training<training.beegrowth@mieu.vn>","toEmail":"={{ $json[\"query\"][\"email\"] }}","subject":"[BeeGrowth] Email X√°c Nh·∫≠n Tham Gia Workshop JBP 01.07.2023","html":"=<!DOCTYPE html>\n<html xmlns=\"http://www.w3.org/1999/xhtml\" xmlns:o=\"urn:schemas-microsoft-com:office:office\" style=\"font-family: 'Futura', Arial, 'Helvetica Neue', Helvetica, sans-serif;\">\n<head>\n<meta charset=\"UTF-8\">\n<meta content=\"width=device-width, initial-scale=1\" name=\"viewport\">\n<meta name=\"x-apple-disable-message-reformatting\">\n<meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\n<meta content=\"telephone=no\" name=\"format-detection\">\n<style type=\"text/css\">\na {text-decoration: none;}\np {font-family: 'Futura', Arial, 'Helvetica Neue', Helvetica, sans-serif;}\n</style>\n<!--[endif]--><!--[if gte mso 9]><style>sup { font-size: 100% !important; }</style><![endif]--><!--[if gte mso 9]>\n<xml>\n<o:OfficeDocumentSettings>\n<o:AllowPNG></o:AllowPNG>\n<o:PixelsPerInch>96</o:PixelsPerInch>\n</o:OfficeDocumentSettings>\n</xml>\n<![endif]--><!--[if !mso]><!-- -->\n<link href=\"https://fonts.googleapis.com/css2?family=Imprima&display=swap\" rel=\"stylesheet\"><!--<![endif]-->\n<style type=\"text/css\">\n#outlook a {\npadding:0;\n}\n.es-button {\nmso-style-priority:100!important;\ntext-decoration:none!important;\n}\na[x-apple-data-detectors] {\ncolor:inherit!important;\ntext-decoration:none!important;\nfont-size:inherit!important;\nfont-family:inherit!important;\nfont-weight:inherit!important;\nline-height:inherit!important;\n}\n.es-desk-hidden {\ndisplay:none;\nfloat:left;\noverflow:hidden;\nwidth:0;\nmax-height:0;\nline-height:0;\nmso-hide:all;\n}\n.btn-link {\n    border: none;\n    outline: none;\n    background: none;\n    cursor: pointer;\n    color: #0000EE;\n    padding: 0;\n    text-decoration: underline;\n    font-family: inherit;\n    font-size: inherit;\n}\n@media only screen and (max-width:600px) {p, ul li, ol li, a { line-height:150%!important } h1, h2, h3, h1 a, h2 a, h3 a { line-height:120% } h1 { font-size:30px!important; text-align:left } h2 { font-size:24px!important; text-align:left } h3 { font-size:20px!important; text-align:left } .es-header-body h1 a, .es-content-body h1 a, .es-footer-body h1 a { font-size:30px!important; text-align:left } .es-header-body h2 a, .es-content-body h2 a, .es-footer-body h2 a { font-size:24px!important; text-align:left } .es-header-body h3 a, .es-content-body h3 a, .es-footer-body h3 a { font-size:20px!important; text-align:left } .es-menu td a { font-size:14px!important } .es-header-body p, .es-header-body ul li, .es-header-body ol li, .es-header-body a { font-size:14px!important } .es-content-body p, .es-content-body ul li, .es-content-body ol li, .es-content-body a { font-size:14px!important } .es-footer-body p, .es-footer-body ul li, .es-footer-body ol li.\n</style>\n</head>\n<body data-new-gr-c-s-loaded=\"14.1101.0\" style=\"width:100%;font-family:arial, 'helvetica neue', helvetica, sans-serif;-webkit-text-size-adjust:100%;-ms-text-size-adjust:100%;padding:0;Margin:0\">\n<div class=\"es-wrapper-color\" style=\"background-color:#FFFFFF\"><!--[if gte mso 9]>\n<v:background xmlns:v=\"urn:schemas-microsoft-com:vml\" fill=\"t\">\n<v:fill type=\"tile\" color=\"#ffffff\"></v:fill>\n</v:background>\n<![endif]-->\n<table class=\"es-wrapper\" width=\"100%\" cellspacing=\"0\" cellpadding=\"0\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;padding:0;Margin:0;width:100%;height:100%;background-repeat:repeat;background-position:center top;background-color:#FFFFFF\">\n<tr>\n<td valign=\"top\" style=\"padding:0;Margin:0\">\n<table cellpadding=\"0\" cellspacing=\"0\" class=\"es-content\" align=\"center\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;table-layout:fixed !important;width:100%\">\n<tr>\n<td align=\"center\" style=\"padding:0;Margin:0\">\n<table bgcolor=\"#efefef\" class=\"es-content-body\" align=\"center\" cellpadding=\"0\" cellspacing=\"0\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;background-color:#EFEFEF;border-radius:20px 20px 0 0;width:600px\">\n<tr>\n<td align=\"left\" style=\"padding:0;Margin:0;padding-top:40px;padding-left:40px;padding-right:40px\">\n<table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\">\n<tr>\n<td align=\"center\" valign=\"top\" style=\"padding:0;Margin:0;width:520px\">\n<table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" role=\"presentation\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\">\n<tr>\n<td align=\"center\" style=\"padding:0;Margin:0;font-size:0px\"><a target=\"_blank\" href=\"https://www.mieu.vn\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:underline;color:#2D3142;font-size:18px\"><a href=\"https://ibb.co/5rczw4F\">\n  <img src=\"https://i.ibb.co/Stv1Gyr/BEEGROWTH-LOGO-1.png\" alt=\"BEEGROWTH-LOGO-1\" border=\"0\" style=\"width: 60%; height: auto;\">\n  \n</a>\n </tr>\n  \n</table></td>\n</tr>\n</table></td>\n</tr>\n<tr>\n<td align=\"left\" style=\"padding:20px;Margin:0;font-family:Futura, Arial, sans-serif;\">\n  <br><br> <h3 style=\"Margin:0;line-height:34px;mso-line-height-rule:exactly;font-size:28px;font-style:normal;font-weight:bold;color:#2D3142\">Hello {{ $json[\"query\"][\"name\"] }},</h3>\n  <p style=\"Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;line-height:27px;color:#2D3142;font-size:18px\"><br><br> Email n√†y ƒë·ªÉ mu·ªën nh·∫Øc b·∫°n v·ªÅ bu·ªïi workshop  <strong>\"L·∫≠p K·∫ø Ho·∫°ch JBP tr√™n E-commerce\"</strong> s·∫Øp di·ªÖn ra v√†o cu·ªëi tu·∫ßn n√†y. ƒê√¢y l√† m·ªôt bu·ªïi workshop r·∫•t th√∫ v·ªã ƒë·ªÉ ch√∫ng ta c√≥ th·ªÉ c√πng nhau h·ªçc h·ªèi v√† trau d·ªìi ki·∫øn th·ª©c v·ªÅ ch·ªß ƒë·ªÅ n√†y.\n   <br><br>Bu·ªïi workshop s·∫Ω di·ªÖn ra t·∫°i ƒë·ªãa ƒëi·ªÉm sau ƒë√¢y:\n   <br> <br><strong>T·∫ßng 8, The Flemington Tower, 182 L√™ ƒê·∫°i H√†nh, Ph∆∞·ªùng 15, Qu·∫≠n 11, TP.HCM\n    <br> <i>(c√≥ b√£i ƒë·ªó xe oto, xe m√°y ngay trong t√≤a nh√†)</i>\n    <br> <br><mark style=\"background-color: yellow; color: black;\">Th·ªùi gian: Th·ª© 7, ng√†y 01/07/2023, 9:00 - 12:00</mark></strong>\n  <br><br>\n ƒê·ª´ng qu√™n ƒë·∫øn ƒë√∫ng gi·ªù ƒë·ªÉ ch√∫ng ta c√≥ th·ªÉ b·∫Øt ƒë·∫ßu bu·ªïi workshop m·ªôt c√°ch su√¥n s·∫ª v√† hi·ªáu qu·∫£.\n  <br><br>\n      <h3 style=\"Margin:0;line-height:34px;mso-line-height-rule:exactly;font-size:28px;font-style:normal;font-weight:bold;color:#2D3142\">Thank you and see you there...</h3>\n \n</tr>\n</table>\n<table cellpadding=\"0\" cellspacing=\"0\" class=\"es-content\" align=\"center\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;table-layout:fixed !important;width:100%\">\n<tr>\n<td align=\"center\" style=\"padding:0;Margin:0\">\n<table bgcolor=\"#efefef\" class=\"es-content-body\" align=\"center\" cellpadding=\"0\" cellspacing=\"0\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;background-color:#EFEFEF;width:600px\">\n<tr>\n<td align=\"left\" style=\"Margin:0;padding-top:30px;padding-bottom:40px;padding-left:40px;padding-right:40px\">\n<table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\">\n<tr>\n<td align=\"center\" valign=\"top\" style=\"padding:0;Margin:0;width:520px\">\n<table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" role=\"presentation\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\">\n<tr>\n<td align=\"center\" style=\"padding:0;Margin:0\"><!--[if mso]><a href=\"\" target=\"_blank\" hidden>\n<v:roundrect xmlns:v=\"urn:schemas-microsoft-com:vml\" xmlns:w=\"urn:schemas-microsoft-com:office:word\" esdevVmlButton href=\"\"\nstyle=\"height:56px; v-text-anchor:middle; width:520px\" arcsize=\"50%\" stroke=\"f\" fillcolor=\"#7630f3\">\n<w:anchorlock></w:anchorlock>\n<center style='color:#ffffff; font-family:Futura, Arial, sans-serif; font-size:22px; font-weight:700; line-height:22px; mso-text-raise:1px'>Take a Test</center>\n</v:roundrect></a>\n<![endif]--><!--[if !mso]><!-- -->\n  \n</form>\n<!--<![endif]--></td>\n</tr>\n</table></td>\n</tr>\n</table></td>\n</tr>\n</table>\n<table cellpadding=\"0\" cellspacing=\"0\" class=\"es-content\" align=\"center\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;table-layout:fixed !important;width:100%\">\n<tr>\n<td align=\"center\" style=\"padding:0;Margin:0\">\n<table bgcolor=\"#efefef\" class=\"es-content-body\" align=\"center\" cellpadding=\"0\" cellspacing=\"0\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;background-color:#EFEFEF;border-radius:0 0 20px 20px;width:600px\">\n<tr>\n<td class=\"esdev-adapt-off\" align=\"left\" style=\"Margin:0;padding-top:20px;padding-bottom:20px;padding-left:40px;padding-right:40px\">\n<table cellpadding=\"0\" cellspacing=\"0\" class=\"esdev-mso-table\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;width:520px\">\n<tr>\n<td class=\"esdev-mso-td\" valign=\"top\" style=\"padding:0;Margin:0\">\n<table cellpadding=\"0\" cellspacing=\"0\" align=\"left\" class=\"es-left\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;float:left\">\n<tr>\n<td align=\"center\" valign=\"top\" style=\"padding:0;Margin:0;width:47px\">\n<table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" role=\"presentation\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\">\n<tr>\n<td align=\"center\" class=\"es-m-txt-l\" style=\"padding:0;Margin:0;font-size:0px\"><a target=\"_blank\" href=\"https://viewstripo.email\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:underline;color:#2D3142;font-size:18px\"><img src=\"https://dnsfnr.stripocdn.email/content/guids/CABINET_ee77850a5a9f3068d9355050e69c76d26d58c3ea2927fa145f0d7a894e624758/images/group_4076325.png\" alt=\"Demo\" style=\"display:block;border:0;outline:none;text-decoration:none;-ms-interpolation-mode:bicubic\" width=\"37\" title=\"Demo\"></a></td>\n</tr>\n</table></td>\n</tr>\n</table></td>\n<td style=\"padding:0;Margin:0;width:20px\"></td>\n<td class=\"esdev-mso-td\" valign=\"top\" style=\"padding:0;Margin:0\">\n<table cellpadding=\"0\" cellspacing=\"0\" class=\"es-right\" align=\"right\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;float:right\">\n<tr>\n<td align=\"center\" valign=\"top\" style=\"padding:0;Margin:0;width:453px\">\n<table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" role=\"presentation\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\">\n<tr>\n<td align=\"left\" style=\"padding:0;Margin:0\"><p style=\"Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family::Futura, Arial, sans-serif;line-height:32px;color:#2D3142;font-size:16px\">If you have any questions, contact us via any channel below!</p></td>\n</tr>\n</table></td>\n</tr>\n</table></td>\n</tr>\n</table></td>\n</tr>\n</table></td>\n</tr>\n</table>\n<table cellpadding=\"0\" cellspacing=\"0\" class=\"es-footer\" align=\"center\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;table-layout:fixed !important;width:100%;background-color:transparent;background-repeat:repeat;background-position:center top\">\n<tr>\n<td align=\"center\" style=\"padding:0;Margin:0\">\n<table bgcolor=\"#bcb8b1\" class=\"es-footer-body\" align=\"center\" cellpadding=\"0\" cellspacing=\"0\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;background-color:#FFFFFF;width:600px\">\n<tr>\n<td align=\"left\" style=\"Margin:0;padding-left:20px;padding-right:20px;padding-bottom:30px;padding-top:40px\">\n<table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\">\n<tr>\n<td align=\"left\" style=\"padding:0;Margin:0;width:560px\">\n<table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" role=\"presentation\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\">\n<tr>\n<td align=\"center\" class=\"es-m-txt-c\" style=\"padding:0;Margin:0;padding-top:10px;padding-bottom:20px;font-size:0\">\n<table cellpadding=\"0\" cellspacing=\"0\" class=\"es-table-not-adapt es-social\" role=\"presentation\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\">\n<tr>\n<td align=\"center\" valign=\"top\" style=\"padding:0;Margin:0\"><a target=\"_blank\" href=\"https://www.facebook.com/mieu.vn\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:underline;color:#2D3142;font-size:14px\"><img src=\"https://dnsfnr.stripocdn.email/content/assets/img/social-icons/logo-black/facebook-logo-black.png\" alt=\"Fb\" title=\"Facebook\" height=\"24\" style=\"display:block;border:0;outline:none;text-decoration:none;-ms-interpolation-mode:bicubic\"></a></td>\n<td align=\"center\" valign=\"top\" style=\"padding:0;Margin:0\"><a target=\"_blank\" href=\"mailto:training.beegrowth@mieu.vn?subject=Get%20Support%20from%20Test%20Invited\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:underline;color:#2D3142;font-size:14px\"><img src=\"https://dnsfnr.stripocdn.email/content/assets/img/other-icons/logo-black/mail-logo-black.png\" alt=\"Email\" title=\"Email\" height=\"24\" style=\"display:block;border:0;outline:none;text-decoration:none;-ms-interpolation-mode:bicubic\"></a></td>\n<td align=\"center\" valign=\"top\" style=\"padding:0;Margin:0\"><a target=\"_blank\" href=\"https://goo.gl/maps/RLUQ3G8dHg35Bfto8\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:underline;color:#2D3142;font-size:14px\"><img src=\"https://dnsfnr.stripocdn.email/content/assets/img/other-icons/logo-black/location-logo-black.png\" alt=\"Map Marker\" title=\"Map Marker\" height=\"24\" style=\"display:block;border:0;outline:none;text-decoration:none;-ms-interpolation-mode:bicubic\"></a></td>\n<td align=\"center\" valign=\"top\" style=\"padding:0;Margin:0\"><a target=\"_blank\" href=\"tel:0905033554\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:underline;color:#2D3142;font-size:14px\"><img src=\"https://dnsfnr.stripocdn.email/content/assets/img/other-icons/logo-black/phone-logo-black.png\" alt=\"Phone\" title=\"Phone\" height=\"24\" style=\"display:block;border:0;outline:none;text-decoration:none;-ms-interpolation-mode:bicubic\"></a></td>\n<td align=\"center\" valign=\"top\" style=\"padding:0;Margin:0\"><a target=\"_blank\" href=\"https://goo.gl/maps/RLUQ3G8dHg35Bfto8\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:underline;color:#2D3142;font-size:14px\"><img src=\"https://dnsfnr.stripocdn.email/content/assets/img/other-icons/logo-black/googlebusiness-logo-black.png\" alt=\"Google Business\" title=\"Google Business\" height=\"24\" style=\"display:block;border:0;outline:none;text-decoration:none;-ms-interpolation-mode:bicubic\"></a></td>\n</tr>\n</table></td>\n</tr>\n<tr>\n<td align=\"center\" style=\"padding:0;Margin:0\"><p style=\"Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:Futura, Arial, sans-serif; font-size:22px; font-weight:700; line-height:22px; mso-text-raise:1px;color:#2D3142;font-size:13px\"><a target=\"_blank\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:none;color:#2D3142;font-size:14px\" href=\"\"></a><a target=\"_blank\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:none;color:#2D3142;font-size:14px\" href=\"\">Privacy Policy</a><a target=\"_blank\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:none;color:#2D3142;font-size:13px\" href=\"\"></a> ‚Ä¢ <a target=\"_blank\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:none;color:#2D3142;font-size:14px\" href=\"\">Unsubscribe</a></p></td>\n</tr>\n<tr>\n<td align=\"center\" style=\"padding:0;Margin:0;padding-top:20px\"><p style=\"Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:Futura, Arial, sans-serif;line-height:21px;color:#2D3142;font-size:14px\"><a target=\"_blank\" href=\"\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:underline;color:#2D3142;font-size:14px\"></a>Copyright ¬© BeeGrowth 2023&nbsp <a target=\"_blank\" href=\"\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:underline;color:#2D3142;font-size:14px\"></a></p></td>\n</tr>\n</table></td>\n</tr>\n</table></td>\n</tr>\n</table></td>\n</tr>\n</table></td>\n</tr>\n</table>\n</div>\n</body>\n</html>\n\n\n","options":{"allowUnauthorizedCerts":false}},"name":"Send Email","type":"n8n-nodes-base.emailSend","position":[640,320],"typeVersion":1,"id":"b0cf2065-9a29-4ec5-9d65-a125f595302c","credentials":{"smtp":{"id":"63","name":"Training.beegrowth@mieu.vn"}}},{"parameters":{"httpMethod":"POST","path":"reminder-email","options":{}},"id":"045e606e-3c5a-44f9-b467-4a70f8f79c2d","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[480,320],"webhookId":"a82b5769-45d3-45a5-afb0-9fdc3f3a518f"}],"connections":{"Webhook":{"main":[[{"node":"Send Email","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{},"versionId":"1fed6eba-4af8-4705-b897-ad95926b27bb","triggerCount":1,"tags":[{"createdAt":"2023-06-29T01:38:22.174Z","updatedAt":"2023-06-29T01:38:22.174Z","id":"21","name":"email"},{"createdAt":"2023-06-29T01:38:33.969Z","updatedAt":"2023-06-29T01:38:33.969Z","id":"22","name":"beegrowth"}]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-06-29T06:59:35.932Z","updatedAt":"2023-06-30T13:13:56.000Z","id":"153","name":"Send Sorry Email - BeeGrowth","active":false,"nodes":[{"parameters":{"fromEmail":"BeeGrowth Training<training.beegrowth@mieu.vn>","toEmail":"={{ $json[\"query\"][\"email\"] }}","subject":"[BeeGrowth] Th√¥ng b√°o Bu·ªïi workshop ƒë√£ h·∫øt ch·ªó ","html":"=<!DOCTYPE html>\n<html xmlns=\"http://www.w3.org/1999/xhtml\" xmlns:o=\"urn:schemas-microsoft-com:office:office\" style=\"font-family: 'Futura', Arial, 'Helvetica Neue', Helvetica, sans-serif;\">\n<head>\n<meta charset=\"UTF-8\">\n<meta content=\"width=device-width, initial-scale=1\" name=\"viewport\">\n<meta name=\"x-apple-disable-message-reformatting\">\n<meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\n<meta content=\"telephone=no\" name=\"format-detection\">\n<style type=\"text/css\">\na {text-decoration: none;}\np {font-family: 'Futura', Arial, 'Helvetica Neue', Helvetica, sans-serif;}\n</style>\n<!--[endif]--><!--[if gte mso 9]><style>sup { font-size: 100% !important; }</style><![endif]--><!--[if gte mso 9]>\n<xml>\n<o:OfficeDocumentSettings>\n<o:AllowPNG></o:AllowPNG>\n<o:PixelsPerInch>96</o:PixelsPerInch>\n</o:OfficeDocumentSettings>\n</xml>\n<![endif]--><!--[if !mso]><!-- -->\n<link href=\"https://fonts.googleapis.com/css2?family=Imprima&display=swap\" rel=\"stylesheet\"><!--<![endif]-->\n<style type=\"text/css\">\n#outlook a {\npadding:0;\n}\n.es-button {\nmso-style-priority:100!important;\ntext-decoration:none!important;\n}\na[x-apple-data-detectors] {\ncolor:inherit!important;\ntext-decoration:none!important;\nfont-size:inherit!important;\nfont-family:inherit!important;\nfont-weight:inherit!important;\nline-height:inherit!important;\n}\n.es-desk-hidden {\ndisplay:none;\nfloat:left;\noverflow:hidden;\nwidth:0;\nmax-height:0;\nline-height:0;\nmso-hide:all;\n}\n.btn-link {\n    border: none;\n    outline: none;\n    background: none;\n    cursor: pointer;\n    color: #0000EE;\n    padding: 0;\n    text-decoration: underline;\n    font-family: inherit;\n    font-size: inherit;\n}\n@media only screen and (max-width:600px) {p, ul li, ol li, a { line-height:150%!important } h1, h2, h3, h1 a, h2 a, h3 a { line-height:120% } h1 { font-size:30px!important; text-align:left } h2 { font-size:24px!important; text-align:left } h3 { font-size:20px!important; text-align:left } .es-header-body h1 a, .es-content-body h1 a, .es-footer-body h1 a { font-size:30px!important; text-align:left } .es-header-body h2 a, .es-content-body h2 a, .es-footer-body h2 a { font-size:24px!important; text-align:left } .es-header-body h3 a, .es-content-body h3 a, .es-footer-body h3 a { font-size:20px!important; text-align:left } .es-menu td a { font-size:14px!important } .es-header-body p, .es-header-body ul li, .es-header-body ol li, .es-header-body a { font-size:14px!important } .es-content-body p, .es-content-body ul li, .es-content-body ol li, .es-content-body a { font-size:14px!important } .es-footer-body p, .es-footer-body ul li, .es-footer-body ol li.\n</style>\n</head>\n<body data-new-gr-c-s-loaded=\"14.1101.0\" style=\"width:100%;font-family:arial, 'helvetica neue', helvetica, sans-serif;-webkit-text-size-adjust:100%;-ms-text-size-adjust:100%;padding:0;Margin:0\">\n<div class=\"es-wrapper-color\" style=\"background-color:#FFFFFF\"><!--[if gte mso 9]>\n<v:background xmlns:v=\"urn:schemas-microsoft-com:vml\" fill=\"t\">\n<v:fill type=\"tile\" color=\"#ffffff\"></v:fill>\n</v:background>\n<![endif]-->\n<table class=\"es-wrapper\" width=\"100%\" cellspacing=\"0\" cellpadding=\"0\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;padding:0;Margin:0;width:100%;height:100%;background-repeat:repeat;background-position:center top;background-color:#FFFFFF\">\n<tr>\n<td valign=\"top\" style=\"padding:0;Margin:0\">\n<table cellpadding=\"0\" cellspacing=\"0\" class=\"es-content\" align=\"center\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;table-layout:fixed !important;width:100%\">\n<tr>\n<td align=\"center\" style=\"padding:0;Margin:0\">\n<table bgcolor=\"#efefef\" class=\"es-content-body\" align=\"center\" cellpadding=\"0\" cellspacing=\"0\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;background-color:#EFEFEF;border-radius:20px 20px 0 0;width:600px\">\n<tr>\n<td align=\"left\" style=\"padding:0;Margin:0;padding-top:40px;padding-left:40px;padding-right:40px\">\n<table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\">\n<tr>\n<td align=\"center\" valign=\"top\" style=\"padding:0;Margin:0;width:520px\">\n<table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" role=\"presentation\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\">\n<tr>\n<td align=\"center\" style=\"padding:0;Margin:0;font-size:0px\"><a target=\"_blank\" href=\"https://www.mieu.vn\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:underline;color:#2D3142;font-size:18px\"><a href=\"https://ibb.co/5rczw4F\">\n  <img src=\"https://i.ibb.co/Stv1Gyr/BEEGROWTH-LOGO-1.png\" alt=\"BEEGROWTH-LOGO-1\" border=\"0\" style=\"width: 60%; height: auto;\">\n  \n</a>\n </tr>\n  \n</table></td>\n</tr>\n</table></td>\n</tr>\n<tr>\n<td align=\"left\" style=\"padding:20px;Margin:0;font-family:Futura, Arial, sans-serif;\">\n  <br><br> <h3 style=\"Margin:0;line-height:34px;mso-line-height-rule:exactly;font-size:28px;font-style:normal;font-weight:bold;color:#2D3142\">Oppps..Sorry {{ $json[\"query\"][\"name\"] }},</h3>\n  <p style=\"Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;line-height:27px;color:#2D3142;font-size:18px\"><br><br> R·∫•t ti·∫øc v√¨ ƒë√£ ph·∫£i g·ª≠i email n√†y ƒë·∫øn b·∫°n. ƒê∆∞·ª£c bi·∫øt r·∫±ng b·∫°n ƒë√£ ƒëƒÉng k√Ω tham gia bu·ªïi workshop<strong>\"L·∫≠p K·∫ø Ho·∫°ch JBP tr√™n E-commerce\"</strong> nh∆∞ng <I><mark style=\"background-color: yellow; color: black;\"> ch∆∞a thanh to√°n</mark></I>. <br><br>Hi·ªán t·∫°i Workshop ƒë√£ ƒë·∫ßy ch·ªó v√† kh√¥ng th·ªÉ ti·∫øp nh·∫≠n th√™m ƒëƒÉng k√Ω n√†o n·ªØa.  \n  \n <br><br>\nMong r·∫±ng b·∫°n s·∫Ω c√≥ th·ªÉ tham gia c√°c s·ª± ki·ªán kh√°c trong t∆∞∆°ng lai c·ªßa ch√∫ng t√¥i. M·ªôt l·∫ßn n·ªØa, m√¨nh xin l·ªói v√¨ s·ª± b·∫•t ti·ªán n√†y v√† c·∫£m ∆°n b·∫°n ƒë√£ quan t√¢m ƒë·∫øn bu·ªïi workshop c·ªßa ch√∫ng t√¥i.\n <br><br>\n <h3 style=\"Margin:0;line-height:34px;mso-line-height-rule:exactly;font-size:28px;font-style:normal;font-weight:bold;color:#2D3142\">Sorry and hope to see you next time...</h3>\n \n</tr>\n</table>\n<table cellpadding=\"0\" cellspacing=\"0\" class=\"es-content\" align=\"center\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;table-layout:fixed !important;width:100%\">\n<tr>\n<td align=\"center\" style=\"padding:0;Margin:0\">\n<table bgcolor=\"#efefef\" class=\"es-content-body\" align=\"center\" cellpadding=\"0\" cellspacing=\"0\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;background-color:#EFEFEF;width:600px\">\n<tr>\n<td align=\"left\" style=\"Margin:0;padding-top:30px;padding-bottom:40px;padding-left:40px;padding-right:40px\">\n<table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\">\n<tr>\n<td align=\"center\" valign=\"top\" style=\"padding:0;Margin:0;width:520px\">\n<table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" role=\"presentation\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\">\n<tr>\n<td align=\"center\" style=\"padding:0;Margin:0\"><!--[if mso]><a href=\"\" target=\"_blank\" hidden>\n<v:roundrect xmlns:v=\"urn:schemas-microsoft-com:vml\" xmlns:w=\"urn:schemas-microsoft-com:office:word\" esdevVmlButton href=\"\"\nstyle=\"height:56px; v-text-anchor:middle; width:520px\" arcsize=\"50%\" stroke=\"f\" fillcolor=\"#7630f3\">\n<w:anchorlock></w:anchorlock>\n<center style='color:#ffffff; font-family:Futura, Arial, sans-serif; font-size:22px; font-weight:700; line-height:22px; mso-text-raise:1px'>Take a Test</center>\n</v:roundrect></a>\n<![endif]--><!--[if !mso]><!-- -->\n  \n</form>\n<!--<![endif]--></td>\n</tr>\n</table></td>\n</tr>\n</table></td>\n</tr>\n</table>\n<table cellpadding=\"0\" cellspacing=\"0\" class=\"es-content\" align=\"center\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;table-layout:fixed !important;width:100%\">\n<tr>\n<td align=\"center\" style=\"padding:0;Margin:0\">\n<table bgcolor=\"#efefef\" class=\"es-content-body\" align=\"center\" cellpadding=\"0\" cellspacing=\"0\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;background-color:#EFEFEF;border-radius:0 0 20px 20px;width:600px\">\n<tr>\n<td class=\"esdev-adapt-off\" align=\"left\" style=\"Margin:0;padding-top:20px;padding-bottom:20px;padding-left:40px;padding-right:40px\">\n<table cellpadding=\"0\" cellspacing=\"0\" class=\"esdev-mso-table\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;width:520px\">\n<tr>\n<td class=\"esdev-mso-td\" valign=\"top\" style=\"padding:0;Margin:0\">\n<table cellpadding=\"0\" cellspacing=\"0\" align=\"left\" class=\"es-left\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;float:left\">\n<tr>\n<td align=\"center\" valign=\"top\" style=\"padding:0;Margin:0;width:47px\">\n<table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" role=\"presentation\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\">\n<tr>\n<td align=\"center\" class=\"es-m-txt-l\" style=\"padding:0;Margin:0;font-size:0px\"><a target=\"_blank\" href=\"https://viewstripo.email\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:underline;color:#2D3142;font-size:18px\"><img src=\"https://dnsfnr.stripocdn.email/content/guids/CABINET_ee77850a5a9f3068d9355050e69c76d26d58c3ea2927fa145f0d7a894e624758/images/group_4076325.png\" alt=\"Demo\" style=\"display:block;border:0;outline:none;text-decoration:none;-ms-interpolation-mode:bicubic\" width=\"37\" title=\"Demo\"></a></td>\n</tr>\n</table></td>\n</tr>\n</table></td>\n<td style=\"padding:0;Margin:0;width:20px\"></td>\n<td class=\"esdev-mso-td\" valign=\"top\" style=\"padding:0;Margin:0\">\n<table cellpadding=\"0\" cellspacing=\"0\" class=\"es-right\" align=\"right\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;float:right\">\n<tr>\n<td align=\"center\" valign=\"top\" style=\"padding:0;Margin:0;width:453px\">\n<table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" role=\"presentation\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\">\n<tr>\n<td align=\"left\" style=\"padding:0;Margin:0\"><p style=\"Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family::Futura, Arial, sans-serif;line-height:32px;color:#2D3142;font-size:16px\">If you have any questions, contact us via any channel below!</p></td>\n</tr>\n</table></td>\n</tr>\n</table></td>\n</tr>\n</table></td>\n</tr>\n</table></td>\n</tr>\n</table>\n<table cellpadding=\"0\" cellspacing=\"0\" class=\"es-footer\" align=\"center\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;table-layout:fixed !important;width:100%;background-color:transparent;background-repeat:repeat;background-position:center top\">\n<tr>\n<td align=\"center\" style=\"padding:0;Margin:0\">\n<table bgcolor=\"#bcb8b1\" class=\"es-footer-body\" align=\"center\" cellpadding=\"0\" cellspacing=\"0\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;background-color:#FFFFFF;width:600px\">\n<tr>\n<td align=\"left\" style=\"Margin:0;padding-left:20px;padding-right:20px;padding-bottom:30px;padding-top:40px\">\n<table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\">\n<tr>\n<td align=\"left\" style=\"padding:0;Margin:0;width:560px\">\n<table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" role=\"presentation\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\">\n<tr>\n<td align=\"center\" class=\"es-m-txt-c\" style=\"padding:0;Margin:0;padding-top:10px;padding-bottom:20px;font-size:0\">\n<table cellpadding=\"0\" cellspacing=\"0\" class=\"es-table-not-adapt es-social\" role=\"presentation\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\">\n<tr>\n<td align=\"center\" valign=\"top\" style=\"padding:0;Margin:0\"><a target=\"_blank\" href=\"https://www.facebook.com/mieu.vn\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:underline;color:#2D3142;font-size:14px\"><img src=\"https://dnsfnr.stripocdn.email/content/assets/img/social-icons/logo-black/facebook-logo-black.png\" alt=\"Fb\" title=\"Facebook\" height=\"24\" style=\"display:block;border:0;outline:none;text-decoration:none;-ms-interpolation-mode:bicubic\"></a></td>\n<td align=\"center\" valign=\"top\" style=\"padding:0;Margin:0\"><a target=\"_blank\" href=\"mailto:training.beegrowth@mieu.vn?subject=Get%20Support%20from%20Test%20Invited\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:underline;color:#2D3142;font-size:14px\"><img src=\"https://dnsfnr.stripocdn.email/content/assets/img/other-icons/logo-black/mail-logo-black.png\" alt=\"Email\" title=\"Email\" height=\"24\" style=\"display:block;border:0;outline:none;text-decoration:none;-ms-interpolation-mode:bicubic\"></a></td>\n<td align=\"center\" valign=\"top\" style=\"padding:0;Margin:0\"><a target=\"_blank\" href=\"https://goo.gl/maps/RLUQ3G8dHg35Bfto8\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:underline;color:#2D3142;font-size:14px\"><img src=\"https://dnsfnr.stripocdn.email/content/assets/img/other-icons/logo-black/location-logo-black.png\" alt=\"Map Marker\" title=\"Map Marker\" height=\"24\" style=\"display:block;border:0;outline:none;text-decoration:none;-ms-interpolation-mode:bicubic\"></a></td>\n<td align=\"center\" valign=\"top\" style=\"padding:0;Margin:0\"><a target=\"_blank\" href=\"tel:0905033554\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:underline;color:#2D3142;font-size:14px\"><img src=\"https://dnsfnr.stripocdn.email/content/assets/img/other-icons/logo-black/phone-logo-black.png\" alt=\"Phone\" title=\"Phone\" height=\"24\" style=\"display:block;border:0;outline:none;text-decoration:none;-ms-interpolation-mode:bicubic\"></a></td>\n<td align=\"center\" valign=\"top\" style=\"padding:0;Margin:0\"><a target=\"_blank\" href=\"https://goo.gl/maps/RLUQ3G8dHg35Bfto8\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:underline;color:#2D3142;font-size:14px\"><img src=\"https://dnsfnr.stripocdn.email/content/assets/img/other-icons/logo-black/googlebusiness-logo-black.png\" alt=\"Google Business\" title=\"Google Business\" height=\"24\" style=\"display:block;border:0;outline:none;text-decoration:none;-ms-interpolation-mode:bicubic\"></a></td>\n</tr>\n</table></td>\n</tr>\n<tr>\n<td align=\"center\" style=\"padding:0;Margin:0\"><p style=\"Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:Futura, Arial, sans-serif; font-size:22px; font-weight:700; line-height:22px; mso-text-raise:1px;color:#2D3142;font-size:13px\"><a target=\"_blank\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:none;color:#2D3142;font-size:14px\" href=\"\"></a><a target=\"_blank\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:none;color:#2D3142;font-size:14px\" href=\"\">Privacy Policy</a><a target=\"_blank\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:none;color:#2D3142;font-size:13px\" href=\"\"></a> ‚Ä¢ <a target=\"_blank\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:none;color:#2D3142;font-size:14px\" href=\"\">Unsubscribe</a></p></td>\n</tr>\n<tr>\n<td align=\"center\" style=\"padding:0;Margin:0;padding-top:20px\"><p style=\"Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:Futura, Arial, sans-serif;line-height:21px;color:#2D3142;font-size:14px\"><a target=\"_blank\" href=\"\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:underline;color:#2D3142;font-size:14px\"></a>Copyright ¬© BeeGrowth 2023&nbsp <a target=\"_blank\" href=\"\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:underline;color:#2D3142;font-size:14px\"></a></p></td>\n</tr>\n</table></td>\n</tr>\n</table></td>\n</tr>\n</table></td>\n</tr>\n</table></td>\n</tr>\n</table>\n</div>\n</body>\n</html>\n\n\n","options":{"allowUnauthorizedCerts":false}},"name":"Send Email","type":"n8n-nodes-base.emailSend","position":[640,320],"typeVersion":1,"id":"17ac71fa-bc1b-4f5a-b05d-0e5c2699e074","credentials":{"smtp":{"id":"63","name":"Training.beegrowth@mieu.vn"}}},{"parameters":{"httpMethod":"POST","path":"sorry-email","options":{}},"id":"75dd083c-a2d1-4fee-ae61-3a7807aac384","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[480,320],"webhookId":"55cdc93b-1215-4ce5-9456-bdb677e7bdda"}],"connections":{"Webhook":{"main":[[{"node":"Send Email","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{},"versionId":"24b689ab-1955-49d4-b47e-c3fbd06db138","triggerCount":1,"tags":[{"createdAt":"2023-06-29T01:38:22.174Z","updatedAt":"2023-06-29T01:38:22.174Z","id":"21","name":"email"},{"createdAt":"2023-06-29T01:38:33.969Z","updatedAt":"2023-06-29T01:38:33.969Z","id":"22","name":"beegrowth"},{"createdAt":"2023-06-29T06:59:28.810Z","updatedAt":"2023-06-29T06:59:28.810Z","id":"23","name":"sorry"}]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-06-30T13:19:20.503Z","updatedAt":"2023-07-26T04:01:22.000Z","id":"155","name":"Send Reminder Confirmation Venue+ timing email via training.Beegrowth","active":false,"nodes":[{"parameters":{"fromEmail":"BeeGrowth Training<training.beegrowth@mieu.vn>","toEmail":"={{ $json[\"query\"][\"email\"] }}","subject":"[BeeGrowth] Download T√†i Li·ªáu Chia S·∫Ω bu·ªïi Workshop ","html":"=<a href=\"\"><!DOCTYPE html>\n<html xmlns=\"http://www.w3.org/1999/xhtml\" xmlns:o=\"urn:schemas-microsoft-com:office:office\" style=\"font-family: 'Futura', Arial, 'Helvetica Neue', Helvetica, sans-serif;\">\n<head>\n<meta charset=\"UTF-8\">\n<meta content=\"width=device-width, initial-scale=1\" name=\"viewport\">\n<meta name=\"x-apple-disable-message-reformatting\">\n<meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\n<meta content=\"telephone=no\" name=\"format-detection\">\n<style type=\"text/css\">\na {text-decoration: none;}\np {font-family: 'Futura', Arial, 'Helvetica Neue', Helvetica, sans-serif;}\n</style>\n<!--[endif]--><!--[if gte mso 9]><style>sup { font-size: 100% !important; }</style><![endif]--><!--[if gte mso 9]>\n<xml>\n<o:OfficeDocumentSettings>\n<o:AllowPNG></o:AllowPNG>\n<o:PixelsPerInch>96</o:PixelsPerInch>\n</o:OfficeDocumentSettings>\n</xml>\n<![endif]--><!--[if !mso]><!-- -->\n<link href=\"https://fonts.googleapis.com/css2?family=Imprima&display=swap\" rel=\"stylesheet\"><!--<![endif]-->\n<style type=\"text/css\">\n#outlook a {\npadding:0;\n}\n.es-button {\nmso-style-priority:100!important;\ntext-decoration:none!important;\n}\na[x-apple-data-detectors] {\ncolor:inherit!important;\ntext-decoration:none!important;\nfont-size:inherit!important;\nfont-family:inherit!important;\nfont-weight:inherit!important;\nline-height:inherit!important;\n}\n.es-desk-hidden {\ndisplay:none;\nfloat:left;\noverflow:hidden;\nwidth:0;\nmax-height:0;\nline-height:0;\nmso-hide:all;\n}\n.btn-link {\n    border: none;\n    outline: none;\n    background: none;\n    cursor: pointer;\n    color: #0000EE;\n    padding: 0;\n    text-decoration: underline;\n    font-family: inherit;\n    font-size: inherit;\n}\n@media only screen and (max-width:600px) {p, ul li, ol li, a { line-height:150%!important } h1, h2, h3, h1 a, h2 a, h3 a { line-height:120% } h1 { font-size:30px!important; text-align:left } h2 { font-size:24px!important; text-align:left } h3 { font-size:20px!important; text-align:left } .es-header-body h1 a, .es-content-body h1 a, .es-footer-body h1 a { font-size:30px!important; text-align:left } .es-header-body h2 a, .es-content-body h2 a, .es-footer-body h2 a { font-size:24px!important; text-align:left } .es-header-body h3 a, .es-content-body h3 a, .es-footer-body h3 a { font-size:20px!important; text-align:left } .es-menu td a { font-size:14px!important } .es-header-body p, .es-header-body ul li, .es-header-body ol li, .es-header-body a { font-size:14px!important } .es-content-body p, .es-content-body ul li, .es-content-body ol li, .es-content-body a { font-size:14px!important } .es-footer-body p, .es-footer-body ul li, .es-footer-body ol li.\n</style>\n</head>\n<body data-new-gr-c-s-loaded=\"14.1101.0\" style=\"width:100%;font-family:arial, 'helvetica neue', helvetica, sans-serif;-webkit-text-size-adjust:100%;-ms-text-size-adjust:100%;padding:0;Margin:0\">\n<div class=\"es-wrapper-color\" style=\"background-color:#FFFFFF\"><!--[if gte mso 9]>\n<v:background xmlns:v=\"urn:schemas-microsoft-com:vml\" fill=\"t\">\n<v:fill type=\"tile\" color=\"#ffffff\"></v:fill>\n</v:background>\n<![endif]-->\n<table class=\"es-wrapper\" width=\"100%\" cellspacing=\"0\" cellpadding=\"0\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;padding:0;Margin:0;width:100%;height:100%;background-repeat:repeat;background-position:center top;background-color:#FFFFFF\">\n<tr>\n<td valign=\"top\" style=\"padding:0;Margin:0\">\n<table cellpadding=\"0\" cellspacing=\"0\" class=\"es-content\" align=\"center\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;table-layout:fixed !important;width:100%\">\n<tr>\n<td align=\"center\" style=\"padding:0;Margin:0\">\n<table bgcolor=\"#efefef\" class=\"es-content-body\" align=\"center\" cellpadding=\"0\" cellspacing=\"0\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;background-color:#EFEFEF;border-radius:20px 20px 0 0;width:600px\">\n<tr>\n<td align=\"left\" style=\"padding:0;Margin:0;padding-top:40px;padding-left:40px;padding-right:40px\">\n<table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\">\n<tr>\n<td align=\"center\" valign=\"top\" style=\"padding:0;Margin:0;width:520px\">\n<table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" role=\"presentation\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\">\n<tr>\n<td align=\"center\" style=\"padding:0;Margin:0;font-size:0px\"><a target=\"_blank\" href=\"https://www.mieu.vn\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:underline;color:#2D3142;font-size:18px\"><a href=\"https://ibb.co/5rczw4F\">\n  <img src=\"https://i.ibb.co/Stv1Gyr/BEEGROWTH-LOGO-1.png\" alt=\"BEEGROWTH-LOGO-1\" border=\"0\" style=\"width: 60%; height: auto;\">\n  \n</a>\n </tr>\n  \n</table></td>\n</tr>\n</table></td>\n</tr>\n<tr>\n<td align=\"left\" style=\"padding:20px;Margin:0;font-family:Futura, Arial, sans-serif;\">\n  <br><br> <h3 style=\"Margin:0;line-height:34px;mso-line-height-rule:exactly;font-size:28px;font-style:normal;font-weight:bold;color:#2D3142\">C√°m ∆°n {{ $json[\"query\"][\"name\"] }},</h3>\n  <p style=\"Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;line-height:27px;color:#2D3142;font-size:18px\"><br><br> C√°m ∆°n b·∫°n ƒë√£ tham d·ª± bu·ªïi workshop  <strong>\"L·∫≠p K·∫ø Ho·∫°ch JBP tr√™n E-commerce\"</strong>. \n   <br><br>B·∫°n vui l√≤ng download t√†i li·ªáu chia s·∫Ω t·∫°i ƒë∆∞·ªùng link b√™n d∆∞·ªõi:\n   <br> <br><strong><a title=\"\" href=\"https://we.tl/t-ZUkCxXaMvj\">T√ÄI LI·ªÜU DOWNLOAD</a> \n    <br> <br><mark style=\"background-color: yellow; color: black;\">Link s·∫Ω t·ªìn t·∫°i trong 7 ng√†y</mark></strong>\n  <br><br>\nTuy nhi√™n, v√¨ l√Ω do b·∫£o m·∫≠t v√† s·ª± t√¥n tr·ªçng b·∫£n quy·ªÅn, hy v·ªçng c√°c b·∫°n s·∫Ω gi·ªØ file ƒë√†o t·∫°o n√†y cho ri√™ng m√¨nh v√† kh√¥ng chia s·∫ª n√≥ v·ªõi b·∫•t k·ª≥ ai kh√°c, \n    <br><br>C·∫£m ∆°n c√°c b·∫°n ƒë√£ ƒë·ªìng h√†nh c√πng Team trong cu·ªôc h√†nh tr√¨nh h·ªçc t·∫≠p v√† ph√°t tri·ªÉn  <br><br>\n      <h3 style=\"Margin:0;line-height:34px;mso-line-height-rule:exactly;font-size:28px;font-style:normal;font-weight:bold;color:#2D3142\">Thank you and see you next time.</h3>\n \n</tr>\n</table>\n<table cellpadding=\"0\" cellspacing=\"0\" class=\"es-content\" align=\"center\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;table-layout:fixed !important;width:100%\">\n<tr>\n<td align=\"center\" style=\"padding:0;Margin:0\">\n<table bgcolor=\"#efefef\" class=\"es-content-body\" align=\"center\" cellpadding=\"0\" cellspacing=\"0\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;background-color:#EFEFEF;width:600px\">\n<tr>\n<td align=\"left\" style=\"Margin:0;padding-top:30px;padding-bottom:40px;padding-left:40px;padding-right:40px\">\n<table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\">\n<tr>\n<td align=\"center\" valign=\"top\" style=\"padding:0;Margin:0;width:520px\">\n<table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" role=\"presentation\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\">\n<tr>\n<td align=\"center\" style=\"padding:0;Margin:0\"><!--[if mso]><a href=\"\" target=\"_blank\" hidden>\n<v:roundrect xmlns:v=\"urn:schemas-microsoft-com:vml\" xmlns:w=\"urn:schemas-microsoft-com:office:word\" esdevVmlButton href=\"\"\nstyle=\"height:56px; v-text-anchor:middle; width:520px\" arcsize=\"50%\" stroke=\"f\" fillcolor=\"#7630f3\">\n<w:anchorlock></w:anchorlock>\n<center style='color:#ffffff; font-family:Futura, Arial, sans-serif; font-size:22px; font-weight:700; line-height:22px; mso-text-raise:1px'>Take a Test</center>\n</v:roundrect></a>\n<![endif]--><!--[if !mso]><!-- -->\n  \n</form>\n<!--<![endif]--></td>\n</tr>\n</table></td>\n</tr>\n</table></td>\n</tr>\n</table>\n<table cellpadding=\"0\" cellspacing=\"0\" class=\"es-content\" align=\"center\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;table-layout:fixed !important;width:100%\">\n<tr>\n<td align=\"center\" style=\"padding:0;Margin:0\">\n<table bgcolor=\"#efefef\" class=\"es-content-body\" align=\"center\" cellpadding=\"0\" cellspacing=\"0\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;background-color:#EFEFEF;border-radius:0 0 20px 20px;width:600px\">\n<tr>\n<td class=\"esdev-adapt-off\" align=\"left\" style=\"Margin:0;padding-top:20px;padding-bottom:20px;padding-left:40px;padding-right:40px\">\n<table cellpadding=\"0\" cellspacing=\"0\" class=\"esdev-mso-table\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;width:520px\">\n<tr>\n<td class=\"esdev-mso-td\" valign=\"top\" style=\"padding:0;Margin:0\">\n<table cellpadding=\"0\" cellspacing=\"0\" align=\"left\" class=\"es-left\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;float:left\">\n<tr>\n<td align=\"center\" valign=\"top\" style=\"padding:0;Margin:0;width:47px\">\n<table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" role=\"presentation\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\">\n<tr>\n<td align=\"center\" class=\"es-m-txt-l\" style=\"padding:0;Margin:0;font-size:0px\"><a target=\"_blank\" href=\"https://viewstripo.email\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:underline;color:#2D3142;font-size:18px\"><img src=\"https://dnsfnr.stripocdn.email/content/guids/CABINET_ee77850a5a9f3068d9355050e69c76d26d58c3ea2927fa145f0d7a894e624758/images/group_4076325.png\" alt=\"Demo\" style=\"display:block;border:0;outline:none;text-decoration:none;-ms-interpolation-mode:bicubic\" width=\"37\" title=\"Demo\"></a></td>\n</tr>\n</table></td>\n</tr>\n</table></td>\n<td style=\"padding:0;Margin:0;width:20px\"></td>\n<td class=\"esdev-mso-td\" valign=\"top\" style=\"padding:0;Margin:0\">\n<table cellpadding=\"0\" cellspacing=\"0\" class=\"es-right\" align=\"right\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;float:right\">\n<tr>\n<td align=\"center\" valign=\"top\" style=\"padding:0;Margin:0;width:453px\">\n<table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" role=\"presentation\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\">\n<tr>\n<td align=\"left\" style=\"padding:0;Margin:0\"><p style=\"Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family::Futura, Arial, sans-serif;line-height:32px;color:#2D3142;font-size:16px\">If you have any questions, contact us via any channel below!</p></td>\n</tr>\n</table></td>\n</tr>\n</table></td>\n</tr>\n</table></td>\n</tr>\n</table></td>\n</tr>\n</table>\n<table cellpadding=\"0\" cellspacing=\"0\" class=\"es-footer\" align=\"center\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;table-layout:fixed !important;width:100%;background-color:transparent;background-repeat:repeat;background-position:center top\">\n<tr>\n<td align=\"center\" style=\"padding:0;Margin:0\">\n<table bgcolor=\"#bcb8b1\" class=\"es-footer-body\" align=\"center\" cellpadding=\"0\" cellspacing=\"0\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;background-color:#FFFFFF;width:600px\">\n<tr>\n<td align=\"left\" style=\"Margin:0;padding-left:20px;padding-right:20px;padding-bottom:30px;padding-top:40px\">\n<table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\">\n<tr>\n<td align=\"left\" style=\"padding:0;Margin:0;width:560px\">\n<table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" role=\"presentation\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\">\n<tr>\n<td align=\"center\" class=\"es-m-txt-c\" style=\"padding:0;Margin:0;padding-top:10px;padding-bottom:20px;font-size:0\">\n<table cellpadding=\"0\" cellspacing=\"0\" class=\"es-table-not-adapt es-social\" role=\"presentation\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\">\n<tr>\n<td align=\"center\" valign=\"top\" style=\"padding:0;Margin:0\"><a target=\"_blank\" href=\"https://www.facebook.com/mieu.vn\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:underline;color:#2D3142;font-size:14px\"><img src=\"https://dnsfnr.stripocdn.email/content/assets/img/social-icons/logo-black/facebook-logo-black.png\" alt=\"Fb\" title=\"Facebook\" height=\"24\" style=\"display:block;border:0;outline:none;text-decoration:none;-ms-interpolation-mode:bicubic\"></a></td>\n<td align=\"center\" valign=\"top\" style=\"padding:0;Margin:0\"><a target=\"_blank\" href=\"mailto:training.beegrowth@mieu.vn?subject=Get%20Support%20from%20Test%20Invited\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:underline;color:#2D3142;font-size:14px\"><img src=\"https://dnsfnr.stripocdn.email/content/assets/img/other-icons/logo-black/mail-logo-black.png\" alt=\"Email\" title=\"Email\" height=\"24\" style=\"display:block;border:0;outline:none;text-decoration:none;-ms-interpolation-mode:bicubic\"></a></td>\n<td align=\"center\" valign=\"top\" style=\"padding:0;Margin:0\"><a target=\"_blank\" href=\"https://goo.gl/maps/RLUQ3G8dHg35Bfto8\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:underline;color:#2D3142;font-size:14px\"><img src=\"https://dnsfnr.stripocdn.email/content/assets/img/other-icons/logo-black/location-logo-black.png\" alt=\"Map Marker\" title=\"Map Marker\" height=\"24\" style=\"display:block;border:0;outline:none;text-decoration:none;-ms-interpolation-mode:bicubic\"></a></td>\n<td align=\"center\" valign=\"top\" style=\"padding:0;Margin:0\"><a target=\"_blank\" href=\"tel:0905033554\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:underline;color:#2D3142;font-size:14px\"><img src=\"https://dnsfnr.stripocdn.email/content/assets/img/other-icons/logo-black/phone-logo-black.png\" alt=\"Phone\" title=\"Phone\" height=\"24\" style=\"display:block;border:0;outline:none;text-decoration:none;-ms-interpolation-mode:bicubic\"></a></td>\n<td align=\"center\" valign=\"top\" style=\"padding:0;Margin:0\"><a target=\"_blank\" href=\"https://goo.gl/maps/RLUQ3G8dHg35Bfto8\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:underline;color:#2D3142;font-size:14px\"><img src=\"https://dnsfnr.stripocdn.email/content/assets/img/other-icons/logo-black/googlebusiness-logo-black.png\" alt=\"Google Business\" title=\"Google Business\" height=\"24\" style=\"display:block;border:0;outline:none;text-decoration:none;-ms-interpolation-mode:bicubic\"></a></td>\n</tr>\n</table></td>\n</tr>\n<tr>\n<td align=\"center\" style=\"padding:0;Margin:0\"><p style=\"Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:Futura, Arial, sans-serif; font-size:22px; font-weight:700; line-height:22px; mso-text-raise:1px;color:#2D3142;font-size:13px\"><a target=\"_blank\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:none;color:#2D3142;font-size:14px\" href=\"\"></a><a target=\"_blank\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:none;color:#2D3142;font-size:14px\" href=\"\">Privacy Policy</a><a target=\"_blank\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:none;color:#2D3142;font-size:13px\" href=\"\"></a> ‚Ä¢ <a target=\"_blank\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:none;color:#2D3142;font-size:14px\" href=\"\">Unsubscribe</a></p></td>\n</tr>\n<tr>\n<td align=\"center\" style=\"padding:0;Margin:0;padding-top:20px\"><p style=\"Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:Futura, Arial, sans-serif;line-height:21px;color:#2D3142;font-size:14px\"><a target=\"_blank\" href=\"\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:underline;color:#2D3142;font-size:14px\"></a>Copyright ¬© BeeGrowth 2023&nbsp <a target=\"_blank\" href=\"\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:underline;color:#2D3142;font-size:14px\"></a></p></td>\n</tr>\n</table></td>\n</tr>\n</table></td>\n</tr>\n</table></td>\n</tr>\n</table></td>\n</tr>\n</table>\n</div>\n</body>\n</html>\n\n\n","options":{"allowUnauthorizedCerts":false}},"name":"Send Email","type":"n8n-nodes-base.emailSend","position":[640,320],"typeVersion":1,"id":"3f0c3762-664d-485e-b4c5-d8209d78c402","credentials":{"smtp":{"id":"63","name":"Training.beegrowth@mieu.vn"}}},{"parameters":{"httpMethod":"POST","path":"gentle-reminder-email","options":{}},"id":"4aedfef5-bd90-4577-80c6-4518c6a1a97b","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[480,320],"webhookId":"b9ab0e0d-4ea5-44fc-9b75-5ea2f857a018"}],"connections":{"Webhook":{"main":[[{"node":"Send Email","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{},"versionId":"ea5b9bd8-394a-4eff-aafb-0b48814491c8","triggerCount":1,"tags":[{"createdAt":"2023-06-29T01:38:22.174Z","updatedAt":"2023-06-29T01:38:22.174Z","id":"21","name":"email"},{"createdAt":"2023-06-29T01:38:33.969Z","updatedAt":"2023-06-29T01:38:33.969Z","id":"22","name":"beegrowth"}]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-07-04T09:43:08.630Z","updatedAt":"2023-07-17T12:24:39.000Z","id":"156","name":"55Kitchen - Sync GGSheet (OK)","active":false,"nodes":[{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/auth/v3/app_access_token/internal","sendBody":true,"specifyBody":"json","jsonBody":"={\n    \"app_id\": \"cli_a41487bb51f8d02f\",\n    \"app_secret\": \"luOwRQprGDvMhz3pN8N4TeM6X8fnsTdR\"\n}","options":{}},"id":"22fd42fb-6961-456b-b197-b280c0293606","name":"HTTP Request - Lark Ternant","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[800,320]},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/bitable/v1/apps/Ev3cb0rrJamJansrYGllPsRwgre/tables/tblnyeeR1DXfqNIE/records","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $json.app_access_token }}"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\"fields\":{\"ü•£Order ID\":\"{{ $('ggsheet').item.json[\"OrderID\"] }}\",\"shopify_OrderIDAuth\":\"{{ $('ggsheet').item.json[\"OrderIDAuth\"] }}\",\"shopify_link\":\"{{ $('ggsheet').item.json[\"LinkShopify\"] }}\",\"shopify_CusFirstName\":\"{{ $('ggsheet').item.json[\"Firstname\"] }}\",\"shopify_CusLastName\":\"{{ $('ggsheet').item.json[\"Lastname\"] }}\",\"shopify_Cusphone\":\"{{ $('ggsheet').item.json[\"Phone\"] }}\",\"shopify_CusZalo\":\"{{ $('ggsheet').item.json[\"Zalo\"] }}\",\"shopify_Createdate\":\"{{ $('ggsheet').item.json[\"Createdate\"] }}\",\"shopify_Deliverydate\":\"{{ $('ggsheet').item.json[\"Deliverydate\"] }}\",\"shopify_Deliveryaddress\":\"{{ $('ggsheet').item.json[\"Deliveryaddress\"] }}\",\"shopify_ID+F.Name\":\"{{ $('ggsheet').item.json[\"Foodname\"] }}\",\"shopify_id+mer.name\":\"{{ $('ggsheet').item.json[\"Merchantname\"] }}\",\"shopify_Qty\":\"{{ $('ggsheet').item.json[\"Qty\"] }}\",\"shopify_Unitprice\":\"{{ $('ggsheet').item.json[\"Unitprice\"] }}\",\"shopify_Somontongbill\":\"{{ $('ggsheet').item.json[\"Somontongbill\"] }}\",\"shopify_Tongtien\":\"{{  $('ggsheet').item.json[\"Totalprice\"]}}\"}}","options":{}},"id":"d2aed0be-051e-4567-b7b9-4dd7083fb4c9","name":"HTTP Request","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[1020,320]},{"parameters":{"pollTimes":{"item":[{"mode":"everyMinute"}]},"documentId":{"__rl":true,"value":"1ar-ryono31SgJ3IUzXy8CHeGdYJjaDqN-onRB-FHO_0","mode":"list","cachedResultName":"55-Kitchen-Order-From-Shopify","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1ar-ryono31SgJ3IUzXy8CHeGdYJjaDqN-onRB-FHO_0/edit?usp=drivesdk"},"sheetName":{"__rl":true,"value":1969433794,"mode":"list","cachedResultName":"Order-LineItems","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1ar-ryono31SgJ3IUzXy8CHeGdYJjaDqN-onRB-FHO_0/edit#gid=1969433794"},"event":"rowAdded","options":{}},"id":"ce622718-11b0-4981-b770-86cf09074c1a","name":"ggsheet","type":"n8n-nodes-base.googleSheetsTrigger","typeVersion":1,"position":[580,320],"credentials":{"googleSheetsTriggerOAuth2Api":{"id":"38","name":"Google Sheets Trigger account (h√¨nh nh∆∞ c·ªßa ngothaikhang@gmail)"}}}],"connections":{"HTTP Request - Lark Ternant":{"main":[[{"node":"HTTP Request","type":"main","index":0}]]},"ggsheet":{"main":[[{"node":"HTTP Request - Lark Ternant","type":"main","index":0}]]}},"settings":{},"staticData":{"node:ggsheet":{"documentId":"1ar-ryono31SgJ3IUzXy8CHeGdYJjaDqN-onRB-FHO_0","sheetId":1969433794,"lastIndexChecked":118}},"pinData":{},"versionId":"a2513049-c7b1-4d8d-8105-a7841ab0b6c4","triggerCount":1,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-07-08T02:43:57.430Z","updatedAt":"2023-07-08T06:31:44.000Z","id":"157","name":"Test work flow","active":false,"nodes":[{"parameters":{"httpMethod":"POST","path":"c57b0617-6a44-4b15-b2ab-984822d7d5b7","options":{}},"id":"8f889c98-3db0-4e2a-b5d0-fd3151c8869a","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[880,420],"webhookId":"c57b0617-6a44-4b15-b2ab-984822d7d5b7"},{"parameters":{"fromEmail":"booking@liahouse.com","toEmail":"nam.river@gmail.com","subject":"Th∆∞ x√°c nh·∫≠n ƒë·∫∑t ph√≤ng - Booking Confirmation","emailFormat":"html","html":"=<table class=\"Table\" style=\"width:100.0%; border:undefined\" width=\"100%\">\n\t<tbody>\n\t\t<tr>\n\t\t\t<td style=\"width:55.36%;vertical-align: text-top;\" width=\"55%\">\n\t\t\t<p style=\"margin:0in 0in 8pt\"><span style=\"font-size:11pt\"><span style=\"line-height:normal\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:12.0pt\"><span style=\"font-size:12pt;font-family: Helvetica Neue,Helvetica,Arial,sans-serif;\"><span style=\"color:black\">X&aacute;c nh·∫≠n ƒë·∫∑t ph&ograve;ng<br />\n\t\t\tS·ªë Booking: <b>{{ $json.body.bookingid }}/b> </span> </span> </span></span></span></span><br />\n\t\t\t&nbsp;</p>\n\t\t\t</td>\n\t\t\t<td style=\"width:43.66%; padding:5.25pt 5.25pt 5.25pt 5.25pt\" width=\"43%\">\n\t\t\t<p align=\"right\" style=\"text-align:right; margin:0in 0in 8pt\"><span style=\"font-size:11pt\"><span style=\"line-height:normal\"><span style=\"Helvetica Neue,Helvetica,Arial,sans-serif\"><b><span style=\"font-size:12.0pt\"><span style=\"font-size:10pt;font-family: Helvetica Neue,Helvetica,Arial,sans-serif;\"><span style=\"color:black\">Lia House Sun ƒê·ªãa Trung H·∫£i Ph√∫ Qu·ªëc</span> </span> </span> </b><br />\n\t\t\t<span style=\"font-size:12.0pt\"><span style=\"font-size:10pt;font-family: Helvetica Neue,Helvetica,Arial,sans-serif;\"><span style=\"color:black\">ƒê·ªãa ch·ªâ: C√°p treo H√≤n Th∆°m, An Th·ªõi, Ph√∫ Qu·ªëc, Kien Giang<br />\n\t\t\tEmail: booking@liahouse.com<br />\n\t\t\tWebsite:www.liahouse.com</span> </span> </span><br />\n\t\t\t<span style=\"font-size:12.0pt\"><span style=\"font-size:10pt;font-family: Helvetica Neue,Helvetica,Arial,sans-serif;\"><span style=\"color:black\">Phone : 0889 006 006</span> </span> </span> </span> </span> </span></p>\n\t\t\t</td>\n\t\t</tr>\n\t</tbody>\n</table>\n\n<p style=\"margin:0\">K&iacute;nh g·ª≠i Qu&yacute; kh&aacute;ch,<br />\n<br />\nC·∫£m ∆°n Qu&yacute; kh&aacute;ch ƒë&atilde; l·ª±a ch·ªçn Lia House Sun ƒê·ªãa Trung H·∫£i Ph√∫ Qu·ªëc. Ch&uacute;ng t&ocirc;i xin g·ª≠i th&ocirc;ng tin ƒë·∫∑t ph&ograve;ng c·ªßa qu&yacute; kh&aacute;ch chi ti·∫øt nh∆∞ b·∫£ng d∆∞·ªõi ƒë&acirc;y. ƒê·∫∑t ph&ograve;ng s·∫Ω c&oacute; hi·ªáu l·ª±c sau khi qu&yacute; kh&aacute;ch thanh to&aacute;n v&agrave;o t&agrave;i kho·∫£n sau:</p>\n\n<p style=\"margin:0\">&nbsp;</p>\n\n<p style=\"margin:0\"><strong>Holder:</strong> <strong>Nguyen Hai Nam</strong><br />\n<strong>Account number:</strong> <strong>5490081</strong><br />\n<strong>Bank:</strong> <strong>ACB Chi nh&aacute;nh Nam S&agrave;i G&ograve;n</strong></p>\n\n<p style=\"margin:0\"><strong>N·ªôi dung chuy·ªÉn kho·∫£n:</strong>&nbsp;&nbsp;<span style=\"color:#e74c3c;\"><em> {{ $json.body.guestname }}&nbsp;- bk {{ $json.bookingid }}</em></span></p>\n\n<p style=\"margin:0\">&nbsp;</p>\n\n<p style=\"margin:0\">N·∫øu c&oacute; b·∫•t c·ª© th·∫Øc m·∫Øc n&agrave;o xin vui l&ograve;ng li&ecirc;n h·ªá BP CSKH c·ªßa ch&uacute;ng t&ocirc;i qua s·ªë ƒëi·ªán tho·∫°i 0889 006 006 ho·∫∑c email:&nbsp;booking@liahouse.com</p>\n\n<p style=\"margin:0\">&nbsp;</p>\n\n<p style=\"margin:0in 0in 8pt;padding-left:10px;border-left: 2px solid #0089d0; background: #f2f2f2;\"><span style=\"font-size:11pt\"><span style=\"line-height:normal\"><span style=\"font-family:Calibri,sans-serif\"><b><span style=\"font-size:12.0pt\"><span style=\"font-size:10pt;font-family: Helvetica Neue,Helvetica,Arial,sans-serif;\"><span style=\"color:black\">Chi ti·∫øt ƒë·∫∑t ph&ograve;ng</span></span></span></b></span></span></span></p>\n\n<table class=\"Table\">\n\t<tbody>\n\t\t<tr>\n\t\t\t<td style=\"padding:0in 0in 1.2pt 0in\" valign=\"top\"><span style=\"font-size:11pt\"><span style=\"line-height:normal\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:12.0pt\"><span style=\"font-size:10pt;font-family: Helvetica Neue,Helvetica,Arial,sans-serif;\"><span style=\"color:black\">Ng&agrave;y ƒë·∫∑t</span></span></span></span></span></span></td>\n\t\t\t<td style=\"padding:0in 0in 1.2pt 0in\" valign=\"top\"><span style=\"font-size:11pt\"><span style=\"line-height:normal\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:12.0pt\"><span style=\"font-size:10pt;font-family: Helvetica Neue,Helvetica,Arial,sans-serif;\"><span style=\"color:black\">:</span> </span> </span> </span> </span> </span></td>\n\t\t\t<td style=\"padding:0in 0in 1.2pt 0in\" valign=\"top\"><span style=\"font-size:11pt\"><span style=\"line-height:normal\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:12.0pt\"><span style=\"font-size:10pt;font-family: Helvetica Neue,Helvetica,Arial,sans-serif;\"><span style=\"color:black\">[BookingDate]</span> </span> </span> </span> </span> </span></td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"padding:0in 0in 1.2pt 0in\" valign=\"top\"><span style=\"font-size:11pt\"><span style=\"line-height:normal\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:12.0pt\"><span style=\"font-size:10pt;font-family: Helvetica Neue,Helvetica,Arial,sans-serif;\"><span style=\"color:black\">Check-In</span> </span> </span> </span> </span> </span></td>\n\t\t\t<td style=\"padding:0in 0in 1.2pt 0in\" valign=\"top\"><span style=\"font-size:11pt\"><span style=\"line-height:normal\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:12.0pt\"><span style=\"font-size:10pt;font-family: Helvetica Neue,Helvetica,Arial,sans-serif;\"><span style=\"color:black\">:</span> </span> </span> </span> </span> </span></td>\n\t\t\t<td style=\"padding:0in 0in 1.2pt 0in\" valign=\"top\"><span style=\"font-size:11pt\"><span style=\"line-height:normal\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:12.0pt\"><span style=\"font-size:10pt;font-family: Helvetica Neue,Helvetica,Arial,sans-serif;\"><span style=\"color:black\">[ArrivalDate]</span> </span> </span> </span> </span> </span></td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"padding:0in 0in 1.2pt 0in\" valign=\"top\"><span style=\"font-size:11pt\"><span style=\"line-height:normal\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:12.0pt\"><span style=\"font-size:10pt;font-family: Helvetica Neue,Helvetica,Arial,sans-serif;\"><span style=\"color:black\">Check Out</span> </span> </span> </span> </span> </span></td>\n\t\t\t<td style=\"padding:0in 0in 1.2pt 0in\" valign=\"top\"><span style=\"font-size:11pt\"><span style=\"line-height:normal\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:12.0pt\"><span style=\"font-size:10pt;font-family: Helvetica Neue,Helvetica,Arial,sans-serif;\"><span style=\"color:black\">:</span> </span> </span> </span> </span> </span></td>\n\t\t\t<td style=\"padding:0in 0in 1.2pt 0in\" valign=\"top\"><span style=\"font-size:11pt\"><span style=\"line-height:normal\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:12.0pt\"><span style=\"font-size:10pt;font-family: Helvetica Neue,Helvetica,Arial,sans-serif;\"><span style=\"color:black\">[DepartureDate]</span> </span> </span> </span> </span> </span></td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"padding:0in 0in 1.2pt 0in\" valign=\"top\"><span style=\"font-size:11pt\"><span style=\"line-height:normal\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:12.0pt\"><span style=\"font-size:10pt;font-family: Helvetica Neue,Helvetica,Arial,sans-serif;\"><span style=\"color:black\">S·ªë ƒë&ecirc;m</span></span></span></span></span></span></td>\n\t\t\t<td style=\"padding:0in 0in 1.2pt 0in\" valign=\"top\"><span style=\"font-size:11pt\"><span style=\"line-height:normal\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:12.0pt\"><span style=\"font-size:10pt;font-family: Helvetica Neue,Helvetica,Arial,sans-serif;\"><span style=\"color:black\">:</span> </span> </span> </span> </span> </span></td>\n\t\t\t<td style=\"padding:0in 0in 1.2pt 0in\" valign=\"top\"><span style=\"font-size:11pt\"><span style=\"line-height:normal\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:12.0pt\"><span style=\"font-size:10pt;font-family: Helvetica Neue,Helvetica,Arial,sans-serif;\"><span style=\"color:black\">[NoOfNights]</span> </span> </span> </span> </span> </span></td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"padding:0in 0in 1.2pt 0in\" valign=\"top\"><font color=\"#000000\" face=\"Helvetica Neue, Helvetica, Arial, sans-serif\"><span style=\"font-size: 13.3333px;\">Y&ecirc;u c·∫ßu kh&aacute;c</span></font></td>\n\t\t\t<td style=\"padding:0in 0in 1.2pt 0in\" valign=\"top\"><span style=\"font-size:11pt\"><span style=\"line-height:normal\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:12.0pt\"><span style=\"font-size:10pt;font-family: Helvetica Neue,Helvetica,Arial,sans-serif;\"><span style=\"color:black\">:</span> </span> </span> </span> </span> </span></td>\n\t\t</tr>\n\t</tbody>\n</table>\n\n<p style=\"margin:0in 0in 0\">&nbsp;</p>\n\n<p style=\"margin:0in 0in 8pt;padding-left:10px;border-left: 2px solid #0089d0; background: #f2f2f2;\"><span style=\"font-size:11pt\"><span style=\"line-height:normal\"><span style=\"font-family:Calibri,sans-serif\"><b><span style=\"font-size:12.0pt\"><span style=\"font-size:10pt;font-family: Helvetica Neue,Helvetica,Arial,sans-serif;\"><span style=\"color:black\">Th&ocirc;ng tin c·ªßa qu&yacute; kh&aacute;ch:</span></span></span></b></span></span></span></p>\n\n<p style=\"margin:0in 0in 8pt\"><span style=\"font-size:11pt\"><span style=\"line-height:normal\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:12.0pt\"><span style=\"font-size:10pt;font-family: Helvetica Neue,Helvetica,Arial,sans-serif;\"><span style=\"color:black\">{{ $json.body.guestname }}, &nbsp;[Guest_Address]</span> </span> </span> <span style=\"font-size:12.0pt\"> <span style=\"font-size:10pt;font-family: Helvetica Neue,Helvetica,Arial,sans-serif;\"> <span style=\"color:black\">, &nbsp;[Guest_Country]</span> </span> </span><br />\n<span style=\"font-size:12.0pt\"><span style=\"font-size:10pt;font-family: Helvetica Neue,Helvetica,Arial,sans-serif;\"><span style=\"color:black\">Phone: [Guest_Phone]</span> </span> </span> </span> </span> </span></p>\n\n<p style=\"margin:0in 0in 0\">&nbsp;</p>\n\n<p style=\"margin:0in 0in 8pt;padding-left:10px;border-left: 2px solid #0089d0; background: #f2f2f2;\"><span style=\"font-size:11pt\"><span style=\"line-height:normal\"><span style=\"font-family:Calibri,sans-serif\"><b><span style=\"font-size:12.0pt\"><span style=\"font-size:10pt;font-family: Helvetica Neue,Helvetica,Arial,sans-serif;\"><span style=\"color:black\">Th&ocirc;ng tin ph&ograve;ng</span></span></span></b></span></span></span></p>\n\n<table class=\"Table\" style=\"border-collapse:collapse;border:1px soild #313131;\">\n\t<tbody>\n\t\t<tr>\n\t\t\t<td style=\"width:77.9pt; padding:0in 5.4pt 0in 5.4pt\" valign=\"top\" width=\"104\">\n\t\t\t<p style=\"margin:0\"><span style=\"font-size:11pt\"><span style=\"line-height:normal\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:12.0pt\"><span style=\"font-size:10pt;font-family: Helvetica Neue,Helvetica,Arial,sans-serif;\">Ng&agrave;y ƒë·∫øn</span></span></span></span></span></p>\n\t\t\t</td>\n\t\t\t<td style=\"width:77.9pt; padding:0in 5.4pt 0in 5.4pt\" valign=\"top\" width=\"119\">\n\t\t\t<p style=\"margin:0\"><span style=\"font-size:11pt\"><span style=\"line-height:normal\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:12.0pt\"><span style=\"font-size:10pt;font-family: Helvetica Neue,Helvetica,Arial,sans-serif;\">Ng&agrave;y ƒëi</span></span></span></span></span></p>\n\t\t\t</td>\n\t\t\t<td style=\"width:77.9pt; padding:0in 5.4pt 0in 5.4pt\" valign=\"top\" width=\"107\">\n\t\t\t<p style=\"margin:0\"><span style=\"font-size:11pt\"><span style=\"line-height:normal\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:12.0pt\"><span style=\"font-size:10pt;font-family: Helvetica Neue,Helvetica,Arial,sans-serif;\">S·ªë l∆∞·ª£ng ph&ograve;ng</span></span></span></span></span></p>\n\t\t\t</td>\n\t\t\t<td style=\"width:77.95pt; padding:0in 5.4pt 0in 5.4pt\" valign=\"top\" width=\"104\">\n\t\t\t<p style=\"margin:0\"><span style=\"font-size:11pt\"><span style=\"line-height:normal\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:12.0pt\"><span style=\"font-size:10pt;font-family: Helvetica Neue,Helvetica,Arial,sans-serif;\">S·ªë kh&aacute;ch</span></span></span></span></span></p>\n\t\t\t</td>\n\t\t\t<td style=\"width:77.95pt; padding:0in 5.4pt 0in 5.4pt\" valign=\"top\" width=\"169\">\n\t\t\t<p style=\"margin:0\"><span style=\"font-size:11pt\"><span style=\"line-height:normal\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:12.0pt\"><span style=\"font-size:10pt;font-family: Helvetica Neue,Helvetica,Arial,sans-serif;\">Gi&aacute; ph&ograve;ng</span></span></span></span></span></p>\n\t\t\t</td>\n\t\t</tr>\n\t</tbody>\n</table>\n\n<table class=\"Table\" style=\"border-collapse:collapse;border:1px soild #313131;\">\n\t<tbody>\n\t\t<tr>\n\t\t\t<td style=\"width:77.9pt; padding:0in 5.4pt 0in 5.4pt\" valign=\"top\" width=\"104\">\n\t\t\t<p style=\"margin:0in 0in 8pt\"><span style=\"font-size:11pt\"><span style=\"line-height:normal\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:12.0pt\"><span style=\"font-size:10pt;font-family: Helvetica Neue,Helvetica,Arial,sans-serif;\">{{ $json.body.dateout }}</span> </span> </span> </span> </span></p>\n\t\t\t</td>\n\t\t\t<td style=\"width:77.9pt; padding:0in 5.4pt 0in 5.4pt\" valign=\"top\" width=\"119\">\n\t\t\t<p style=\"margin:0in 0in 8pt\"><span style=\"font-size:11pt\"><span style=\"line-height:normal\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:12.0pt\"><span style=\"font-size:10pt;font-family: Helvetica Neue,Helvetica,Arial,sans-serif;\">{{ $json.body.dateout }}</span> </span> </span> </span> </span></p>\n\t\t\t</td>\n\t\t\t<td style=\"width:77.9pt; padding:0in 5.4pt 0in 5.4pt\" valign=\"top\" width=\"107\">\n\t\t\t<p style=\"margin:0in 0in 8pt\"><span style=\"font-size:11pt\"><span style=\"line-height:normal\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:12.0pt\"><span style=\"font-size:10pt;font-family: Helvetica Neue,Helvetica,Arial,sans-serif;\"><span style=\"text-align:center\">[NoOfRooms]</span></span> </span> </span> </span> </span></p>\n\t\t\t</td>\n\t\t\t<td style=\"width:77.95pt; padding:0in 5.4pt 0in 5.4pt\" valign=\"top\" width=\"104\">\n\t\t\t<p style=\"margin:0in 0in 8pt\"><span style=\"font-size:11pt\"><span style=\"line-height:normal\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:12.0pt\"><span style=\"font-size:10pt;font-family: Helvetica Neue,Helvetica,Arial,sans-serif;\">[Adult] Adult &amp; [Child] Child</span> </span> </span> </span> </span></p>\n\t\t\t</td>\n\t\t\t<td style=\"width:77.95pt; padding:0in 5.4pt 0in 5.4pt\" valign=\"top\" width=\"169\">\n\t\t\t<p style=\"margin:0in 0in 8pt\"><span style=\"font-size:11pt\"><span style=\"line-height:normal\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:12.0pt\"><span style=\"font-size:10pt;font-family: Helvetica Neue,Helvetica,Arial,sans-serif;\">[Price_room_per_night]</span> </span> </span> </span> </span></p>\n\t\t\t</td>\n\t\t</tr>\n\t</tbody>\n</table>\n\n<p style=\"margin:0in 0in 0\">&nbsp;</p>\n\n<p style=\"margin:0in 0in 0\"><strong style=\"font-size:10pt;font-family: Helvetica Neue,Helvetica,Arial,sans-serif;\">- Gi·ªù Check-in:&nbsp;[TimeInPrivate]</strong></p>\n\n<p style=\"margin:0in 0in 0\"><strong style=\"font-size:10pt;font-family: Helvetica Neue,Helvetica,Arial,sans-serif;\">- Gi·ªù&nbsp;Check-out:&nbsp;[TimeOutPrivate]</strong></p>\n\n<p style=\"margin:0in 0in 0\">&nbsp;</p>\n\n<table align=\"right\" class=\"Table\" style=\"border-collapse:collapse; margin-left:6.75pt; margin-right:6.75pt; border:undefined\">\n\t<tbody>\n\t\t<tr>\n\t\t\t<td style=\"width:143.75pt; padding:0in 5.4pt 0in 5.4pt\" valign=\"top\" width=\"192\">\n\t\t\t<p align=\"right\" style=\"text-align:right; margin:0in 0in 8pt\"><font color=\"#000000\" face=\"Helvetica Neue, Helvetica, Arial, sans-serif\"><span style=\"font-size: 13.3333px;\"><i>Booking ƒë∆∞·ª£c ƒë·∫∑t v&agrave; thanh to&aacute;n b·ªüi:</i></span></font></p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td style=\"width:143.75pt; padding:0in 5.4pt 0in 5.4pt\" valign=\"top\" width=\"192\">\n\t\t\t<p align=\"right\" style=\"text-align:right; margin:0in 0in 8pt\"><span style=\"font-size:11pt\"><span style=\"line-height:normal\"><span style=\"font-family:Calibri,sans-serif\"><span lang=\"VI\" style=\"font-size:12.0pt\"><span style=\"font-size:10pt;font-family: Helvetica Neue,Helvetica,Arial,sans-serif;\"><span style=\"color:black\">[Guest_Name]</span> </span> </span> </span> </span> </span></p>\n\t\t\t</td>\n\t\t</tr>\n\t</tbody>\n</table>\n\n<table class=\"Table\" style=\"border-collapse:collapse; border:undefined\">\n\t<tbody>\n\t\t<tr style=\"height:23.4pt\">\n\t\t\t<td style=\"width:306.4pt; padding:0in 5.4pt 0in 5.4pt; height:23.4pt\" width=\"409\">\n\t\t\t<p align=\"center\" style=\"text-align:center; margin:0in 0in 8pt\"><span style=\"font-size:11pt\"><span style=\"line-height:normal\"><span style=\"font-family:Calibri,sans-serif\"><b><span lang=\"VI\"><span style=\"font-size:10pt;font-family: Helvetica Neue,Helvetica,Arial,sans-serif;\"><span style=\"color:black\">T·ªïng ti·ªÅn c·ªßa booking</span></span></span></b></span></span></span></p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr style=\"height:26.5pt\">\n\t\t\t<td style=\"width:306.4pt; padding:0in 5.4pt 0in 5.4pt; height:26.5pt\" width=\"409\">\n\t\t\t<p align=\"center\" style=\"text-align:center; margin:0in 0in 8pt\"><span style=\"font-size:11pt\"><span style=\"line-height:normal\"><span style=\"font-family:Calibri,sans-serif\"><b><span><span style=\"font-size:12pt;font-family: Helvetica Neue,Helvetica,Arial,sans-serif;\">[Total_Group_price]</span> </span> </b> </span> </span> </span></p>\n\t\t\t</td>\n\t\t</tr>\n\t</tbody>\n</table>\n\n<p style=\"margin:0in 0in 0\">&nbsp;</p>\n","options":{}},"id":"ce50104c-af3a-4f1d-b8cd-507f4fc2766e","name":"Send Email","type":"n8n-nodes-base.emailSend","typeVersion":2,"position":[1100,420],"credentials":{"smtp":{"id":"70","name":"SMTP account 8"}}}],"connections":{"Webhook":{"main":[[{"node":"Send Email","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{},"versionId":"5c2c2ede-10ba-4d96-a1cb-be8a6c809b9e","triggerCount":1,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-07-08T08:27:02.573Z","updatedAt":"2023-07-16T12:19:10.000Z","id":"158","name":"ReadGmail","active":false,"nodes":[{"parameters":{"pollTimes":{"item":[{"mode":"everyMinute"}]},"simple":false,"filters":{"q":" subject:x√°c nh·∫≠n ƒë·∫∑t ph√≤ng"},"options":{}},"id":"4e1d9fe2-109a-430d-b6c5-cd97e556fd50","name":"Gmail Trigger","type":"n8n-nodes-base.gmailTrigger","typeVersion":1,"position":[880,420],"credentials":{"gmailOAuth2":{"id":"72","name":"Gmail account 2"}}},{"parameters":{"mode":"runOnceForEachItem","jsCode":"// Add a new field called 'myNewField' to the JSON of the item\n$input.item.json.email = $json.text.match(/[\\w.-]+@[\\w.-]+\\.[A-Za-z]{2,}/)[0];\n$input.item.json.bkno = $json.text.match(/Booking:\\s(\\d{4})/)[0];\n$input.item.json.phone = $json.text.match(/S·ªë ƒëi·ªán tho·∫°i\\s*:\\s*(\\d{10})/)[0];\n$input.item.json.phone = $json.text.match(/S·ªë ƒëi·ªán tho·∫°i\\s*:\\s*(\\d{10})/)[1];\n$input.item.json.guestname = $json.text.match(/T√™n kh√°ch h√†ng:\\s*(.*)/)[0];\nreturn $input.item;\n"},"id":"5bb82752-001e-4828-a373-95aef4f5473a","name":"Gedata","type":"n8n-nodes-base.code","typeVersion":1,"position":[1120,440]}],"connections":{"Gmail Trigger":{"main":[[{"node":"Gedata","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{},"versionId":"f2d0ca64-9582-48bd-86de-5545e8a79853","triggerCount":0,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-07-08T10:19:20.864Z","updatedAt":"2023-07-08T10:19:20.864Z","id":"159","name":"My workflow 17","active":false,"nodes":[{"parameters":{"jiraVersion":"server","events":["jira:issue_created"],"additionalFields":{}},"id":"ee49555e-2948-4e53-b7b5-a518d4d71857","name":"Jira Trigger","type":"n8n-nodes-base.jiraTrigger","typeVersion":1,"position":[700,400],"webhookId":"23bed7e0-dccd-4b2a-876b-503df5edf507","credentials":{"jiraSoftwareServerApi":{"id":"73","name":"Jira SW Server account"}}}],"connections":{},"settings":{},"staticData":null,"pinData":{},"versionId":"e1e6d3b9-cada-4071-bf6a-4d6e7e0688bd","triggerCount":0,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-07-09T06:35:43.620Z","updatedAt":"2023-07-09T06:35:43.620Z","id":"160","name":"55Kitchen - Sync GGSheet (backup OK)","active":false,"nodes":[{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/auth/v3/app_access_token/internal","sendBody":true,"specifyBody":"json","jsonBody":"={\n    \"app_id\": \"cli_a41487bb51f8d02f\",\n    \"app_secret\": \"luOwRQprGDvMhz3pN8N4TeM6X8fnsTdR\"\n}","options":{}},"id":"b192a1b3-be94-4523-9d88-4e307c56eb48","name":"HTTP Request - Lark Ternant","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[800,320]},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/bitable/v1/apps/Ev3cb0rrJamJansrYGllPsRwgre/tables/tblnyeeR1DXfqNIE/records","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $json.app_access_token }}"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\"fields\":{\"ü•£Order ID\":\"{{ $('ggsheet').item.json[\"OrderID\"] }}\",\"shopify_CusFirstName\":\"{{ $('ggsheet').item.json[\"Firstname\"] }}\",\"shopify_CusLastName\":\"{{ $('ggsheet').item.json[\"Lastname\"] }}\",\"shopify_Cusphone\":\"{{ $('ggsheet').item.json[\"Phone\"] }}\",\"üßè‚Äç‚ôÇÔ∏èCusZalo\":\"{{ $('ggsheet').item.json[\"Zalo\"] }}\",\"shopify_Createdate\":\"{{ $('ggsheet').item.json[\"Createdate\"] }}\",\"shopify_Deliverydate\":\"{{ $('ggsheet').item.json[\"Deliverydate\"] }}\",\"shopify_Deliveryaddress\":\"{{ $('ggsheet').item.json[\"Deliveryaddress\"] }}\",\"shopify_ID+F.Name\":\"{{ $('ggsheet').item.json[\"Foodname\"] }}\",\"shopify_id+mer.name\":\"{{ $('ggsheet').item.json[\"Merchantname\"] }}\",\"shopify_Qty\":\"{{ $('ggsheet').item.json[\"Qty\"] }}\",\"shopify_Unitprice\":\"{{ $('ggsheet').item.json[\"Unitprice\"] }}\",\"shopify_Somontongbill\":\"{{ $('ggsheet').item.json[\"Somontongbill\"] }}\",\"shopify_Tongtien\":\"{{  $('ggsheet').item.json[\"Totalprice\"]}}\"}}","options":{}},"id":"1cb324f0-7dcd-4d80-85ec-7c23821fcc1d","name":"HTTP Request","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[1020,320]},{"parameters":{"pollTimes":{"item":[{"mode":"everyMinute"}]},"documentId":{"__rl":true,"value":"1ar-ryono31SgJ3IUzXy8CHeGdYJjaDqN-onRB-FHO_0","mode":"list","cachedResultName":"55-Kitchen-Order-From-Shopify","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1ar-ryono31SgJ3IUzXy8CHeGdYJjaDqN-onRB-FHO_0/edit?usp=drivesdk"},"sheetName":{"__rl":true,"value":1969433794,"mode":"list","cachedResultName":"Order-LineItems","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1ar-ryono31SgJ3IUzXy8CHeGdYJjaDqN-onRB-FHO_0/edit#gid=1969433794"},"event":"rowAdded","options":{}},"id":"f368aab4-f34a-41ed-93f5-f514dc4f87a0","name":"ggsheet","type":"n8n-nodes-base.googleSheetsTrigger","typeVersion":1,"position":[580,320],"credentials":{"googleSheetsTriggerOAuth2Api":{"id":"38","name":"Google Sheets Trigger account (h√¨nh nh∆∞ c·ªßa ngothaikhang@gmail)"}}}],"connections":{"HTTP Request - Lark Ternant":{"main":[[{"node":"HTTP Request","type":"main","index":0}]]},"ggsheet":{"main":[[{"node":"HTTP Request - Lark Ternant","type":"main","index":0}]]}},"settings":{},"staticData":{"node:ggsheet":{"documentId":"1ar-ryono31SgJ3IUzXy8CHeGdYJjaDqN-onRB-FHO_0","sheetId":1969433794,"lastIndexChecked":83}},"pinData":{},"versionId":"2a68b393-69eb-41d5-9332-801d0ec67c00","triggerCount":1,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-07-09T10:07:11.742Z","updatedAt":"2023-07-09T10:18:30.000Z","id":"161","name":"(test) 55Kitchen - Sync GGSheet (OK) copy","active":false,"nodes":[{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/auth/v3/app_access_token/internal","sendBody":true,"specifyBody":"json","jsonBody":"={\n    \"app_id\": \"cli_a41487bb51f8d02f\",\n    \"app_secret\": \"luOwRQprGDvMhz3pN8N4TeM6X8fnsTdR\"\n}","options":{}},"id":"c642efad-956b-4001-a28a-93ca3d667146","name":"HTTP Request - Lark Ternant","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[800,320],"disabled":true},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/bitable/v1/apps/Ev3cb0rrJamJansrYGllPsRwgre/tables/tblnyeeR1DXfqNIE/records","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $json.app_access_token }}"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\"fields\":{\"ü•£Order ID\":\"{{ $('ggsheet').item.json[\"OrderID\"] }}\",\"ü•£OrderIDAuth\":\"{{ $('ggsheet').item.json[\"OrderIDAuth\"] }}\",\"shopify_link\":\"{{ $('ggsheet').item.json[\"LinkShopify\"] }}\",\"shopify_CusFirstName\":\"{{ $('ggsheet').item.json[\"Firstname\"] }}\",\"shopify_CusLastName\":\"{{ $('ggsheet').item.json[\"Lastname\"] }}\",\"shopify_Cusphone\":\"{{ $('ggsheet').item.json[\"Phone\"] }}\",\"üßè‚Äç‚ôÇÔ∏èCusZalo\":\"{{ $('ggsheet').item.json[\"Zalo\"] }}\",\"shopify_Createdate\":\"{{ $('ggsheet').item.json[\"Createdate\"] }}\",\"shopify_Deliverydate\":\"{{ $('ggsheet').item.json[\"Deliverydate\"] }}\",\"shopify_Deliveryaddress\":\"{{ $('ggsheet').item.json[\"Deliveryaddress\"] }}\",\"shopify_ID+F.Name\":\"{{ $('ggsheet').item.json[\"Foodname\"] }}\",\"shopify_id+mer.name\":\"{{ $('ggsheet').item.json[\"Merchantname\"] }}\",\"shopify_Qty\":\"{{ $('ggsheet').item.json[\"Qty\"] }}\",\"shopify_Unitprice\":\"{{ $('ggsheet').item.json[\"Unitprice\"] }}\",\"shopify_Somontongbill\":\"{{ $('ggsheet').item.json[\"Somontongbill\"] }}\",\"shopify_Tongtien\":\"{{  $('ggsheet').item.json[\"Totalprice\"]}}\"}}","options":{}},"id":"a73b7f52-4c04-4cee-a3ca-6facfb815ba4","name":"HTTP Request","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[1020,320],"disabled":true},{"parameters":{"pollTimes":{"item":[{"mode":"everyMinute"}]},"documentId":{"__rl":true,"value":"1ar-ryono31SgJ3IUzXy8CHeGdYJjaDqN-onRB-FHO_0","mode":"list","cachedResultName":"55-Kitchen-Order-From-Shopify","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1ar-ryono31SgJ3IUzXy8CHeGdYJjaDqN-onRB-FHO_0/edit?usp=drivesdk"},"sheetName":{"__rl":true,"value":1969433794,"mode":"list","cachedResultName":"Order-LineItems","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1ar-ryono31SgJ3IUzXy8CHeGdYJjaDqN-onRB-FHO_0/edit#gid=1969433794"},"event":"rowAdded","options":{}},"id":"67b6a596-a702-4528-8ef7-eda5e6a6d741","name":"ggsheet","type":"n8n-nodes-base.googleSheetsTrigger","typeVersion":1,"position":[580,320],"credentials":{"googleSheetsTriggerOAuth2Api":{"id":"38","name":"Google Sheets Trigger account (h√¨nh nh∆∞ c·ªßa ngothaikhang@gmail)"}},"disabled":true},{"parameters":{"additionalFields":{}},"id":"f9c75624-02df-42c6-8c82-1a32b7377d8b","name":"Shopify","type":"n8n-nodes-base.shopify","typeVersion":1,"position":[580,20]},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/auth/v3/app_access_token/internal","sendBody":true,"specifyBody":"json","jsonBody":"={\n    \"app_id\": \"cli_a41487bb51f8d02f\",\n    \"app_secret\": \"luOwRQprGDvMhz3pN8N4TeM6X8fnsTdR\"\n}","options":{}},"id":"2228be7f-ebce-4be8-a6e7-e21e5928e05b","name":"HTTP Request - Lark Ternant1","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[800,20]},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/bitable/v1/apps/Ev3cb0rrJamJansrYGllPsRwgre/tables/tblnyeeR1DXfqNIE/records","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $json.app_access_token }}"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\"fields\":{\"ü•£Order ID\":\"{{ $('ggsheet').item.json[\"OrderID\"] }}\",\"ü•£OrderIDAuth\":\"{{ $('ggsheet').item.json[\"OrderIDAuth\"] }}\",\"shopify_link\":\"{{ $('ggsheet').item.json[\"LinkShopify\"] }}\",\"shopify_CusFirstName\":\"{{ $('ggsheet').item.json[\"Firstname\"] }}\",\"shopify_CusLastName\":\"{{ $('ggsheet').item.json[\"Lastname\"] }}\",\"shopify_Cusphone\":\"{{ $('ggsheet').item.json[\"Phone\"] }}\",\"üßè‚Äç‚ôÇÔ∏èCusZalo\":\"{{ $('ggsheet').item.json[\"Zalo\"] }}\",\"shopify_Createdate\":\"{{ $('ggsheet').item.json[\"Createdate\"] }}\",\"shopify_Deliverydate\":\"{{ $('ggsheet').item.json[\"Deliverydate\"] }}\",\"shopify_Deliveryaddress\":\"{{ $('ggsheet').item.json[\"Deliveryaddress\"] }}\",\"shopify_ID+F.Name\":\"{{ $('ggsheet').item.json[\"Foodname\"] }}\",\"shopify_id+mer.name\":\"{{ $('ggsheet').item.json[\"Merchantname\"] }}\",\"shopify_Qty\":\"{{ $('ggsheet').item.json[\"Qty\"] }}\",\"shopify_Unitprice\":\"{{ $('ggsheet').item.json[\"Unitprice\"] }}\",\"shopify_Somontongbill\":\"{{ $('ggsheet').item.json[\"Somontongbill\"] }}\",\"shopify_Tongtien\":\"{{  $('ggsheet').item.json[\"Totalprice\"]}}\"}}","options":{}},"id":"4bdcd763-21c9-430f-943d-9ee1388b0f26","name":"HTTP Request1","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[1020,20]}],"connections":{"HTTP Request - Lark Ternant":{"main":[[{"node":"HTTP Request","type":"main","index":0}]]},"ggsheet":{"main":[[{"node":"HTTP Request - Lark Ternant","type":"main","index":0}]]},"Shopify":{"main":[[{"node":"HTTP Request - Lark Ternant1","type":"main","index":0}]]},"HTTP Request - Lark Ternant1":{"main":[[{"node":"HTTP Request1","type":"main","index":0}]]}},"settings":{},"staticData":{"node:ggsheet":{"documentId":"1ar-ryono31SgJ3IUzXy8CHeGdYJjaDqN-onRB-FHO_0","sheetId":1969433794,"lastIndexChecked":84}},"pinData":{},"versionId":"20c0f976-6ddc-4e4d-a9ae-f771cc0277c8","triggerCount":1,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-07-10T04:51:43.490Z","updatedAt":"2023-07-26T04:01:21.000Z","id":"163","name":"MieuFlow copyRESTOCK","active":false,"nodes":[{"parameters":{"httpMethod":"POST","path":"TEST RESTOCK","options":{}},"id":"62a6dcdf-3d8a-414a-8e76-97ff3497f763","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[-100,360],"webhookId":"a341f7b4-547a-4de6-968d-ddc289f28bbc"},{"parameters":{"jsCode":"let htmlTables = '<div class=\"table-wrapper\">';\nlet tenXuongSX = \"\"; // T√™n X∆∞·ªüng SX\nlet tenSP = \"\"; // T√™n SP\nlet maRap = \"\"; // M√£ R·∫≠p\n\nconst currentDate = new Date();\nconst month = currentDate.getMonth() + 1;\n// L·∫•y ng√†y ƒë·∫∑t h√†ng l√† ng√†y hi·ªán t·∫°i\nconst ngayDatHang = new Date();\n// S·ªë ng√†y l√†m vi·ªác c·∫ßn t√≠nh\nconst soNgayLamViec = 15;\n\n// T√≠nh to√°n ng√†y nh·∫≠n h√†ng d·ª± ki·∫øn\nlet ngayNhanHangDuKien = new Date(ngayDatHang); // Sao ch√©p ng√†y ƒë·∫∑t h√†ng\nlet countNgayLamViec = 0; // Bi·∫øn ƒë·∫øm s·ªë ng√†y l√†m vi·ªác\n\n// Ki·ªÉm tra t·ª´ng ng√†y, n·∫øu l√† ng√†y l√†m vi·ªác (t·ª´ th·ª© 2 ƒë·∫øn th·ª© 6), tƒÉng bi·∫øn ƒë·∫øm\nwhile (countNgayLamViec < soNgayLamViec) {\n  ngayNhanHangDuKien.setDate(ngayNhanHangDuKien.getDate() + 1); // TƒÉng ng√†y l√™n 1\n  const dayOfWeek = ngayNhanHangDuKien.getDay(); // L·∫•y s·ªë th·ª© t·ª± c·ªßa ng√†y trong tu·∫ßn (0: Ch·ªß nh·∫≠t, 1: Th·ª© 2, 2: Th·ª© 3, ..., 6: Th·ª© 7)\n  if (dayOfWeek > 0 && dayOfWeek < 6) { // Ki·ªÉm tra n·∫øu l√† ng√†y l√†m vi·ªác (t·ª´ th·ª© 2 ƒë·∫øn th·ª© 6)\n    countNgayLamViec++;\n  }\n}\n\n// Chu·∫©n b·ªã ƒë·ªãnh d·∫°ng ng√†y/th√°ng/nƒÉm (01/01/2023)\nconst options = { year: 'numeric', month: '2-digit', day: '2-digit' };\nconst ngayNhanHangDuKienFormatted = ngayNhanHangDuKien.toLocaleDateString('vi-VN', options);\nconst ngayDathangFormatted = ngayDatHang.toLocaleDateString('vi-VN', options);\n//xong ph·∫ßn ng√†y r·ªìi ƒë√≥\n\n//ƒë·ªÉ l√†m l·ªánh sx\n\nlet tongsp=0;\nfor (const item of $input.all()) {\n  for (const items of item.json.body.data.items) {\n    tongsp += parseInt(items.fields[\"üìù S\"]) || 0;;\n    tongsp += parseInt(items.fields[\"üìù M\"]) || 0;;\n    tongsp += parseInt(items.fields[\"üìù L\"]) || 0;;\n    tongsp += parseInt(items.fields[\"üìù XL\"]) || 0;;\n    tongsp += parseInt(items.fields[\"üìù FS\"]) || 0;;\n    \n  }\n}\n\n\nfor (const item of $input.all()) {\n  for (const items of item.json.body.data.items) {\n    tenXuongSX = items.fields[\"üìùT√™n X∆∞·ªüng SX\"]|| \"\";\n    tenSP = items.fields[\"T√™n SP Cha\"]?.[0]?.text || \"\";\n    const MaCha = items.fields[\"M√£ cha\"] || \"\";;\n    const maRapArray = items.fields[\"‚õî M√£ R·∫≠p\"];\n    if (Array.isArray(maRapArray) && maRapArray.length > 0) {\n      maRap = maRapArray[0]?.text || \"\";\n    }\n      // L·∫•y hai k√Ω t·ª± cu·ªëi c·ªßa M√£ nh√† cung c·∫•p\nconst maNCC = items.fields[\"M√£ NCC\"][0].text;\nconst kyTuCuoi = maNCC.slice(-2);\nconst dathangne = ngayDatHang.toLocaleDateString(\"vi-VN\", {\n  day: \"2-digit\",\n  month: \"2-digit\",\n  year: \"numeric\"\n});\n\nconst maLenhSX = `${maRap}/${kyTuCuoi}/${dathangne.replace(/\\//g, \"\")}`;\n\n\nhtmlTables += `<p>Th√°ng: ${month}</p><table><thead><tr><th class=\"bentrai bold-big\"><span style=\"color:red; font-weight:bold;\"> ${maRap}</span></th><th colspan=\"2\"><span style=\"color:red; font-weight:bold;\"> ${MaCha}</th> <th><span  class=\"bold-big\">${tenSP}</span></th></tr></thead><tbody><tr><td class=\"bentrai\">X∆∞·ªüng gia c√¥ng</td><td class=\"bold-big maudo\" style=\"color:red; font-weight:bold;\">${tenXuongSX}</td>\n      <td>S·ªë l∆∞·ª£ng SX</td>\n      <td class=\"bold-big\">${tongsp}</td>\n    </tr>\n    <tr>\n      <td class=\"bentrai\">Ng√†y ƒë·∫∑t h√†ng</td>\n      <td style=\"color:red; font-weight:bold;\">${ngayDathangFormatted}</td>\n      <td>L·ªánh SX</td>\n      <td>${maLenhSX}</td>\n    </tr>\n    <tr>\n      <td class=\"bentrai\">Ng√†y giao d·ª± ki·∫øn</td>\n      <td class=\"bold-big\">${ngayNhanHangDuKienFormatted}</td>\n      <td>Lo·∫°i SX</td>\n      <td>M·ªõi</td>\n    </tr>\n  </tbody>\n</table>\n`;\n  break; // Tho√°t kh·ªèi v√≤ng l·∫∑p sau khi l·∫•y gi√° tr·ªã ƒë·∫ßu ti√™n\n  }\n}\nfor (const item of $input.all()) {\n  for (const items of item.json.body.data.items) {\n    const MaVaiChinh = items.fields[\"M√£ V·∫£i Ch√≠nh\"] || \"\";;\n    const sizeS = items.fields[\"üìù S\"] || \"\";;\n    const sizeM = items.fields[\"üìù M\"] || \"\";;\n    const sizeL = items.fields[\"üìù L\"] || \"\";;\n    const sizeXL = items.fields[\"üìù XL\"] || \"\";;\n    const sizeFS = items.fields[\"üìù FS\"] || \"0\";;\n    const DinhMuc = items.fields[\"‚õî ƒê·ªãnh m·ª©c\"] || \"\";;\n    const SoMet = items.fields[\"T·ªïng Slg V·∫£i Ch√≠nh (m)\"] || \"\";;\n    const MaVaiPhu = items.fields[\"üìùM√£ V·∫£i ph·ª•\"] || \"\";;\n    const DinhMucPhu = items.fields[\"‚õî ƒê·ªãnh m·ª©c v·∫£i ph·ª•\"] || \"\";;\n    const TongMetPhu = items.fields[\"T·ªïng Slg V·∫£i ph·ª• (m)\"] || \"\";;  \n    const TongSML = items.fields[\"T·ªïng Slg\"] || \"\";;  \n\n        htmlTables += `\n<table>\n  <thead>\n    <tr>\n      <td colspan=\"2\" class=\"bentrai bold-big\">V·∫£i ch√≠nh:</td>\n      <td class=\"bold-big\">ƒê·ªãnh m·ª©c</td>\n      <td class=\"bold-big\">S·ªë m√©t</td>\n      <td class=\"bold-big\">S</td>\n      <td class=\"bold-big\">M</td>\n      <td class=\"bold-big\">L</td>\n      <td class=\"bold-big\">XL</td>\n      <td class=\"bold-big\">FS</td>\n      <td class=\"bold-big cot-cuoi\">T·ªïng SL</td>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td class=\"cot-1 bentrai bold-big\" rowspan=\"2\">${MaVaiChinh}</td>\n      <td class=\"cot-2\" style=\"font-weight:bold;\">Y√™u c·∫ßu</td>\n      <td class=\"cot-3 bold-big\">${DinhMuc}</td>\n      <td class=\"cot-4 bold-big\">${SoMet}</td>\n      <td class=\"cot-5 bold-big\">${sizeS}</td>\n      <td class=\"cot-5 bold-big\">${sizeM}</td>\n      <td class=\"cot-5 bold-big\">${sizeL}</td>\n      <td class=\"cot-5 bold-big\">${sizeXL}</td>\n      <td class=\"cot-5 bold-big\">${sizeFS}</td>\n      <td class=\"cot-5 bold-big\">${TongSML}</td>\n    </tr>\n    <tr>\n      <td>Th·ª±c c·∫Øt</td>\n      <td></td>\n      <td></td>\n      <td></td>\n      <td></td>\n      <td></td>\n      <td></td>\n      <td></td>\n      <td></td>\n    </tr>\n    <tr>\n      <td class=\"bentrai bold-big\">V·∫£i l√≥t</td>\n      <td>${MaVaiPhu}</td>\n      <td>${DinhMucPhu}</td>\n      <td>${TongMetPhu}</td>\n      <td class=\"ghichu\" colspan=\"3\" rowspan=\"3\">*Ghi ch√∫ n·ªôi b·ªô</td>\n      <td class=\"ghichu\" colspan=\"3\" rowspan=\"3\">*Ghi ch√∫ x∆∞·ªüng</td>\n    </tr>\n    <tr>\n      <td class=\"bentrai bold-big\">N√∫t</td>\n      <td></td>\n      <td></td>\n      <td></td>\n    </tr>\n    <tr>\n      <td class=\"bentrai bold-big\">Ph·ª• li·ªáu kh√°c</td>\n      <td></td>\n      <td></td>\n      <td></td>\n    </tr>\n  </tbody>\n</table></br>\n`;\n  }\n}\n\nhtmlTables += `</div>`;\nreturn {\n  htmlTables: htmlTables\n};"},"id":"58272e28-585d-489a-8c1c-cdd25177d0da","name":"Code","type":"n8n-nodes-base.code","typeVersion":1,"position":[560,360]},{"parameters":{"html":"<!DOCTYPE html>\n\n<html>\n<head>\n  <meta charset=\"UTF-8\" />\n  <title>ƒê∆°n ƒë·∫∑t h√†ng Mieu</title>\n</head>\n<body>\n  <div class=\"container\">\n    <h1><img src=\"https://theme.hstatic.net/200000561729/1000985167/14/logo.png?v=311\" width=\"18%\"/></h1>\n    <p>  ƒê·ªãa ch·ªâ: 400/2 L√™ VƒÉn S·ªπ, Q3 </p>\n    <p>  Tel: 0902.303.006 </p>\n    <h2 style=\"text-align:center;font-size:2em;font-weight:bold;\">ƒê∆†N ƒê·∫∂T H√ÄNG</h2>\n    {{ $node[\"Code\"].json[\"htmlTables\"] }}\n    <div class=\"table-wrapper\">\n  <table class=\"bang-luu-y\">\n    <thead>\n      <tr>\n        <th>L∆∞u √Ω ph·ª• li·ªáu</th>\n        <th></th>\n        <th></th>\n        <th></th>\n      </tr>\n    </thead>\n    <tbody>\n      <tr>\n        <td>1/ D√πng keo l·ª•a/tƒÉng ƒë∆° s·∫Øt</td>\n        <td>4/ V·∫Øt s·ªï ch·ªâ Cotton</td>\n        <td></td>\n        <td></td>\n      </tr>\n      <tr>\n        <td>2/ L·∫•y k√©o ƒë·∫ßm 60cm</td>\n        <td>5/ Ch·ªâ, d√¢y k√©o, n√∫t ph·ª• li·ªáu ti·ªáp m√†u v·∫£i</td>\n        <td></td>\n        <td></td>\n      </tr>\n      <tr>\n        <td colspan=\"4\">3/ Mocking tr√™n thun d∆∞·ªõi thun</td>\n      </tr>\n    </tbody>\n  </table>\n</div>\n\n  </div>\n</body>\n</html>\n\n<style>\n.container {\n  background-color: #ffffff;\n  /*text-align: center;*/\n  padding: 16px;\n  border-radius: 8px;\n}\n\nbody{\n  text-align:left;\n}\n  .bentrai{\n  text-align:left!important;    \n  }\nh1 {\n  color: #ff6d5a;\n  font-size: 24px;\n  font-weight: bold;\n  padding: 8px;\n}\n\nh2 {\n  color: #909399;\n  font-size: 18px;\n  font-weight: bold;\n  padding: 8px;\n}\n.table-wrapper {\n    display: flex;\n    flex-direction: column;\n  }\n\n  .table-wrapper table {\n    width: 100%;\n    border-collapse: collapse;\n    font-family: Arial, sans-serif;\n    margin-bottom: 20px;\n  }\n\n  .table-wrapper th,\n  .table-wrapper td {\n    border: 1px solid #ddd;\n    padding: 8px;\n    text-align: center;\n  }\n\n  .table-wrapper th {\n    background-color: #f2f2f2;\n    font-weight: bold;\n  }\n\n  .table-wrapper tbody tr:nth-child(even) {\n    background-color: #f9f9f9;\n  }\n  .bentrai{\n    text-align: left;\n  }\n  .cot-1{\n    width:20%;\n  }\n  .cot-2,.cot-3,.cot-4{\n    width:15%;\n  }\n  .cot-5{\n   width:8%; \n  }\n  .bold-big{\n    text-transform: uppercase;\n    font-weight:bold;\n  }\n  .table-wrapper {\n  width: 100%;\n  overflow-x: auto;\n}\n\n.bang-luu-y {\n  border-collapse: collapse;\n  width: 100%;\n}\n\n.bang-luu-y th,\n.bang-luu-y td {\n  padding: 8px;\n  text-align: left;\n}\n\n.bang-luu-y th {\n  font-weight: bold;\n  background-color: #f2f2f2;\n}\n\n.bang-luu-y td {\n  border-bottom: 1px solid #ddd;\n}\n\n\n\n/* Lo·∫°i b·ªè ƒë∆∞·ªùng vi·ªÅn b·∫£ng */\n.bang-luu-y {\n  border: none;\n}\n\n.bang-luu-y th,\n.bang-luu-y td {\n  border: none;\n  \n}\n  .cot-cuoi{\n    width:20%!important;\n  }\n  .ghichu{\n    vertical-align: top;\n    text-align:left!important;\n  }\n\n</style>"},"id":"d49af7d8-b40a-4f62-b561-66a07c07965e","name":"HTML","type":"n8n-nodes-base.html","typeVersion":1,"position":[800,360]},{"parameters":{"method":"POST","url":"https://hcti.io/v1/image","sendHeaders":true,"headerParameters":{"parameters":[{"name":"authorization","value":"Basic NmZkMTA3YjUtYzIxYy00ZTU4LTk4OGItYzEyMzQ0MDIyYmEyOjcxNGFmYWUxLTkwYzEtNDEwNy05MDgxLWYwOThmNmQ1Y2ZmMg=="}]},"sendBody":true,"contentType":"form-urlencoded","bodyParameters":{"parameters":[{"name":"html","value":"={{ $json[\"html\"] }}"},{"name":"ms_delay","value":"1000"}]},"options":{}},"id":"558e29a0-61bb-4f4a-9732-d37e35c9da74","name":"HTTP Request2","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[1020,360]},{"parameters":{"method":"PUT","url":"=https://open.larksuite.com/open-apis/bitable/v1/apps/QncPb90v9azHZRsiBsMutNctsrY/tables/tbl7pE4Q4B5FwP0m/records/{{ $node[\"Webhook\"].json[\"body\"][\"record_id\"] }}","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $node[\"tenantAccess\"].json[\"body\"][\"tenant_access_token\"] }}"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\"fields\":{\"H√¨nh ƒë∆°n ƒë·∫∑t h√†ng\":{\"link\":\"{{ $json[\"url\"] }}\",\"text\":\"xem h√¨nh\"}}}","options":{"response":{"response":{"fullResponse":true}}}},"id":"2fd7fc46-c63b-48a5-918d-f0846a8b9136","name":"HTTP Request3","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[1240,360]},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/auth/v3/tenant_access_token/internal","sendBody":true,"bodyParameters":{"parameters":[{"name":"app_id","value":"cli_a4d6c704d9b85009"},{"name":"app_secret","value":"mY1fnsO5t2PvCRhKV6TxLfYuO5Iw57zh"}]},"options":{"response":{"response":{"fullResponse":true}}}},"id":"726dd0fa-9560-4ac6-b220-90ab4c434fac","name":"tenantAccess","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[120,360]},{"parameters":{"url":"https://open.larksuite.com/open-apis/bitable/v1/apps/SazubCnLxaFHcjsXjF5uksVusye/tables/tblUn6QPgNdusF0E/records","sendQuery":true,"queryParameters":{"parameters":[{"name":"filter","value":"=CurrentValue.[‚õî M√£ R·∫≠p]=\"{{ $node[\"Webhook\"].json[\"body\"][\"macha\"] }}\"&&CurrentValue.[T·∫°o phi·∫øu LSX]=1&&CurrentValue.[Restock]=\"{{ $node[\"Webhook\"].json[\"body\"][\"restock_status\"] }}"},{"name":"page_size","value":"20"}]},"sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $json[\"body\"][\"tenant_access_token\"] }}"}]},"options":{"response":{"response":{"fullResponse":true}}}},"id":"e23333ba-d919-4f3c-8041-bcab7f7896e0","name":"GetInfor","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[340,360]}],"connections":{"Webhook":{"main":[[{"node":"tenantAccess","type":"main","index":0}]]},"Code":{"main":[[{"node":"HTML","type":"main","index":0}]]},"HTML":{"main":[[{"node":"HTTP Request2","type":"main","index":0}]]},"HTTP Request2":{"main":[[{"node":"HTTP Request3","type":"main","index":0}]]},"tenantAccess":{"main":[[{"node":"GetInfor","type":"main","index":0}]]},"GetInfor":{"main":[[{"node":"Code","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{"HTTP Request2":[{"json":{"url":"https://hcti.io/v1/image/51ec49c8-6afb-4262-824b-098d019a2a7d"},"pairedItem":{"item":0}}]},"versionId":"b54d4a8b-2c9b-4d87-88d9-dffbc254e0e8","triggerCount":1,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-07-13T09:44:10.459Z","updatedAt":"2023-07-15T04:44:25.000Z","id":"164","name":"khoi: catch balance sms & extract data","active":true,"nodes":[{"parameters":{"httpMethod":"POST","path":"kdigi-api-bank","options":{}},"id":"b4de67e5-38cd-468f-8570-b0fc6a5e1fe2","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[1400,500],"webhookId":"243b3294-25f7-4240-987d-01a168faab28"},{"parameters":{"jsCode":"const data = $input.first().json.data;\n\nlet elements = [];\n\nelements.push(\n  // First section\n  {\n    tag: 'div',\n    fields: [\n      {\n        is_short: false,\n        text: {\n          tag: 'lark_md',\n          content: `**Ng√¢n h√†ng**: ${data.bankName}`,\n        },\n      },\n      {\n        is_short: false,\n        text: {\n          tag: 'lark_md',\n          content: `**S·ªë t√†i kho·∫£n**: ${data.receiverAccount}`,\n        },\n      },\n      {\n        is_short: false,\n        text: {\n          tag: 'lark_md',\n          content: `**S·ªë d∆∞ thay ƒë·ªïi:** (${data.transactionType.text}) ${data.transactionAmount.text} VND`,\n        },\n      },\n      {\n        is_short: false,\n        text: {\n          tag: 'lark_md',\n          content: `**S·ªë d∆∞ t·∫°m t√≠nh**: ${data.balance.text} VND`,\n        },\n      },\n    ],\n  },\n  { tag: 'hr' },\n\n  //   Second section\n  {\n    tag: 'div',\n    fields: [\n      {\n        is_short: false,\n        text: {\n          tag: 'lark_md',\n          content: `**N·ªôi dung chuy·ªÉn kho·∫£n:**\\n ${data.transactionMessage}`,\n        },\n      },\n    ],\n  },\n  { tag: 'hr' },\n\n  //   Third section\n  {\n    tag: 'div',\n    fields: [\n      {\n        is_short: false,\n        text: {\n          tag: 'lark_md',\n          content: `**Th·ªùi gian nh·∫≠n:** ${data.receivedTime.text}`,\n        },\n      },\n    ],\n  }\n);\n\n// Add transactionId to third section\nif (data.transactionId) {\n  elements[4].fields.push({\n    is_short: false,\n    text: {\n      tag: 'lark_md',\n      content: `**M√£ giao d·ªãch:** ${data.transactionId}`,\n    },\n  });\n}\n\n// Add action\nif (data.deepLinks) {\n  elements.push({\n    tag: 'action',\n    actions: [],\n  });\n\n  //   if iOS link found\n  if (data.deepLinks.ios.link) {\n    elements.at(-1).actions.push({\n      tag: 'button',\n      text: {\n        tag: 'plain_text',\n        content: `M·ªü App ${data.bankName} (iOS)`,\n      },\n      url: `${data.deepLinks.ios.link}`,\n      type: 'primary',\n    });\n  }\n\n  //   if android link found\n  if (data.deepLinks.android.link) {\n    elements.at(-1).actions.push({\n      tag: 'button',\n      text: {\n        tag: 'plain_text',\n        content: `M·ªü App ${data.bankName} (Android)`,\n      },\n      url: `${data.deepLinks.android.link}`,\n      type: 'default',\n    });\n  }\n}\n\n// create message card\nlet result = {\n  msg_type: 'interactive',\n  card: {\n    config: {\n      wide_screen_mode: true,\n    },\n    header: {\n      template: 'green',\n      title: {\n        content: `${data.bankName}-${data.receiverAccount} (${data.transactionType.text}) ${data.transactionAmount.text}VND`,\n        tag: 'plain_text',\n      },\n    },\n    elements,\n  },\n};\n\nreturn { json: result };\n"},"id":"65036269-a824-46b8-96fe-501f9252a31f","name":"Convert to Lark Message Card","type":"n8n-nodes-base.code","typeVersion":1,"position":[2280,660]},{"parameters":{"method":"POST","url":"=https://open.larksuite.com/open-apis/auth/v3/tenant_access_token/internal/","sendBody":true,"specifyBody":"json","jsonBody":"={ \"app_id\" : \"{{ $input.item.json[\"appId\"] }}\", \"app_secret\" : \"{{ $input.item.json[\"appSecret\"] }}\" }","options":{}},"id":"ecfc5c46-0d38-4605-a9f3-2931538b6174","name":"Get Lark tenant access token","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[2460,340]},{"parameters":{"values":{"string":[{"name":"appId","value":"cli_a36a65082eb85009"},{"name":"appSecret","value":"n6EEtyICEiK2IoQGXLAFtedQTGY0Z5Sk"}]},"options":{}},"id":"04ee72ae-0bfa-4c2c-9b2a-8386074758a2","name":"Set Lark auth data","type":"n8n-nodes-base.set","typeVersion":1,"position":[2260,340]},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/bot/v2/hook/b8407056-e8cc-45d0-bfc6-7893201c4ff4","sendBody":true,"specifyBody":"json","jsonBody":"={{ JSON.stringify($('Convert to Lark Message Card').first().json)}}","options":{}},"id":"69af75c4-3582-4270-bd82-092c0495373a","name":"[Lark] Send noti to group chat","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[2480,660]},{"parameters":{"jsCode":"let input = $('Lark entry point').first().json.data;\n\n// Convert to Lark Base format\nlet records = [\n  {\n    fields: {\n      ID: input.bankName + '-' + input.receiverAccount,\n      Bank: input.bankName,\n      Account: input.receiverAccount,\n      'Transaction Type': input.transactionType.type === 0 ? 'Debit' : 'Credit',\n      Debit:\n        input.transactionType.type === 0\n          ? input.transactionAmount.amount\n          : undefined,\n      Credit:\n        input.transactionType.type === 1\n          ? input.transactionAmount.amount\n          : undefined,\n      Balance: input.balance.amount,\n      // 'Transaction ID':input.transactionId,\n      'Transaction Message': input.transactionMessage,\n      'Original Message': input.originalMessage,\n      'Time received': input.receivedTime.timestamp,\n    },\n  },\n];\n\nlet result = { json: { records } };\nreturn result;\n"},"id":"8be4e447-ff48-4778-b17e-3fe80c9a7f31","name":"Convert to Lark Base format","type":"n8n-nodes-base.code","typeVersion":1,"position":[2640,340]},{"parameters":{},"id":"62408ae4-3394-4f88-a5a8-a471f9f0d5b2","name":"Lark entry point","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[1960,500]},{"parameters":{"method":"POST","url":"=https://open.larksuite.com/open-apis/bitable/v1/apps/{{ $input.item.json[\"appId\"] }}/tables/{{ $input.item.json[\"tableId\"] }}/records/batch_create","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $node[\"Get Lark tenant access token\"].json.tenant_access_token }}"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\"records\":{{ JSON.stringify($('Convert to Lark Base format').first().json.records) }}}","options":{}},"id":"d1d6f90c-e25b-42f3-b803-4f4f79c17695","name":"[SMS Log] Add records to Bitable","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[3000,340]},{"parameters":{"values":{"string":[{"name":"appId","value":"Vz9eb7avZa95IUsOk99uji8Fsdd"},{"name":"tableId","value":"tbl9prfOWONpDCbk"}]},"options":{}},"id":"4d433300-f5fb-4237-889a-f154808fe3f2","name":"Set SMS Log config","type":"n8n-nodes-base.set","typeVersion":2,"position":[2820,340]},{"parameters":{"method":"POST","url":"https://app.n8n.vn/webhook/kdigi-process-sms-banking","sendBody":true,"specifyBody":"json","jsonBody":"={{ JSON.stringify($input.first().json.body) }}","options":{}},"id":"fa4213a0-9c68-4984-8404-2ef07d28037c","name":"Call KDIGI API","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[1640,500]}],"connections":{"Webhook":{"main":[[{"node":"Call KDIGI API","type":"main","index":0}]]},"Convert to Lark Message Card":{"main":[[{"node":"[Lark] Send noti to group chat","type":"main","index":0}]]},"Set Lark auth data":{"main":[[{"node":"Get Lark tenant access token","type":"main","index":0}]]},"Get Lark tenant access token":{"main":[[{"node":"Convert to Lark Base format","type":"main","index":0}]]},"Convert to Lark Base format":{"main":[[{"node":"Set SMS Log config","type":"main","index":0}]]},"Lark entry point":{"main":[[{"node":"Convert to Lark Message Card","type":"main","index":0},{"node":"Set Lark auth data","type":"main","index":0}]]},"Set SMS Log config":{"main":[[{"node":"[SMS Log] Add records to Bitable","type":"main","index":0}]]},"Call KDIGI API":{"main":[[{"node":"Lark entry point","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{"Webhook":[{"json":{"headers":{"host":"app.n8n.vn","user-agent":"SMS Forwarder App","transfer-encoding":"chunked","accept-encoding":"gzip","content-type":"application/json; charset=utf-8","x-forwarded-for":"125.235.237.202","x-forwarded-host":"app.n8n.vn","x-forwarded-port":"443","x-forwarded-proto":"https","x-forwarded-server":"f2605f992776","x-real-ip":"125.235.237.202"},"params":{},"query":{},"body":{"from":"OCB","text":"OCB 13/07 17:47\nTK 88882\n(+) 12,345 VND\nN/dung: MBVCB.3847384432.027204.Khoi test chuyen tien api lark.CT tu 6681888888 LE QUOC KHOI toi 88...\nSo du: 50,058 VND","sentStamp":1689245252000,"receivedStamp":1689245252894,"sim":"sim1"}}}]},"versionId":"49632683-e697-4494-ae1b-c46edc1c5c63","triggerCount":1,"tags":[{"createdAt":"2023-01-05T09:55:57.214Z","updatedAt":"2023-01-05T09:55:57.214Z","id":"1","name":"Lark"},{"createdAt":"2023-07-15T01:37:36.669Z","updatedAt":"2023-07-15T01:37:36.669Z","id":"27","name":"KDIGI"}]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-07-13T12:01:09.452Z","updatedAt":"2023-07-13T12:28:57.000Z","id":"165","name":"b·∫Øn mail v·ªÅ Lark","active":false,"nodes":[{"parameters":{"pollTimes":{"item":[{"mode":"everyMinute"}]},"filters":{"readStatus":"unread","sender":"shpromotion2010@gmail.com"}},"id":"87971a3b-0b60-4823-b8bd-8fc11aee57cf","name":"Gmail Trigger","type":"n8n-nodes-base.gmailTrigger","typeVersion":1,"position":[580,340],"alwaysOutputData":true,"retryOnFail":true,"credentials":{"gmailOAuth2":{"id":"77","name":"Gmail account 3"}}},{"parameters":{"jsCode":"// Loop over input items and add a new field called 'myNewField' to the JSON of each one\nfor (const item of $input.all()) {\n  item.json.myNewField = 1;\n}\n\nreturn $input.all();"},"id":"c44552e9-c26c-4490-960b-b31f392b3a8b","name":"Code","type":"n8n-nodes-base.code","typeVersion":1,"position":[800,340]}],"connections":{"Gmail Trigger":{"main":[[{"node":"Code","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{},"versionId":"3d7c0c2b-7c1c-4e20-8d0f-803a07af2f83","triggerCount":0,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-07-14T08:35:45.359Z","updatedAt":"2023-07-16T09:37:10.000Z","id":"167","name":"Passed scanning","active":true,"nodes":[{"parameters":{"httpMethod":"POST","path":"PassCV","options":{}},"id":"1447d7fd-885c-43a7-9b3d-b556cad3254f","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[320,240],"webhookId":"292a69a2-98f6-450a-9991-5f6b90efcb90"},{"parameters":{"fromEmail":"GRGR Tuy·ªÉn D·ª•ng <Tuyendung@grgr.vn>","toEmail":"={{ $json.query.Email }}","subject":"GRGR | HO√ÄN TH√ÄNH S∆† TUY·ªÇN","emailFormat":"html","html":"<!DOCTYPE html>\n<html>\n<head>\n  <style>\n    body {\n      background-color: #21618C; /* M√†u n·ªÅn */\n      font-family: Arial, sans-serif; /* Font ch·ªØ */\n      color: #ffffff; /* M√†u ch·ªØ */\n    }\n    .container {\n      max-width: 600px;\n      margin: 0 auto;\n      padding: 20px;\n      text-align: center;\n    }\n    h1 {\n      font-size: 24px;\n      color: #ffffff;\n      margin-top: 0;\n    }\n    p {\n      font-size: 16px;\n      color: #ffffff;\n    }\n    .logo {\n      display: block;\n      margin-bottom: 20px;\n    }\n    .button-container {\n      display: flex;\n      justify-content: center;\n      align-items: center;\n    }\n    .button {\n      display: inline-block;\n      background-color:#FFFFFF;\n      color: #000000;\n      padding: 10px 20px;\n      margin-top: 20px;\n      text-decoration: None;\n      border-radius: 4px;\n    }\n    .contact-info {\n      font-size: 14px;\n      margin-top: 20px;\n    }\n    .contact-info a {\n      color: #ffffff;\n      text-decoration: underline;\n    }\n  </style>\n</head>\n<body>\n  <table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n    <tr>\n      <td align=\"center\" valign=\"top\">\n        <table cellpadding=\"0\" cellspacing=\"0\" border=\"0\" width=\"600\">\n          <tr>\n            <td align=\"center\" bgcolor=\"#21618C\" style=\"padding: 20px;\">\n              <img src=\"http://grgr.vn/Content/img/Logo.png\" alt=\"Logo\" class=\"logo\" width=\"100\" height=\"100\">\n              <h1>CHU·∫®N B·ªä PH·ªéNG V·∫§N</h1>\n            </td>\n          </tr>\n          <tr>\n            <td bgcolor=\"#21618C\" style=\"padding: 20px;\">\n              <p>CH√öC M·ª™NG B·∫†N ƒë√£ qua v√≤ng s∆° tuy·ªÉn. Ch√∫ng t√¥i s·∫Ω s·ªõm g·ª≠i l·ªãch Ph·ªèng V·∫•n! Trong khi ch·ªù ƒë·ª£i, B·∫°n c√≥ th·ªÉ tham kh·∫£o b√†i vi·∫øt d∆∞·ªõi ƒë√¢y!</p>\n              \n              <div class=\"button-container\">\n                <a href=\"https://grgrcorp.larksuite.com/docx/W8mAdxhL6oDzuSxmxRFufduZsxw\" class=\"button\">C·∫¶N CHU·∫®N B·ªä G√å KHI ƒêI PH·ªéNG V·∫§N?</a>\n              </div>\n              \n              <div class=\"contact-info\">\n                <p>Ph√≤ng Nh√¢n S·ª±</p>\n                <p>Cty TNHH GRGR | <a href=\"https://grgr.vn\">Grgr.vn</a> | Hotline: 086 98 908 98 (Anh D≈©ng)</p>\n              </div>\n            </td>\n          </tr>\n        </table>\n      </td>\n    </tr>\n  </table>\n</body>\n</html>","options":{}},"id":"5ada26e7-ae6b-4e05-bb7f-54668dac6100","name":"Send Email","type":"n8n-nodes-base.emailSend","typeVersion":2,"position":[520,240],"credentials":{"smtp":{"id":"56","name":"SMTP account 6"}}}],"connections":{"Webhook":{"main":[[{"node":"Send Email","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{},"versionId":"9f23374b-de9b-4fc2-910f-5e5c56449120","triggerCount":1,"tags":[{"createdAt":"2023-07-14T04:57:09.608Z","updatedAt":"2023-07-14T04:57:09.608Z","id":"24","name":"GRGR_Recruite"}]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-07-14T12:34:21.232Z","updatedAt":"2023-07-16T09:35:42.000Z","id":"168","name":"Failed CV","active":true,"nodes":[{"parameters":{"httpMethod":"POST","path":"FailedCV","options":{}},"id":"9721dd5f-5a22-4e01-8648-ed63c748a7dc","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[320,240],"webhookId":"158f1443-f91e-47d9-bf13-8be2d93433ae"},{"parameters":{"fromEmail":"GRGR Tuy·ªÉn D·ª•ng <Tuyendung@grgr.vn>","toEmail":"={{ $json.query.Email }}","subject":"GRGR | C·∫¢M ∆†N ƒê√É ·ª®NG TUY·ªÇN","emailFormat":"html","html":"<!DOCTYPE html>\n<html>\n<head>\n  <style>\n    body {\n      background-color: #21618C; /* M√†u n·ªÅn */\n      font-family: Arial, sans-serif; /* Font ch·ªØ */\n      color: #ffffff; /* M√†u ch·ªØ */\n    }\n    .container {\n      max-width: 600px;\n      margin: 0 auto;\n      padding: 20px;\n      text-align: center;\n    }\n    h1 {\n      font-size: 24px;\n      color: #ffffff;\n      margin-top: 0;\n    }\n    p {\n      font-size: 16px;\n      color: #ffffff;\n    }\n    .logo {\n      display: block;\n      margin-bottom: 20px;\n    }\n    .button-container {\n      display: flex;\n      justify-content: center;\n      align-items: center;\n    }\n    .button {\n      display: inline-block;\n      background-color:#FFFFFF;\n      color: #000000;\n      padding: 10px 20px;\n      margin-top: 20px;\n      text-decoration: None;\n      border-radius: 4px;\n    }\n    .contact-info {\n      font-size: 14px;\n      margin-top: 20px;\n    }\n    .contact-info a {\n      color: #ffffff;\n      text-decoration: underline;\n    }\n  </style>\n</head>\n<body>\n  <table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n    <tr>\n      <td align=\"center\" valign=\"top\">\n        <table cellpadding=\"0\" cellspacing=\"0\" border=\"0\" width=\"600\">\n          <tr>\n            <td align=\"center\" bgcolor=\"#21618C\" style=\"padding: 20px;\">\n              <img src=\"http://grgr.vn/Content/img/Logo.png\" alt=\"Logo\" class=\"logo\" width=\"100\" height=\"100\">\n              <h1>TH∆Ø C·∫¢M ∆†N!</h1>\n            </td>\n          </tr>\n          <tr>\n            <td bgcolor=\"#21618C\" style=\"padding: 20px;\">\n              <p>C·∫¢M ∆†N B·∫†N ƒë√£ tham gia ·ª©ng tuy·ªÉn, nh∆∞ng r·∫•t ti·∫øc ch√∫ng t√¥i ch∆∞a t√¨m th·∫•y c√¥ng vi·ªác ph√π h·ª£p v√†o l√∫c n√†y. Ch√∫ng t√¥i ƒë√£ l∆∞u h·ªì s∆° v√† xem x√©t l·∫°i trong ƒë·ª£t ti·∫øp theo!</p>\n              \n              <div class=\"button-container\">\n                <a href=\"https://www.facebook.com/profile.php?id=100070155469589\" class=\"button\">Gi·ªØ k·∫øt n·ªëi qua Facebook</a>\n              </div>\n              \n              <div class=\"contact-info\">\n                <p>Ph√≤ng Nh√¢n S·ª±</p>\n                <p>Cty TNHH GRGR | <a href=\"https://grgr.vn\">Grgr.vn</a> | Hotline: 086 98 908 98 (Anh D≈©ng)</p>\n              </div>\n            </td>\n          </tr>\n        </table>\n      </td>\n    </tr>\n  </table>\n</body>\n</html>","options":{}},"id":"d65b7871-4150-4de6-a795-c097057fd3f5","name":"Send Email","type":"n8n-nodes-base.emailSend","typeVersion":2,"position":[520,240],"credentials":{"smtp":{"id":"56","name":"SMTP account 6"}}}],"connections":{"Webhook":{"main":[[{"node":"Send Email","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{},"versionId":"97035bb2-1bcf-4566-9ea2-edd49eb18d3d","triggerCount":1,"tags":[{"createdAt":"2023-07-14T04:57:09.608Z","updatedAt":"2023-07-14T04:57:09.608Z","id":"24","name":"GRGR_Recruite"}]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-07-14T12:53:29.902Z","updatedAt":"2023-07-27T12:44:27.000Z","id":"169","name":"Interviewed_Hired","active":true,"nodes":[{"parameters":{"httpMethod":"POST","path":"hired","options":{}},"id":"87ca5c55-5930-48fe-bf83-2797ddf8830c","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[320,240],"webhookId":"cc19a4f3-2ab0-4569-919b-b12163a3c632"},{"parameters":{"fromEmail":"GRGR Tuy·ªÉn D·ª•ng <Tuyendung@grgr.vn>","toEmail":"={{ $json.query.Email }}","subject":"GRGR | PH·ªéNG V·∫§N TH√ÄNH C√îNG","emailFormat":"html","html":"=<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\">\n<html xmlns=\"http://www.w3.org/1999/xhtml\" xmlns:o=\"urn:schemas-microsoft-com:office:office\" style=\"font-family:arial, 'helvetica neue', helvetica, sans-serif\">\n<head>\n<meta charset=\"UTF-8\">\n<meta content=\"width=device-width, initial-scale=1\" name=\"viewport\">\n<meta name=\"x-apple-disable-message-reformatting\">\n<meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\n<meta content=\"telephone=no\" name=\"format-detection\">\n<title>B·∫†N ƒê√É TR√öNG TUY·ªÇN</title><!--[if (mso 16)]>\n<style type=\"text/css\">\na {text-decoration: none;}\n</style>\n<![endif]--><!--[if gte mso 9]><style>sup { font-size: 100% !important; }</style><![endif]--><!--[if gte mso 9]>\n<xml>\n<o:OfficeDocumentSettings>\n<o:AllowPNG></o:AllowPNG>\n<o:PixelsPerInch>96</o:PixelsPerInch>\n</o:OfficeDocumentSettings>\n</xml>\n<![endif]--><!--[if !mso]><!-- -->\n<link href=\"https://fonts.googleapis.com/css2?family=Imprima&display=swap\" rel=\"stylesheet\"><!--<![endif]-->\n<style type=\"text/css\">\n#outlook a {\npadding:0;\n}\n.es-button {\nmso-style-priority:100!important;\ntext-decoration:none!important;\n}\na[x-apple-data-detectors] {\ncolor:inherit!important;\ntext-decoration:none!important;\nfont-size:inherit!important;\nfont-family:inherit!important;\nfont-weight:inherit!important;\nline-height:inherit!important;\n}\n.es-desk-hidden {\ndisplay:none;\nfloat:left;\noverflow:hidden;\nwidth:0;\nmax-height:0;\nline-height:0;\nmso-hide:all;\n}\n.btn-link {\n    border: none;\n    outline: none;\n    background: none;\n    cursor: pointer;\n    color: #0000EE;\n    padding: 0;\n    text-decoration: underline;\n    font-family: inherit;\n    font-size: inherit;\n}\n@media only screen and (max-width:600px) {p, ul li, ol li, a { line-height:150%!important } h1, h2, h3, h1 a, h2 a, h3 a { line-height:120% } h1 { font-size:30px!important; text-align:left } h2 { font-size:24px!important; text-align:left } h3 { font-size:20px!important; text-align:left } .es-header-body h1 a, .es-content-body h1 a, .es-footer-body h1 a { font-size:30px!important; text-align:left } .es-header-body h2 a, .es-content-body h2 a, .es-footer-body h2 a { font-size:24px!important; text-align:left } .es-header-body h3 a, .es-content-body h3 a, .es-footer-body h3 a { font-size:20px!important; text-align:left } .es-menu td a { font-size:14px!important } .es-header-body p, .es-header-body ul li, .es-header-body ol li, .es-header-body a { font-size:14px!important } .es-content-body p, .es-content-body ul li, .es-content-body ol li, .es-content-body a { font-size:14px!important } .es-footer-body p, .es-footer-body ul li, .es-footer-body ol li, .es-footer-body a { font-size:14px!important } .es-infoblock p, .es-infoblock ul li, .es-infoblock ol li, .es-infoblock a { font-size:12px!important } *[class=\"gmail-fix\"] { display:none!important } .es-m-txt-c, .es-m-txt-c h1, .es-m-txt-c h2, .es-m-txt-c h3 { text-align:center!important } .es-m-txt-r, .es-m-txt-r h1, .es-m-txt-r h2, .es-m-txt-r h3 { text-align:right!important } .es-m-txt-l, .es-m-txt-l h1, .es-m-txt-l h2, .es-m-txt-l h3 { text-align:left!important } .es-m-txt-r img, .es-m-txt-c img, .es-m-txt-l img { display:inline!important } .es-button-border { display:block!important } a.es-button, button.es-button { font-size:18px!important; display:block!important; border-right-width:0px!important; border-left-width:0px!important; border-top-width:15px!important; border-bottom-width:15px!important } .es-adaptive table, .es-left, .es-right { width:100%!important } .es-content table, .es-header table, .es-footer table, .es-content, .es-footer, .es-header { width:100%!important; max-width:600px!important } .es-adapt-td { display:block!important; width:100%!important } .adapt-img { width:100%!important; height:auto!important } .es-m-p0 { padding:0px!important } .es-m-p0r { padding-right:0px!important } .es-m-p0l { padding-left:0px!important } .es-m-p0t { padding-top:0px!important } .es-m-p0b { padding-bottom:0!important } .es-m-p20b { padding-bottom:20px!important } .es-mobile-hidden, .es-hidden { display:none!important } tr.es-desk-hidden, td.es-desk-hidden, table.es-desk-hidden { width:auto!important; overflow:visible!important; float:none!important; max-height:inherit!important; line-height:inherit!important } tr.es-desk-hidden { display:table-row!important } table.es-desk-hidden { display:table!important } td.es-desk-menu-hidden { display:table-cell!important } .es-menu td { width:1%!important } table.es-table-not-adapt, .esd-block-html table { width:auto!important } table.es-social { display:inline-block!important } table.es-social td { display:inline-block!important } .es-desk-hidden { display:table-row!important; width:auto!important; overflow:visible!important; max-height:inherit!important } .h-auto { height:auto!important } }\n</style>\n</head>\n<body data-new-gr-c-s-loaded=\"14.1101.0\" style=\"width:100%;font-family:arial, 'helvetica neue', helvetica, sans-serif;-webkit-text-size-adjust:100%;-ms-text-size-adjust:100%;padding:0;Margin:0\">\n<div class=\"es-wrapper-color\" style=\"background-color:#FFFFFF\"><!--[if gte mso 9]>\n<v:background xmlns:v=\"urn:schemas-microsoft-com:vml\" fill=\"t\">\n<v:fill type=\"tile\" color=\"#ffffff\"></v:fill>\n</v:background>\n<![endif]-->\n<table class=\"es-wrapper\" width=\"100%\" cellspacing=\"0\" cellpadding=\"0\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;padding:0;Margin:0;width:100%;height:100%;background-repeat:repeat;background-position:center top;background-color:#FFFFFF\">\n<tr>\n<td valign=\"top\" style=\"padding:0;Margin:0\">\n<table cellpadding=\"0\" cellspacing=\"0\" class=\"es-content\" align=\"center\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;table-layout:fixed !important;width:100%\">\n<tr>\n<td align=\"center\" style=\"padding:0;Margin:0\">\n<table bgcolor=\"#efefef\" class=\"es-content-body\" align=\"center\" cellpadding=\"0\" cellspacing=\"0\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;background-color:#EFEFEF;border-radius:20px 20px 0 0;width:600px\">\n<tr>\n<td align=\"left\" style=\"padding:0;Margin:0;padding-top:40px;padding-left:40px;padding-right:40px\">\n<table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\">\n<tr>\n<td align=\"center\" valign=\"top\" style=\"padding:0;Margin:0;width:520px\">\n<table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" role=\"presentation\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\">\n<tr>\n<td align=\"center\" style=\"padding:0;Margin:0;font-size:0px\"><a target=\"_blank\" href=\"https://www.facebook.com/profile.php?id=100070155469589\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:underline;color:#2D3142;font-size:18px\"><img src=\"http://grgr.vn/Content/img/Logo.png\" alt style=\"display:block;border:0;outline:none;text-decoration:none;-ms-interpolation-mode:bicubic;border-radius:100px\" width=\"180\"></a></td>\n</tr>\n</table></td>\n</tr>\n</table></td>\n</tr>\n<tr>\n<td align=\"left\" style=\"padding:0;Margin:0;padding-top:20px;padding-left:40px;padding-right:40px\">\n<table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\">\n<tr>\n<td align=\"center\" valign=\"top\" style=\"padding:0;Margin:0;width:520px\">\n<table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" bgcolor=\"#fafafa\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:separate;border-spacing:0px;background-color:#fafafa;border-radius:10px\" role=\"presentation\">\n<tr>\n<td align=\"left\" style=\"padding:20px;Margin:0\"><h3 style=\"Margin:0;line-height:34px;mso-line-height-rule:exactly;font-family:Imprima, Arial, sans-serif;font-size:28px;font-style:normal;font-weight:bold;color:#2D3142\">Ch√†o {{ $json.query.Name }},</h3><p style=\"Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:Imprima, Arial, sans-serif;line-height:27px;color:#2D3142;font-size:18px\"><br><br>Ch√∫ng t√¥i vui m·ª´ng th√¥ng b√°o r·∫±ng b·∫°n ƒë√£ tr√∫ng tuy·ªÉn v√†o v·ªã tr√≠: <strong>{{ $json.query.position}}</strong>. XIN CH√öC M·ª™NG! S·ª± th·ªÉ hi·ªán c·ªßa B·∫°n qua c√°c v√≤ng l√† ·∫•n t∆∞·ª£ng, v√† ch√∫ng t√¥i tin r·∫±ng B·∫°n s·∫Ω ƒë·∫°t nh·ªØng th√†nh t·ª±u m·ªõi v·ªõi v·ªã tr√≠ m·ªõi.<br><br>N·∫øu c√≥ ƒëi·ªÅu g√¨ th·∫Øc m·∫Øc, vui l√≤ng li√™n h·ªá ngay v·ªõi ch√∫ng t√¥i ƒë·ªÉ ƒë∆∞·ª£c r√µ.<br><br>M·ªôt l·∫ßn n·ªØa, ch√∫c m·ª´ng s·ª± th√†nh c√¥ng ƒë·∫ßu ti√™n c·ªßa B·∫°n, v√† mong g·∫∑p B·∫°n ƒë·∫øn nh·∫≠n vi·ªác. Nh·∫±m gi√∫p ch√∫ng t√¥i chu·∫©n b·ªã chu ƒë√°o, B·∫°n vui l√≤ng x√°c nh·∫≠n c√¥ng vi·ªác n√†y b·∫±ng n√∫t <strong>ƒê·ªìng √ù</strong> b√™n d∆∞·ªõi<br><br>Tr√¢n tr·ªçng,<br><strong>GRGR</strong></p></td>\n</tr>\n</table></td>\n</tr>\n</table></td>\n</tr>\n</table></td>\n</tr>\n</table>\n<table cellpadding=\"0\" cellspacing=\"0\" class=\"es-content\" align=\"center\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;table-layout:fixed !important;width:100%\">\n<tr>\n<td align=\"center\" style=\"padding:0;Margin:0\">\n<table bgcolor=\"#efefef\" class=\"es-content-body\" align=\"center\" cellpadding=\"0\" cellspacing=\"0\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;background-color:#EFEFEF;width:600px\">\n<tr>\n<td align=\"left\" style=\"Margin:0;padding-top:30px;padding-bottom:40px;padding-left:40px;padding-right:40px\">\n<table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\">\n<tr>\n<td align=\"center\" valign=\"top\" style=\"padding:0;Margin:0;width:520px\">\n<table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" role=\"presentation\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\">\n<tr>\n<td align=\"center\" style=\"padding:0;Margin:0\"><!--[if mso]><a href=\"\" target=\"_blank\" hidden>\n<v:roundrect xmlns:v=\"urn:schemas-microsoft-com:vml\" xmlns:w=\"urn:schemas-microsoft-com:office:word\" esdevVmlButton href=\"\"\nstyle=\"height:56px; v-text-anchor:middle; width:520px\" arcsize=\"50%\" stroke=\"f\" fillcolor=\"#7630f3\">\n<w:anchorlock></w:anchorlock>\n<center style='color:#ffffff; font-family:-apple-system, \"system-ui\", \"Segoe UI\", Roboto, Helvetica, Arial, sans-serif, \"Apple Color Emoji\", \"Segoe UI Emoji\", \"Segoe UI Symbol\"; font-size:22px; font-weight:700; line-height:22px; mso-text-raise:1px'>Take a Test</center>\n</v:roundrect></a>\n<![endif]--><!--[if !mso]><!-- -->\n   <form action=\"https://app.n8n.vn/webhook/bamnut?recordID={{ $json[\"query\"][\"RecordID\"] }}\" method=\"post\">\n    <button type=\"submit\" style=\"mso-style-priority:100 !important;text-decoration:none;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;color:#FFFFFF;font-size:22px;padding:15px 20px 15px 20px;display:block;background:#7630f3;border-radius:30px;font-family:-apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol';font-weight:bold;font-style:normal;line-height:26px;width:auto;text-align:center;mso-hide:all;padding-left:50px;padding-right:50px;border-color:#7630f3\">ƒê·ªíNG √ù</button>\n</form>\n<!--<![endif]--></td>\n</tr>\n  </table></td>\n</tr>\n</table></td>\n</tr>\n</table></td>\n</tr>\n</table>\n\n<table cellpadding=\"0\" cellspacing=\"0\" class=\"es-footer\" align=\"center\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;table-layout:fixed !important;width:100%;background-color:transparent;background-repeat:repeat;background-position:center top\">\n<tr>\n<td align=\"center\" style=\"padding:0;Margin:0\">\n<table bgcolor=\"#bcb8b1\" class=\"es-footer-body\" align=\"center\" cellpadding=\"0\" cellspacing=\"0\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;background-color:#FFFFFF;width:600px\">\n<tr>\n<td align=\"left\" style=\"Margin:0;padding-left:20px;padding-right:20px;padding-bottom:30px;padding-top:40px\">\n<table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\">\n<tr>\n<td align=\"left\" style=\"padding:0;Margin:0;width:560px\">\n<table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" role=\"presentation\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\">\n<tr>\n<td align=\"center\" class=\"es-m-txt-c\" style=\"padding:0;Margin:0;padding-top:10px;padding-bottom:20px;font-size:0\">\n<table cellpadding=\"0\" cellspacing=\"0\" class=\"es-table-not-adapt es-social\" role=\"presentation\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\">\n<tr>\n<td align=\"center\" valign=\"top\" style=\"padding:0;Margin:0\"><a target=\"_blank\" href=\"https://www.facebook.com/profile.php?id=100070155469589\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:underline;color:#2D3142;font-size:14px\"><img src=\"https://dnsfnr.stripocdn.email/content/assets/img/social-icons/logo-black/facebook-logo-black.png\" alt=\"Fb\" title=\"Facebook\" height=\"24\" style=\"display:block;border:0;outline:none;text-decoration:none;-ms-interpolation-mode:bicubic\"></a></td>\n\n<td align=\"center\" valign=\"top\" style=\"padding:0;Margin:0\"><a target=\"_blank\" href=\"https://goo.gl/maps/qoCMKgPT5DDoMmZj9\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:underline;color:#2D3142;font-size:14px\"><img src=\"https://dnsfnr.stripocdn.email/content/assets/img/other-icons/logo-black/location-logo-black.png\" alt=\"Map Marker\" title=\"Map Marker\" height=\"24\" style=\"display:block;border:0;outline:none;text-decoration:none;-ms-interpolation-mode:bicubic\"></a></td>\n<td align=\"center\" valign=\"top\" style=\"padding:0;Margin:0\"><a target=\"_blank\" href=\"tel:0908376800\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:underline;color:#2D3142;font-size:14px\"><img src=\"https://dnsfnr.stripocdn.email/content/assets/img/other-icons/logo-black/phone-logo-black.png\" alt=\"Phone\" title=\"Phone\" height=\"24\" style=\"display:block;border:0;outline:none;text-decoration:none;-ms-interpolation-mode:bicubic\"></a></td>\n\n</tr>\n</table></td>\n</tr>\n<tr>\n<td align=\"center\" style=\"padding:0;Margin:0;padding-top:20px\"><p style=\"Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:Imprima, Arial, sans-serif;line-height:21px;color:#2D3142;font-size:14px\"><a target=\"_blank\" href=\"\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:underline;color:#2D3142;font-size:14px\"></a>Copyright ¬© 2023&nbsp;GRGR<a target=\"_blank\" href=\"\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:underline;color:#2D3142;font-size:14px\"></a></p></td>\n</tr>\n</table></td>\n</tr>\n</table></td>\n</tr>\n</table></td>\n</tr>\n</table></td>\n</tr>\n</table>\n</div>\n</body>\n</html>","options":{}},"id":"9a17cabd-e1c0-4de1-be9b-85d1bd139402","name":"Send Email","type":"n8n-nodes-base.emailSend","typeVersion":2,"position":[520,240],"credentials":{"smtp":{"id":"80","name":"greenspeed"}}}],"connections":{"Webhook":{"main":[[{"node":"Send Email","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{},"versionId":"03e8993c-95f9-4a76-a535-43ce3860e160","triggerCount":1,"tags":[{"createdAt":"2023-07-14T04:57:09.608Z","updatedAt":"2023-07-14T04:57:09.608Z","id":"24","name":"GRGR_Recruite"}]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-07-15T02:06:43.952Z","updatedAt":"2023-07-19T07:01:21.000Z","id":"172","name":"Money-SaiGon39-Noti","active":true,"nodes":[{"parameters":{"httpMethod":"POST","path":"saigon39-mnin","options":{}},"id":"2fd2da7d-0320-4c98-be2d-d1c0b7ba7308","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[820,420],"webhookId":"17ae85b2-4402-489c-b2c9-5bad9de39b5f"},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/auth/v3/app_access_token/internal","sendBody":true,"specifyBody":"json","jsonBody":"{   \"app_id\": \"cli_a438be409938d02f\",   \"app_secret\": \"JQVHt8heUABfGlVUDbqRLgBc45DHbBOe\" }","options":{}},"id":"d7d8e3f1-4227-426e-b8f2-e2af7e516280","name":"Tenant","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[1040,420]},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/im/v1/messages","sendQuery":true,"queryParameters":{"parameters":[{"name":"receive_id_type","value":"chat_id"}]},"sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $('Tenant').item.json[\"tenant_access_token\"] }}"}]},"sendBody":true,"bodyParameters":{"parameters":[{"name":"content","value":"={\"config\":{\"wide_screen_mode\":true},\"elements\":[{\"tag\":\"div\",\"text\":{\"content\":\"**Ng√¢n h√†ng**: ACB\\n**S·ªë ti·ªÅn**: {{ $json[\"amount\"] }} \\n\\n**N·ªôi dung**: {{ $('Webhook').item.json[\"body\"][\"content\"] }} \\n\",\"tag\":\"lark_md\"}}],\"header\":{\"template\":\"turquoise\",\"title\":{\"content\":\"[Ti·ªÅn V√†o] Kh√°ch chuy·ªÉn kho·∫£n !!! \",\"tag\":\"plain_text\"}}} \n"},{"name":"msg_type","value":"interactive"},{"name":"receive_id","value":"oc_17c5813e5ca810e29817bcdb09b3c30a"}]},"options":{"response":{"response":{"fullResponse":true}}}},"id":"b09f6f98-c86a-43ac-a4e3-e666019eb32b","name":"HTTP Request","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[1480,420]},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/bitable/v1/apps/SPqfbutsYaKiFrsBIY9lwnaRgag/tables/tblXPUE9251er0Qz/records/batch_create","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $('Tenant').item.json[\"tenant_access_token\"] }}"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\n  \"records\": [\n    {\n      \"fields\": {\n        \"N·ªôi dung\":\"{{ $('Webhook').item.json[\"body\"][\"content\"] }}\",\n        \"S·ªë ti·ªÅn\":{{ $('Webhook').item.json[\"body\"][\"amount\"] }}\n      }\n    }\n  ]\n}","options":{}},"id":"05eea8d0-cf7c-4418-afe9-62e4a9a5a8fd","name":"B·∫Øn Base","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[1700,420]},{"parameters":{"jsCode":"// Loop over input items and add a new field called 'myNewField' to the JSON of each one\nconst data = $(\"Webhook\").first().json;\n\nconst amount = data.body.amount;\nconst amount2 = Math.floor(amount).toLocaleString(\"vi-VN\") + \" VND\";\n\nreturn {\n  json: {\n    amount: amount2,\n  },\n};"},"id":"3cf528bc-17ba-49f1-81ac-f176aa27c048","name":"Code","type":"n8n-nodes-base.code","typeVersion":1,"position":[1260,420]}],"connections":{"Webhook":{"main":[[{"node":"Tenant","type":"main","index":0}]]},"Tenant":{"main":[[{"node":"Code","type":"main","index":0}]]},"HTTP Request":{"main":[[{"node":"B·∫Øn Base","type":"main","index":0}]]},"Code":{"main":[[{"node":"HTTP Request","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{},"versionId":"c01b5e9c-bbb2-4b6e-a893-6e96173a6424","triggerCount":1,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-07-15T04:33:17.561Z","updatedAt":"2023-07-15T04:57:47.000Z","id":"174","name":"khoi: process SMS banking API","active":true,"nodes":[{"parameters":{"dataType":"string","value1":"={{ $('Webhook').first().json.body.from.toLowerCase()}}","rules":{"rules":[{"value2":"ocb"}]},"fallbackOutput":3},"id":"b89ea191-e8c7-435e-b2fd-680de4e1a7c1","name":"Check bank name","type":"n8n-nodes-base.switch","typeVersion":1,"position":[1960,280]},{"parameters":{"jsCode":"const data = $('Webhook').first().json.body;\nconst splittedMsg = data.text.split('\\n');\n\nconst deeplinkSearchKeywords = {\n  ios: { search: 'oceanbank' },\n  android: { search: 'oceanbank' },\n};\n\n// Main logic\nlet result = {\n  // common info\n  bankName: getBankName(data.from),\n  receivedTime: getReceivedTime(data.sentStamp),\n  receiverAccount: getReceiverAccount(splittedMsg[1]),\n  senderAccount: getSenderAccount(splittedMsg[0]),\n\n  //transaction info\n  transactionType: getTransactionType(splittedMsg[2]),\n  transactionAmount: getTransactionAmount(splittedMsg[2]),\n  balance: getBalance(splittedMsg[4]),\n  transactionId: getTransactionId(splittedMsg[0]),\n  transactionMessage: getTransactionMessage(splittedMsg[3]),\n\n  // additional info\n  originalMessage: data.text,\n  deepLinks: deeplinkSearchKeywords,\n};\n\nreturn {\n  json: {\n    data: result,\n  },\n};\n\n/**\n * Process & Get bank name\n * @param {string} msg SMS message\n */\nfunction getBankName(msg) {\n  return msg;\n}\n\n/**\n * Convert received timestamp value\n * @param {Date} timestamp received timestamp\n */\nfunction getReceivedTime(timestamp) {\n  return {\n    text: new Date(timestamp).toLocaleString('vi-VN', {\n      timeZone: 'Asia/Ho_Chi_Minh',\n    }),\n    timestamp: timestamp,\n  };\n}\n/**\n * Get receiver account from the message\n * @param {string} msg SMS message\n */\nfunction getReceiverAccount(msg) {\n  const regex = /TK (\\d+)/;\n  const match = msg.match(regex);\n\n  if (match) {\n    return match[1];\n  }\n\n  return undefined;\n}\n\n/**\n * Get sender account from the message\n * @param {string} msg SMS message\n */\nfunction getSenderAccount(msg) {\n  return undefined;\n}\n\n/**\n * Get transaction type (deposit/withdrawal) from the message\n * @param {string} msg SMS message\n */\nfunction getTransactionType(msg) {\n  const regex = /\\(\\+\\)/;\n  const match = msg.match(regex);\n\n  if (match) {\n    const text = match[0];\n    if (text === '(+)') {\n      return {\n        text: '+',\n        type: 1,\n      };\n    } else {\n      return {\n        text: '-',\n        type: 0,\n      };\n    }\n  }\n\n  return undefined;\n}\n\n/**\n * Get transaction amount from the message\n * @param {string} msg SMS message\n */\nfunction getTransactionAmount(msg) {\n  const regex = /\\(\\+\\) (.*?) VND/;\n  const match = msg.match(regex);\n\n  if (match) {\n    const text = match[1];\n    const amount = +text.replace(/,/g, '');\n    return {\n      text,\n      amount,\n    };\n  }\n\n  return undefined;\n}\n\n/**\n * Get balance from the message\n * @param {string} msg SMS message\n */\nfunction getBalance(msg) {\n  const regex = /So du: (.*?) VND/;\n  const match = msg.match(regex);\n\n  if (match) {\n    const text = match[1];\n    const amount = +text.replace(/,/g, '');\n    return {\n      text,\n      amount,\n    };\n  }\n\n  return undefined;\n}\n\n/**\n * Get transaction ID from the message\n * @param {string} msg SMS message\n */\nfunction getTransactionId(msg) {\n  return undefined;\n}\n\n/**\n * Get transaction message from the message\n * @param {string} msg SMS message\n */\nfunction getTransactionMessage(msg) {\n  const regex = /N\\/dung: (.*)/;\n  const match = msg.match(regex);\n\n  if (match) {\n    return match[1];\n  }\n\n  return msg;\n}\n"},"id":"0c463932-24cf-47bb-a332-0184b8451937","name":"OCB","type":"n8n-nodes-base.code","typeVersion":1,"position":[2360,120]},{"parameters":{"dataType":"string","value1":"={{ $('Webhook').first().json.body.from.toLowerCase()}}","rules":{"rules":[{"value2":"ocb"}]}},"id":"13fe7a7e-f97d-42f4-a822-fa8500034241","name":"Check bank name 2","type":"n8n-nodes-base.switch","typeVersion":1,"position":[1960,600]},{"parameters":{},"id":"186bc853-5f5c-4b0f-aa78-867be6f61c70","name":"Merge deeplinks","type":"n8n-nodes-base.merge","typeVersion":2.1,"position":[1440,440]},{"parameters":{},"id":"941339df-b3c0-4b2a-b7f3-146b6104bac9","name":"Start process SMS message","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[1640,440]},{"parameters":{"jsCode":"const iosLinks = $('Merge deeplinks').first().json.apps;\nconst androidLinks = $('Merge deeplinks').last().json.apps;\n\nconst extractedData = $input.first().json.data;\n\nconst deepLinks = {\n  ios: {\n    link: iosLinks.find(\n      (app) => app.appId === extractedData.deepLinks.ios.search\n    )?.deeplink,\n    search: extractedData.deepLinks.ios.search,\n  },\n  android: {\n    link: androidLinks.find(\n      (app) => app.appId === extractedData.deepLinks.android.search\n    )?.deeplink,\n    search: extractedData.deepLinks.android.search,\n  },\n};\n\nreturn {\n  json: {\n    data: {\n      ...$input.first().json.data,\n      deepLinks: { ...deepLinks },\n    },\n  },\n};\n"},"id":"8d2de57c-7c91-42de-a344-5f57b516953e","name":"Add deeplinks","type":"n8n-nodes-base.code","typeVersion":1,"position":[2660,420]},{"parameters":{"url":"https://api.vietqr.io/v2/ios-app-deeplinks","options":{}},"id":"e182f1de-af30-4593-9390-c81b9e2a3798","name":"Fetch iOS deeplinks","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[1200,320]},{"parameters":{"url":"https://api.vietqr.io/v2/android-app-deeplinks","options":{}},"id":"4e873dbe-ea12-4b22-8665-a07231131a32","name":"Fetch android deeplinks","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[1200,580]},{"parameters":{"httpMethod":"POST","path":"kdigi-process-sms-banking","responseMode":"responseNode","options":{"ignoreBots":true}},"id":"2d64834f-4a05-43e3-b606-1babd5edaf7a","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[940,480],"webhookId":"24dab9fe-807c-46b7-8a29-62e9d225b8ba"},{"parameters":{"respondWith":"json","responseBody":"={{ JSON.stringify($json) }}","options":{}},"id":"ee0af9b2-c7cb-4d24-acae-f1f6227a12fd","name":"Respond to Webhook","type":"n8n-nodes-base.respondToWebhook","typeVersion":1,"position":[2880,420]}],"connections":{"Check bank name":{"main":[[{"node":"OCB","type":"main","index":0}],[],[],[{"node":"Check bank name 2","type":"main","index":0}]]},"OCB":{"main":[[{"node":"Add deeplinks","type":"main","index":0}]]},"Merge deeplinks":{"main":[[{"node":"Start process SMS message","type":"main","index":0}]]},"Start process SMS message":{"main":[[{"node":"Check bank name","type":"main","index":0}]]},"Fetch iOS deeplinks":{"main":[[{"node":"Merge deeplinks","type":"main","index":0}]]},"Fetch android deeplinks":{"main":[[{"node":"Merge deeplinks","type":"main","index":1}]]},"Webhook":{"main":[[{"node":"Fetch iOS deeplinks","type":"main","index":0},{"node":"Fetch android deeplinks","type":"main","index":0}]]},"Add deeplinks":{"main":[[{"node":"Respond to Webhook","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{},"versionId":"08a06fa2-13fb-479f-87ca-b3ce76a5735d","triggerCount":1,"tags":[{"createdAt":"2023-07-15T01:37:36.669Z","updatedAt":"2023-07-15T01:37:36.669Z","id":"27","name":"KDIGI"}]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-07-15T05:14:43.124Z","updatedAt":"2023-07-26T06:51:53.000Z","id":"175","name":"KDIGI_BANK_BOT: webhook catch balance sms & extract data","active":true,"nodes":[{"parameters":{"httpMethod":"POST","path":"template-kdigi-bank-bot-api","options":{}},"id":"ecfe376b-bfd7-4ab5-85b7-375a98a6139e","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[40,1940],"webhookId":"b459d9da-c462-43e0-880c-12b8d6304763"},{"parameters":{"mode":"runOnceForEachItem","jsCode":"if (\n  ($('getBankData').item.json.result.transactionType.type === '-' &&\n    $input.item.json.enableOutgoing) ||\n  ($('getBankData').item.json.result.transactionType.type === '+' &&\n    $input.item.json.enableIncoming)\n) {\n  const data = $('getBankData').first().json.result;\n\n  let elements = [];\n\n  elements.push({\n    tag: 'div',\n    fields: [\n      {\n        is_short: false,\n        text: {\n          tag: 'lark_md',\n          content: `**Ng√¢n h√†ng**: ${data.bankName.toUpperCase()}`,\n        },\n      },\n      {\n        is_short: false,\n        text: {\n          tag: 'lark_md',\n          content: `**S·ªë t√†i kho·∫£n**: ${data.receiverAccount}`,\n        },\n      },\n      {\n        is_short: false,\n        text: {\n          tag: 'lark_md',\n          content: `**S·ªë d∆∞ thay ƒë·ªïi:** ${data.transactionType.type} ${data.transactionAmount.amountText} VND`,\n        },\n      },\n      {\n        is_short: false,\n        text: {\n          tag: 'lark_md',\n          content: `**N·ªôi dung:** ${data.transactionMessage}`,\n        },\n      },\n    ],\n  });\n\n  // Append transaction ID if exist\n  if (data.transactionId) {\n    elements[0].fields.push({\n      is_short: false,\n      text: {\n        tag: 'lark_md',\n        content: `**M√£ giao d·ªãch:** ${data.transactionId}`,\n      },\n    });\n  }\n\n  // Append received time\n  elements[0].fields.push({\n    is_short: false,\n    text: {\n      tag: 'lark_md',\n      content: `**Th·ªùi gian nh·∫≠n:** ${data.receivedTime.text}`,\n    },\n  });\n\n  // Ki·ªÉm tra enableBalance n·∫øu true th√¨ th√™m ph·∫ßn t·ª≠ \"S·ªë d∆∞ t·∫°m t√≠nh\" v√†o m·∫£ng fields\n  if ($input.item.json.enableBalance) {\n    const balanceIndex = elements[0].fields.findIndex((field) =>\n      field?.text?.content?.includes('S·ªë d∆∞ thay ƒë·ªïi')\n    );\n    if (balanceIndex !== -1) {\n      elements[0].fields.splice(balanceIndex + 1, 0, {\n        is_short: false,\n        text: {\n          tag: 'lark_md',\n          content: `**S·ªë d∆∞ t·∫°m t√≠nh**: ${data.balance.amountText} VND`,\n        },\n      });\n    }\n  }\n\n  // create message card\n  let result = {\n    msg_type: 'interactive',\n    card: {\n      config: {\n        wide_screen_mode: true,\n      },\n      header: {\n        template: data.larkMessConfig?.cardColor ?? 'blue',\n        title: {\n          content: `${data.bankName.toUpperCase()}-${data.receiverAccount} (${\n            data.transactionType.type\n          }) ${data.transactionAmount.amountText}VND`,\n          tag: 'plain_text',\n        },\n      },\n      elements,\n    },\n  };\n\n  return {\n    json: {\n      isSend: true,\n      data: result,\n      customBotURL: $input.item.json.customBotURL,\n    },\n  };\n}\n\nreturn {\n  json: {\n    isSend: false,\n  },\n};\n"},"id":"09ab9919-775f-42c2-8a55-99b2416b44ff","name":"Convert to Lark Message Card","type":"n8n-nodes-base.code","typeVersion":1,"position":[2360,1940]},{"parameters":{"method":"POST","url":"=https://open.larksuite.com/open-apis/auth/v3/tenant_access_token/internal/","sendBody":true,"specifyBody":"json","jsonBody":"={ \"app_id\" : \"{{ $input.item.json[\"appId\"] }}\", \"app_secret\" : \"{{ $input.item.json[\"appSecret\"] }}\" }","options":{}},"id":"342ee0e1-4d6b-4133-a6f0-929b59a38358","name":"Get Lark tenant access token","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[1280,1680]},{"parameters":{"method":"POST","url":"={{ $input.item.json.customBotURL }}","sendBody":true,"specifyBody":"json","jsonBody":"={{ JSON.stringify($input.item.json.data)}}","options":{}},"id":"7941d381-e47a-4a19-a6aa-c69d8849313d","name":"[Lark] Send noti to group chat","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[2740,1800]},{"parameters":{"mode":"runOnceForEachItem","jsCode":"if (\n  ($('getBankData').item.json.result.transactionType.type === '-' &&\n    $input.item.json.enableOutgoing) ||\n  ($('getBankData').item.json.result.transactionType.type === '+' &&\n    $input.item.json.enableIncoming)\n) {\n  const data = $('getBankData').first().json.result;\n\n  // Convert to Lark Base format\n  const records = [\n    {\n      fields: {\n        ID: data.bankName + '-' + data.receiverAccount,\n        Bank: data.bankName.toUpperCase(),\n        Account: data.receiverAccount,\n        'Transaction Type': data.transactionType.typeText,\n        Debit:\n          data.transactionType.type === '+'\n            ? data.transactionAmount.amount\n            : undefined,\n        Credit:\n          data.transactionType.type === '-'\n            ? data.transactionAmount.amount\n            : undefined,\n        'Transaction ID': data.transactionId,\n        'Transaction Message': data.transactionMessage,\n        'Original Message': data.originalMessage,\n        'Transaction Time': data.transactionTime.timestamp,\n        'Time received': data.receivedTime.timestamp,\n      },\n    },\n  ];\n\n  // Ki·ªÉm tra enableBalance n·∫øu true th√¨ th√™m ph·∫ßn t·ª≠ \"Balance\" v√†o m·∫£ng fields\n  if ($input.item.json.enableBalance) {\n    records[0].fields = {\n      ...records[0].fields,\n      Balance: data.balance.amount,\n    };\n  }\n\n  return {\n    json: {\n      isSend: true,\n      records,\n      configs: {\n        baseId: $input.item.json.baseId,\n        tableId: $input.item.json.tableId,\n      },\n    },\n  };\n}\n\nreturn {\n  json: {\n    isSend: false,\n  },\n};\n"},"id":"a5bc2527-cf99-4a85-805a-6b7c3b7d04ea","name":"Convert to Lark Base format","type":"n8n-nodes-base.code","typeVersion":1,"position":[2320,1580]},{"parameters":{"method":"POST","url":"=https://open.larksuite.com/open-apis/bitable/v1/apps/{{ $json[\"configs\"][\"baseId\"] }}/tables/{{  $json[\"configs\"][\"tableId\"]}}/records/batch_create","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $node[\"Get Lark tenant access token\"].json.tenant_access_token }}"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\"records\":{{ JSON.stringify($json[\"records\"]) }}}","options":{}},"id":"38a9e5f9-1ce7-4710-b980-0b01a0d20105","name":"[SMS Log] Add records to Bitable","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[2700,1500]},{"parameters":{"conditions":{"boolean":[{"value1":"={{ $json.isBankSupport }}","value2":true}]}},"id":"e74df616-7a7b-4204-8a4c-85cd1fb3ae43","name":"ifBankSupport","type":"n8n-nodes-base.if","typeVersion":1,"position":[460,1940]},{"parameters":{"method":"POST","url":"https://app.n8n.vn/webhook/kdigi-bank-bot-process-data","sendBody":true,"specifyBody":"json","jsonBody":"={{ JSON.stringify($input.first().json.body) }}","options":{}},"id":"219db1be-36a2-41a7-ac09-f18714758635","name":"getBankData","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[240,1940]},{"parameters":{},"id":"ac6260e2-d132-40b6-b91b-495b9843c850","name":"Start Actions","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[660,1920]},{"parameters":{"mode":"runOnceForEachItem","jsCode":"if (\n  ($('getBankData').item.json.result.transactionType.type === '-' &&\n    $input.item.json.enableOutgoing) ||\n  ($('getBankData').item.json.result.transactionType.type === '+' &&\n    $input.item.json.enableIncoming)\n) {\n  const data = $('getBankData').first().json.result;\n\n  let message = [];\n\n  message.push(\n    `<b>${data.bankName.toUpperCase()}-${data.receiverAccount} (${\n      data.transactionType.type\n    }) ${data.transactionAmount.amountText}VND</b>\\n`,\n    `<b>Ng√¢n h√†ng:</b> ${data.bankName.toUpperCase()}`,\n    `<b>S·ªë t√†i kho·∫£n:</b> ${data.receiverAccount}`,\n    `<b>S·ªë d∆∞ thay ƒë·ªïi:</b> ${data.transactionType.type} ${data.transactionAmount.amountText} VND`\n  );\n\n  // Add balance\n  if ($input.item.json.enableBalance) {\n    message.push(`<b>S·ªë d∆∞ t·∫°m t√≠nh:</b> ${data.balance.amountText} VND`);\n  }\n\n  message.push(`<b>N·ªôi dung:</b>\\n ${data.transactionMessage}`);\n\n  // Check transaction ID\n  if (data.transactionId) {\n    message.push(`<b>M√£ giao d·ªãch:</b> ${data.transactionId}`);\n  }\n\n  message.push(`<b>Th·ªùi gian nh·∫≠n:</b> ${data.receivedTime.text}`);\n\n  return {\n    json: {\n      isSend: true,\n      botToken: $input.item.json.botToken,\n      payload: {\n        chat_id: $input.item.json.chatId,\n        parse_mode: 'HTML',\n        text: message.join('\\n'),\n      },\n    },\n  };\n}\n\nreturn {\n  json: {\n    isSend: false,\n  },\n};\n"},"id":"e48439a7-73d5-4338-8c00-6f95309ec4dc","name":"Create Telegram Message","type":"n8n-nodes-base.code","typeVersion":1,"position":[1720,2540]},{"parameters":{"method":"POST","url":"=https://api.telegram.org/bot{{ $input.item.json.botToken }}/sendMessage ","sendBody":true,"specifyBody":"json","jsonBody":"={{ JSON.stringify($input.item.json.payload) }}","options":{}},"id":"73ab302a-b5bb-4ef3-965e-ac7e554c23e2","name":"Send to Telegram chat","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[2180,2460]},{"parameters":{"values":{"string":[{"name":"appId","value":"cli_a33cd37530b8900a"},{"name":"appSecret","value":"qNz8YxoCCZoGm9Nlm2bOrcUriJsJtHHD"}]},"options":{}},"id":"2699e14f-8b68-429b-b28f-d911ef2e03cb","name":"Set Lark Configs","type":"n8n-nodes-base.set","typeVersion":2,"position":[1100,1680]},{"parameters":{"values":{"string":[{"name":"customBotURL","value":"https://open.larksuite.com/open-apis/bot/v2/hook/b8407056-e8cc-45d0-bfc6-7893201c4ff4"}],"boolean":[{"name":"enableBalance","value":true},{"name":"enableOTP"},{"name":"enableOutgoing","value":true},{"name":"enableIncoming"}]},"options":{}},"id":"74bca4c7-84b5-4747-a88c-31a5e7fce354","name":"Set Lark Mess Config","type":"n8n-nodes-base.set","typeVersion":2,"position":[1720,1820]},{"parameters":{"values":{"string":[{"name":"baseId","value":"Vz9eb7avZa95IUsOk99uji8Fsdd"},{"name":"tableId","value":"tbl9prfOWONpDCbk"}],"boolean":[{"name":"enableBalance"},{"name":"enableOTP"},{"name":"enableOutgoing"},{"name":"enableIncoming","value":true}]},"options":{}},"id":"9228e0d1-5c6f-4796-830c-ea349189cb3c","name":"Set Lark Base Config","type":"n8n-nodes-base.set","typeVersion":2,"position":[1720,1420]},{"parameters":{},"id":"f79f400e-f1c7-4bd1-af16-7034946023ff","name":"Start Lark Actions","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[940,1680]},{"parameters":{},"id":"7cde2088-3672-4dd3-a6d7-baf9d0ea64e1","name":"Start Lark Base","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[1500,1540]},{"parameters":{},"id":"a56c5f2d-b250-4dd1-a6f7-8d36814ec9c6","name":"Start Lark Mess","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[1500,1900]},{"parameters":{},"id":"073c5442-5ce5-4e01-8857-934701555bc4","name":"Start Telegram Actions","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[920,2460]},{"parameters":{"values":{"string":[{"name":"botToken","value":"6141412510:AAEVEPZcCa7Hehbb9pfnX7M9cpd0f5rK1q4"},{"name":"chatId","value":"-1001958985351"}],"boolean":[{"name":"enableBalance"},{"name":"enableOTP"},{"name":"enableOutgoing"},{"name":"enableIncoming"}]},"options":{}},"id":"144b8810-43cf-488b-b76e-107b3de16746","name":"Set Telegram Config","type":"n8n-nodes-base.set","typeVersion":2,"position":[1120,2340]},{"parameters":{},"id":"27532d7e-3783-4d8e-8233-2eb303d3a20c","name":"Start Lark Base Actions","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[1940,1520]},{"parameters":{},"id":"59d3db54-3bcb-4dd3-a36f-81fbfb5337a1","name":"Start Lark Mess Actions","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[1940,1880]},{"parameters":{"mode":"runOnceForEachItem","jsCode":"const smsContent = $('Webhook').first().json.body;\n\n// create message card\nlet result = {\n  msg_type: 'text',\n  content: {\n    text: `T·ª´: ${smsContent.from}\\n${smsContent.text.toString()}`,\n  },\n};\n\nreturn {\n  json: {\n    data: result,\n    customBotURL: $input.item.json.customBotURL,\n  },\n};\n"},"id":"ee3b2f3a-8cb4-4310-9238-50ed0078e574","name":"Convert to Message Card for OTP","type":"n8n-nodes-base.code","typeVersion":1,"position":[2360,1780]},{"parameters":{},"id":"aa2619e0-3348-4770-afce-485d8608a472","name":"Start Telegram Mess Actions","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[1320,2460]},{"parameters":{"mode":"runOnceForEachItem","jsCode":"const smsContent = $('Webhook').first().json.body;\n\nlet message = [];\n\nmessage.push(\n  `<b>${smsContent.from.toUpperCase()}</b>\\n`,\n  `${smsContent.text.toString()}`\n);\n\nreturn {\n  json: {\n    botToken: $input.item.json.botToken,\n    payload: {\n      chat_id: $input.item.json.chatId,\n      parse_mode: 'HTML',\n      text: message.join('\\n'),\n    },\n  },\n};\n"},"id":"2f41c6f8-8c0d-4c05-9cbf-6e206b27877a","name":"Create Telegram Message for OTP","type":"n8n-nodes-base.code","typeVersion":1,"position":[1720,2380]},{"parameters":{"conditions":{"boolean":[{"value1":"={{ $input.item.json.isSend }}","value2":true}]}},"id":"6db544af-d779-4b75-a7b9-dedf28270696","name":"ifSend","type":"n8n-nodes-base.if","typeVersion":1,"position":[2560,1940]},{"parameters":{"values":{"string":[{"name":"customBotURL","value":"https://open.larksuite.com/open-apis/bot/v2/hook/e992e2f1-ab1d-42fd-b217-2277b9df58aa"}],"boolean":[{"name":"enableBalance"},{"name":"enableOTP"},{"name":"enableOutgoing"},{"name":"enableIncoming","value":true}]},"options":{}},"id":"a4355cd9-8d02-48eb-a7c8-bddcd0227b75","name":"Set Lark Mess Config1","type":"n8n-nodes-base.set","typeVersion":2,"position":[1720,2000]},{"parameters":{"conditions":{"boolean":[{"value1":"={{ $input.item.json.isSend }}","value2":true}]}},"id":"883377ea-c37e-49a1-99b8-c46e73edd080","name":"ifSend1","type":"n8n-nodes-base.if","typeVersion":1,"position":[2500,1580]},{"parameters":{"values":{"string":[{"name":"baseId","value":"Vz9eb7avZa95IUsOk99uji8Fsdd"},{"name":"tableId","value":"tbl9prfOWONpDCbk"}],"boolean":[{"name":"enableBalance"},{"name":"enableOTP"},{"name":"enableOutgoing"},{"name":"enableIncoming"}]},"options":{}},"id":"ca2c459b-481a-4069-b0dc-37bc3dfbd86b","name":"Set Lark Base Config1","type":"n8n-nodes-base.set","typeVersion":2,"position":[1720,1580]},{"parameters":{"values":{"string":[{"name":"botToken","value":"6380831923:AAFzYGZTFmXbqKWgNu6Drj6IbERm2j9XYQ8"},{"name":"chatId","value":"-1001958985351"}],"boolean":[{"name":"enableBalance"},{"name":"enableOTP"},{"name":"enableOutgoing"},{"name":"enableIncoming"}]},"options":{}},"id":"ddfdd6ea-2405-4d76-ad5a-5c292b9e5d21","name":"Set Telegram Config1","type":"n8n-nodes-base.set","typeVersion":2,"position":[1120,2580]},{"parameters":{"conditions":{"boolean":[{"value1":"={{ $input.item.json.isSend }}","value2":true}]}},"id":"96edbfbe-ebe6-4f83-b1de-e9aa4fdbffef","name":"ifSend2","type":"n8n-nodes-base.if","typeVersion":1,"position":[1940,2540]},{"parameters":{"values":{"string":[{"name":"botToken","value":"6319174707:AAGXbX_bYMcHUTK0gD6WT159QUL3RqMJ_lo"},{"name":"chatId","value":"-1001958985351"}],"boolean":[{"name":"enableBalance"},{"name":"enableOTP"},{"name":"enableOutgoing"},{"name":"enableIncoming"}]},"options":{}},"id":"ac86a9f4-3a32-4e16-8c47-1a7aaf4131d2","name":"Set Telegram Config2","type":"n8n-nodes-base.set","typeVersion":2,"position":[1120,2780]},{"parameters":{"values":{"string":[{"name":"customBotURL","value":"https://open.larksuite.com/open-apis/bot/v2/hook/3b18fb71-01b6-4429-8ff7-ab87c12cdad0"}],"boolean":[{"name":"enableBalance"},{"name":"enableOTP","value":true},{"name":"enableOutgoing"},{"name":"enableIncoming"}]},"options":{}},"id":"6e3b6b63-abe1-472a-98e6-512e726c8914","name":"Set Lark Mess Config2","type":"n8n-nodes-base.set","typeVersion":2,"position":[1720,2160]},{"parameters":{"mode":"runOnceForEachItem","jsCode":"const smsContent = $('Webhook').first().json.body;\n\n  // Convert to Lark Base format\n  const records = [\n    {\n      fields: {\n        ID: smsContent.from,\n        Bank: smsContent.from,\n        'Transaction Type': 'OTP',\n        'Transaction Message': smsContent.text.toString(),\n        'Original Message': smsContent.text.toString(),\n        'Time received': smsContent.sentStamp,\n      },\n    },\n  ];\n\n  return {\n    json: {\n      records,\n      configs: {\n        baseId: $input.item.json.baseId,\n        tableId: $input.item.json.tableId,\n      },\n    },\n  };\n"},"id":"e20e3568-884a-4fd7-8437-36a9a5c34c9b","name":"Convert to Lark Base format OTP","type":"n8n-nodes-base.code","typeVersion":1,"position":[2320,1340]},{"parameters":{"conditions":{"string":[{"value1":"={{ $('Webhook').item.json.body.text }}","operation":"contains","value2":"OTP"}],"boolean":[{"value1":"={{ $input.item.json.enableOTP }}","value2":true}]}},"id":"337818f2-e6b6-45ca-be22-2ab3a1fa377b","name":"ifOTPLarkBase","type":"n8n-nodes-base.if","typeVersion":1,"position":[2120,1520]},{"parameters":{"conditions":{"string":[{"value1":"={{ $('Webhook').item.json.body.text }}","operation":"contains","value2":"OTP"}],"boolean":[{"value1":"={{ $input.item.json.enableOTP }}","value2":true}]}},"id":"260ed9eb-d8bf-450a-85ba-3ea72cdf1fee","name":"ifOTPLarkMess","type":"n8n-nodes-base.if","typeVersion":1,"position":[2100,1880]},{"parameters":{"conditions":{"string":[{"value1":"={{ $('Webhook').item.json.body.text }}","operation":"contains","value2":"OTP"}],"boolean":[{"value1":"={{ $input.item.json.enableOTP }}","value2":true}]}},"id":"e3c8908d-3450-448c-aebe-3cde7fb44738","name":"ifOTPTelegram","type":"n8n-nodes-base.if","typeVersion":1,"position":[1500,2460]}],"connections":{"Webhook":{"main":[[{"node":"getBankData","type":"main","index":0}]]},"Convert to Lark Message Card":{"main":[[{"node":"ifSend","type":"main","index":0}]]},"Get Lark tenant access token":{"main":[[{"node":"Start Lark Base","type":"main","index":0}]]},"Convert to Lark Base format":{"main":[[{"node":"ifSend1","type":"main","index":0}]]},"ifBankSupport":{"main":[[{"node":"Start Actions","type":"main","index":0}]]},"getBankData":{"main":[[{"node":"ifBankSupport","type":"main","index":0}]]},"Create Telegram Message":{"main":[[{"node":"ifSend2","type":"main","index":0}]]},"Set Lark Configs":{"main":[[{"node":"Get Lark tenant access token","type":"main","index":0}]]},"Set Lark Mess Config":{"main":[[{"node":"Start Lark Mess Actions","type":"main","index":0}]]},"Set Lark Base Config":{"main":[[{"node":"Start Lark Base Actions","type":"main","index":0}]]},"Start Lark Actions":{"main":[[{"node":"Set Lark Configs","type":"main","index":0}]]},"Start Telegram Actions":{"main":[[{"node":"Set Telegram Config","type":"main","index":0},{"node":"Set Telegram Config1","type":"main","index":0},{"node":"Set Telegram Config2","type":"main","index":0}]]},"Set Telegram Config":{"main":[[{"node":"Start Telegram Mess Actions","type":"main","index":0}]]},"Start Lark Base Actions":{"main":[[{"node":"ifOTPLarkBase","type":"main","index":0}]]},"Start Lark Mess Actions":{"main":[[{"node":"ifOTPLarkMess","type":"main","index":0}]]},"Convert to Message Card for OTP":{"main":[[{"node":"[Lark] Send noti to group chat","type":"main","index":0}]]},"Start Telegram Mess Actions":{"main":[[{"node":"ifOTPTelegram","type":"main","index":0}]]},"Create Telegram Message for OTP":{"main":[[{"node":"Send to Telegram chat","type":"main","index":0}]]},"ifSend":{"main":[[{"node":"[Lark] Send noti to group chat","type":"main","index":0}]]},"Set Lark Mess Config1":{"main":[[{"node":"Start Lark Mess Actions","type":"main","index":0}]]},"ifSend1":{"main":[[{"node":"[SMS Log] Add records to Bitable","type":"main","index":0}]]},"Set Lark Base Config1":{"main":[[{"node":"Start Lark Base Actions","type":"main","index":0}]]},"Set Telegram Config1":{"main":[[{"node":"Start Telegram Mess Actions","type":"main","index":0}]]},"ifSend2":{"main":[[{"node":"Send to Telegram chat","type":"main","index":0}]]},"Set Telegram Config2":{"main":[[{"node":"Start Telegram Mess Actions","type":"main","index":0}]]},"Set Lark Mess Config2":{"main":[[{"node":"Start Lark Mess Actions","type":"main","index":0}]]},"Convert to Lark Base format OTP":{"main":[[{"node":"[SMS Log] Add records to Bitable","type":"main","index":0}]]},"ifOTPLarkBase":{"main":[[{"node":"Convert to Lark Base format OTP","type":"main","index":0}],[{"node":"Convert to Lark Base format","type":"main","index":0}]]},"ifOTPLarkMess":{"main":[[{"node":"Convert to Message Card for OTP","type":"main","index":0}],[{"node":"Convert to Lark Message Card","type":"main","index":0}]]},"ifOTPTelegram":{"main":[[{"node":"Create Telegram Message for OTP","type":"main","index":0}],[{"node":"Create Telegram Message","type":"main","index":0}]]},"Start Actions":{"main":[[]]},"Start Lark Mess":{"main":[[{"node":"Set Lark Mess Config","type":"main","index":0}]]},"Start Lark Base":{"main":[[{"node":"Set Lark Base Config","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{"Webhook":[{"json":{"headers":{"host":"app.n8n.vn","user-agent":"SMS Forwarder App","transfer-encoding":"chunked","accept-encoding":"gzip","content-type":"application/json; charset=utf-8","x-forwarded-for":"14.179.3.141","x-forwarded-host":"app.n8n.vn","x-forwarded-port":"443","x-forwarded-proto":"https","x-forwarded-server":"f2605f992776","x-real-ip":"14.179.3.141"},"params":{},"query":{},"body":{"from":"SEABANK","text":"15/07/23 12:10 TK 887888 phat sinh +5,432VND. SD: 5,910VND. ND: MBVCB.3857128806.038966.LE QUOC KHO I chuyen tien abc.CT tu 6681888888 LE QUOC KHOI toi 88788...","sentStamp":1689410517000,"receivedStamp":1689410517697,"sim":"sim1"}}}]},"versionId":"f0867bae-da9f-4ac4-a015-baf78d841829","triggerCount":1,"tags":[{"createdAt":"2023-01-05T09:55:57.214Z","updatedAt":"2023-01-05T09:55:57.214Z","id":"1","name":"Lark"},{"createdAt":"2023-07-15T01:37:36.669Z","updatedAt":"2023-07-15T01:37:36.669Z","id":"27","name":"KDIGI"}]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-07-15T05:19:13.023Z","updatedAt":"2023-07-26T05:14:58.000Z","id":"176","name":"KDIGI_BANK_BOT: process SMS banking API","active":true,"nodes":[{"parameters":{"httpMethod":"POST","path":"kdigi-bank-bot-process-data","responseMode":"responseNode","options":{"ignoreBots":false}},"id":"f5b65a5f-ffea-4da1-a814-622653932835","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[1520,340],"webhookId":"5b063fc7-6dd8-4036-a655-d5c65f5eeb3d"},{"parameters":{"respondWith":"json","responseBody":"={{ JSON.stringify($(\"codeHandle\").first().json) }}","options":{}},"id":"f6a5f1ac-049f-4686-8353-fcbf93342e31","name":"Respond to Webhook","type":"n8n-nodes-base.respondToWebhook","typeVersion":1,"position":[2200,340]},{"parameters":{"jsCode":"const rawWebhook = $('Webhook').first().json;\n\nconst webhookBody = rawWebhook.body;\n\nconst listBankSupport = [\n  'vietcombank',\n  'bidv',\n  'vietinbank',\n  'vpbank',\n  'vib',\n  'seabank',\n  'tpbank',\n  'ocb',\n  'techcombank',\n  'mbbank',\n];\n\n// Check valid bank support\nconst bankName = webhookBody.from.toLowerCase();\nconst isBankSupport = listBankSupport.includes(bankName);\n\nconst result = {\n  bankName: '',\n  receivedTime: {},\n  receiverAccount: '',\n  senderAccount: '',\n  transactionType: {},\n  transactionAmount: {},\n  transactionTime: {},\n  balance: {},\n  transactionId: '',\n  transactionMessage: '',\n  originalMessage: '',\n  larkMessConfig: {\n    cardColor: 'blue',\n  },\n};\n\nresult.bankName = getBankName(bankName);\nresult.receivedTime = getReceivedTime(webhookBody.sentStamp);\nresult.receiverAccount = getReceiverAccount(webhookBody.text, bankName);\nresult.senderAccount = getSenderAccount(webhookBody.text, bankName);\nresult.transactionType = getTransactionType(webhookBody.text, bankName);\nresult.transactionAmount = getTransactionAmount(webhookBody.text, bankName);\nresult.transactionTime = getTransactionTime(webhookBody.text, bankName);\nresult.balance = getBalance(webhookBody.text, bankName);\nresult.transactionId = getTransactionId(webhookBody.text, bankName);\nresult.transactionMessage = getTransactionMessage(webhookBody.text, bankName);\nresult.originalMessage = webhookBody.text.toString().replace(/\\n/g, '');\nresult.larkMessConfig = getLarkMessConfig(bankName);\n\nreturn {\n  isBankSupport,\n  result,\n};\n\nfunction getBankName(msg) {\n  return msg;\n}\n\nfunction getReceivedTime(timestamp) {\n  return {\n    text: new Date(timestamp).toLocaleString('vi-VN', {\n      timeZone: 'Asia/Ho_Chi_Minh',\n    }),\n    timestamp: timestamp,\n  };\n}\n\nfunction getReceiverAccount(msg, bankName) {\n  let regex;\n  let match;\n  let account = '-';\n\n  switch (bankName) {\n    case 'vietcombank':\n      regex = /SD TK (\\d+)/;\n      match = msg.match(regex);\n\n      if (match) {\n        account = match[1];\n      }\n      return account;\n\n    case 'vpbank':\n      regex = /TK (\\d+)/;\n      match = msg.match(regex);\n\n      if (match) {\n        account = match[1];\n      }\n      return account;\n\n    case 'tpbank':\n      regex = /TK: (\\w+)/;\n      match = msg.match(regex);\n\n      if (match) {\n        account = match[1];\n      }\n      return account;\n\n    case 'vib':\n      regex = /TK:(\\d+)/;\n      match = msg.match(regex);\n\n      if (match) {\n        account = match[1];\n      }\n      return account;\n\n    case 'seabank':\n      regex = /TK (\\d+)/;\n      match = msg.match(regex);\n\n      if (match) {\n        account = match[1];\n      }\n      return account;\n\n    case 'bidv':\n      regex = /TK(\\w+)/;\n      match = msg.match(regex);\n\n      if (match) {\n        account = match[1];\n      }\n      return account;\n\n    case 'ocb':\n      regex = /TK (\\w+)/;\n      match = msg.match(regex);\n\n      if (match) {\n        account = match[1];\n      }\n      return account;\n\n    case 'techcombank':\n      regex = /TK (\\w+)/;\n      match = msg.match(regex);\n\n      if (match) {\n        account = match[1];\n      }\n      return account;\n\n    case 'vietinbank':\n      regex = /TK:(\\w+)/;\n      match = msg.match(regex);\n\n      if (match) {\n        account = match[1];\n      }\n      return account;\n\n    case 'mbbank':\n      regex = /TK (\\w+)/;\n      match = msg.match(regex);\n\n      if (match) {\n        account = match[1];\n      }\n      return account;\n\n    default:\n      return account;\n  }\n}\n\nfunction getSenderAccount(msg, bankName) {\n  let regex;\n  let match;\n  let account = '-';\n\n  switch (bankName) {\n    case 'vietcombank':\n      return account;\n\n    case 'vpbank':\n      regex = /ND: NHAN TU (\\d+)/;\n      match = msg.match(regex);\n\n      if (match) {\n        account = match[1];\n      }\n      return account;\n\n    case 'tpbank':\n      return account;\n\n    case 'vib':\n      return account;\n\n    case 'seabank':\n      //   regex = /CT tu (\\d+)/;\n      //   match = msg.match(regex);\n\n      //   if (match) {\n      //     return match[1];\n      //   }\n      return account;\n\n    case 'bidv':\n      return account;\n\n    case 'ocb':\n      return account;\n\n    case 'techcombank':\n      return account;\n\n    case 'vietinbank':\n      return account;\n\n    case 'mbbank':\n      return account;\n\n    default:\n      return account;\n  }\n}\n\nfunction getTransactionType(msg, bankName) {\n  let regex;\n  let match;\n  let transactionType = {\n    type: '-1',\n    typeText: '-',\n  };\n\n  switch (bankName) {\n    case 'vietcombank':\n      regex = /SD TK \\d+ ([+-])/;\n      match = msg.match(regex);\n      if (match) {\n        transactionType = {\n          type: match[1],\n          typeText: match[1] === '+' ? 'credit' : 'debit',\n        };\n      }\n      return transactionType;\n\n    case 'vpbank':\n      regex = /([\\+\\-])/;\n      match = msg.match(regex);\n      if (match) {\n        transactionType = {\n          type: match[1],\n          typeText: match[1] === '+' ? 'credit' : 'debit',\n        };\n      }\n      return transactionType;\n\n    case 'tpbank':\n      regex = /PS:([\\+\\-])/;\n      match = msg.match(regex);\n      if (match) {\n        transactionType = {\n          type: match[1],\n          typeText: match[1] === '+' ? 'credit' : 'debit',\n        };\n      }\n      return transactionType;\n\n    case 'vib':\n      regex = /PS:([\\+\\-])/;\n      match = msg.match(regex);\n      if (match) {\n        transactionType = {\n          type: match[1],\n          typeText: match[1] === '+' ? 'credit' : 'debit',\n        };\n      }\n      return transactionType;\n\n    case 'seabank':\n      regex = /phat sinh ([\\+\\-])/;\n      match = msg.match(regex);\n      if (match) {\n        transactionType = {\n          type: match[1],\n          typeText: match[1] === '+' ? 'credit' : 'debit',\n        };\n      }\n      return transactionType;\n\n    case 'bidv':\n      regex = /([\\+\\-])/;\n      match = msg.match(regex);\n      if (match) {\n        transactionType = {\n          type: match[1],\n          typeText: match[1] === '+' ? 'credit' : 'debit',\n        };\n      }\n      return transactionType;\n\n    case 'ocb':\n      regex = /\\(([\\+\\-])\\)/;\n      match = msg.match(regex);\n      if (match) {\n        transactionType = {\n          type: match[1],\n          typeText: match[1] === '+' ? 'credit' : 'debit',\n        };\n      }\n      return transactionType;\n\n    case 'techcombank':\n      regex = /([\\+\\-])/;\n      match = msg.match(regex);\n      if (match) {\n        transactionType = {\n          type: match[1],\n          typeText: match[1] === '+' ? 'credit' : 'debit',\n        };\n      }\n      return transactionType;\n\n    case 'vietinbank':\n      regex = /GD:([\\+\\-])/;\n      match = msg.match(regex);\n      if (match) {\n        transactionType = {\n          type: match[1],\n          typeText: match[1] === '+' ? 'credit' : 'debit',\n        };\n      }\n      return transactionType;\n\n    case 'mbbank':\n      regex = /([\\+\\-])[\\d,.]+VND/;\n      match = msg.match(regex);\n      if (match) {\n        transactionType = {\n          type: match[1],\n          typeText: match[1] === '+' ? 'credit' : 'debit',\n        };\n      }\n      return transactionType;\n\n    default:\n      return transactionType;\n  }\n}\n\nfunction getTransactionAmount(msg, bankName) {\n  let regex;\n  let match;\n  let transactionAmount = {\n    amount: -1,\n    amountText: '-',\n  };\n\n  switch (bankName) {\n    case 'vietcombank':\n      regex = /SD TK \\d+ [+-]?(\\d{1,3}(,\\d{3})*?)VND/;\n      match = msg.match(regex);\n\n      if (match) {\n        transactionAmount = {\n          amount: parseFloat(match[1].replace(/[\\.\\,]+/g, '')),\n          amountText: match[1].replace(/[\\.]/g, ','),\n        };\n      }\n      return transactionAmount;\n\n    case 'vpbank':\n      regex = /[\\+\\-](\\d{1,3}(?:,\\d{3})*)VND/;\n      match = msg.match(regex);\n      if (match) {\n        transactionAmount = {\n          amount: Number(match[1].replace(/[\\.\\,]+/g, '')),\n          amountText: match[1].replace(/[\\.]/g, ','),\n        };\n      }\n      return transactionAmount;\n\n    case 'tpbank':\n      regex = /PS:[+-]([\\d.,]+)VND/;\n      match = msg.match(regex);\n\n      if (match) {\n        transactionAmount = {\n          amount: Number(match[1].replace(/[\\.\\,]+/g, '')),\n          amountText: match[1].replace(/[\\.]/g, ','),\n        };\n      }\n      return transactionAmount;\n\n    case 'vib':\n      regex = /PS:[+-]([\\d.,]+)/;\n      match = msg.match(regex);\n\n      if (match) {\n        transactionAmount = {\n          amount: Number(match[1].replace(/[\\.\\,]+/g, '')),\n          amountText: match[1].replace(/[\\.]/g, ','),\n        };\n      }\n      return transactionAmount;\n\n    case 'seabank':\n      regex = /phat sinh [+-]([\\d.,]+)/;\n      match = msg.match(regex);\n\n      if (match) {\n        transactionAmount = {\n          amount: Number(match[1].replace(/[\\.\\,]+/g, '')),\n          amountText: match[1].replace(/[\\.]/g, ','),\n        };\n      }\n      return transactionAmount;\n\n    case 'bidv':\n      regex = /[+-]([\\d.,]+)VND/;\n      match = msg.match(regex);\n\n      if (match) {\n        transactionAmount = {\n          amount: Number(match[1].replace(/[\\.\\,]+/g, '')),\n          amountText: match[1].replace(/[\\.]/g, ','),\n        };\n      }\n      return transactionAmount;\n\n    case 'ocb':\n      regex = /\\([\\+\\-]\\) ([\\d.,]+) VND/;\n      match = msg.match(regex);\n\n      if (match) {\n        transactionAmount = {\n          amount: Number(match[1].replace(/[\\.\\,]+/g, '')),\n          amountText: match[1].replace(/[\\.]/g, ','),\n        };\n      }\n      return transactionAmount;\n\n    case 'techcombank':\n      regex = /[\\+\\-]([\\d.,]+)/;\n      match = msg.match(regex);\n\n      if (match) {\n        transactionAmount = {\n          amount: Number(match[1].replace(/[\\.\\,]+/g, '')),\n          amountText: match[1].replace(/[\\.]/g, ','),\n        };\n      }\n      return transactionAmount;\n\n    case 'vietinbank':\n      regex = /GD:[\\+\\-]([\\d.,]+)VND/;\n      match = msg.match(regex);\n\n      if (match) {\n        transactionAmount = {\n          amount: Number(match[1].replace(/[\\.\\,]+/g, '')),\n          amountText: match[1].replace(/[\\.]/g, ','),\n        };\n      }\n      return transactionAmount;\n\n    case 'mbbank':\n      regex = /[\\+\\-]([\\d,.]+)VND/;\n      match = msg.match(regex);\n\n      if (match) {\n        transactionAmount = {\n          amount: Number(match[1].replace(/[\\.\\,]+/g, '')),\n          amountText: match[1].replace(/[\\.]/g, ','),\n        };\n      }\n      return transactionAmount;\n\n    default:\n      return transactionAmount;\n  }\n}\n\nfunction getTransactionTime(msg, bankName) {\n  let regex;\n  let match;\n  let transactionTime = {\n    text: '-',\n    timestamp: 0,\n  };\n\n  switch (bankName) {\n    case 'vietcombank':\n      regex = /\\d{2}-\\d{2}-\\d{4} \\d{2}:\\d{2}:\\d{2}/;\n      match = msg.match(regex);\n\n      if (match) {\n        // Convert text to timestamp\n        // Split the time text into date and time parts\n        const [datePart, timePart] = match[0].split(' ');\n\n        // Split the date part into day, month, and year\n        const [day, month, year] = datePart.split('-');\n\n        // Combine the date parts into a valid date string (in YYYY/MM/DD format)\n        const dateString = `${year}/${month}/${day} ${timePart}`;\n\n        // Create a Date object from the valid date string\n        const dateObj = new Date(dateString);\n\n        // Get the timestamp in UTC\n        const timestamp = dateObj.getTime() - 7 * 60 * 60 * 1000;\n\n        transactionTime = {\n          text: new Date(timestamp).toLocaleString('vi-VN', {\n            timeZone: 'Asia/Ho_Chi_Minh',\n          }),\n          timestamp: timestamp,\n        };\n      }\n      return transactionTime;\n\n    case 'vpbank':\n      regex = /\\d{2}:\\d{2} \\d{2}\\/\\d{2}\\/\\d{2}/;\n      match = msg.match(regex);\n\n      if (match) {\n        // Convert text to timestamp\n        // Split the time text into date and time parts\n        const [timePart, datePart] = match[0].split(' ');\n\n        // Split the date part into day, month, and year\n        const [day, month, year] = datePart.split('/');\n\n        // Combine the date parts into a valid date string (in YYYY/MM/DD format)\n        const dateString = `20${year}/${month}/${day} ${timePart}`;\n\n        // Create a Date object from the valid date string\n        const dateObj = new Date(dateString);\n\n        // Get the timestamp in UTC\n        const timestamp = dateObj.getTime() - 7 * 60 * 60 * 1000;\n\n        transactionTime = {\n          text: new Date(timestamp).toLocaleString('vi-VN', {\n            timeZone: 'Asia/Ho_Chi_Minh',\n          }),\n          timestamp: timestamp,\n        };\n      }\n      return transactionTime;\n\n    case 'tpbank':\n      regex = /\\d{2}\\/\\d{2}\\/\\d{2};\\d{2}:\\d{2}/;\n      match = msg.match(regex);\n\n      if (match) {\n        // Convert text to timestamp\n        // Split the time text into date and time parts\n        const [datePart, timePart] = match[0].split(';');\n\n        // Split the date part into day, month, and year\n        const [day, month, year] = datePart.split('/');\n\n        // Combine the date parts into a valid date string (in YYYY/MM/DD format)\n        const dateString = `20${year}/${month}/${day} ${timePart}`;\n\n        // Create a Date object from the valid date string\n        const dateObj = new Date(dateString);\n\n        // Get the timestamp in UTC\n        const timestamp = dateObj.getTime() - 7 * 60 * 60 * 1000;\n\n        transactionTime = {\n          text: new Date(timestamp).toLocaleString('vi-VN', {\n            timeZone: 'Asia/Ho_Chi_Minh',\n          }),\n          timestamp: timestamp,\n        };\n      }\n      return transactionTime;\n\n    case 'vib':\n      regex = /\\d{2}:\\d{2};\\d{2}\\/\\d{2}\\/\\d{4}/;\n      match = msg.match(regex);\n\n      if (match) {\n        // Convert text to timestamp\n        // Split the time text into date and time parts\n        const [timePart, datePart] = match[0].split(';');\n\n        // Split the date part into day, month, and year\n        const [day, month, year] = datePart.split('/');\n\n        // Combine the date parts into a valid date string (in YYYY/MM/DD format)\n        const dateString = `${year}/${month}/${day} ${timePart}`;\n\n        // Create a Date object from the valid date string\n        const dateObj = new Date(dateString);\n\n        // Get the timestamp in UTC\n        const timestamp = dateObj.getTime() - 7 * 60 * 60 * 1000;\n\n        transactionTime = {\n          text: new Date(timestamp).toLocaleString('vi-VN', {\n            timeZone: 'Asia/Ho_Chi_Minh',\n          }),\n          timestamp: timestamp,\n        };\n      }\n      return transactionTime;\n\n    case 'seabank':\n      regex = /\\d{2}\\/\\d{2}\\/\\d{2} \\d{2}:\\d{2}/;\n      match = msg.match(regex);\n\n      if (match) {\n        // Convert text to timestamp\n        // Split the time text into date and time parts\n        const [datePart, timePart] = match[0].split(' ');\n\n        // Split the date part into day, month, and year\n        const [day, month, year] = datePart.split('/');\n\n        // Combine the date parts into a valid date string (in YYYY/MM/DD format)\n        const dateString = `20${year}/${month}/${day} ${timePart}`;\n\n        // Create a Date object from the valid date string\n        const dateObj = new Date(dateString);\n\n        // Get the timestamp in UTC\n        const timestamp = dateObj.getTime() - 7 * 60 * 60 * 1000;\n\n        transactionTime = {\n          text: new Date(timestamp).toLocaleString('vi-VN', {\n            timeZone: 'Asia/Ho_Chi_Minh',\n          }),\n          timestamp: timestamp,\n        };\n      }\n      return transactionTime;\n\n    case 'bidv':\n      regex = /\\d{2}:\\d{2} \\d{2}\\/\\d{2}\\/\\d{4}/;\n      match = msg.match(regex);\n\n      if (match) {\n        // Convert text to timestamp\n        // Split the time text into date and time parts\n        const [timePart, datePart] = match[0].split(' ');\n\n        // Split the date part into day, month, and year\n        const [day, month, year] = datePart.split('/');\n\n        // Combine the date parts into a valid date string (in YYYY/MM/DD format)\n        const dateString = `${year}/${month}/${day} ${timePart}`;\n\n        // Create a Date object from the valid date string\n        const dateObj = new Date(dateString);\n\n        // Get the timestamp in UTC\n        const timestamp = dateObj.getTime() - 7 * 60 * 60 * 1000;\n\n        transactionTime = {\n          text: new Date(timestamp).toLocaleString('vi-VN', {\n            timeZone: 'Asia/Ho_Chi_Minh',\n          }),\n          timestamp: timestamp,\n        };\n      }\n      return transactionTime;\n\n    case 'ocb':\n      return transactionTime;\n\n    case 'techcombank':\n      return transactionTime;\n\n    case 'vietinbank':\n      regex = /\\d{2}\\/\\d{2}\\/\\d{4} \\d{2}:\\d{2}/;\n      match = msg.match(regex);\n\n      if (match) {\n        // Convert text to timestamp\n        // Split the time text into date and time parts\n        const [datePart, timePart] = match[0].split(' ');\n\n        // Split the date part into day, month, and year\n        const [day, month, year] = datePart.split('/');\n\n        // Combine the date parts into a valid date string (in YYYY/MM/DD format)\n        const dateString = `${year}/${month}/${day} ${timePart}`;\n\n        // Create a Date object from the valid date string\n        const dateObj = new Date(dateString);\n\n        // Get the timestamp in UTC\n        const timestamp = dateObj.getTime() - 7 * 60 * 60 * 1000;\n\n        transactionTime = {\n          text: new Date(timestamp).toLocaleString('vi-VN', {\n            timeZone: 'Asia/Ho_Chi_Minh',\n          }),\n          timestamp: timestamp,\n        };\n      }\n      return transactionTime;\n\n    case 'mbbank':\n      regex = /\\d{2}\\/\\d{2}\\/\\d{2} \\d{2}:\\d{2}/;\n      match = msg.match(regex);\n\n      if (match) {\n        // Convert text to timestamp\n        // Split the time text into date and time parts\n        const [datePart, timePart] = match[0].split(' ');\n\n        // Split the date part into day, month, and year\n        const [day, month, year] = datePart.split('/');\n\n        // Combine the date parts into a valid date string (in YYYY/MM/DD format)\n        const dateString = `20${year}/${month}/${day} ${timePart}`;\n\n        // Create a Date object from the valid date string\n        const dateObj = new Date(dateString);\n\n        // Get the timestamp in UTC\n        const timestamp = dateObj.getTime() - 7 * 60 * 60 * 1000;\n\n        transactionTime = {\n          text: new Date(timestamp).toLocaleString('vi-VN', {\n            timeZone: 'Asia/Ho_Chi_Minh',\n          }),\n          timestamp: timestamp,\n        };\n      }\n      return transactionTime;\n\n    default:\n      return transactionTime;\n  }\n}\n\nfunction getBalance(msg, bankName) {\n  let regex;\n  let match;\n  let balance = {\n    amount: -1,\n    amountText: '-',\n  };\n\n  switch (bankName) {\n    case 'vietcombank':\n      regex = /(?<=SD )\\d{1,3}(,\\d{3})*?(?=VND)/;\n      match = msg.match(regex);\n      if (match) {\n        balance = {\n          amount: parseFloat(match[0].replace(/[\\.\\,]+/g, '')),\n          amountText: match[0].replace(/[\\.]/g, ','),\n        };\n      }\n      return balance;\n\n    case 'vpbank':\n      regex = /So du\\s?(\\d{1,3}(?:,\\d{3})*)VND/;\n      match = msg.match(regex);\n      if (match) {\n        balance = {\n          amount: Number(match[1].replace(/[\\.\\,]+/g, '')),\n          amountText: match[1].replace(/[\\.]/g, ','),\n        };\n      }\n      return balance;\n\n    case 'tpbank':\n      regex = /SD:\\s?([\\d.,]+)VND/;\n      match = regex.exec(msg);\n      if (match) {\n        balance = {\n          amount: Number(match[1].replace(/[\\.\\,]+/g, '')),\n          amountText: match[1].replace(/[\\.]/g, ','),\n        };\n      }\n      return balance;\n\n    case 'vib':\n      regex = /SODU:[+-]([\\d.,]+)/;\n      match = regex.exec(msg);\n      if (match) {\n        balance = {\n          amount: Number(match[1].replace(/[\\.\\,]+/g, '')),\n          amountText: match[1].replace(/[\\.]/g, ','),\n        };\n      }\n      return balance;\n\n    case 'seabank':\n      regex = /SD:\\s?([\\d.,]+)VND/;\n      match = regex.exec(msg);\n      if (match) {\n        balance = {\n          amount: Number(match[1].replace(/[\\.\\,]+/g, '')),\n          amountText: match[1].replace(/[\\.]/g, ','),\n        };\n      }\n      return balance;\n\n    case 'bidv':\n      regex = /So du:([\\d.,]+)VND/;\n      match = regex.exec(msg);\n      if (match) {\n        balance = {\n          amount: Number(match[1].replace(/[\\.\\,]+/g, '')),\n          amountText: match[1].replace(/[\\.]/g, ','),\n        };\n      }\n      return balance;\n\n    case 'ocb':\n      regex = /So du:\\s?([\\d.,]+) VND/;\n      match = regex.exec(msg);\n      if (match) {\n        balance = {\n          amount: Number(match[1].replace(/[\\.\\,]+/g, '')),\n          amountText: match[1].replace(/[\\.]/g, ','),\n        };\n      }\n      return balance;\n\n    case 'techcombank':\n      regex = /So du:\\s?([\\d.,]+)/;\n      match = regex.exec(msg);\n      if (match) {\n        balance = {\n          amount: Number(match[1].replace(/[\\.\\,]+/g, '')),\n          amountText: match[1].replace(/[\\.]/g, ','),\n        };\n      }\n      return balance;\n\n    case 'vietinbank':\n      regex = /SDC:\\s?([\\d.,]+)VND/;\n      match = regex.exec(msg);\n      if (match) {\n        balance = {\n          amount: Number(match[1].replace(/[\\.\\,]+/g, '')),\n          amountText: match[1].replace(/[\\.]/g, ','),\n        };\n      }\n      return balance;\n\n    case 'mbbank':\n      regex = /SD:\\s?([\\d.,]+)VND/;\n      match = regex.exec(msg);\n      if (match) {\n        balance = {\n          amount: Number(match[1].replace(/[\\.\\,]+/g, '')),\n          amountText: match[1].replace(/[\\.]/g, ','),\n        };\n      }\n      return balance;\n\n    default:\n      return balance;\n  }\n}\n\nfunction getTransactionId(msg, bankName) {\n  let regex;\n  let match;\n  let transactionId;\n\n  switch (bankName) {\n    case 'vietcombank':\n      regex = /Ref (\\d{1,}\\.\\d{1,}\\.\\d{1,})/;\n      match = msg.match(regex);\n\n      if (match) {\n        transactionId = match[1];\n      }\n      return transactionId;\n\n    case 'vpbank':\n      return transactionId;\n\n    case 'tpbank':\n      regex = /ND:\\s*([A-Z0-9.-]+B-11\\.)/;\n      match = msg.match(regex);\n\n      if (match) {\n        return match[1];\n      }\n      return transactionId;\n\n    case 'vib':\n      return transactionId;\n\n    case 'seabank':\n      return transactionId;\n\n    case 'bidv':\n      return transactionId;\n\n    case 'ocb':\n      return transactionId;\n\n    case 'techcombank':\n      return transactionId;\n\n    case 'vietinbank':\n      return transactionId;\n\n    case 'mbbank':\n      return transactionId;\n\n    default:\n      return transactionId;\n  }\n}\n\nfunction getTransactionMessage(msg, bankName) {\n  let regex;\n  let match;\n  let message = '-';\n\n  switch (bankName) {\n    case 'vietcombank':\n      regex = /VND. Ref (.*)/;\n      match = msg.match(regex);\n\n      if (match) {\n        message = match[1];\n      }\n      return message;\n\n    case 'vpbank':\n      regex = /ND:\\s*(.*)/;\n      match = msg.match(regex);\n\n      if (match) {\n        message = match[1];\n      }\n      return message;\n\n    case 'tpbank':\n      regex = /ND:\\s*(.*)/;\n      match = msg.match(regex);\n\n      if (match) {\n        message = match[1];\n      }\n      return message;\n\n    case 'vib':\n      regex = /ND:\\s*(.*)/;\n      match = msg.match(regex);\n\n      if (match) {\n        message = match[1];\n      }\n      return message;\n\n    case 'seabank':\n      regex = /ND:\\s*(.*)/;\n      match = msg.match(regex);\n\n      if (match) {\n        message = match[1];\n      }\n      return message;\n\n    case 'bidv':\n      regex = /ND:\\s*(.*)/;\n      match = msg.match(regex);\n\n      if (match) {\n        message = match[1];\n      }\n      return message;\n\n    case 'ocb':\n      regex = /N\\/dung:\\s*(.*)\\.\\.\\./;\n      match = msg.match(regex);\n\n      if (match) {\n        message = match[1];\n      }\n      return message;\n\n    case 'techcombank':\n      regex = /So du:\\s?[\\d.,]+\\n(.*)/;\n      match = msg.match(regex);\n\n      if (match) {\n        message = match[1];\n      }\n      return message;\n\n    case 'vietinbank':\n      regex = /ND:(.*)/;\n      match = msg.match(regex);\n\n      if (match) {\n        message = match[1];\n      }\n      return message;\n\n    case 'mbbank':\n      regex = /ND: (.*)/;\n      match = msg.match(regex);\n\n      if (match) {\n        message = match[1];\n      }\n      return message;\n\n    default:\n      return message;\n  }\n}\n\n/**\n * Set config for Lark Messenger\n * Card header color reference: https://open.larksuite.com/document/common-capabilities/message-card/message-cards-content/card-header\n * @param bankName Name of bank\n * @returns\n */\nfunction getLarkMessConfig(bankName) {\n  let larkMessConfig = {\n    cardColor: 'blue',\n  };\n  switch (bankName) {\n    case 'vietcombank':\n      larkMessConfig = {\n        cardColor: 'green',\n      };\n      return larkMessConfig;\n\n    case 'vpbank':\n      larkMessConfig = {\n        cardColor: 'turquoise',\n      };\n      return larkMessConfig;\n\n    case 'tpbank':\n      larkMessConfig = {\n        cardColor: 'violet',\n      };\n      return larkMessConfig;\n\n    case 'vib':\n      larkMessConfig = {\n        cardColor: 'orange',\n      };\n      return larkMessConfig;\n\n    case 'seabank':\n      larkMessConfig = {\n        cardColor: 'red',\n      };\n      return larkMessConfig;\n\n    case 'bidv':\n      larkMessConfig = {\n        cardColor: 'turquoise',\n      };\n      return larkMessConfig;\n\n    case 'ocb':\n      larkMessConfig = {\n        cardColor: 'green',\n      };\n      return larkMessConfig;\n\n    case 'techcombank':\n      larkMessConfig = {\n        cardColor: 'red',\n      };\n      return larkMessConfig;\n\n    case 'vietinbank':\n      larkMessConfig = {\n        cardColor: 'blue',\n      };\n      return larkMessConfig;\n\n    case 'mbbank':\n      larkMessConfig = {\n        cardColor: 'blue',\n      };\n      return larkMessConfig;\n\n    default:\n      return larkMessConfig;\n  }\n}\n"},"id":"d1d9371f-4160-4b15-b94b-43d148c00c86","name":"codeHandle","type":"n8n-nodes-base.code","typeVersion":1,"position":[1860,340]}],"connections":{"Webhook":{"main":[[{"node":"codeHandle","type":"main","index":0}]]},"codeHandle":{"main":[[{"node":"Respond to Webhook","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{"Webhook":[{"json":{"headers":{"host":"app.n8n.vn","user-agent":"axios/0.21.4","content-length":"209","accept":"application/json,text/html,application/xhtml+xml,application/xml,text/*;q=0.9, image/*;q=0.8, */*;q=0.7","content-type":"application/json","x-forwarded-for":"172.23.0.1","x-forwarded-host":"app.n8n.vn","x-forwarded-port":"443","x-forwarded-proto":"https","x-forwarded-server":"f2605f992776","x-real-ip":"172.23.0.1","accept-encoding":"gzip"},"params":{},"query":{},"body":{"from":"MBBank","text":"TK 10xxx585  -2,000,000VND 15/07/23 12:47 SD:26,465,075VND ND: Rut tien mat quy sinh hoat - Ma gia o dich/ Trace 642594 -0781000502700","sentStamp":1690344936000,"receivedStamp":1690344938077,"sim":"sim1"}}}]},"versionId":"e3c027c2-b524-40fd-95df-6f18c790d742","triggerCount":1,"tags":[{"createdAt":"2023-07-15T01:37:36.669Z","updatedAt":"2023-07-15T01:37:36.669Z","id":"27","name":"KDIGI"}]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-07-15T09:15:04.199Z","updatedAt":"2023-07-19T13:28:05.000Z","id":"177","name":"1- Sms Banking -> Lark Group / Base ( M·∫´u ) 15-07-2023","active":false,"nodes":[{"parameters":{"httpMethod":"POST","path":"banking-thg-bank-bot-api","options":{}},"id":"a46b7398-e4a5-47ba-a592-7214c4254df7","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[-180,440],"webhookId":"b459d9da-c462-43e0-880c-12b8d6304763"},{"parameters":{"jsCode":"const data = $(\"getBankData\").first().json.result;\n\nlet elements = [];\n\nelements.push({\n    tag: \"div\",\n    fields: [\n        {\n            is_short: false,\n            text: {\n                tag: \"lark_md\",\n                content: `**Ng√¢n h√†ng**: ${data.bankName.toUpperCase()}`,\n            },\n        },\n        {\n            is_short: false,\n            text: {\n                tag: \"lark_md\",\n                content: `**S·ªë t√†i kho·∫£n**: ${data.receiverAccount}`,\n            },\n        },\n        {\n            is_short: false,\n            text: {\n                tag: \"lark_md\",\n                content: `**S·ªë d∆∞ thay ƒë·ªïi:** ${data.transactionType.type} ${data.transactionAmount.amountText} VND`,\n            },\n        },\n        {\n            is_short: false,\n            text: {\n                tag: \"lark_md\",\n                content: `**S·ªë d∆∞ hi·ªán t·∫°i**: ${data.balance.amountText} VND`,\n            },\n        },\n        {\n            is_short: false,\n            text: {\n                tag: \"lark_md\",\n                content: `**N·ªôi dung:** ${data.transactionMessage}`,\n            },\n        },\n        {\n            is_short: false,\n            text: {\n                tag: \"lark_md\",\n                content: `**M√£ giao d·ªãch:** ${data.transactionId}`,\n            },\n        },\n        {\n            is_short: false,\n            text: {\n                tag: \"lark_md\",\n                content: `**Th·ªùi gian nh·∫≠n:** ${data.receivedTime.text}`,\n            },\n        },\n    ],\n});\n\n// create message card\nlet result = {\n    msg_type: \"interactive\",\n    card: {\n        config: {\n            wide_screen_mode: true,\n        },\n        header: {\n            template: \"blue\",\n            title: {\n                content: `${data.bankName.toUpperCase()}-${\n                    data.receiverAccount\n                } (${data.transactionType.type}) ${\n                    data.transactionAmount.amountText\n                }VND`,\n                tag: \"plain_text\",\n            },\n        },\n        elements,\n    },\n};\n\nreturn { json: result };\n"},"id":"28b64ce8-913e-4a2d-a01e-bdb0ab5eb551","name":"Convert to Lark Message Card","type":"n8n-nodes-base.code","typeVersion":1,"position":[540,660]},{"parameters":{"method":"POST","url":"=https://open.larksuite.com/open-apis/auth/v3/tenant_access_token/internal/","sendBody":true,"specifyBody":"json","jsonBody":"={ \"app_id\" : \"{{ $input.item.json[\"appId\"] }}\", \"app_secret\" : \"{{ $input.item.json[\"appSecret\"] }}\" }","options":{}},"id":"a57ee005-cc5b-4f69-9e42-74be0292e7e4","name":"Get Lark tenant access token","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[720,340]},{"parameters":{"values":{"string":[{"name":"appId","value":"cli_a438c83ad878d00a"},{"name":"appSecret","value":"gwq4pl4jv2ssbtaQdWb3llFRtMWQRvq0"}]},"options":{}},"id":"7163a8b4-3c95-49f6-9017-6321dafd4d75","name":"Set Lark auth data","type":"n8n-nodes-base.set","typeVersion":1,"position":[520,340]},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/bot/v2/hook/bf893582-8516-4d56-a71b-f95ac103484a","sendBody":true,"specifyBody":"json","jsonBody":"={{ JSON.stringify($('Convert to Lark Message Card').first().json)}}","options":{}},"id":"7968e6bb-c30f-4dd9-91cd-a419b7d6cd51","name":"[Lark] Send noti to group chat","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[740,660]},{"parameters":{"jsCode":"const data = $('getBankData').first().json.result;\n\n// Convert to Lark Base format\nconst records = [\n  {\n    fields: {\n      'ID': data.bankName + '-' + data.receiverAccount,\n      'Bank': data.bankName,\n      'Account': data.receiverAccount,\n      'Transaction Type': data.transactionType.typeText,\n      'Debit':\n        data.transactionType.type === '+'\n          ? data.transactionAmount.amount\n          : undefined,\n      'Credit':\n        data.transactionType.type === '-'\n          ? data.transactionAmount.amount\n          : undefined,\n      'Balance': data.balance.amount,\n      'Transaction ID': data.transactionId,\n      'Transaction Message': data.transactionMessage,\n      'Original Message': data.originalMessage,\n      'Time received': data.receivedTime.timestamp,\n    },\n  },\n];\n\nconst result = { json: { records } };\nreturn result;\n"},"id":"f598fc13-f6a0-4978-8797-306917daf9c2","name":"Convert to Lark Base format","type":"n8n-nodes-base.code","typeVersion":1,"position":[900,340]},{"parameters":{"method":"POST","url":"=https://open.larksuite.com/open-apis/bitable/v1/apps/{{ $input.item.json[\"baseId\"] }}/tables/{{ $input.item.json[\"tableId\"] }}/records/batch_create","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $node[\"Get Lark tenant access token\"].json.tenant_access_token }}"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\"records\":{{ JSON.stringify($('Convert to Lark Base format').first().json.records) }}}","options":{}},"id":"b6b6d04d-5443-4d99-8df1-2d011d83e494","name":"[SMS Log] Add records to Bitable","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[1260,340]},{"parameters":{"values":{"string":[{"name":"baseId","value":"QeEUbcUVwaj2IVs4fVGuv33XsLb"},{"name":"tableId","value":"tblOVlFoMmLGa2S6"}]},"options":{}},"id":"99801753-8625-482a-b545-f913a15b89ab","name":"Set SMS Log config","type":"n8n-nodes-base.set","typeVersion":2,"position":[1080,340]},{"parameters":{"conditions":{"boolean":[{"value1":"={{ $json.isBankSupport }}","value2":true}]}},"id":"12cd7720-b820-4599-b4bf-3fcb69142b3e","name":"ifBankSupport","type":"n8n-nodes-base.if","typeVersion":1,"position":[280,440]},{"parameters":{"method":"POST","url":"https://app.n8n.vn/webhook/kdigi-bank-bot-process-data","sendBody":true,"specifyBody":"json","jsonBody":"={{ JSON.stringify($input.first().json.body) }}","options":{}},"id":"89d0af27-1672-4343-b0c9-eb656a7f28c3","name":"getBankData","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[60,440]}],"connections":{"Webhook":{"main":[[{"node":"getBankData","type":"main","index":0}]]},"Convert to Lark Message Card":{"main":[[{"node":"[Lark] Send noti to group chat","type":"main","index":0}]]},"Get Lark tenant access token":{"main":[[{"node":"Convert to Lark Base format","type":"main","index":0}]]},"Set Lark auth data":{"main":[[{"node":"Get Lark tenant access token","type":"main","index":0}]]},"Convert to Lark Base format":{"main":[[{"node":"Set SMS Log config","type":"main","index":0}]]},"Set SMS Log config":{"main":[[{"node":"[SMS Log] Add records to Bitable","type":"main","index":0}]]},"ifBankSupport":{"main":[[{"node":"Set Lark auth data","type":"main","index":0},{"node":"Convert to Lark Message Card","type":"main","index":0}]]},"getBankData":{"main":[[{"node":"ifBankSupport","type":"main","index":0}]]}},"settings":{"saveManualExecutions":true,"callerPolicy":"workflowsFromSameOwner","errorWorkflow":"201"},"staticData":null,"pinData":{},"versionId":"886b9750-6080-4306-b79d-16c88c34904f","triggerCount":1,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-07-15T12:57:02.403Z","updatedAt":"2023-07-15T12:57:28.000Z","id":"178","name":"bankbot guide","active":true,"nodes":[{"parameters":{"httpMethod":"POST","path":"bank-bot-68","options":{}},"id":"422424e5-d23c-4fd1-97dd-7eccb637b004","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[-660,560],"webhookId":"b459d9da-c462-43e0-880c-12b8d6304763"},{"parameters":{"jsCode":"const data = $(\"getBankData\").first().json.result;\n\nlet elements = [];\n\nelements.push({\n    tag: \"div\",\n    fields: [\n        {\n            is_short: false,\n            text: {\n                tag: \"lark_md\",\n                content: `**Ng√¢n h√†ng**: ${data.bankName.toUpperCase()}`,\n            },\n        },\n        {\n            is_short: false,\n            text: {\n                tag: \"lark_md\",\n                content: `**S·ªë t√†i kho·∫£n**: ${data.receiverAccount}`,\n            },\n        },\n        {\n            is_short: false,\n            text: {\n                tag: \"lark_md\",\n                content: `**S·ªë d∆∞ thay ƒë·ªïi:** ${data.transactionType.type} ${data.transactionAmount.amountText} VND`,\n            },\n        },\n        {\n            is_short: false,\n            text: {\n                tag: \"lark_md\",\n                content: `**N·ªôi dung:** ${data.transactionMessage}`,\n            },\n        },\n        {\n            is_short: false,\n            text: {\n                tag: \"lark_md\",\n                content: `**M√£ giao d·ªãch:** ${data.transactionId}`,\n            },\n        },\n        {\n            is_short: false,\n            text: {\n                tag: \"lark_md\",\n                content: `**Th·ªùi gian nh·∫≠n:** ${data.receivedTime.text}`,\n            },\n        },\n    ],\n});\n\n// Ki·ªÉm tra enableBalance n·∫øu true th√¨ th√™m ph·∫ßn t·ª≠ \"S·ªë d∆∞ t·∫°m t√≠nh\" v√†o m·∫£ng fields\nif ($('setData').first().json.enableBalance) {\n  const balanceIndex = elements[0].fields.findIndex(\n    (field) => field?.text?.content?.includes(\"S·ªë d∆∞ thay ƒë·ªïi\")\n  );\n  if (balanceIndex !== -1) {\n    elements[0].fields.splice(balanceIndex + 1, 0, {\n      is_short: false,\n      text: {\n        tag: \"lark_md\",\n        content: `**S·ªë d∆∞ t·∫°m t√≠nh**: ${data.balance.amountText} VND`,\n      },\n    });\n  }\n}\n\n// create message card\nlet result = {\n    msg_type: \"interactive\",\n    card: {\n        config: {\n            wide_screen_mode: true,\n        },\n        header: {\n            template: \"blue\",\n            title: {\n                content: `${data.bankName.toUpperCase()}-${\n                    data.receiverAccount\n                } (${data.transactionType.type}) ${\n                    data.transactionAmount.amountText\n                }VND`,\n                tag: \"plain_text\",\n            },\n        },\n        elements,\n    },\n};\n\nreturn { json: result };\n"},"id":"af8b2db4-50c2-4115-b501-61dcdbac6723","name":"Convert to Lark Message Card","type":"n8n-nodes-base.code","typeVersion":1,"position":[460,660]},{"parameters":{"method":"POST","url":"=https://open.larksuite.com/open-apis/auth/v3/tenant_access_token/internal/","sendBody":true,"specifyBody":"json","jsonBody":"={ \"app_id\" : \"{{ $('setData').item.json[\"appId\"] }}\", \"app_secret\" : \"{{ $('setData').item.json[\"appSecret\"] }}\" }","options":{}},"id":"927e2295-95b1-4b8d-b430-a5a818c45fcd","name":"Get Lark tenant access token","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[460,460]},{"parameters":{"method":"POST","url":"={{ $('setData').item.json.customBotURL }}","sendBody":true,"specifyBody":"json","jsonBody":"={{ JSON.stringify($('Convert to Lark Message Card').first().json)}}","options":{}},"id":"ed5575b5-498a-4537-ba4f-0931c7cd7867","name":"[Lark] Send noti to group chat","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[660,660]},{"parameters":{"jsCode":"const data = $('getBankData').first().json.result;\n\n// Convert to Lark Base format\nconst records = [\n  {\n    fields: {\n      'ID': data.bankName + '-' + data.receiverAccount,\n      'Bank': data.bankName,\n      'Account': data.receiverAccount,\n      'Transaction Type': data.transactionType.typeText,\n      'Debit':\n        data.transactionType.type === '+'\n          ? data.transactionAmount.amount\n          : undefined,\n      'Credit':\n        data.transactionType.type === '-'\n          ? data.transactionAmount.amount\n          : undefined,\n      'Balance': data.balance.amount,\n      'Transaction ID': data.transactionId,\n      'Transaction Message': data.transactionMessage,\n      'Original Message': data.originalMessage,\n      'Time received': data.receivedTime.timestamp,\n    },\n  },\n];\n\nconst result = { json: { records } };\nreturn result;\n"},"id":"4ce31b20-c763-4c52-b28f-37223496fd90","name":"Convert to Lark Base format","type":"n8n-nodes-base.code","typeVersion":1,"position":[640,460]},{"parameters":{"method":"POST","url":"=https://open.larksuite.com/open-apis/bitable/v1/apps/{{ $('setData').item.json[\"baseId\"] }}/tables/{{ $('setData').item.json[\"tableId\"] }}/records/batch_create","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $node[\"Get Lark tenant access token\"].json.tenant_access_token }}"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\"records\":{{ JSON.stringify($('Convert to Lark Base format').first().json.records) }}}","options":{}},"id":"cea83190-b135-4010-8e77-46d2a3121132","name":"[SMS Log] Add records to Bitable","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[840,460]},{"parameters":{"conditions":{"boolean":[{"value1":"={{ $json.isBankSupport }}","value2":true}]}},"id":"0464feed-96e0-4e34-94b7-3ee757eecf83","name":"ifBankSupport","type":"n8n-nodes-base.if","typeVersion":1,"position":[20,560]},{"parameters":{"method":"POST","url":"https://app.n8n.vn/webhook/kdigi-bank-bot-process-data","sendBody":true,"specifyBody":"json","jsonBody":"={{ JSON.stringify($input.first().json.body) }}","options":{}},"id":"1fbf2bfe-754b-47b9-9d54-febafe5a8cc9","name":"getBankData","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[-200,560]},{"parameters":{"conditions":{"string":[{"value1":"={{ $json.body.text }}","operation":"contains","value2":"OTP"}],"boolean":[{"value1":"={{ $json.enableOTP }}","value2":true}]}},"id":"11e0b8be-84ec-4f32-b99f-054cbe1767f5","name":"ifOTP","type":"n8n-nodes-base.if","typeVersion":1,"position":[-200,800]},{"parameters":{"method":"POST","url":"={{ $('setData').item.json.customBotURL }}","sendBody":true,"specifyBody":"json","jsonBody":"={{ JSON.stringify($('Convert to Message Card 2').first().json)}}","options":{}},"id":"57a72a75-1b58-4262-b81f-2113d3b7f1cb","name":"[Lark] Send OTP to group chat","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[240,780]},{"parameters":{"values":{"string":[{"name":"appId","value":"cli_a33cd37530b8900a"},{"name":"appSecret","value":"qNz8YxoCCZoGm9Nlm2bOrcUriJsJtHHD"},{"name":"baseId","value":"Vz9eb7avZa95IUsOk99uji8Fsdd"},{"name":"tableId","value":"tbl9prfOWONpDCbk"},{"name":"customBotURL","value":"https://open.larksuite.com/open-apis/bot/v2/hook/b8407056-e8cc-45d0-bfc6-7893201c4ff4"}],"boolean":[{"name":"enableBalance"},{"name":"enableOTP"}]},"options":{}},"id":"9afbaddf-510f-4e63-8384-d94b43f2bea1","name":"setData","type":"n8n-nodes-base.set","typeVersion":2,"position":[-400,560]},{"parameters":{"jsCode":"const smsContent = $('Webhook').first().json.body\n\n// create message card\nlet result = {\n    msg_type: \"text\",\n    content: {\n        text: `T·ª´: ${smsContent.from}\\n${smsContent.text.toString()}`\n    },\n};\n\nreturn { json: result };"},"id":"553c2b8b-114e-4544-a139-89dd83a3cdfd","name":"Convert to Message Card 2","type":"n8n-nodes-base.code","typeVersion":1,"position":[20,780]}],"connections":{"Webhook":{"main":[[{"node":"setData","type":"main","index":0}]]},"Convert to Lark Message Card":{"main":[[{"node":"[Lark] Send noti to group chat","type":"main","index":0}]]},"Get Lark tenant access token":{"main":[[{"node":"Convert to Lark Base format","type":"main","index":0}]]},"Convert to Lark Base format":{"main":[[{"node":"[SMS Log] Add records to Bitable","type":"main","index":0}]]},"ifBankSupport":{"main":[[{"node":"Get Lark tenant access token","type":"main","index":0},{"node":"Convert to Lark Message Card","type":"main","index":0}]]},"getBankData":{"main":[[{"node":"ifBankSupport","type":"main","index":0}]]},"ifOTP":{"main":[[{"node":"Convert to Message Card 2","type":"main","index":0}]]},"setData":{"main":[[{"node":"ifOTP","type":"main","index":0},{"node":"getBankData","type":"main","index":0}]]},"Convert to Message Card 2":{"main":[[{"node":"[Lark] Send OTP to group chat","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{},"versionId":"618d2183-2adf-46de-ba1b-588a0be9cf4f","triggerCount":1,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-07-16T04:25:39.134Z","updatedAt":"2023-07-27T12:50:54.000Z","id":"179","name":"Bamnut","active":true,"nodes":[{"parameters":{"httpMethod":"POST","path":"bamnut","options":{"responseData":"Ch√∫ng t√¥i ƒë√£ nh·∫≠n th√¥ng tin. B·∫°n c√≥ th·ªÉ ƒë√≥ng c·ª≠a s·ªï n√†y!!"}},"id":"1d88e8db-f9a0-4e2b-a968-c69e4a553a64","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[560,220],"webhookId":"cb2f44e0-ba10-46b9-ba4d-d562895d9615"},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/auth/v3/app_access_token/internal/","sendBody":true,"specifyBody":"json","jsonBody":"={ \"app_id\" : \"{{ $('setData').item.json[\"appId\"] }}\",\n \"app_secret\" : \"{{ $('setData').item.json[\"appSecret\"] }}\" } ","options":{}},"id":"e5603090-42e8-49fc-ac4b-283b65342df0","name":"app_token","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[940,220]},{"parameters":{"values":{"string":[{"name":"appId","value":"cli_a43f02058738d0099"},{"name":"appSecret","value":"ayBQyWmXTY2f1Js58pU1XdVIDrzqYDA2"},{"name":"recordID","value":"={{ $json.query.recordID }}"},{"name":"OK","value":"OK"}]},"options":{}},"id":"db00735d-f3b4-4f19-bbb6-bb30fb9eca03","name":"setData","type":"n8n-nodes-base.set","typeVersion":2,"position":[780,220]},{"parameters":{"method":"PUT","url":"=https://open.larksuite.com/open-apis/bitable/v1/apps/KbF5bW0E2a7mENse5Vgu8OJLsog/tables/tblTTEfBCIGNY53A/records/{{ $('setData').item.json[\"recordID\"] }}\n\n","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $json[\"app_access_token\"] }}"}]},"sendBody":true,"specifyBody":"json","jsonBody":"{\"fields\" : {\"FB\":\"OK\"}}","options":{}},"id":"a452bbc6-0ce5-445d-841d-463648c7d772","name":"Update record","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[1160,220]}],"connections":{"Webhook":{"main":[[{"node":"setData","type":"main","index":0}]]},"app_token":{"main":[[{"node":"Update record","type":"main","index":0}]]},"setData":{"main":[[{"node":"app_token","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{},"versionId":"e00fd4a7-a2a1-47a7-900b-da22f8cf7448","triggerCount":1,"tags":[{"createdAt":"2023-07-14T04:57:09.608Z","updatedAt":"2023-07-14T04:57:09.608Z","id":"24","name":"GRGR_Recruite"}]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-07-17T11:08:02.944Z","updatedAt":"2023-07-18T04:36:09.000Z","id":"183","name":"LSGD Vietinbank","active":false,"nodes":[{"parameters":{"httpMethod":"POST","path":"template-kdigi-bank-bot-api","options":{}},"id":"e17829d5-2830-45d6-adf4-6b3c9c41ffb2","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[-720,780],"webhookId":"b459d9da-c462-43e0-880c-12b8d6304763"},{"parameters":{"jsCode":"const data = $(\"getBankData\").first().json.result;\n\nlet elements = [];\n\nelements.push({\n    tag: \"div\",\n    fields: [\n        {\n            is_short: false,\n            text: {\n                tag: \"lark_md\",\n                content: `**Ng√¢n h√†ng**: ${data.bankName.toUpperCase()}`,\n            },\n        },\n        {\n            is_short: false,\n            text: {\n                tag: \"lark_md\",\n                content: `**S·ªë t√†i kho·∫£n**: ${data.receiverAccount}`,\n            },\n        },\n        {\n            is_short: false,\n            text: {\n                tag: \"lark_md\",\n                content: `**S·ªë d∆∞ thay ƒë·ªïi:** ${data.transactionType.type} ${data.transactionAmount.amountText} VND`,\n            },\n        },\n        {\n            is_short: false,\n            text: {\n                tag: \"lark_md\",\n                content: `**N·ªôi dung:** ${data.transactionMessage}`,\n            },\n        },\n        {\n            is_short: false,\n            text: {\n                tag: \"lark_md\",\n                content: `**M√£ giao d·ªãch:** ${data.transactionId}`,\n            },\n        },\n        {\n            is_short: false,\n            text: {\n                tag: \"lark_md\",\n                content: `**Th·ªùi gian nh·∫≠n:** ${data.receivedTime.text}`,\n            },\n        },\n    ],\n});\n\n// Ki·ªÉm tra enableBalance n·∫øu true th√¨ th√™m ph·∫ßn t·ª≠ \"S·ªë d∆∞ t·∫°m t√≠nh\" v√†o m·∫£ng fields\nif ($('setData').first().json.enableBalance) {\n  const balanceIndex = elements[0].fields.findIndex(\n    (field) => field?.text?.content?.includes(\"S·ªë d∆∞ thay ƒë·ªïi\")\n  );\n  if (balanceIndex !== -1) {\n    elements[0].fields.splice(balanceIndex + 1, 0, {\n      is_short: false,\n      text: {\n        tag: \"lark_md\",\n        content: `**S·ªë d∆∞ t·∫°m t√≠nh**: ${data.balance.amountText} VND`,\n      },\n    });\n  }\n}\n\n// create message card\nlet result = {\n    msg_type: \"interactive\",\n    card: {\n        config: {\n            wide_screen_mode: true,\n        },\n        header: {\n            template: \"blue\",\n            title: {\n                content: `${data.bankName.toUpperCase()}-${\n                    data.receiverAccount\n                } (${data.transactionType.type}) ${\n                    data.transactionAmount.amountText\n                }VND`,\n                tag: \"plain_text\",\n            },\n        },\n        elements,\n    },\n};\n\nreturn { json: result };\n"},"id":"d13cfab5-19b4-4988-ac0a-1a1fca4d1d7d","name":"Convert to Lark Message Card","type":"n8n-nodes-base.code","typeVersion":1,"position":[460,680]},{"parameters":{"method":"POST","url":"=https://open.larksuite.com/open-apis/auth/v3/tenant_access_token/internal/","sendBody":true,"specifyBody":"json","jsonBody":"={ \"app_id\" : \"{{ $('setData').item.json[\"appId\"] }}\", \"app_secret\" : \"{{ $('setData').item.json[\"appSecret\"] }}\" }","options":{}},"id":"2fa53e0b-8607-48e5-8f81-1d059ebcb25c","name":"Get Lark tenant access token","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[460,460]},{"parameters":{"method":"POST","url":"={{ $('setData').item.json.customBotURL }}","sendBody":true,"specifyBody":"json","jsonBody":"={{ JSON.stringify($('Convert to Lark Message Card').first().json)}}","options":{}},"id":"cfb2124c-82a8-49bd-ac2a-622923beed53","name":"[Lark] Send noti to group chat","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[640,680]},{"parameters":{"jsCode":"const data = $('getBankData').first().json.result;\n\n// Convert to Lark Base format\nconst records = [\n  {\n    fields: {\n      'ID': data.bankName + '-' + data.receiverAccount,\n      'Bank': data.bankName,\n      'Account': data.receiverAccount,\n      'Transaction Type': data.transactionType.typeText,\n      'Debit':\n        data.transactionType.type === '+'\n          ? data.transactionAmount.amount\n          : undefined,\n      'Credit':\n        data.transactionType.type === '-'\n          ? data.transactionAmount.amount\n          : undefined,\n      'Balance': data.balance.amount,\n      'Transaction ID': data.transactionId,\n      'Transaction Message': data.transactionMessage,\n      'Original Message': data.originalMessage,\n      'Time received': data.receivedTime.timestamp,\n    },\n  },\n];\n\nconst result = { json: { records } };\nreturn result;\n"},"id":"51cb1b2d-3227-4f86-bfa3-5764058e2e3c","name":"Convert to Lark Base format","type":"n8n-nodes-base.code","typeVersion":1,"position":[620,460]},{"parameters":{"method":"POST","url":"=https://open.larksuite.com/open-apis/bitable/v1/apps/{{ $('setData').item.json[\"baseId\"] }}/tables/{{ $('setData').item.json[\"tableId\"] }}/records/batch_create","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $node[\"Get Lark tenant access token\"].json.tenant_access_token }}"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\"records\":{{ JSON.stringify($('Convert to Lark Base format').first().json.records) }}}","options":{}},"id":"1c62a4de-057b-4fcf-9d52-3192f0fe1c36","name":"[SMS Log] Add records to Bitable","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[800,460]},{"parameters":{"conditions":{"boolean":[{"value1":"={{ $json.isBankSupport }}","value2":true}]}},"id":"c7c5e121-c468-43ba-8015-9e96fcf7042e","name":"ifBankSupport","type":"n8n-nodes-base.if","typeVersion":1,"position":[-40,780]},{"parameters":{"method":"POST","url":"https://app.n8n.vn/webhook/kdigi-bank-bot-process-data","sendBody":true,"specifyBody":"json","jsonBody":"={{ JSON.stringify($input.first().json.body) }}","options":{}},"id":"14ea6c0b-eb12-4c8d-9365-859e814601ea","name":"getBankData","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[-260,780]},{"parameters":{"conditions":{"string":[{"value1":"={{ $json.body.text }}","operation":"contains","value2":"OTP"}],"boolean":[{"value1":"={{ $json.enableOTP }}","value2":true}]}},"id":"c66c1951-4e9a-4dc0-af49-dd0d657def36","name":"ifOTP","type":"n8n-nodes-base.if","typeVersion":1,"position":[-260,1020]},{"parameters":{"method":"POST","url":"={{ $('setData').item.json.customBotURL }}","sendBody":true,"specifyBody":"json","jsonBody":"={{ JSON.stringify($('Convert to Message Card 2').first().json)}}","options":{}},"id":"f4f7f84d-344d-4f50-854f-d62137cbe7c7","name":"[Lark] Send OTP to group chat","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[180,1000]},{"parameters":{"values":{"string":[{"name":"appId","value":"cli_a33cd37530b8900a"},{"name":"appSecret","value":"qNz8YxoCCZoGm9Nlm2bOrcUriJsJtHHD"},{"name":"baseId","value":"Vz9eb7avZa95IUsOk99uji8Fsdd"},{"name":"tableId","value":"tbl9prfOWONpDCbk"},{"name":"customBotURL","value":"https://open.larksuite.com/open-apis/bot/v2/hook/b8407056-e8cc-45d0-bfc6-7893201c4ff4"}],"boolean":[{"name":"enableBalance"},{"name":"enableOTP"},{"name":"enableOutgoing","value":true}]},"options":{}},"id":"13eb80ad-a898-4cb5-827d-ddec37e802ec","name":"setData","type":"n8n-nodes-base.set","typeVersion":2,"position":[-460,780]},{"parameters":{"jsCode":"const smsContent = $('Webhook').first().json.body\n\n// create message card\nlet result = {\n    msg_type: \"text\",\n    content: {\n        text: `T·ª´: ${smsContent.from}\\n${smsContent.text.toString()}`\n    },\n};\n\nreturn { json: result };"},"id":"a3502fa8-c502-4a11-a863-035d8a74413d","name":"Convert to Message Card 2","type":"n8n-nodes-base.code","typeVersion":1,"position":[-40,1000]},{"parameters":{"conditions":{"string":[{"value1":"={{ $('getBankData').item.json.result.transactionType.type }}","value2":"-"}],"boolean":[{"value1":"={{ $('setData').item.json.enableOutgoing }}","value2":true}]}},"id":"0a8ba921-561e-47cd-9bd6-c122c44380d3","name":"ifOutGoingEnable","type":"n8n-nodes-base.if","typeVersion":1,"position":[200,480]},{"parameters":{"conditions":{"string":[{"value1":"={{ $('getBankData').item.json.result.transactionType.type }}","value2":"+"}]}},"id":"7760f1c6-526e-4af5-8d62-d004f56d2db7","name":"ifIncoming","type":"n8n-nodes-base.if","typeVersion":1,"position":[200,660]}],"connections":{"Webhook":{"main":[[{"node":"setData","type":"main","index":0}]]},"Convert to Lark Message Card":{"main":[[{"node":"[Lark] Send noti to group chat","type":"main","index":0}]]},"Get Lark tenant access token":{"main":[[{"node":"Convert to Lark Base format","type":"main","index":0}]]},"Convert to Lark Base format":{"main":[[{"node":"[SMS Log] Add records to Bitable","type":"main","index":0}]]},"ifBankSupport":{"main":[[{"node":"ifOutGoingEnable","type":"main","index":0},{"node":"ifIncoming","type":"main","index":0}]]},"getBankData":{"main":[[{"node":"ifBankSupport","type":"main","index":0}]]},"ifOTP":{"main":[[{"node":"Convert to Message Card 2","type":"main","index":0}]]},"setData":{"main":[[{"node":"ifOTP","type":"main","index":0},{"node":"getBankData","type":"main","index":0}]]},"Convert to Message Card 2":{"main":[[{"node":"[Lark] Send OTP to group chat","type":"main","index":0}]]},"ifOutGoingEnable":{"main":[[{"node":"Get Lark tenant access token","type":"main","index":0},{"node":"Convert to Lark Message Card","type":"main","index":0}]]},"ifIncoming":{"main":[[{"node":"Get Lark tenant access token","type":"main","index":0},{"node":"Convert to Lark Message Card","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{},"versionId":"b2d7d346-ebbc-4217-9712-e18e4835dfbe","triggerCount":0,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-07-17T12:00:31.689Z","updatedAt":"2023-07-20T12:47:04.000Z","id":"185","name":"55Kitchen - Sync GGSheet OK (copy 17/07/2023)","active":false,"nodes":[{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/auth/v3/app_access_token/internal","sendBody":true,"specifyBody":"json","jsonBody":"={\n    \"app_id\": \"cli_a41487bb51f8d02f\",\n    \"app_secret\": \"luOwRQprGDvMhz3pN8N4TeM6X8fnsTdR\"\n}","options":{}},"id":"a2f5992d-fe96-482c-a472-734bbf36a77f","name":"HTTP Request - Lark Ternant","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[800,320]},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/bitable/v1/apps/Ev3cb0rrJamJansrYGllPsRwgre/tables/tblnyeeR1DXfqNIE/records","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $json.app_access_token }}"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\"fields\":{\"ü•£Order ID\":\"{{ $('ggsheet').item.json[\"OrderID\"] }}\",\"shopify_OrderIDAuth\":\"{{ $('ggsheet').item.json[\"OrderIDAuth\"] }}\",\"shopify_link\":\"{{ $('ggsheet').item.json[\"LinkShopify\"] }}\",\"shopify_CusFirstName\":\"{{ $('ggsheet').item.json[\"Firstname\"] }}\",\"shopify_CusLastName\":\"{{ $('ggsheet').item.json[\"Lastname\"] }}\",\"shopify_Cusphone\":\"{{ $('ggsheet').item.json[\"Phone\"] }}\",\"shopify_CusZalo\":\"{{ $('ggsheet').item.json[\"Zalo\"] }}\",\"shopify_Createdate\":\"{{ $('ggsheet').item.json[\"Createdate\"] }}\",\"shopify_Deliverydate\":\"{{ $('ggsheet').item.json[\"Deliverydate\"] }}\",\"shopify_Deliveryaddress\":\"{{ $('ggsheet').item.json[\"Deliveryaddress\"] }}\",\"shopify_ID+F.Name\":\"{{ $('ggsheet').item.json[\"Foodname\"] }}\",\"shopify_id+mer.name\":\"{{ $('ggsheet').item.json[\"Merchantname\"] }}\",\"shopify_Qty\":\"{{ $('ggsheet').item.json[\"Qty\"] }}\",\"shopify_Unitprice\":\"{{ $('ggsheet').item.json[\"Unitprice\"] }}\",\"shopify_Somontongbill\":\"{{ $('ggsheet').item.json[\"Somontongbill\"] }}\",\"shopify_Tongtien\":\"{{  $('ggsheet').item.json[\"Totalprice\"]}}\"}}","options":{}},"id":"64051f44-976c-48b3-8fa3-ccde8c11d6c2","name":"HTTP Request","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[1020,320]},{"parameters":{"pollTimes":{"item":[{"mode":"everyMinute"}]},"documentId":{"__rl":true,"value":"1ar-ryono31SgJ3IUzXy8CHeGdYJjaDqN-onRB-FHO_0","mode":"list","cachedResultName":"55-Kitchen-Order-From-Shopify","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1ar-ryono31SgJ3IUzXy8CHeGdYJjaDqN-onRB-FHO_0/edit?usp=drivesdk"},"sheetName":{"__rl":true,"value":1969433794,"mode":"list","cachedResultName":"Order-LineItems","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1ar-ryono31SgJ3IUzXy8CHeGdYJjaDqN-onRB-FHO_0/edit#gid=1969433794"},"event":"rowAdded","options":{}},"id":"0a37ab60-a6e9-4b74-9a65-79b341f9a3aa","name":"ggsheet","type":"n8n-nodes-base.googleSheetsTrigger","typeVersion":1,"position":[580,320],"credentials":{"googleSheetsTriggerOAuth2Api":{"id":"84","name":"Google Sheets Trigger 55kitchen.vn@gmail.com"}}}],"connections":{"HTTP Request - Lark Ternant":{"main":[[{"node":"HTTP Request","type":"main","index":0}]]},"ggsheet":{"main":[[{"node":"HTTP Request - Lark Ternant","type":"main","index":0}]]}},"settings":{},"staticData":{"node:ggsheet":{"documentId":"1ar-ryono31SgJ3IUzXy8CHeGdYJjaDqN-onRB-FHO_0","sheetId":1969433794,"lastIndexChecked":190}},"pinData":{},"versionId":"ac93303a-da54-4275-bfd4-727d57802483","triggerCount":1,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-07-17T22:26:41.596Z","updatedAt":"2023-07-17T23:16:58.000Z","id":"186","name":"khoi","active":false,"nodes":[{"parameters":{"httpMethod":"POST","path":"template-kdigi-bank-bot-api","options":{}},"id":"7229ee87-dd8a-4f8a-a750-b88894672e50","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[-880,520],"webhookId":"b459d9da-c462-43e0-880c-12b8d6304763"},{"parameters":{"jsCode":"const data = $(\"getBankData\").first().json.result;\n\nlet elements = [];\n\nelements.push({\n    tag: \"div\",\n    fields: [\n        {\n            is_short: false,\n            text: {\n                tag: \"lark_md\",\n                content: `**Ng√¢n h√†ng**: ${data.bankName.toUpperCase()}`,\n            },\n        },\n        {\n            is_short: false,\n            text: {\n                tag: \"lark_md\",\n                content: `**S·ªë t√†i kho·∫£n**: ${data.receiverAccount}`,\n            },\n        },\n        {\n            is_short: false,\n            text: {\n                tag: \"lark_md\",\n                content: `**S·ªë d∆∞ thay ƒë·ªïi:** ${data.transactionType.type} ${data.transactionAmount.amountText} VND`,\n            },\n        },\n        {\n            is_short: false,\n            text: {\n                tag: \"lark_md\",\n                content: `**N·ªôi dung:** ${data.transactionMessage}`,\n            },\n        },\n        {\n            is_short: false,\n            text: {\n                tag: \"lark_md\",\n                content: `**M√£ giao d·ªãch:** ${data.transactionId}`,\n            },\n        },\n        {\n            is_short: false,\n            text: {\n                tag: \"lark_md\",\n                content: `**Th·ªùi gian nh·∫≠n:** ${data.receivedTime.text}`,\n            },\n        },\n    ],\n});\n\n// Ki·ªÉm tra enableBalance n·∫øu true th√¨ th√™m ph·∫ßn t·ª≠ \"S·ªë d∆∞ t·∫°m t√≠nh\" v√†o m·∫£ng fields\nif ($('setData').first().json.enableBalance) {\n  const balanceIndex = elements[0].fields.findIndex(\n    (field) => field?.text?.content?.includes(\"S·ªë d∆∞ thay ƒë·ªïi\")\n  );\n  if (balanceIndex !== -1) {\n    elements[0].fields.splice(balanceIndex + 1, 0, {\n      is_short: false,\n      text: {\n        tag: \"lark_md\",\n        content: `**S·ªë d∆∞ t·∫°m t√≠nh**: ${data.balance.amountText} VND`,\n      },\n    });\n  }\n}\n\n// create message card\nlet result = {\n    msg_type: \"interactive\",\n    card: {\n        config: {\n            wide_screen_mode: true,\n        },\n        header: {\n            template: \"blue\",\n            title: {\n                content: `${data.bankName.toUpperCase()}-${\n                    data.receiverAccount\n                } (${data.transactionType.type}) ${\n                    data.transactionAmount.amountText\n                }VND`,\n                tag: \"plain_text\",\n            },\n        },\n        elements,\n    },\n};\n\nreturn { json: result };\n"},"id":"d3003d3a-87d8-4901-a62c-a5c648ff3cbf","name":"Convert to Lark Message Card","type":"n8n-nodes-base.code","typeVersion":1,"position":[300,420]},{"parameters":{"method":"POST","url":"=https://open.larksuite.com/open-apis/auth/v3/tenant_access_token/internal/","sendBody":true,"specifyBody":"json","jsonBody":"={ \"app_id\" : \"{{ $('setData').item.json[\"appId\"] }}\", \"app_secret\" : \"{{ $('setData').item.json[\"appSecret\"] }}\" }","options":{}},"id":"77a0473f-8061-4147-8601-8b7dcd34832f","name":"Get Lark tenant access token","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[300,200]},{"parameters":{"method":"POST","url":"={{ $('setData').item.json.customBotURL }}","sendBody":true,"specifyBody":"json","jsonBody":"={{ JSON.stringify($('Convert to Lark Message Card').first().json)}}","options":{}},"id":"0bc070d9-aeae-40fd-8cb3-71bfccdbc05c","name":"[Lark] Send noti to group chat","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[480,420]},{"parameters":{"jsCode":"const data = $('getBankData').first().json.result;\n\n// Convert to Lark Base format\nconst records = [\n  {\n    fields: {\n      'ID': data.bankName + '-' + data.receiverAccount,\n      'Bank': data.bankName,\n      'Account': data.receiverAccount,\n      'Transaction Type': data.transactionType.typeText,\n      'Debit':\n        data.transactionType.type === '+'\n          ? data.transactionAmount.amount\n          : undefined,\n      'Credit':\n        data.transactionType.type === '-'\n          ? data.transactionAmount.amount\n          : undefined,\n      'Balance': data.balance.amount,\n      'Transaction ID': data.transactionId,\n      'Transaction Message': data.transactionMessage,\n      'Original Message': data.originalMessage,\n      'Time received': data.receivedTime.timestamp,\n    },\n  },\n];\n\nconst result = { json: { records } };\nreturn result;\n"},"id":"dfab3664-f373-4454-afcf-37ba81e7e4f2","name":"Convert to Lark Base format","type":"n8n-nodes-base.code","typeVersion":1,"position":[460,200]},{"parameters":{"method":"POST","url":"=https://open.larksuite.com/open-apis/bitable/v1/apps/{{ $('setData').item.json[\"baseId\"] }}/tables/{{ $('setData').item.json[\"tableId\"] }}/records/batch_create","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $node[\"Get Lark tenant access token\"].json.tenant_access_token }}"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\"records\":{{ JSON.stringify($('Convert to Lark Base format').first().json.records) }}}","options":{}},"id":"f83a4a91-81fc-4a97-9400-fb0d82a03954","name":"[SMS Log] Add records to Bitable","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[640,200]},{"parameters":{"conditions":{"boolean":[{"value1":"={{ $json.isBankSupport }}","value2":true}]}},"id":"ac04b62c-6ef3-40b3-b85f-843032809b3c","name":"ifBankSupport","type":"n8n-nodes-base.if","typeVersion":1,"position":[-200,520]},{"parameters":{"method":"POST","url":"https://app.n8n.vn/webhook/kdigi-bank-bot-process-data","sendBody":true,"specifyBody":"json","jsonBody":"={{ JSON.stringify($input.first().json.body) }}","options":{}},"id":"6752d6a5-08dd-4b3b-bfee-bf257648840f","name":"getBankData","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[-420,520]},{"parameters":{"conditions":{"string":[{"value1":"={{ $json.body.text }}","operation":"contains","value2":"OTP"}],"boolean":[{"value1":"={{ $json.enableOTP }}","value2":true}]}},"id":"aa36414f-b21c-4259-9c38-5298db3da5a5","name":"ifOTP","type":"n8n-nodes-base.if","typeVersion":1,"position":[-420,760]},{"parameters":{"method":"POST","url":"={{ $('setData').item.json.customBotURL }}","sendBody":true,"specifyBody":"json","jsonBody":"={{ JSON.stringify($('Convert to Message Card 2').first().json)}}","options":{}},"id":"0b94a462-de4b-4b9b-9126-d77c2b0c57f5","name":"[Lark] Send OTP to group chat","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[20,740]},{"parameters":{"values":{"string":[{"name":"appId","value":"cli_a33cd37530b8900a"},{"name":"appSecret","value":"qNz8YxoCCZoGm9Nlm2bOrcUriJsJtHHD"},{"name":"baseId","value":"Vz9eb7avZa95IUsOk99uji8Fsdd"},{"name":"tableId","value":"tbl9prfOWONpDCbk"},{"name":"customBotURL","value":"https://open.larksuite.com/open-apis/bot/v2/hook/b8407056-e8cc-45d0-bfc6-7893201c4ff4"}],"boolean":[{"name":"enableBalance"},{"name":"enableOTP"},{"name":"enableOutgoing","value":true}]},"options":{}},"id":"eaca57f2-2329-4c12-b2f5-70e8e345874c","name":"setData","type":"n8n-nodes-base.set","typeVersion":2,"position":[-620,520]},{"parameters":{"jsCode":"const smsContent = $('Webhook').first().json.body\n\n// create message card\nlet result = {\n    msg_type: \"text\",\n    content: {\n        text: `T·ª´: ${smsContent.from}\\n${smsContent.text.toString()}`\n    },\n};\n\nreturn { json: result };"},"id":"e1b36fc1-4b1f-4a62-bc53-0eed005140e1","name":"Convert to Message Card 2","type":"n8n-nodes-base.code","typeVersion":1,"position":[-200,740]},{"parameters":{"conditions":{"string":[{"value1":"={{ $('getBankData').item.json.result.transactionType.type }}","value2":"-"}],"boolean":[{"value1":"={{ $('setData').item.json.enableOutgoing }}","value2":true}]}},"id":"31153763-4bf8-41c3-a4d3-11f346915f04","name":"ifOutGoingEnable","type":"n8n-nodes-base.if","typeVersion":1,"position":[40,220]},{"parameters":{"conditions":{"string":[{"value1":"={{ $('getBankData').item.json.result.transactionType.type }}","value2":"+"}]}},"id":"78e00a1e-9c52-4896-9510-196b2a48e2fe","name":"ifIncoming","type":"n8n-nodes-base.if","typeVersion":1,"position":[40,400]}],"connections":{"Webhook":{"main":[[{"node":"setData","type":"main","index":0}]]},"Convert to Lark Message Card":{"main":[[{"node":"[Lark] Send noti to group chat","type":"main","index":0}]]},"Get Lark tenant access token":{"main":[[{"node":"Convert to Lark Base format","type":"main","index":0}]]},"Convert to Lark Base format":{"main":[[{"node":"[SMS Log] Add records to Bitable","type":"main","index":0}]]},"ifBankSupport":{"main":[[{"node":"ifOutGoingEnable","type":"main","index":0},{"node":"ifIncoming","type":"main","index":0}]]},"getBankData":{"main":[[{"node":"ifBankSupport","type":"main","index":0}]]},"ifOTP":{"main":[[{"node":"Convert to Message Card 2","type":"main","index":0}]]},"setData":{"main":[[{"node":"ifOTP","type":"main","index":0},{"node":"getBankData","type":"main","index":0}]]},"Convert to Message Card 2":{"main":[[{"node":"[Lark] Send OTP to group chat","type":"main","index":0}]]},"ifOutGoingEnable":{"main":[[{"node":"Get Lark tenant access token","type":"main","index":0},{"node":"Convert to Lark Message Card","type":"main","index":0}]]},"ifIncoming":{"main":[[{"node":"Get Lark tenant access token","type":"main","index":0},{"node":"Convert to Lark Message Card","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{},"versionId":"aa653087-d1c0-494f-8b0f-b86758997697","triggerCount":0,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-07-18T04:39:40.941Z","updatedAt":"2023-07-20T10:33:00.000Z","id":"187","name":"Crawl PRS","active":false,"nodes":[{"parameters":{"rule":{"interval":[{"field":"cronExpression","expression":"0 */6 * * *"}]}},"id":"23eab27e-2fc1-4b71-86be-14659ecacb92","name":"Schedule Trigger","type":"n8n-nodes-base.scheduleTrigger","typeVersion":1.1,"position":[780,560]},{"parameters":{"url":"https://dstt.postmart.vn/api/prs/workflow/scan-folder","sendQuery":true,"queryParameters":{"parameters":[{"name":"shift_date","value":"0"}]},"sendHeaders":true,"headerParameters":{"parameters":[{"name":"token","value":"7a51b166dfe235dfec2901a24ed2f671"}]},"options":{}},"id":"ab83a953-22fd-4615-aed8-91ab1bb44bcd","name":"ListFolder","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[980,560]},{"parameters":{"conditions":{"string":[{"value1":"={{ $json.data }}","operation":"isNotEmpty"}]}},"id":"0d9249fc-b5e8-4f30-b0f7-a1246ca1bc60","name":"IF","type":"n8n-nodes-base.if","typeVersion":1,"position":[1200,560]},{"parameters":{"fieldToSplitOut":"data","options":{}},"id":"09fac41f-af5c-4073-8dc2-ea8422a566b4","name":"ItemListsFolder","type":"n8n-nodes-base.itemLists","typeVersion":2.1,"position":[1440,540]},{"parameters":{"url":"https://dstt.postmart.vn/api/prs/workflow/scan-file","sendQuery":true,"queryParameters":{"parameters":[{"name":"file_path","value":"={{ $json.data }}"}]},"sendHeaders":true,"headerParameters":{"parameters":[{"name":"token","value":"7a51b166dfe235dfec2901a24ed2f671"}]},"options":{}},"id":"d2d6f908-b880-42b9-a6d3-8173657262b0","name":"ScanFileInFolder","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[1660,540]},{"parameters":{"fieldToSplitOut":"data","options":{}},"id":"e3f4fb6a-89b9-4c6f-9bd8-af31bfd82660","name":"ListFilePRS","type":"n8n-nodes-base.itemLists","typeVersion":2.1,"position":[1880,540]},{"parameters":{"url":"https://dstt.postmart.vn/api/prs/workflow/save-file","sendQuery":true,"queryParameters":{"parameters":[{"name":"file_path","value":"={{ $json.data }}"}]},"sendHeaders":true,"headerParameters":{"parameters":[{"name":"token","value":"7a51b166dfe235dfec2901a24ed2f671"}]},"options":{}},"id":"ebc337b1-6b07-4497-b034-157e91e3ee75","name":"SaveFile2Storage","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[2100,540]},{"parameters":{"conditions":{"string":[{"value1":"={{ $json.code }}","value2":"success"},{"value1":"={{ $json.data._id }}","operation":"isNotEmpty"}]}},"id":"c20c3173-e605-450f-b9a8-75f79bfb784b","name":"IF-Have-Row","type":"n8n-nodes-base.if","typeVersion":1,"position":[2320,540]},{"parameters":{"url":"https://dstt.postmart.vn/api/prs/workflow/read-file","sendQuery":true,"queryParameters":{"parameters":[{"name":"file_id","value":"={{ $json.data._id }}"}]},"sendHeaders":true,"headerParameters":{"parameters":[{"name":"token","value":"7a51b166dfe235dfec2901a24ed2f671"}]},"options":{}},"id":"69abcd65-4784-436c-ba6f-03d6d8f8bb6b","name":"Insert2db","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[2540,520]}],"connections":{"Schedule Trigger":{"main":[[{"node":"ListFolder","type":"main","index":0}]]},"ListFolder":{"main":[[{"node":"IF","type":"main","index":0}]]},"IF":{"main":[[{"node":"ItemListsFolder","type":"main","index":0}]]},"ItemListsFolder":{"main":[[{"node":"ScanFileInFolder","type":"main","index":0}]]},"ScanFileInFolder":{"main":[[{"node":"ListFilePRS","type":"main","index":0}]]},"ListFilePRS":{"main":[[{"node":"SaveFile2Storage","type":"main","index":0}]]},"SaveFile2Storage":{"main":[[{"node":"IF-Have-Row","type":"main","index":0}]]},"IF-Have-Row":{"main":[[{"node":"Insert2db","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{},"versionId":"c9db7cce-d070-453c-a717-a4e85ca91645","triggerCount":0,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-07-18T14:03:12.317Z","updatedAt":"2023-07-20T14:27:08.000Z","id":"189","name":"TMHN BANK BOT","active":false,"nodes":[{"parameters":{"httpMethod":"POST","path":"tmhn-xn3-bank-bot","options":{}},"id":"62ba37c4-cdca-4ffe-9c50-5e1650a72449","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[-1360,1100],"webhookId":"b459d9da-c462-43e0-880c-12b8d6304763"},{"parameters":{"mode":"runOnceForEachItem","jsCode":"if (\n  ($('getBankData').item.json.result.transactionType.type === '-' &&\n    $input.item.json.enableOutgoing) ||\n  ($('getBankData').item.json.result.transactionType.type === '+' &&\n    $input.item.json.enableIncoming)\n) {\n  const data = $('getBankData').first().json.result;\n\n  let elements = [];\n\n  elements.push({\n    tag: 'div',\n    fields: [\n      {\n        is_short: false,\n        text: {\n          tag: 'lark_md',\n          content: `**Ng√¢n h√†ng**: ${data.bankName.toUpperCase()}`,\n        },\n      },\n      {\n        is_short: false,\n        text: {\n          tag: 'lark_md',\n          content: `**S·ªë t√†i kho·∫£n**: ${data.receiverAccount}`,\n        },\n      },\n      {\n        is_short: false,\n        text: {\n          tag: 'lark_md',\n          content: `**S·ªë d∆∞ thay ƒë·ªïi:** ${data.transactionType.type} ${data.transactionAmount.amountText} VND`,\n        },\n      },\n      {\n        is_short: false,\n        text: {\n          tag: 'lark_md',\n          content: `**N·ªôi dung:** ${data.transactionMessage}`,\n        },\n      },\n    ],\n  });\n\n  // Append transaction ID if exist\n  if (data.transactionId) {\n    elements[0].fields.push({\n      is_short: false,\n      text: {\n        tag: 'lark_md',\n        content: `**M√£ giao d·ªãch:** ${data.transactionId}`,\n      },\n    });\n  }\n\n  // Append received time\n  elements[0].fields.push({\n    is_short: false,\n    text: {\n      tag: 'lark_md',\n      content: `**Th·ªùi gian nh·∫≠n:** ${data.receivedTime.text}`,\n    },\n  });\n\n  // Ki·ªÉm tra enableBalance n·∫øu true th√¨ th√™m ph·∫ßn t·ª≠ \"S·ªë d∆∞ t·∫°m t√≠nh\" v√†o m·∫£ng fields\n  if ($input.item.json.enableBalance) {\n    const balanceIndex = elements[0].fields.findIndex((field) =>\n      field?.text?.content?.includes('S·ªë d∆∞ thay ƒë·ªïi')\n    );\n    if (balanceIndex !== -1) {\n      elements[0].fields.splice(balanceIndex + 1, 0, {\n        is_short: false,\n        text: {\n          tag: 'lark_md',\n          content: `**S·ªë d∆∞ t·∫°m t√≠nh**: ${data.balance.amountText} VND`,\n        },\n      });\n    }\n  }\n\n  // create message card\n  let result = {\n    msg_type: 'interactive',\n    card: {\n      config: {\n        wide_screen_mode: true,\n      },\n      header: {\n        template: data.larkMessConfig?.cardColor ?? 'blue',\n        title: {\n          content: `${data.bankName.toUpperCase()}-${data.receiverAccount} (${\n            data.transactionType.type\n          }) ${data.transactionAmount.amountText}VND`,\n          tag: 'plain_text',\n        },\n      },\n      elements,\n    },\n  };\n\n  return {\n    json: {\n      isSend: true,\n      data: result,\n      customBotURL: $input.item.json.customBotURL,\n    },\n  };\n}\n\nreturn {\n  json: {\n    isSend: false,\n  },\n};\n"},"id":"bc8c95a6-e8ce-40e5-97a1-40107731f34f","name":"Convert to Lark Message Card","type":"n8n-nodes-base.code","typeVersion":1,"position":[940,1140]},{"parameters":{"method":"POST","url":"=https://open.larksuite.com/open-apis/auth/v3/tenant_access_token/internal/","sendBody":true,"specifyBody":"json","jsonBody":"={ \"app_id\" : \"{{ $input.item.json[\"appId\"] }}\", \"app_secret\" : \"{{ $input.item.json[\"appSecret\"] }}\" }","options":{}},"id":"ae5d612e-3e9f-450a-b04f-438db4ddca3c","name":"Get Lark tenant access token","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[-120,840]},{"parameters":{"method":"POST","url":"={{ $input.item.json.customBotURL }}","sendBody":true,"specifyBody":"json","jsonBody":"={{ JSON.stringify($input.item.json.data)}}","options":{}},"id":"ee85d359-e1bb-4e8b-b27f-cb220c0006e3","name":"[Lark] Send noti to group chat","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[1360,1000]},{"parameters":{"mode":"runOnceForEachItem","jsCode":"if (\n  ($('getBankData').item.json.result.transactionType.type === '-' &&\n    $input.item.json.enableOutgoing) ||\n  ($('getBankData').item.json.result.transactionType.type === '+' &&\n    $input.item.json.enableIncoming)\n) {\n  const data = $('getBankData').first().json.result;\n\n  // Convert to Lark Base format\n  const records = [\n    {\n      fields: {\n        ID: data.bankName + '-' + data.receiverAccount,\n        Bank: data.bankName.toUpperCase(),\n        Account: data.receiverAccount,\n        'Transaction Type': data.transactionType.typeText,\n        Debit:\n          data.transactionType.type === '+'\n            ? data.transactionAmount.amount\n            : undefined,\n        Credit:\n          data.transactionType.type === '-'\n            ? data.transactionAmount.amount\n            : undefined,\n        'Transaction ID': data.transactionId,\n        'Transaction Message': data.transactionMessage,\n        'Original Message': data.originalMessage,\n        'Time received': data.receivedTime.timestamp,\n      },\n    },\n  ];\n\n  // Ki·ªÉm tra enableBalance n·∫øu true th√¨ th√™m ph·∫ßn t·ª≠ \"Balance\" v√†o m·∫£ng fields\n  if ($input.item.json.enableBalance) {\n    records[0].fields = {\n      ...records[0].fields,\n      Balance: data.balance.amount,\n    };\n  }\n\n  return {\n    json: {\n      isSend: true,\n      records,\n      configs: {\n        baseId: $input.item.json.baseId,\n        tableId: $input.item.json.tableId,\n      },\n    },\n  };\n}\n\nreturn {\n  json: {\n    isSend: false,\n  },\n};\n"},"id":"a94a119b-37f7-4779-9686-8dd3fabcd55d","name":"Convert to Lark Base format","type":"n8n-nodes-base.code","typeVersion":1,"position":[920,740]},{"parameters":{"method":"POST","url":"=https://open.larksuite.com/open-apis/bitable/v1/apps/{{ $json[\"configs\"][\"baseId\"] }}/tables/{{  $json[\"configs\"][\"tableId\"]}}/records/batch_create","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $node[\"Get Lark tenant access token\"].json.tenant_access_token }}"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\"records\":{{ JSON.stringify($json[\"records\"]) }}}","options":{}},"id":"74df42e8-dbd7-44ac-8ea0-83e7ca7d5698","name":"[SMS Log] Add records to Bitable","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[1340,680]},{"parameters":{"conditions":{"boolean":[{"value1":"={{ $json.isBankSupport }}","value2":true}]}},"id":"4f116ec7-0924-4ab2-81c2-e92d5285b8bd","name":"ifBankSupport","type":"n8n-nodes-base.if","typeVersion":1,"position":[-940,1100]},{"parameters":{"method":"POST","url":"https://app.n8n.vn/webhook/kdigi-bank-bot-process-data","sendBody":true,"specifyBody":"json","jsonBody":"={{ JSON.stringify($input.first().json.body) }}","options":{}},"id":"c386b925-693e-44fc-b9c5-79dc18840fa6","name":"getBankData","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[-1160,1100]},{"parameters":{},"id":"490e0847-9a90-4668-b269-729ee1b31c6f","name":"Start Actions","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[-740,1080]},{"parameters":{"mode":"runOnceForEachItem","jsCode":"if (\n  ($('getBankData').item.json.result.transactionType.type === '-' &&\n    $input.item.json.enableOutgoing) ||\n  ($('getBankData').item.json.result.transactionType.type === '+' &&\n    $input.item.json.enableIncoming)\n) {\n  const data = $('getBankData').first().json.result;\n\n  let message = [];\n\n  message.push(\n    `<b>${data.bankName.toUpperCase()}-${data.receiverAccount} (${\n      data.transactionType.type\n    }) ${data.transactionAmount.amountText}VND</b>\\n`,\n    `<b>Ng√¢n h√†ng:</b> ${data.bankName.toUpperCase()}`,\n    `<b>S·ªë t√†i kho·∫£n:</b> ${data.receiverAccount}`,\n    `<b>S·ªë d∆∞ thay ƒë·ªïi:</b> ${data.transactionType.type} ${data.transactionAmount.amountText} VND`\n  );\n\n  // Add balance\n  if ($input.item.json.enableBalance) {\n    message.push(`<b>S·ªë d∆∞ t·∫°m t√≠nh:</b> ${data.balance.amountText} VND`);\n  }\n\n  message.push(`<b>N·ªôi dung:</b>\\n ${data.transactionMessage}`);\n\n  // Check transaction ID\n  if (data.transactionId) {\n    message.push(`<b>M√£ giao d·ªãch:</b> ${data.transactionId}`);\n  }\n\n  message.push(`<b>Th·ªùi gian nh·∫≠n:</b> ${data.receivedTime.text}`);\n\n  return {\n    json: {\n      isSend: true,\n      botId: $input.item.json.botId,\n      payload: {\n        chat_id: $input.item.json.chatId,\n        parse_mode: 'HTML',\n        text: message.join('\\n'),\n      },\n    },\n  };\n}\n\nreturn {\n  json: {\n    isSend: false,\n  },\n};\n"},"id":"1616d19d-f407-43ca-bab6-fdb4f2e0f507","name":"Create Telegram Message","type":"n8n-nodes-base.code","typeVersion":1,"position":[380,1500]},{"parameters":{"method":"POST","url":"=https://api.telegram.org/bot{{ $input.item.json.botId }}/sendMessage ","sendBody":true,"specifyBody":"json","jsonBody":"={{ JSON.stringify($input.item.json.payload) }}","options":{}},"id":"e35b8e56-8cc5-41ad-9a5a-caa97ff2936a","name":"Send to Telegram chat","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[840,1420]},{"parameters":{"values":{"string":[{"name":"appId","value":"cli_a279a52d29f8d009"},{"name":"appSecret","value":"cqor0pj2uybFM9PzACTpuDnasGqbFaje"}]},"options":{}},"id":"d5f4da79-4f89-45e0-90cb-81f879aa08af","name":"Set Lark Configs","type":"n8n-nodes-base.set","typeVersion":2,"position":[-300,840]},{"parameters":{"values":{"string":[{"name":"customBotURL","value":"https://open.larksuite.com/open-apis/bot/v2/hook/af9c50af-44dd-4cdd-a26c-a4e150425303"}],"boolean":[{"name":"enableBalance","value":true},{"name":"enableOTP","value":true},{"name":"enableOutgoing","value":true},{"name":"enableIncoming","value":true}]},"options":{}},"id":"107305b9-c2aa-4268-923c-efc60b0a510e","name":"Set Lark Mess Config","type":"n8n-nodes-base.set","typeVersion":2,"position":[300,1100]},{"parameters":{"values":{"string":[{"name":"baseId","value":"LIx9b5n6wazCqns1euGuCOthsyh"},{"name":"tableId","value":"tblK7k96kQfosl5C"}],"boolean":[{"name":"enableBalance","value":true},{"name":"enableOTP","value":true},{"name":"enableOutgoing","value":true},{"name":"enableIncoming","value":true}]},"options":{}},"id":"0a5c30e1-8195-4173-80d5-c72d4b347977","name":"Set Lark Base Config","type":"n8n-nodes-base.set","typeVersion":2,"position":[320,680]},{"parameters":{},"id":"efe7faf4-f291-48d3-9263-c5bcbad130a0","name":"Start Lark Actions","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[-460,840]},{"parameters":{},"id":"05e75d5c-03f7-4ef2-bd58-a9d99b880e17","name":"Start Lark Base","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[100,700]},{"parameters":{},"id":"5a9c59a1-2a50-407d-ba16-d1c7689c88d2","name":"Start Lark Mess","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[80,1100]},{"parameters":{},"id":"fdd156ce-8d53-4978-910f-db3a9524abd1","name":"Start Telegram Actions","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[-420,1420]},{"parameters":{"values":{"string":[{"name":"botId","value":"set-bot-id"},{"name":"chatId","value":"set-chat-id"}],"boolean":[{"name":"enableBalance","value":true},{"name":"enableOTP","value":true},{"name":"enableOutgoing","value":true},{"name":"enableIncoming","value":true}]},"options":{}},"id":"063d6027-041c-4e30-be71-5c2ef2d893f4","name":"Set Telegram Config","type":"n8n-nodes-base.set","typeVersion":2,"position":[-220,1420]},{"parameters":{},"id":"d5b8d793-9dec-46e0-b9ef-46f3a905e45b","name":"Start Lark Base Actions","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[540,680]},{"parameters":{},"id":"f56f422e-5258-4159-9690-cb59b4c8160b","name":"Start Lark Mess Actions","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[520,1080]},{"parameters":{"mode":"runOnceForEachItem","jsCode":"const smsContent = $('Webhook').first().json.body;\n\n// create message card\nlet result = {\n  msg_type: 'text',\n  content: {\n    text: `T·ª´: ${smsContent.from}\\n${smsContent.text.toString()}`,\n  },\n};\n\nreturn {\n  json: {\n    data: result,\n    customBotURL: $input.item.json.customBotURL,\n  },\n};\n"},"id":"7022812d-892c-46d9-8e7b-73d5455078e3","name":"Convert to Message Card for OTP","type":"n8n-nodes-base.code","typeVersion":1,"position":[940,980]},{"parameters":{},"id":"26456794-70d9-4b2a-9ead-472fb548cc03","name":"Start Telegram Mess Actions","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[-20,1420]},{"parameters":{"mode":"runOnceForEachItem","jsCode":"const smsContent = $('Webhook').first().json.body;\n\nlet message = [];\n\nmessage.push(\n  `<b>${smsContent.from.toUpperCase()}</b>\\n`,\n  `${smsContent.text.toString()}`\n);\n\nreturn {\n  json: {\n    botId: $input.item.json.botId,\n    payload: {\n      chat_id: $input.item.json.chatId,\n      parse_mode: 'HTML',\n      text: message.join('\\n'),\n    },\n  },\n};\n"},"id":"af2b16e1-5232-42d5-aeb8-5943587236d6","name":"Create Telegram Message for OTP","type":"n8n-nodes-base.code","typeVersion":1,"position":[380,1340]},{"parameters":{"conditions":{"boolean":[{"value1":"={{ $input.item.json.isSend }}","value2":true}]}},"id":"ec2114b3-2fb5-4264-bf07-5a5c304931b6","name":"ifSend","type":"n8n-nodes-base.if","typeVersion":1,"position":[1140,1140]},{"parameters":{"conditions":{"boolean":[{"value1":"={{ $input.item.json.isSend }}","value2":true}]}},"id":"1ba263c8-642f-42d2-bffe-92bff741f583","name":"ifSend1","type":"n8n-nodes-base.if","typeVersion":1,"position":[1100,740]},{"parameters":{"conditions":{"boolean":[{"value1":"={{ $input.item.json.isSend }}","value2":true}]}},"id":"efeb94f8-03a4-4495-9200-bf33fb67c71b","name":"ifSend2","type":"n8n-nodes-base.if","typeVersion":1,"position":[600,1500]},{"parameters":{"mode":"runOnceForEachItem","jsCode":"const smsContent = $('Webhook').first().json.body;\n\n  // Convert to Lark Base format\n  const records = [\n    {\n      fields: {\n        ID: smsContent.from,\n        Bank: smsContent.from,\n        'Transaction Type': 'OTP',\n        'Transaction Message': smsContent.text.toString(),\n        'Original Message': smsContent.text.toString(),\n        'Time received': smsContent.sentStamp,\n      },\n    },\n  ];\n\n  return {\n    json: {\n      records,\n      configs: {\n        baseId: $input.item.json.baseId,\n        tableId: $input.item.json.tableId,\n      },\n    },\n  };\n"},"id":"25880fff-969a-4790-afc2-3ad5aa3ed495","name":"Convert to Lark Base format OTP","type":"n8n-nodes-base.code","typeVersion":1,"position":[920,500]},{"parameters":{"conditions":{"string":[{"value1":"={{ $('setData').item.json.body.text }}","operation":"contains","value2":"OTP"}],"boolean":[{"value1":"={{ $input.item.json.enableOTP }}","value2":true}]}},"id":"922b08b1-2a50-4564-bc88-262eeb23e44b","name":"ifOTPLarkBase","type":"n8n-nodes-base.if","typeVersion":1,"position":[720,680]},{"parameters":{"conditions":{"string":[{"value1":"={{ $('setData').item.json.body.text }}","operation":"contains","value2":"OTP"}],"boolean":[{"value1":"={{ $input.item.json.enableOTP }}","value2":true}]}},"id":"dbae34be-d266-4e88-8b0f-3d56614dfd68","name":"ifOTPLarkMess","type":"n8n-nodes-base.if","typeVersion":1,"position":[680,1080]},{"parameters":{"conditions":{"string":[{"value1":"={{ $('setData').item.json.body.text }}","operation":"contains","value2":"OTP"}],"boolean":[{"value1":"={{ $input.item.json.enableOTP }}","value2":true}]}},"id":"096c407b-acfb-4cac-bfd8-ed7809acf603","name":"ifOTPTelegram","type":"n8n-nodes-base.if","typeVersion":1,"position":[160,1420]}],"connections":{"Webhook":{"main":[[{"node":"getBankData","type":"main","index":0}]]},"Convert to Lark Message Card":{"main":[[{"node":"ifSend","type":"main","index":0}]]},"Get Lark tenant access token":{"main":[[{"node":"Start Lark Base","type":"main","index":0},{"node":"Start Lark Mess","type":"main","index":0}]]},"Convert to Lark Base format":{"main":[[{"node":"ifSend1","type":"main","index":0}]]},"ifBankSupport":{"main":[[{"node":"Start Actions","type":"main","index":0}]]},"getBankData":{"main":[[{"node":"ifBankSupport","type":"main","index":0}]]},"Start Actions":{"main":[[{"node":"Start Lark Actions","type":"main","index":0},{"node":"Start Telegram Actions","type":"main","index":0}]]},"Create Telegram Message":{"main":[[{"node":"ifSend2","type":"main","index":0}]]},"Set Lark Configs":{"main":[[{"node":"Get Lark tenant access token","type":"main","index":0}]]},"Set Lark Mess Config":{"main":[[{"node":"Start Lark Mess Actions","type":"main","index":0}]]},"Set Lark Base Config":{"main":[[{"node":"Start Lark Base Actions","type":"main","index":0}]]},"Start Lark Actions":{"main":[[{"node":"Set Lark Configs","type":"main","index":0}]]},"Start Lark Base":{"main":[[{"node":"Set Lark Base Config","type":"main","index":0}]]},"Start Lark Mess":{"main":[[{"node":"Set Lark Mess Config","type":"main","index":0}]]},"Start Telegram Actions":{"main":[[{"node":"Set Telegram Config","type":"main","index":0}]]},"Set Telegram Config":{"main":[[{"node":"Start Telegram Mess Actions","type":"main","index":0}]]},"Start Lark Base Actions":{"main":[[{"node":"ifOTPLarkBase","type":"main","index":0}]]},"Start Lark Mess Actions":{"main":[[{"node":"ifOTPLarkMess","type":"main","index":0}]]},"Convert to Message Card for OTP":{"main":[[{"node":"[Lark] Send noti to group chat","type":"main","index":0}]]},"Start Telegram Mess Actions":{"main":[[{"node":"ifOTPTelegram","type":"main","index":0}]]},"Create Telegram Message for OTP":{"main":[[{"node":"Send to Telegram chat","type":"main","index":0}]]},"ifSend":{"main":[[{"node":"[Lark] Send noti to group chat","type":"main","index":0}]]},"ifSend1":{"main":[[{"node":"[SMS Log] Add records to Bitable","type":"main","index":0}]]},"ifSend2":{"main":[[{"node":"Send to Telegram chat","type":"main","index":0}]]},"Convert to Lark Base format OTP":{"main":[[{"node":"[SMS Log] Add records to Bitable","type":"main","index":0}]]},"ifOTPLarkBase":{"main":[[{"node":"Convert to Lark Base format OTP","type":"main","index":0}],[{"node":"Convert to Lark Base format","type":"main","index":0}]]},"ifOTPLarkMess":{"main":[[{"node":"Convert to Message Card for OTP","type":"main","index":0}],[{"node":"Convert to Lark Message Card","type":"main","index":0}]]},"ifOTPTelegram":{"main":[[{"node":"Create Telegram Message for OTP","type":"main","index":0}],[{"node":"Create Telegram Message","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{},"versionId":"38fa44db-38df-450c-9b8a-5cfb3e3f8cba","triggerCount":1,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-07-19T02:35:27.918Z","updatedAt":"2023-07-19T04:11:19.000Z","id":"190","name":"Check n8.quanchatbot.com","active":true,"nodes":[{"parameters":{},"id":"3f6eeaae-143c-4e5b-a29d-f4dd152d603c","name":"When clicking \"Execute Workflow\"","type":"n8n-nodes-base.manualTrigger","typeVersion":1,"position":[800,320]},{"parameters":{"returnAll":false,"limit":1,"filters":{"activeWorkflows":false}},"id":"5af8751a-c32d-4c2a-a0f1-8978b0714a1a","name":"n8n","type":"n8n-nodes-base.n8n","typeVersion":1,"position":[1060,400],"credentials":{"n8nApi":{"id":"86","name":"n8.quanchatbot.com"}},"continueOnFail":true},{"parameters":{"conditions":{"string":[{"value1":"={{ $json.id }}","operation":"isEmpty"}]}},"id":"f7303ec0-68c6-4899-8e9d-fbad0f798ed2","name":"IF","type":"n8n-nodes-base.if","typeVersion":1,"position":[1240,400]},{"parameters":{"chatId":"-832099157","text":"‚õî C√≥ v·∫•n ƒë·ªÅ v·ªõi server n8.quanchatbot.com k√¨a anh em!","additionalFields":{}},"id":"e8aa94bb-87de-49f9-aa95-1b0afaaf67db","name":"Telegram","type":"n8n-nodes-base.telegram","typeVersion":1,"position":[1660,380],"credentials":{"telegramApi":{"id":"87","name":"hita_5ptb_bot"}},"continueOnFail":true},{"parameters":{"operation":"sendPhoto","chatId":"-832099157","file":"AgACAgUAAxkBAAJ--GS3UcuXymzEv22XKtzuafdugrjcAALDtTEbEsW5VQpzzSUoCXRRAQADAgADeAADLwQ","additionalFields":{}},"id":"59696ea2-b249-4dcd-b59f-e00ab78f7d93","name":"Telegram1","type":"n8n-nodes-base.telegram","typeVersion":1,"position":[1460,380],"credentials":{"telegramApi":{"id":"87","name":"hita_5ptb_bot"}},"continueOnFail":true},{"parameters":{"rule":{"interval":[{"field":"minutes"}]}},"id":"34d3ac8d-da4e-42ea-af2f-f9271ce1e8e7","name":"Schedule Trigger","type":"n8n-nodes-base.scheduleTrigger","typeVersion":1.1,"position":[800,540]}],"connections":{"When clicking \"Execute Workflow\"":{"main":[[{"node":"n8n","type":"main","index":0}]]},"IF":{"main":[[{"node":"Telegram1","type":"main","index":0}]]},"Telegram1":{"main":[[{"node":"Telegram","type":"main","index":0}]]},"Schedule Trigger":{"main":[[{"node":"n8n","type":"main","index":0}]]},"n8n":{"main":[[{"node":"IF","type":"main","index":0}]]}},"settings":{"saveManualExecutions":false,"callerPolicy":"workflowsFromSameOwner","executionTimeout":30},"staticData":{"node:Schedule Trigger":{"recurrencyRules":[]}},"pinData":{},"versionId":"dc3b4295-9a4c-491c-9f21-7e228c8434cf","triggerCount":1,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-07-19T03:09:49.873Z","updatedAt":"2023-07-19T03:09:49.873Z","id":"191","name":"My workflow 23","active":false,"nodes":[{"parameters":{"httpMethod":"POST","path":"template-kdigi-bank-bot-api","options":{}},"id":"9e205cb4-11bb-46b7-ab58-a3aed0d3e084","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[-2480,1920],"webhookId":"b459d9da-c462-43e0-880c-12b8d6304763"},{"parameters":{"mode":"runOnceForEachItem","jsCode":"if (\n  ($('getBankData').item.json.result.transactionType.type === '-' &&\n    $input.item.json.enableOutgoing) ||\n  ($('getBankData').item.json.result.transactionType.type === '+' &&\n    $input.item.json.enableIncoming)\n) {\n  const data = $('getBankData').first().json.result;\n\n  let elements = [];\n\n  elements.push({\n    tag: 'div',\n    fields: [\n      {\n        is_short: false,\n        text: {\n          tag: 'lark_md',\n          content: `**Ng√¢n h√†ng**: ${data.bankName.toUpperCase()}`,\n        },\n      },\n      {\n        is_short: false,\n        text: {\n          tag: 'lark_md',\n          content: `**S·ªë t√†i kho·∫£n**: ${data.receiverAccount}`,\n        },\n      },\n      {\n        is_short: false,\n        text: {\n          tag: 'lark_md',\n          content: `**S·ªë d∆∞ thay ƒë·ªïi:** ${data.transactionType.type} ${data.transactionAmount.amountText} VND`,\n        },\n      },\n      {\n        is_short: false,\n        text: {\n          tag: 'lark_md',\n          content: `**N·ªôi dung:** ${data.transactionMessage}`,\n        },\n      },\n    ],\n  });\n\n  // Append transaction ID if exist\n  if (data.transactionId) {\n    elements[0].fields.push({\n      is_short: false,\n      text: {\n        tag: 'lark_md',\n        content: `**M√£ giao d·ªãch:** ${data.transactionId}`,\n      },\n    });\n  }\n\n  // Append received time\n  elements[0].fields.push({\n    is_short: false,\n    text: {\n      tag: 'lark_md',\n      content: `**Th·ªùi gian nh·∫≠n:** ${data.receivedTime.text}`,\n    },\n  });\n\n  // Ki·ªÉm tra enableBalance n·∫øu true th√¨ th√™m ph·∫ßn t·ª≠ \"S·ªë d∆∞ t·∫°m t√≠nh\" v√†o m·∫£ng fields\n  if ($input.item.json.enableBalance) {\n    const balanceIndex = elements[0].fields.findIndex((field) =>\n      field?.text?.content?.includes('S·ªë d∆∞ thay ƒë·ªïi')\n    );\n    if (balanceIndex !== -1) {\n      elements[0].fields.splice(balanceIndex + 1, 0, {\n        is_short: false,\n        text: {\n          tag: 'lark_md',\n          content: `**S·ªë d∆∞ t·∫°m t√≠nh**: ${data.balance.amountText} VND`,\n        },\n      });\n    }\n  }\n\n  // create message card\n  let result = {\n    msg_type: 'interactive',\n    card: {\n      config: {\n        wide_screen_mode: true,\n      },\n      header: {\n        template: data.larkMessConfig?.cardColor ?? 'blue',\n        title: {\n          content: `${data.bankName.toUpperCase()}-${data.receiverAccount} (${\n            data.transactionType.type\n          }) ${data.transactionAmount.amountText}VND`,\n          tag: 'plain_text',\n        },\n      },\n      elements,\n    },\n  };\n\n  return {\n    json: {\n      isSend: true,\n      data: result,\n      customBotURL: $input.item.json.customBotURL,\n    },\n  };\n}\n\nreturn {\n  json: {\n    isSend: false,\n  },\n};\n"},"id":"f8e63601-f951-4297-a7c7-deb9b420e965","name":"Convert to Lark Message Card","type":"n8n-nodes-base.code","typeVersion":1,"position":[-180,1960]},{"parameters":{"method":"POST","url":"=https://open.larksuite.com/open-apis/auth/v3/tenant_access_token/internal/","sendBody":true,"specifyBody":"json","jsonBody":"={ \"app_id\" : \"{{ $input.item.json[\"appId\"] }}\", \"app_secret\" : \"{{ $input.item.json[\"appSecret\"] }}\" }","options":{}},"id":"9e1dc9ff-8975-45ed-bc21-6ab37b664ff3","name":"Get Lark tenant access token","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[-1240,1660]},{"parameters":{"method":"POST","url":"={{ $input.item.json.customBotURL }}","sendBody":true,"specifyBody":"json","jsonBody":"={{ JSON.stringify($input.item.json.data)}}","options":{}},"id":"748f1019-d8cf-49b9-ac3b-9c58ce4cfa11","name":"[Lark] Send noti to group chat","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[240,1820]},{"parameters":{"mode":"runOnceForEachItem","jsCode":"if (\n  ($('getBankData').item.json.result.transactionType.type === '-' &&\n    $input.item.json.enableOutgoing) ||\n  ($('getBankData').item.json.result.transactionType.type === '+' &&\n    $input.item.json.enableIncoming)\n) {\n  const data = $('getBankData').first().json.result;\n\n  // Convert to Lark Base format\n  const records = [\n    {\n      fields: {\n        ID: data.bankName + '-' + data.receiverAccount,\n        Bank: data.bankName.toUpperCase(),\n        Account: data.receiverAccount,\n        'Transaction Type': data.transactionType.typeText,\n        Debit:\n          data.transactionType.type === '+'\n            ? data.transactionAmount.amount\n            : undefined,\n        Credit:\n          data.transactionType.type === '-'\n            ? data.transactionAmount.amount\n            : undefined,\n        'Transaction ID': data.transactionId,\n        'Transaction Message': data.transactionMessage,\n        'Original Message': data.originalMessage,\n        'Time received': data.receivedTime.timestamp,\n      },\n    },\n  ];\n\n  // Ki·ªÉm tra enableBalance n·∫øu true th√¨ th√™m ph·∫ßn t·ª≠ \"Balance\" v√†o m·∫£ng fields\n  if ($input.item.json.enableBalance) {\n    records[0].fields = {\n      ...records[0].fields,\n      Balance: data.balance.amount,\n    };\n  }\n\n  return {\n    json: {\n      isSend: true,\n      records,\n      configs: {\n        baseId: $input.item.json.baseId,\n        tableId: $input.item.json.tableId,\n      },\n    },\n  };\n}\n\nreturn {\n  json: {\n    isSend: false,\n  },\n};\n"},"id":"4f9c200d-37c6-4652-9774-48a7272d3057","name":"Convert to Lark Base format","type":"n8n-nodes-base.code","typeVersion":1,"position":[-200,1560]},{"parameters":{"method":"POST","url":"=https://open.larksuite.com/open-apis/bitable/v1/apps/{{ $json[\"configs\"][\"baseId\"] }}/tables/{{  $json[\"configs\"][\"tableId\"]}}/records/batch_create","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $node[\"Get Lark tenant access token\"].json.tenant_access_token }}"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\"records\":{{ JSON.stringify($json[\"records\"]) }}}","options":{}},"id":"d99af9ee-0058-4fc1-809a-4c203ad5d1ce","name":"[SMS Log] Add records to Bitable","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[220,1500]},{"parameters":{"conditions":{"boolean":[{"value1":"={{ $json.isBankSupport }}","value2":true}]}},"id":"c8308bb2-7068-4e9a-aff1-3e2649d6be58","name":"ifBankSupport","type":"n8n-nodes-base.if","typeVersion":1,"position":[-2060,1920]},{"parameters":{"method":"POST","url":"https://app.n8n.vn/webhook/kdigi-bank-bot-process-data","sendBody":true,"specifyBody":"json","jsonBody":"={{ JSON.stringify($input.first().json.body) }}","options":{}},"id":"05ce27ac-fb20-445e-80e0-f3341ebda293","name":"getBankData","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[-2280,1920]},{"parameters":{},"id":"7fdff97a-e91c-4817-b6ce-ba707473649c","name":"Start Actions","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[-1860,1900]},{"parameters":{"mode":"runOnceForEachItem","jsCode":"if (\n  ($('getBankData').item.json.result.transactionType.type === '-' &&\n    $input.item.json.enableOutgoing) ||\n  ($('getBankData').item.json.result.transactionType.type === '+' &&\n    $input.item.json.enableIncoming)\n) {\n  const data = $('getBankData').first().json.result;\n\n  let message = [];\n\n  message.push(\n    `<b>${data.bankName.toUpperCase()}-${data.receiverAccount} (${\n      data.transactionType.type\n    }) ${data.transactionAmount.amountText}VND</b>\\n`,\n    `<b>Ng√¢n h√†ng:</b> ${data.bankName.toUpperCase()}`,\n    `<b>S·ªë t√†i kho·∫£n:</b> ${data.receiverAccount}`,\n    `<b>S·ªë d∆∞ thay ƒë·ªïi:</b> ${data.transactionType.type} ${data.transactionAmount.amountText} VND`\n  );\n\n  // Add balance\n  if ($input.item.json.enableBalance) {\n    message.push(`<b>S·ªë d∆∞ t·∫°m t√≠nh:</b> ${data.balance.amountText} VND`);\n  }\n\n  message.push(`<b>N·ªôi dung:</b>\\n ${data.transactionMessage}`);\n\n  // Check transaction ID\n  if (data.transactionId) {\n    message.push(`<b>M√£ giao d·ªãch:</b> ${data.transactionId}`);\n  }\n\n  message.push(`<b>Th·ªùi gian nh·∫≠n:</b> ${data.receivedTime.text}`);\n\n  return {\n    json: {\n      isSend: true,\n      botToken: $input.item.json.botToken,\n      payload: {\n        chat_id: $input.item.json.chatId,\n        parse_mode: 'HTML',\n        text: message.join('\\n'),\n      },\n    },\n  };\n}\n\nreturn {\n  json: {\n    isSend: false,\n  },\n};\n"},"id":"70b44c4a-0246-4c51-9c96-3fe0d032930a","name":"Create Telegram Message","type":"n8n-nodes-base.code","typeVersion":1,"position":[-740,2400]},{"parameters":{"method":"POST","url":"=https://api.telegram.org/bot{{ $input.item.json.botToken }}/sendMessage ","sendBody":true,"specifyBody":"json","jsonBody":"={{ JSON.stringify($input.item.json.payload) }}","options":{}},"id":"532bbae7-5d3c-43dc-9deb-a9c1bd162ac0","name":"Send to Telegram chat","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[-280,2320]},{"parameters":{"values":{"string":[{"name":"appId","value":"set-app-id"},{"name":"appSecret","value":"set-app-secret"}]},"options":{}},"id":"ac5e8793-d7d8-4109-ad4f-00f188877695","name":"Set Lark Configs","type":"n8n-nodes-base.set","typeVersion":2,"position":[-1420,1660]},{"parameters":{"values":{"string":[{"name":"customBotURL","value":"set-bot-url"}],"boolean":[{"name":"enableBalance","value":true},{"name":"enableOTP","value":true},{"name":"enableOutgoing","value":true},{"name":"enableIncoming","value":true}]},"options":{}},"id":"2436410c-4636-468a-8b9f-4d9864aceaf0","name":"Set Lark Mess Config","type":"n8n-nodes-base.set","typeVersion":2,"position":[-820,1920]},{"parameters":{"values":{"string":[{"name":"baseId","value":"set-base-id"},{"name":"tableId","value":"set-table-id"}],"boolean":[{"name":"enableBalance","value":true},{"name":"enableOTP","value":true},{"name":"enableOutgoing","value":true},{"name":"enableIncoming","value":true}]},"options":{}},"id":"e4ea1799-14ca-455a-8377-80a22c9e3c59","name":"Set Lark Base Config","type":"n8n-nodes-base.set","typeVersion":2,"position":[-800,1520]},{"parameters":{},"id":"91fea677-c312-463c-b5fc-de6006bdc2d1","name":"Start Lark Actions","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[-1580,1660]},{"parameters":{},"id":"5dfea83d-ec43-4783-89d5-294f8a61e58f","name":"Start Lark Base","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[-1020,1520]},{"parameters":{},"id":"18dbb169-5b39-4e3b-87bb-b788e6cf3985","name":"Start Lark Mess","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[-1040,1920]},{"parameters":{},"id":"e9f043f1-b1c7-47e0-9dd4-b71371fa466e","name":"Start Telegram Actions","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[-1540,2320]},{"parameters":{"values":{"string":[{"name":"botToken","value":"set-bot-token"},{"name":"chatId","value":"set-chat-id"}],"boolean":[{"name":"enableBalance","value":true},{"name":"enableOTP","value":true},{"name":"enableOutgoing","value":true},{"name":"enableIncoming","value":true}]},"options":{}},"id":"07487408-643f-432c-bb79-6833875aedcf","name":"Set Telegram Config","type":"n8n-nodes-base.set","typeVersion":2,"position":[-1340,2320]},{"parameters":{},"id":"2f3cbb94-9391-4d46-86e4-3667afd8ffbd","name":"Start Lark Base Actions","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[-580,1500]},{"parameters":{},"id":"55a126b3-cbfc-4d28-bdfc-20b73a4d1a89","name":"Start Lark Mess Actions","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[-600,1900]},{"parameters":{"mode":"runOnceForEachItem","jsCode":"const smsContent = $('Webhook').first().json.body;\n\n// create message card\nlet result = {\n  msg_type: 'text',\n  content: {\n    text: `T·ª´: ${smsContent.from}\\n${smsContent.text.toString()}`,\n  },\n};\n\nreturn {\n  json: {\n    data: result,\n    customBotURL: $input.item.json.customBotURL,\n  },\n};\n"},"id":"965200f8-259c-4330-966b-5918c4e6246c","name":"Convert to Message Card for OTP","type":"n8n-nodes-base.code","typeVersion":1,"position":[-180,1800]},{"parameters":{},"id":"bb18cf7c-8761-47b8-a44b-9f6d9d710420","name":"Start Telegram Mess Actions","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[-1140,2320]},{"parameters":{"mode":"runOnceForEachItem","jsCode":"const smsContent = $('Webhook').first().json.body;\n\nlet message = [];\n\nmessage.push(\n  `<b>${smsContent.from.toUpperCase()}</b>\\n`,\n  `${smsContent.text.toString()}`\n);\n\nreturn {\n  json: {\n    botToken: $input.item.json.botToken,\n    payload: {\n      chat_id: $input.item.json.chatId,\n      parse_mode: 'HTML',\n      text: message.join('\\n'),\n    },\n  },\n};\n"},"id":"707f8817-f448-40f2-9cc3-303d66769cc9","name":"Create Telegram Message for OTP","type":"n8n-nodes-base.code","typeVersion":1,"position":[-740,2240]},{"parameters":{"conditions":{"boolean":[{"value1":"={{ $input.item.json.isSend }}","value2":true}]}},"id":"ab31666f-b112-46da-9fc1-9ab27152d3d8","name":"ifSend","type":"n8n-nodes-base.if","typeVersion":1,"position":[20,1960]},{"parameters":{"conditions":{"boolean":[{"value1":"={{ $input.item.json.isSend }}","value2":true}]}},"id":"c9f29178-4906-4d8d-99cd-6dc9b6483056","name":"ifSend1","type":"n8n-nodes-base.if","typeVersion":1,"position":[-20,1560]},{"parameters":{"conditions":{"boolean":[{"value1":"={{ $input.item.json.isSend }}","value2":true}]}},"id":"48c50e90-5ae0-4bf0-bac3-62afa254e90d","name":"ifSend2","type":"n8n-nodes-base.if","typeVersion":1,"position":[-520,2400]},{"parameters":{"mode":"runOnceForEachItem","jsCode":"const smsContent = $('Webhook').first().json.body;\n\n  // Convert to Lark Base format\n  const records = [\n    {\n      fields: {\n        ID: smsContent.from,\n        Bank: smsContent.from,\n        'Transaction Type': 'OTP',\n        'Transaction Message': smsContent.text.toString(),\n        'Original Message': smsContent.text.toString(),\n        'Time received': smsContent.sentStamp,\n      },\n    },\n  ];\n\n  return {\n    json: {\n      records,\n      configs: {\n        baseId: $input.item.json.baseId,\n        tableId: $input.item.json.tableId,\n      },\n    },\n  };\n"},"id":"1e3eaf03-56c2-453e-800c-912dd46d4391","name":"Convert to Lark Base format OTP","type":"n8n-nodes-base.code","typeVersion":1,"position":[-200,1320]},{"parameters":{"conditions":{"string":[{"value1":"={{ $('Webhook').item.json.body.text }}","operation":"contains","value2":"OTP"}],"boolean":[{"value1":"={{ $input.item.json.enableOTP }}","value2":true}]}},"id":"2ba72c67-7292-49a6-a7b7-6f4a0f27c995","name":"ifOTPLarkBase","type":"n8n-nodes-base.if","typeVersion":1,"position":[-400,1500]},{"parameters":{"conditions":{"string":[{"value1":"={{ $('Webhook').item.json.body.text }}","operation":"contains","value2":"OTP"}],"boolean":[{"value1":"={{ $input.item.json.enableOTP }}","value2":true}]}},"id":"769b61fe-d90e-4e45-a9ee-582167a6ccc5","name":"ifOTPLarkMess","type":"n8n-nodes-base.if","typeVersion":1,"position":[-440,1900]},{"parameters":{"conditions":{"string":[{"value1":"={{ $('Webhook').item.json.body.text }}","operation":"contains","value2":"OTP"}],"boolean":[{"value1":"={{ $input.item.json.enableOTP }}","value2":true}]}},"id":"21f1fcc7-b0c4-429d-855b-9d48355ccefd","name":"ifOTPTelegram","type":"n8n-nodes-base.if","typeVersion":1,"position":[-960,2320]}],"connections":{"Webhook":{"main":[[{"node":"getBankData","type":"main","index":0}]]},"Convert to Lark Message Card":{"main":[[{"node":"ifSend","type":"main","index":0}]]},"Get Lark tenant access token":{"main":[[{"node":"Start Lark Base","type":"main","index":0},{"node":"Start Lark Mess","type":"main","index":0}]]},"Convert to Lark Base format":{"main":[[{"node":"ifSend1","type":"main","index":0}]]},"ifBankSupport":{"main":[[{"node":"Start Actions","type":"main","index":0}]]},"getBankData":{"main":[[{"node":"ifBankSupport","type":"main","index":0}]]},"Start Actions":{"main":[[{"node":"Start Lark Actions","type":"main","index":0},{"node":"Start Telegram Actions","type":"main","index":0}]]},"Create Telegram Message":{"main":[[{"node":"ifSend2","type":"main","index":0}]]},"Set Lark Configs":{"main":[[{"node":"Get Lark tenant access token","type":"main","index":0}]]},"Set Lark Mess Config":{"main":[[{"node":"Start Lark Mess Actions","type":"main","index":0}]]},"Set Lark Base Config":{"main":[[{"node":"Start Lark Base Actions","type":"main","index":0}]]},"Start Lark Actions":{"main":[[{"node":"Set Lark Configs","type":"main","index":0}]]},"Start Lark Base":{"main":[[{"node":"Set Lark Base Config","type":"main","index":0}]]},"Start Lark Mess":{"main":[[{"node":"Set Lark Mess Config","type":"main","index":0}]]},"Start Telegram Actions":{"main":[[{"node":"Set Telegram Config","type":"main","index":0}]]},"Set Telegram Config":{"main":[[{"node":"Start Telegram Mess Actions","type":"main","index":0}]]},"Start Lark Base Actions":{"main":[[{"node":"ifOTPLarkBase","type":"main","index":0}]]},"Start Lark Mess Actions":{"main":[[{"node":"ifOTPLarkMess","type":"main","index":0}]]},"Convert to Message Card for OTP":{"main":[[{"node":"[Lark] Send noti to group chat","type":"main","index":0}]]},"Start Telegram Mess Actions":{"main":[[{"node":"ifOTPTelegram","type":"main","index":0}]]},"Create Telegram Message for OTP":{"main":[[{"node":"Send to Telegram chat","type":"main","index":0}]]},"ifSend":{"main":[[{"node":"[Lark] Send noti to group chat","type":"main","index":0}]]},"ifSend1":{"main":[[{"node":"[SMS Log] Add records to Bitable","type":"main","index":0}]]},"ifSend2":{"main":[[{"node":"Send to Telegram chat","type":"main","index":0}]]},"Convert to Lark Base format OTP":{"main":[[{"node":"[SMS Log] Add records to Bitable","type":"main","index":0}]]},"ifOTPLarkBase":{"main":[[{"node":"Convert to Lark Base format OTP","type":"main","index":0}],[{"node":"Convert to Lark Base format","type":"main","index":0}]]},"ifOTPLarkMess":{"main":[[{"node":"Convert to Message Card for OTP","type":"main","index":0}],[{"node":"Convert to Lark Message Card","type":"main","index":0}]]},"ifOTPTelegram":{"main":[[{"node":"Create Telegram Message for OTP","type":"main","index":0}],[{"node":"Create Telegram Message","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{},"versionId":"32e4f5dd-8eee-4096-b197-5bc3ddcc4ad9","triggerCount":0,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-07-19T04:15:19.338Z","updatedAt":"2023-07-19T04:15:19.338Z","id":"192","name":"Bao Hanh TRIP","active":false,"nodes":[{"parameters":{"httpMethod":"POST","path":"bao-hanh-trip","options":{}},"id":"8987c2ec-8523-48d0-95e8-6971739cbb08","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[1440,700],"webhookId":"8aba7f1f-52de-42bc-b484-64e9b6b8789d"},{"parameters":{"method":"POST","url":"https://api.infusionsoft.com/crm/rest/v1/contacts","sendHeaders":true,"headerParameters":{"parameters":[{"name":"X-Keap-API-Key","value":"KeapAK-92d6c1b7992aa8d49e447eac57ec430e509d07527cce90182a"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={ \n  \"birthday\": \"{{ $('Webhook').item.json[\"body\"][\"ngaysinh1\"] }}\",  \n  \"custom_fields\": [\n{\n\"content\": \"{{ $('Webhook').item.json[\"body\"][\"serial\"] }}\",\n\"id\": 516\n},\n{\n\"content\": \"{{ $('Webhook').item.json[\"body\"][\"sanpham\"] }}\",\n\"id\": 514\n},\n{\n\"content\": \"{{ $('Webhook').item.json[\"body\"][\"ngaykichhoat1\"] }}\",\n\"id\": 510\n},\n{\n\"content\": \"{{ $('Webhook').item.json[\"body\"][\"hanbaohanh1\"] }}\",\n\"id\": 512\n}\n],\n  \"email_addresses\": [\n    {\n      \"email\": \"{{ $('Webhook').item.json[\"body\"][\"emailKH\"] }}\",\n      \"field\": \"EMAIL1\"\n    }\n  ],\n  \"given_name\": \"{{ $('Webhook').item.json[\"body\"][\"name\"] }}\",\n  \"opt_in_reason\": \"K√≠ch ho·∫°t b·∫£o h√†nh\",\n  \"phone_numbers\": [\n    {      \n      \"field\": \"PHONE1\",\n      \"number\": \"{{ $('Webhook').item.json[\"body\"][\"phoneKH\"] }}\",\n      \"type\": \"Mobile\"\n    }\n  ]\n}","options":{}},"id":"fd45e88b-cc6c-4f7d-8d50-4114996aee6f","name":"Keap - New Contact","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[1660,700]},{"parameters":{"method":"POST","url":"=https://api.infusionsoft.com/crm/rest/v1/contacts/{{ $json[\"id\"] }}/tags","sendHeaders":true,"headerParameters":{"parameters":[{"name":"X-Keap-API-Key","value":"KeapAK-92d6c1b7992aa8d49e447eac57ec430e509d07527cce90182a"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\n\"tagIds\": [\n15474\n]\n}","options":{}},"id":"1288dd99-d974-413e-9092-858de9dbe1d8","name":"Keap - Add Tag","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[1860,700]}],"connections":{"Webhook":{"main":[[{"node":"Keap - New Contact","type":"main","index":0}]]},"Keap - New Contact":{"main":[[{"node":"Keap - Add Tag","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{"Webhook":[{"json":{"headers":{"host":"n8.quanchatbot.com","user-agent":"axios/0.19.2","content-length":"234","accept":"application/json, text/plain, */*","content-type":"application/json","x-forwarded-for":"34.87.3.106","x-forwarded-host":"n8.quanchatbot.com","x-forwarded-port":"443","x-forwarded-proto":"https","x-forwarded-server":"cc3a1a76fa48","x-real-ip":"34.87.3.106","accept-encoding":"gzip"},"params":{},"query":{},"body":{"serial":"444482068","sanpham":"Vali Trip PC911 size 70 xanh d∆∞∆°ng","ngaykichhoat1":"2023-06-15","hanbaohanh1":"2024-08-16","name":"L√™ H·ªìng Qu√¢n","emailKH":"lehongquan@gmail.com","phoneKH":"0866088807","ngaysinh1":"1984-12-25"}},"pairedItem":{"item":0}}]},"versionId":"a923d71e-9639-4d1b-b354-dbe8af72fd55","triggerCount":0,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-07-19T04:15:51.284Z","updatedAt":"2023-07-19T07:53:12.000Z","id":"193","name":"Enroll Thinkific","active":true,"nodes":[{"parameters":{"httpMethod":"POST","path":"thinkific","options":{}},"id":"0e17f16b-7fe9-4e42-9e14-820da97e8e50","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[40,900],"webhookId":"e315873f-1073-4606-909e-254bac1c6bb5"},{"parameters":{"conditions":{"number":[{"value1":"={{ $json.items[0].id }}","operation":"isNotEmpty"}]}},"id":"2f1011a7-5028-4574-94e6-75ca6b417a6d","name":"Chua co tk?","type":"n8n-nodes-base.if","typeVersion":1,"position":[1040,900]},{"parameters":{"method":"POST","url":"=https://api.quanchatbot.com/thinkific/new-user.php","sendBody":true,"contentType":"form-urlencoded","bodyParameters":{"parameters":[{"name":"first_name","value":"={{ $node.Webhook.json.body.first_name }}"},{"name":"last_name","value":"={{ $node.Webhook.json.body.last_name }}"},{"name":"email","value":"={{ $node.Webhook.json.body.email }}"},{"name":"phone","value":"={{ $node.Webhook.json.body.phone }}"},{"name":"messid","value":"={{ $node.Webhook.json.body.messid }}"},{"name":"password","value":"={{ $node.Webhook.json.body.password }}"}]},"options":{}},"id":"b00b93e2-3830-4cf9-9730-38022b02082e","name":"New User","type":"n8n-nodes-base.httpRequest","typeVersion":4,"position":[80,1160],"disabled":true,"continueOnFail":true},{"parameters":{"url":"=https://api.thinkific.com/api/public/v1/users?query[email]={{ $node.Webhook.json.body.email }}","sendHeaders":true,"headerParameters":{"parameters":[{"name":"X-Auth-API-Key","value":"20c0d3dae7a7bf515967a24ad97f7bc2"},{"name":"X-Auth-Subdomain","value":"hita"}]},"options":{}},"id":"fb3188fd-e64f-4b00-8383-b0abb276390e","name":"Check da co tk?","type":"n8n-nodes-base.httpRequest","typeVersion":4,"position":[900,900],"continueOnFail":true},{"parameters":{"conditions":{"string":[{"value1":"={{ $node.Webhook.json.body.type }}","value2":"course"}]}},"id":"641e2d0a-0772-4b1f-a80f-35eeb4015d3d","name":"is Course","type":"n8n-nodes-base.if","typeVersion":1,"position":[1260,920]},{"parameters":{"conditions":{"string":[{"value1":"={{ $node.Webhook.json.body.type }}","value2":"bundle"}]}},"id":"06ca0799-c8ed-4245-b04f-45056cd0e083","name":"is Bundle","type":"n8n-nodes-base.if","typeVersion":1,"position":[1460,1000]},{"parameters":{"method":"POST","url":"=https://api.thinkific.com/api/public/v1/enrollments","sendHeaders":true,"headerParameters":{"parameters":[{"name":"X-Auth-API-Key","value":"20c0d3dae7a7bf515967a24ad97f7bc2"},{"name":"X-Auth-Subdomain","value":"hita"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\n  \"course_id\": {{ $node.Webhook.json.body.learning_id }},\n  \"user_id\": {{ $node[\"Check da co tk?\"].json[\"items\"][0][\"id\"] }},\n  \"activated_at\": \"{{ $node[\"Now Year\"].json[\"NowYear\"] }}T01:01:00Z\",\n  \"expiry_date\": \"{{ $node[\"Add 1 Year\"].json[\"NextYear\"] }}T01:01:00Z\"\n}","options":{}},"id":"2f6543a0-a491-429b-9229-52eb908f6a95","name":"Enroll Course","type":"n8n-nodes-base.httpRequest","typeVersion":4,"position":[1460,800],"retryOnFail":true,"executeOnce":false,"continueOnFail":true},{"parameters":{"method":"POST","url":"=https://api.thinkific.com/api/public/v1/bundles/{{ $node.Webhook.json.body.learning_id }}/enrollments","sendHeaders":true,"headerParameters":{"parameters":[{"name":"X-Auth-API-Key","value":"20c0d3dae7a7bf515967a24ad97f7bc2"},{"name":"X-Auth-Subdomain","value":"hita"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={  \n  \"user_id\": {{ $json[\"items\"][0][\"id\"] }},\n  \"activated_at\": \"{{ $node[\"Now Year\"].json[\"NowYear\"] }}T01:01:00Z\",\n  \"expiry_date\": \"{{ $node[\"Add 1 Year\"].json[\"NextYear\"] }}T01:01:00Z\"\n}","options":{"response":{"response":{"fullResponse":true,"responseFormat":"json"}}}},"id":"a24e5e29-48b4-421e-bcbe-82a785abcb3f","name":"Enroll Bundle","type":"n8n-nodes-base.httpRequest","typeVersion":4,"position":[1660,1000],"notesInFlow":false,"retryOnFail":false,"alwaysOutputData":true,"continueOnFail":true},{"parameters":{"value":"={{ $now }}","dataPropertyName":"NowYear","toFormat":"YYYY-MM-DD","options":{}},"id":"908acc46-dd38-4b95-a5c1-c66a93f8524d","name":"Now Year","type":"n8n-nodes-base.dateTime","typeVersion":1,"position":[380,900]},{"parameters":{"value":"={{ $now.plus(1, 'year') }}","dataPropertyName":"NextYear","toFormat":"YYYY-MM-DD","options":{}},"id":"4baffa5c-e9e7-4a18-9d0e-4710a20aaa41","name":"Add 1 Year","type":"n8n-nodes-base.dateTime","typeVersion":1,"position":[540,900]},{"parameters":{"conditions":{"string":[{"value1":"={{ $node.Webhook.json.body.type }}","value2":"course"}]}},"id":"887a91d3-591f-4624-8c7d-000541760eca","name":"is Course1","type":"n8n-nodes-base.if","typeVersion":1,"position":[800,560],"disabled":true},{"parameters":{"method":"POST","url":"=https://api.thinkific.com/api/public/v1/enrollments","sendHeaders":true,"headerParameters":{"parameters":[{"name":"X-Auth-API-Key","value":"20c0d3dae7a7bf515967a24ad97f7bc2"},{"name":"X-Auth-Subdomain","value":"hita"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\n  \"course_id\": {{ $node[\"Webhook\"].json[\"body\"][\"learning_id\"] }},\n  \"user_id\": {{ $node[\"New User2\"].json[\"id\"] }},\n  \"activated_at\": \"{{ $node[\"Now Year\"].json[\"NowYear\"] }}T01:01:00Z\",\n  \"expiry_date\": \"{{ $node[\"Add 1 Year\"].json[\"NextYear\"] }}T01:01:00Z\"\n}","options":{}},"id":"60849a74-2a95-41f2-bce7-be3982101528","name":"Enroll Course1","type":"n8n-nodes-base.httpRequest","typeVersion":4,"position":[1040,500],"disabled":true},{"parameters":{"conditions":{"string":[{"value1":"={{ $node.Webhook.json.body.type }}","value2":"bundle"}]}},"id":"8006c285-b27a-49ac-83ef-b76a0321b32e","name":"is Bundle1","type":"n8n-nodes-base.if","typeVersion":1,"position":[1080,680],"disabled":true},{"parameters":{"method":"POST","url":"=https://api.thinkific.com/api/public/v1/bundles/{{ $node[\"Webhook\"].json[\"body\"][\"learning_id\"] }}/enrollments ","sendHeaders":true,"headerParameters":{"parameters":[{"name":"X-Auth-API-Key","value":"20c0d3dae7a7bf515967a24ad97f7bc2"},{"name":"X-Auth-Subdomain","value":"hita"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={  \n  \"user_id\": {{ $node[\"New User2\"].json[\"id\"] }},\n  \"activated_at\": \"{{ $node[\"Now Year\"].json[\"NowYear\"] }}T01:01:00Z\",\n  \"expiry_date\": \"{{ $node[\"Add 1 Year\"].json[\"NextYear\"] }}T01:01:00Z\"\n}","options":{}},"id":"dc5ab4e7-5150-49f6-84e8-0cf3bee1c49a","name":"Enroll Bundle1","type":"n8n-nodes-base.httpRequest","typeVersion":4,"position":[1260,620],"disabled":true},{"parameters":{},"id":"55272fcb-e5cc-4f67-8240-bb4597de1727","name":"IF","type":"n8n-nodes-base.if","typeVersion":1,"position":[480,1180],"disabled":true},{"parameters":{"method":"POST","url":"=https://api.thinkific.com/api/public/v1/users","sendHeaders":true,"headerParameters":{"parameters":[{"name":"X-Auth-API-Key","value":"20c0d3dae7a7bf515967a24ad97f7bc2"},{"name":"X-Auth-Subdomain","value":"hita"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={   \"first_name\": \"{{ $node[\"Webhook\"].json[\"body\"][\"first_name\"] }}\",   \"last_name\": \"{{ $node[\"Webhook\"].json[\"body\"][\"last_name\"] }}\",   \"email\": \"{{ $node[\"Webhook\"].json[\"body\"][\"email\"] }}\",   \"password\": \"TG2023@TTL\",    \"bio\": \"{{ $node.Webhook.json.body.first_name }} {{ $node[\"Webhook\"].json[\"body\"][\"last_name\"] }}\",   \"company\": \"TTL\",   \"headline\": \"Student\", \"custom_profile_fields\": [     {       \"value\": \"{{$node[\"Webhook\"].json[\"body\"][\"phone\"]}}\",       \"custom_profile_field_definition_id\": 67351     },  {       \"value\": \"{{$node[\"Webhook\"].json[\"body\"][\"messid\"]}}\",       \"custom_profile_field_definition_id\": 67352     }   ],   \"skip_custom_fields_validation\": false,   \"send_welcome_email\": true }","options":{}},"id":"7570592e-4a02-46f8-a449-de0228115aba","name":"New User1","type":"n8n-nodes-base.httpRequest","typeVersion":4,"position":[320,1160],"disabled":true},{"parameters":{"method":"POST","url":"=https://api.quanchatbot.com/thinkific/new-user.php","sendBody":true,"contentType":"form-urlencoded","bodyParameters":{"parameters":[{"name":"first_name","value":"={{ $node.Webhook.json.body.first_name }}"},{"name":"last_name","value":"={{ $node.Webhook.json.body.last_name }}"},{"name":"email","value":"={{ $node.Webhook.json.body.email }}"},{"name":"phone","value":"={{ $node.Webhook.json.body.phone }}"},{"name":"messid","value":"={{ $node.Webhook.json.body.messid }}"},{"name":"password","value":"={{ $node.Webhook.json.body.password }}"}]},"options":{}},"id":"7ad45a75-8b98-457a-a2ef-20436268c485","name":"New User2","type":"n8n-nodes-base.httpRequest","typeVersion":4,"position":[380,580],"disabled":true},{"parameters":{"conditions":{"string":[{"value1":"={{ $json.data }}","operation":"contains","value2":"has already been taken"},{"value1":"{{ $json.data }}","operation":"contains","value2":"Error creating user"}]},"combineOperation":"any"},"id":"e9dcfd0d-1a2a-41a0-adb3-ec1e2e6deb70","name":"IF1","type":"n8n-nodes-base.if","typeVersion":1,"position":[580,560],"disabled":true},{"parameters":{"conditions":{"string":[{"value1":"={{ $json.body.email }}","operation":"regex","value2":"(?:[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*|\"(?:[\\x01-\\x08\\x0b\\x0c\\x0e-\\x1f\\x21\\x23-\\x5b\\x5d-\\x7f]|\\\\[\\x01-\\x09\\x0b\\x0c\\x0e-\\x7f])*\")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\\[(?:(?:(2(5[0-5]|[0-4][0-9])|1[0-9][0-9]|[1-9]?[0-9]))\\.){3}(?:(2(5[0-5]|[0-4][0-9])|1[0-9][0-9]|[1-9]?[0-9])|[a-z0-9-]*[a-z0-9]:(?:[\\x01-\\x08\\x0b\\x0c\\x0e-\\x1f\\x21-\\x5a\\x53-\\x7f]|\\\\[\\x01-\\x09\\x0b\\x0c\\x0e-\\x7f])+)\\])"}]}},"id":"963b5ec2-7fea-4463-957b-abd2119a1f2c","name":"IF2","type":"n8n-nodes-base.if","typeVersion":1,"position":[220,900]},{"parameters":{"method":"POST","url":"=https://api.thinkific.com/api/public/v1/bundles/{{ $node.Webhook.json.body.learning_id }}/enrollments","sendHeaders":true,"headerParameters":{"parameters":[{"name":"X-Auth-API-Key","value":"20c0d3dae7a7bf515967a24ad97f7bc2"},{"name":"X-Auth-Subdomain","value":"hita"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={  \n  \"user_id\": {{ $json[\"items\"][0][\"id\"] }},\n  \"activated_at\": \"{{ $node[\"Now Year\"].json[\"NowYear\"] }}T01:01:00Z\",\n  \"expiry_date\": \"{{ $node[\"Add 1 Year\"].json[\"NextYear\"] }}T01:01:00Z\"\n}","options":{}},"id":"fe91075c-0ed4-4693-be72-801ee0658046","name":"Enroll Bundle2","type":"n8n-nodes-base.httpRequest","typeVersion":4,"position":[1780,1220],"notesInFlow":false,"retryOnFail":true,"continueOnFail":true},{"parameters":{"conditions":{"string":[{}]}},"id":"161622a6-2c2b-4f99-a11e-429a0033c59a","name":"IF3","type":"n8n-nodes-base.if","typeVersion":1,"position":[1580,1200],"continueOnFail":true},{"parameters":{"method":"POST","url":"=https://api.thinkific.com/api/public/v1/users","sendHeaders":true,"headerParameters":{"parameters":[{"name":"X-Auth-API-Key","value":"20c0d3dae7a7bf515967a24ad97f7bc2"},{"name":"X-Auth-Subdomain","value":"hita"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={   \n\t\"first_name\": \"{{ $('Webhook').item.json[\"body\"][\"first_name\"].toUpperCase() }}\",   \n\t\"last_name\": \"{{ $('Webhook').item.json[\"body\"][\"last_name\"].toUpperCase() }}\",   \n\t\"email\": \"{{ $('Webhook').item.json[\"body\"][\"email\"] }}\",   \n\t\"password\": \"{{ $('Webhook').item.json[\"body\"][\"password\"] }}\",    \n\t\"bio\": \"{{ $('Webhook').item.json[\"body\"][\"first_name\"] }} {{ $('Webhook').item.json[\"body\"][\"last_name\"] }}\",   \n\t\"company\": \"TTL\",   \n\t\"headline\": \"Student\", \n\t\"custom_profile_fields\": [     \n\t{       \n\t\t\"value\": \"{{ $('Webhook').item.json[\"body\"][\"phone\"] }}\",       \n\t\t\"custom_profile_field_definition_id\": 67351     \n\t\t},  \n\t\t{       \n\t\t\"value\": \"{{ $('Webhook').item.json[\"body\"][\"messid\"] }}\",       \n\t\t\"custom_profile_field_definition_id\": 67352     \n\t\t\t}   ],  \n\t\"skip_custom_fields_validation\": false,   \n\t\"send_welcome_email\": true\n\t}","options":{}},"id":"b0052bb4-6916-4430-9f0a-05923589eefa","name":"Check da co tk?1","type":"n8n-nodes-base.httpRequest","typeVersion":4,"position":[720,900],"retryOnFail":true,"continueOnFail":true},{"parameters":{"amount":10,"unit":"seconds"},"id":"aefc1a9d-50cd-4b22-aa8d-f44d20372988","name":"Wait","type":"n8n-nodes-base.wait","typeVersion":1,"position":[1260,1120],"webhookId":"ceb5595e-10f2-4343-81c2-ca2bd83ebdde"}],"connections":{"Webhook":{"main":[[{"node":"IF2","type":"main","index":0}]]},"Chua co tk?":{"main":[[{"node":"is Course","type":"main","index":0}],[{"node":"Wait","type":"main","index":0}]]},"Check da co tk?":{"main":[[{"node":"Chua co tk?","type":"main","index":0}]]},"is Course":{"main":[[{"node":"Enroll Course","type":"main","index":0}],[{"node":"is Bundle","type":"main","index":0}]]},"is Bundle":{"main":[[{"node":"Enroll Bundle","type":"main","index":0}]]},"Now Year":{"main":[[{"node":"Add 1 Year","type":"main","index":0}]]},"Add 1 Year":{"main":[[{"node":"Check da co tk?1","type":"main","index":0}]]},"is Course1":{"main":[[{"node":"Enroll Course1","type":"main","index":0}],[{"node":"is Bundle1","type":"main","index":0}]]},"is Bundle1":{"main":[[{"node":"Enroll Bundle1","type":"main","index":0}]]},"New User1":{"main":[[{"node":"IF","type":"main","index":0}]]},"IF1":{"main":[[],[{"node":"is Course1","type":"main","index":0}]]},"IF2":{"main":[[{"node":"Now Year","type":"main","index":0}]]},"Check da co tk?1":{"main":[[{"node":"Check da co tk?","type":"main","index":0}]]},"Wait":{"main":[[{"node":"Check da co tk?1","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{"Webhook":[{"json":{"headers":{"host":"n8.quanchatbot.com","user-agent":"WordPress/6.2.2; https://5ptb.vn","content-length":"138","accept":"*/*","accept-encoding":"deflate, gzip, br","content-type":"application/x-www-form-urlencoded","x-forwarded-for":"103.173.227.161","x-forwarded-host":"n8.quanchatbot.com","x-forwarded-port":"443","x-forwarded-proto":"https","x-forwarded-server":"cc3a1a76fa48","x-real-ip":"103.173.227.161"},"params":{},"query":{},"body":{"first_name":"HV","last_name":"Le Quan Le","email":"quanchatbot@gmail.com","phone":"+84985767138","password":"TG2023@TTL","type":"bundle","learning_id":"114378"}},"pairedItem":{"item":0}}]},"versionId":"c635a7ed-aee0-470c-b8f3-73aa3d90ff04","triggerCount":1,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-07-19T04:16:12.501Z","updatedAt":"2023-07-19T04:16:12.501Z","id":"194","name":"Get Key 5PTB Mon","active":false,"nodes":[{"parameters":{"url":"=https://api.quanchatbot.com/5ptb/get-code-mon.php?class={{ $json.body.class }}","options":{"response":{"response":{"responseFormat":"json"}}}},"id":"d1655ede-d3ce-49dc-a007-f3db6be8176e","name":"Get Active Code","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[-240,940],"retryOnFail":true},{"parameters":{"httpMethod":"POST","path":"get-key-5ptb","options":{}},"id":"5ba78794-6f5c-4089-8321-4059e3cc8ac0","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[-460,940],"webhookId":"3a0d455b-cc09-4642-b3e7-6b93192ccf00","alwaysOutputData":false},{"parameters":{"conditions":{"string":[{"value1":"={{ $json.activeCode }}","operation":"isNotEmpty"}]}},"id":"66b41de0-6e49-4992-8559-f051d4f26c59","name":"IF Have Code","type":"n8n-nodes-base.if","typeVersion":1,"position":[-20,940],"continueOnFail":true},{"parameters":{"fromEmail":"cskh5@hitacamp.vn","toEmail":"={{ $node.Webhook.json.body.order_email }}","subject":"=G·ª≠i b·∫°n {{ $node.Webhook.json.body.full_name }} m√£ k√≠ch ho·∫°t 5PTB m√¥n {{ $node['Get Active Code'].json.productName }}","text":"=Ch√†o b·∫°n {{ $node.Webhook.json.body.full_name }},\n\nC·∫£m ∆°n b·∫°n ƒë√£ ho√†n th√†nh ƒë∆°n h√†ng HT{{ $node.Webhook.json.body.order_id }}.\nG·ª≠i b·∫°n m√£ code k√≠ch ho·∫°t m√¥n {{ $node['Get Active Code'].json.productName }} tr√™n ·ª©ng d·ª•ng 5 PH√öT THU·ªòC B√ÄI\n\n- M√£ k√≠ch ho·∫°t:  {{ $node['Get Active Code'].json.activeCode }}\n----------------\n- H∆∞·ªõng d·∫´n c√†i ƒë·∫∑t ·ª©ng d·ª•ng 5PTB:\n- H∆∞·ªõng d·∫´n d√πng m√£ k√≠ch ho·∫°t m√¥n h·ªçc: \n- H∆∞·ªõng d·∫´n c√°c t√≠nh nƒÉng 5PTB:","options":{"replyTo":"cskh@hitacamp.vn"}},"id":"befadc35-6d93-489a-aacd-27dcd74a4661","name":"Send Email","type":"n8n-nodes-base.emailSend","typeVersion":2,"position":[160,720],"credentials":{"smtp":{"id":"10","name":"SMTP cskh5@hitacamp.vn"}},"disabled":true},{"parameters":{"method":"POST","url":"https://5ptb.vn/wp-json/autonami/v1/webhook/?bwfan_autonami_webhook_id=23&bwfan_autonami_webhook_key=f167acba81d3c856239ed85d0cc2ac62","sendBody":true,"bodyParameters":{"parameters":[{"name":"monhoc","value":"={{ $json.productName }}"},{"name":"makichoat","value":"={{ $json.activeCode }}"},{"name":"order_id","value":"={{ $node.Webhook.json.body.order_id }}"},{"name":"order_key","value":"={{ $node.Webhook.json.body.order_key }}"},{"name":"full_name","value":"={{ $node.Webhook.json.body.full_name }}"},{"name":"order_email","value":"={{ $node.Webhook.json.body.order_email }}"},{"name":"order_phone","value":"={{ $node.Webhook.json.body.order_phone }}"}]},"options":{}},"id":"6196801d-c54f-44ba-9e28-431201c6c2cd","name":"Gui mail FunnelKit","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[280,860],"retryOnFail":true,"continueOnFail":true},{"parameters":{"operation":"append","documentId":{"__rl":true,"value":"1ZyK5MRh2ZcLv1XABtnzSGePopbzAwGvxOlG6VuUOXf4","mode":"list","cachedResultName":"Log - Active Key 5PTB 99k","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1ZyK5MRh2ZcLv1XABtnzSGePopbzAwGvxOlG6VuUOXf4/edit?usp=drivesdk"},"sheetName":{"__rl":true,"value":"gid=0","mode":"list","cachedResultName":"Trang t√≠nh1","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1ZyK5MRh2ZcLv1XABtnzSGePopbzAwGvxOlG6VuUOXf4/edit#gid=0"},"fieldsUi":{"fieldValues":[{"fieldId":"Date","fieldValue":"={{ $now.setZone('Asia/Ho_chi_minh').toFormat('yyyy-MM-dd HH:mm:ss') }}"},{"fieldId":"Order ID","fieldValue":"={{ $node.Webhook.json.body.order_id }}"},{"fieldId":"Code 5PTB","fieldValue":"={{ $json.activeCode }}"},{"fieldId":"Name","fieldValue":"={{ $node.Webhook.json.body.full_name }}"},{"fieldId":"Phone","fieldValue":"={{ $node.Webhook.json.body.order_phone }}"},{"fieldId":"Email","fieldValue":"={{ $node.Webhook.json.body.order_email }}"},{"fieldId":"MessID","fieldValue":"={{ $node.Webhook.json.body.messid }}"}]},"options":{}},"id":"e0c70a43-3c14-44bb-a35f-0a1666b5b8a2","name":"Google Sheets","type":"n8n-nodes-base.googleSheets","typeVersion":3,"position":[360,1040],"credentials":{"googleSheetsOAuth2Api":{"id":"2","name":"Google Sheets lehongquan@gmail.com"}}},{"parameters":{"method":"POST","url":"https://chatapi.viber.com/pa/post","sendBody":true,"specifyBody":"json","jsonBody":"={\n\"auth_token\":\"5115ba0980351cde-9d055a8983e4a79-50efec3164ee05c\",\n\"from\": \"v9Yd/w+PRP5A22ZgNN1wqQ==\",\n\"type\": \"text\",\n\"text\": \"‚úÖC√≥ m√£ code 5PTB m√¥n {{ $json[\"productName\"] }} *{{ $json.activeCode }}*:\\n- Order ID: *{{ $node.Webhook.json.body.order_id }}*\\n- H·ªç t√™n: {{ $node.Webhook.json.body.full_name }}\\n- ƒêi·ªán tho·∫°i: {{ $node.Webhook.json.body.order_phone }}\\n- Email: {{ $node.Webhook.json.body.order_email }}\\n- Th·ªùi gian: {{ $now.setZone('Asia/Ho_chi_minh').toFormat('yyyy-MM-dd HH:mm:ss') }}\\n------------------\\n- Mess ID: {{ $node.Webhook.json.body.messid }}\\n-Chi ti·∫øt ƒë∆°n h√†ng theo Phone: https://hitacamp.vn/chi-tiet-don-hang-theo-dien-thoai/?phone={{ $node.Webhook.json.body.order_phone }}\\n- Chi ti·∫øt ƒë∆°n h√†ng theo Email: https://hitacamp.vn/chi-tiet-don-hang-theo-email/?mail={{ $node.Webhook.json.body.order_email }}\\n- SmaxChat: https://smax.chat/pages/267860490322486/conversation?tid=th_{{ $node.Webhook.json.body.messid }}\"\n}","options":{}},"id":"cb9affb7-1f3f-4970-a873-886b92c98339","name":"HTTP Request","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[240,1200],"retryOnFail":true,"continueOnFail":true}],"connections":{"Get Active Code":{"main":[[{"node":"IF Have Code","type":"main","index":0}]]},"Webhook":{"main":[[{"node":"Get Active Code","type":"main","index":0}]]},"IF Have Code":{"main":[[{"node":"Send Email","type":"main","index":0},{"node":"Gui mail FunnelKit","type":"main","index":0},{"node":"Google Sheets","type":"main","index":0},{"node":"HTTP Request","type":"main","index":0}],[{"node":"Get Active Code","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{"Webhook":[{"json":{"headers":{"host":"n8.quanchatbot.com","user-agent":"axios/0.19.2","content-length":"170","accept":"application/json, text/plain, */*","content-type":"application/x-www-form-urlencoded","x-forwarded-for":"34.87.3.106","x-forwarded-host":"n8.quanchatbot.com","x-forwarded-port":"443","x-forwarded-proto":"https","x-forwarded-server":"cc3a1a76fa48","x-real-ip":"34.87.3.106","accept-encoding":"gzip"},"params":{},"query":{},"body":{"order_id":"21164","order_key":"wc_order_QrN3qBlWc2s9C","full_name":"Qu√¢n Test","order_email":"lehongquan@gmail.com","order_phone":"0985767138","messid":"3385630971486789","class":"4|142"}},"pairedItem":{"item":0}}],"Get Active Code":[{"json":{"orderCode":"HD2305-0126","productName":"To√°n l·ªõp 1","activeCode":"776DBD28110","serialNumber":"W000007815"},"pairedItem":{"item":0}}],"Google Sheets":[{"json":{"orderCode":"HD2305-0126","productName":"To√°n l·ªõp 1","activeCode":"776DBD28110","serialNumber":"W000007815"},"pairedItem":{"item":0}}]},"versionId":"36df1247-6221-4d51-afbc-ee8ff6a9952c","triggerCount":0,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-07-19T04:16:39.906Z","updatedAt":"2023-07-19T04:20:04.000Z","id":"195","name":"Tao Customer tu Coupon CGGQVƒêCT.0723","active":false,"nodes":[{"parameters":{"event":"order.updated"},"id":"03c138a0-d1b7-4578-971c-d4fd0f6a827c","name":"WooCommerce Trigger","type":"n8n-nodes-base.wooCommerceTrigger","typeVersion":1,"position":[-260,620],"webhookId":"5a2d9fab-bf42-400c-a2fb-1befc1a7bb76","credentials":{"wooCommerceApi":{"id":"81","name":"HitaCamp.vn"}}},{"parameters":{"amount":15,"unit":"minutes"},"id":"ce8998dd-aafa-459f-8850-6e599408c586","name":"Wait","type":"n8n-nodes-base.wait","typeVersion":1,"position":[300,240],"webhookId":"7cf31eb5-39f7-4bad-8f99-b49dc5c0d74e","disabled":true},{"parameters":{"conditions":{"string":[{"value1":"={{ $json.data.listData[0].code }}","operation":"isEmpty"}]}},"id":"70e3ea1d-bbcc-45f6-89a2-9dbae926e795","name":"IF","type":"n8n-nodes-base.if","typeVersion":1,"position":[320,400],"disabled":true},{"parameters":{"url":"=https://api.tamtriluc.com/api/vi-VN/Customer/GetAllByPhone?phone={{ $json.coupon_lines[0].code.slice(-9) }}","authentication":"genericCredentialType","genericAuthType":"httpHeaderAuth","options":{}},"id":"28c47bd5-f4ff-4a6b-864e-f4e89064ae4a","name":"API GetByPhone","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[-100,300],"credentials":{"httpHeaderAuth":{"id":"19","name":"api.tamtriluc.com"}},"disabled":true},{"parameters":{"url":"=https://api.tamtriluc.com/api/vi-VN/Customer/GetAllByPhone?phone={{ $json.billing.phone }}","authentication":"genericCredentialType","genericAuthType":"httpHeaderAuth","options":{}},"id":"6a227476-bc81-4a29-90b3-c1adef917ac5","name":"HTTP Request","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[80,320],"credentials":{"httpHeaderAuth":{"id":"19","name":"api.tamtriluc.com"}},"disabled":true},{"parameters":{"conditions":{"string":[{"value1":"={{ $json.coupon_lines[0].code.slice(0,3) }}","operation":"contains","value2":"bni"},{"value1":"={{ $json.coupon_lines[0].code.slice(0,3) }}","operation":"contains","value2":"vit"},{"value1":"={{ $json.coupon_lines[0].code.slice(0,3) }}","operation":"contains","value2":"nkn"}]},"combineOperation":"any"},"id":"073ff508-33d9-4410-8ca9-48ca4c466b8d","name":"IF Coupon BNI","type":"n8n-nodes-base.if","typeVersion":1,"position":[-20,560]},{"parameters":{"conditions":{"string":[{"value1":"={{ $json.coupon_lines[0].code.slice(0,2) }}","operation":"contains","value2":"cg"}]}},"id":"f1063735-db69-4125-bf18-74d86fe03ffb","name":"IF Coupn CG","type":"n8n-nodes-base.if","typeVersion":1,"position":[-20,760]},{"parameters":{"method":"POST","url":"=https://api.quanchatbot.com/tamtriluc/add-customer.php","sendBody":true,"contentType":"form-urlencoded","bodyParameters":{"parameters":[{"name":"fullName","value":"={{ $json[\"billing\"][\"first_name\"] }}"},{"name":"phone","value":"={{  $json[\"billing\"][\"phone\"]}}"},{"name":"email","value":"={{ $json[\"billing\"][\"email\"]}}"},{"name":"ref_Code","value":"KHT2457872"}]},"options":{}},"id":"1f3bebba-c690-4ba7-92e9-479e119e93c1","name":"HTTP Request2","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[260,580]},{"parameters":{"url":"=https://hitacamp.vn/wp-json/woo_smaxbot/get_order?secret=6688&order_id={{ $('WooCommerce Trigger').first().json[\"id\"] }}","options":{}},"id":"253cca9e-591d-43db-bea9-2e28cd8dfc5a","name":"HTTP Request4","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[880,520],"continueOnFail":true},{"parameters":{"method":"POST","url":"=https://api.quanchatbot.com/tamtriluc/add-customer.php","sendBody":true,"contentType":"form-urlencoded","bodyParameters":{"parameters":[{"name":"fullName","value":"={{ $('IF Coupn CG').item.json[\"billing\"][\"first_name\"] }}"},{"name":"phone","value":"={{  $('IF Coupn CG').item.json[\"billing\"][\"phone\"]}}"},{"name":"email","value":"={{ $('IF Coupn CG').item.json[\"billing\"][\"email\"]}}"},{"name":"ref_Code","value":"={{ $json.row.code }}"}]},"options":{}},"id":"be0c4713-7985-41f8-a410-a1977d609c0d","name":"HTTP Request5","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[660,740],"continueOnFail":true},{"parameters":{"method":"POST","url":"https://public.botplus.io/table/64af8d807c96a5179c681236?secret=1234","sendBody":true,"specifyBody":"json","jsonBody":"={\n  \"findRow\": {\n    \"coupon\": \"{{ $('WooCommerce Trigger').first().json[\"coupon_lines\"][0][\"code\"].toUpperCase() }}\\r\"\n  },\n  \"response\": true\n}","options":{}},"id":"90793b3a-1522-48c5-8014-140a2377f45c","name":"HTTP Request1","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[220,760],"continueOnFail":true},{"parameters":{"method":"POST","url":"https://public.botplus.io/table/64af8d807c96a5179c681236?secret=1234","sendBody":true,"specifyBody":"json","jsonBody":"={\n  \"findRow\": {\n    \"coupon\": \"{{ $('WooCommerce Trigger').first().json[\"coupon_lines\"][0][\"code\"].toUpperCase() }}\"\n  },\n  \"response\": true\n}","options":{}},"id":"b06a601a-1946-4323-99db-f896cdb238d5","name":"HTTP Request3","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[220,920],"continueOnFail":true},{"parameters":{"conditions":{"string":[{"value1":"={{ $json.row.code }}","operation":"isNotEmpty"}]}},"id":"7deb69d6-7405-4d12-9b92-ce15e050819f","name":"IF1","type":"n8n-nodes-base.if","typeVersion":1,"position":[400,920]},{"parameters":{"conditions":{"string":[{"value1":"={{ $json.row.code }}","operation":"isNotEmpty"}]}},"id":"1276c229-d9dc-4b60-b035-fc55ae622c5d","name":"IF2","type":"n8n-nodes-base.if","typeVersion":1,"position":[400,760]}],"connections":{"WooCommerce Trigger":{"main":[[{"node":"IF Coupon BNI","type":"main","index":0},{"node":"IF Coupn CG","type":"main","index":0}]]},"HTTP Request":{"main":[[{"node":"IF","type":"main","index":0}]]},"IF Coupn CG":{"main":[[{"node":"HTTP Request1","type":"main","index":0},{"node":"HTTP Request3","type":"main","index":0}]]},"IF Coupon BNI":{"main":[[{"node":"HTTP Request2","type":"main","index":0}]]},"HTTP Request2":{"main":[[{"node":"HTTP Request4","type":"main","index":0}]]},"HTTP Request5":{"main":[[{"node":"HTTP Request4","type":"main","index":0}]]},"HTTP Request1":{"main":[[{"node":"IF2","type":"main","index":0}]]},"HTTP Request3":{"main":[[{"node":"IF1","type":"main","index":0}]]},"IF1":{"main":[[{"node":"HTTP Request5","type":"main","index":0}]]},"IF2":{"main":[[{"node":"HTTP Request5","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{"WooCommerce Trigger":[{"json":{"id":24613,"parent_id":0,"status":"completed","currency":"VND","version":"7.8.0","prices_include_tax":false,"date_created":"2023-07-13T12:03:47","date_modified":"2023-07-13T12:03:57","discount_total":"99000","discount_tax":"0","shipping_total":"0","shipping_tax":"0","cart_tax":"0","total":"0","total_tax":"0","customer_id":33,"order_key":"wc_order_R9Qi4JDP2OCg4","billing":{"first_name":"X·ª≠ Test","last_name":"","company":"","address_1":"","address_2":"","city":"","state":"","postcode":"","country":"VN","email":"nguyenngocxu594@gmail.com","phone":"0909477729"},"shipping":{"first_name":"","last_name":"","company":"","address_1":"","address_2":"","city":"","state":"","postcode":"","country":"VN","phone":"0909477729"},"payment_method":"","payment_method_title":"","transaction_id":"","customer_ip_address":"14.241.253.8","customer_user_agent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.0.0 Safari/537.36","created_via":"checkout","customer_note":"","date_completed":"2023-07-13T12:03:57","date_paid":"2023-07-13T12:03:48","cart_hash":"f31d8e780d9faa3be1aec711756b2208","number":"24613","meta_data":[{"id":753490,"key":"is_vat_exempt","value":"no"},{"id":753491,"key":"marketing_status","value":"1"},{"id":753493,"key":"wvw_currency_rate","value":"1"},{"id":753494,"key":"wvw_price_format","value":{"ex_tax_label":false,"currency":"VND","decimal_separator":",","thousand_separator":".","decimals":0,"price_format":"%2$s&nbsp;%1$s"}},{"id":753497,"key":"_woofunnel_cid","value":"36"},{"id":753498,"key":"_wfacp_post_id","value":"24328"},{"id":753499,"key":"_wfacp_source","value":"https://hitacamp.vn/dang-ky/chuyen-gia-giai-quyet-van-de-con-tre/"},{"id":753500,"key":"_wfacp_timezone","value":"Asia/Saigon"},{"id":753501,"key":"messid","value":"4501448519887732"},{"id":753502,"key":"nguon","value":"LDP"},{"id":753503,"key":"_bwfan_order_total_base","value":"0"},{"id":753507,"key":"_woofunnel_custid","value":"36"},{"id":753508,"key":"order_key","value":"wc_order_R9Qi4JDP2OCg4"},{"id":753509,"key":"ref_id","value":"R_"},{"id":753512,"key":"lws_woovip_pro_membership_done","value":"2023-07-13T05:03:58+00:00"},{"id":753513,"key":"lws_woovirtualwallet_add_amount_done","value":"2023-07-13T05:03:58+00:00"},{"id":753514,"key":"lws_woovirtualwallet_add_gems_done","value":"2023-07-13T05:03:58+00:00"},{"id":753515,"key":"_wfob_stats_ids","value":[]},{"id":753516,"key":"_wfocu_thankyou_visited","value":"yes"}],"line_items":[{"id":12549,"name":"Chuy√™n gia gi·∫£i quy·∫øt v·∫•n ƒë·ªÅ con tr·∫ª","product_id":24336,"variation_id":0,"quantity":1,"tax_class":"","subtotal":"99000","subtotal_tax":"0","total":"0","total_tax":"0","taxes":[],"meta_data":[{"id":108808,"key":"_wfacp_product","value":"1","display_key":"_wfacp_product","display_value":"1"},{"id":108809,"key":"_wfacp_product_key","value":"wfacp_64acda0ede98d","display_key":"_wfacp_product_key","display_value":"wfacp_64acda0ede98d"},{"id":108810,"key":"_wfacp_options","value":{"title":"Chuy√™n gia gi·∫£i quy·∫øt v·∫•n ƒë·ªÅ con tr·∫ª","discount_type":"fixed_discount_reg","discount_amount":"87000","discount_price":"0","quantity":1,"type":"simple","id":"24336","parent_product_id":"0","stock":"true","is_sold_individually":"false","is_default":true,"org_quantity":1,"you_save_text":"","whats_included":"","enable_delete":"false","old_title":"Chuy√™n gia gi·∫£i quy·∫øt v·∫•n ƒë·ªÅ con tr·∫ª","product_id":"24336","whats_include_heading":"Chuy√™n gia gi·∫£i quy·∫øt v·∫•n ƒë·ªÅ con tr·∫ª","item_key":"wfacp_64acda0ede98d"},"display_key":"_wfacp_options","display_value":{"title":"Chuy√™n gia gi·∫£i quy·∫øt v·∫•n ƒë·ªÅ con tr·∫ª","discount_type":"fixed_discount_reg","discount_amount":"87000","discount_price":"0","quantity":1,"type":"simple","id":"24336","parent_product_id":"0","stock":"true","is_sold_individually":"false","is_default":true,"org_quantity":1,"you_save_text":"","whats_included":"","enable_delete":"false","old_title":"Chuy√™n gia gi·∫£i quy·∫øt v·∫•n ƒë·ªÅ con tr·∫ª","product_id":"24336","whats_include_heading":"Chuy√™n gia gi·∫£i quy·∫øt v·∫•n ƒë·ªÅ con tr·∫ª","item_key":"wfacp_64acda0ede98d"}},{"id":108811,"key":"_wfacp_item_discount","value":{"VND":{"regular_price":"186000","sale_price":99000}},"display_key":"_wfacp_item_discount","display_value":{"VND":{"regular_price":"186000","sale_price":99000}}},{"id":108812,"key":"_lws_wvw_extra_mode","value":"wallet","display_key":"_lws_wvw_extra_mode","display_value":"wallet"}],"sku":"","price":0,"image":{"id":"24422","src":"https://hitacamp.vn/wp-content/uploads/2023/07/NPP_HUYENGIA_KV-1.jpeg"},"parent_name":null}],"tax_lines":[],"shipping_lines":[],"fee_lines":[],"coupon_lines":[{"id":12550,"code":"cg985767138","discount":"99000","discount_tax":"0","meta_data":[{"id":108815,"key":"coupon_data","value":{"id":24610,"code":"cg985767138","amount":"100","status":"publish","date_created":{"date":"2023-07-13 04:56:48.000000","timezone_type":1,"timezone":"+00:00"},"date_modified":{"date":"2023-07-13 04:56:48.000000","timezone_type":1,"timezone":"+00:00"},"date_expires":null,"discount_type":"percent","description":"","usage_count":2,"individual_use":true,"product_ids":[24336],"excluded_product_ids":[],"usage_limit":20,"usage_limit_per_user":0,"limit_usage_to_x_items":1,"free_shipping":false,"product_categories":[],"excluded_product_categories":[],"exclude_sale_items":false,"minimum_amount":"","maximum_amount":"","email_restrictions":[],"virtual":false,"meta_data":[{"id":753311,"key":"sc_coupon_validity","value":""},{"id":753312,"key":"validity_suffix","value":"days"},{"id":753313,"key":"auto_generate_coupon","value":""},{"id":753314,"key":"coupon_title_prefix","value":""},{"id":753315,"key":"coupon_title_suffix","value":""},{"id":753316,"key":"is_pick_price_of_product","value":"no"},{"id":753317,"key":"sc_disable_email_restriction","value":"no"},{"id":753318,"key":"sc_is_visible_storewide","value":"no"},{"id":753319,"key":"sc_restrict_to_new_user","value":""},{"id":753320,"key":"wc_sc_max_discount","value":""},{"id":753321,"key":"wc_sc_auto_apply_coupon","value":""},{"id":753322,"key":"wc_sc_add_product_details","value":""},{"id":753323,"key":"sa_cbl_locations_lookup_in","value":{"address":"billing"}},{"id":753324,"key":"sa_cbl_billing_locations","value":[]},{"id":753325,"key":"sa_cbl_shipping_locations","value":[]},{"id":753326,"key":"wc_sc_payment_method_ids","value":[]},{"id":753327,"key":"wc_sc_shipping_method_ids","value":[]},{"id":753328,"key":"wc_sc_user_role_ids","value":[]},{"id":753329,"key":"wc_sc_exclude_user_role_ids","value":[]},{"id":753330,"key":"wc_sc_product_attribute_ids","value":""},{"id":753331,"key":"wc_sc_exclude_product_attribute_ids","value":""},{"id":753332,"key":"wc_sc_excluded_customer_email","value":[]},{"id":753333,"key":"wc_coupon_message","value":""},{"id":753334,"key":"wc_email_message","value":"no"},{"id":753335,"key":"wc_sc_expiry_time","value":""},{"id":753460,"key":"_coupon_held_1689228227_HYCCP4","value":""}]},"display_key":"coupon_data","display_value":{"id":24610,"code":"cg985767138","amount":"100","status":"publish","date_created":{"date":"2023-07-13 04:56:48.000000","timezone_type":1,"timezone":"+00:00"},"date_modified":{"date":"2023-07-13 04:56:48.000000","timezone_type":1,"timezone":"+00:00"},"date_expires":null,"discount_type":"percent","description":"","usage_count":2,"individual_use":true,"product_ids":[24336],"excluded_product_ids":[],"usage_limit":20,"usage_limit_per_user":0,"limit_usage_to_x_items":1,"free_shipping":false,"product_categories":[],"excluded_product_categories":[],"exclude_sale_items":false,"minimum_amount":"","maximum_amount":"","email_restrictions":[],"virtual":false,"meta_data":[{"id":753311,"key":"sc_coupon_validity","value":""},{"id":753312,"key":"validity_suffix","value":"days"},{"id":753313,"key":"auto_generate_coupon","value":""},{"id":753314,"key":"coupon_title_prefix","value":""},{"id":753315,"key":"coupon_title_suffix","value":""},{"id":753316,"key":"is_pick_price_of_product","value":"no"},{"id":753317,"key":"sc_disable_email_restriction","value":"no"},{"id":753318,"key":"sc_is_visible_storewide","value":"no"},{"id":753319,"key":"sc_restrict_to_new_user","value":""},{"id":753320,"key":"wc_sc_max_discount","value":""},{"id":753321,"key":"wc_sc_auto_apply_coupon","value":""},{"id":753322,"key":"wc_sc_add_product_details","value":""},{"id":753323,"key":"sa_cbl_locations_lookup_in","value":{"address":"billing"}},{"id":753324,"key":"sa_cbl_billing_locations","value":[]},{"id":753325,"key":"sa_cbl_shipping_locations","value":[]},{"id":753326,"key":"wc_sc_payment_method_ids","value":[]},{"id":753327,"key":"wc_sc_shipping_method_ids","value":[]},{"id":753328,"key":"wc_sc_user_role_ids","value":[]},{"id":753329,"key":"wc_sc_exclude_user_role_ids","value":[]},{"id":753330,"key":"wc_sc_product_attribute_ids","value":""},{"id":753331,"key":"wc_sc_exclude_product_attribute_ids","value":""},{"id":753332,"key":"wc_sc_excluded_customer_email","value":[]},{"id":753333,"key":"wc_coupon_message","value":""},{"id":753334,"key":"wc_email_message","value":"no"},{"id":753335,"key":"wc_sc_expiry_time","value":""},{"id":753460,"key":"_coupon_held_1689228227_HYCCP4","value":""}]}}]}],"refunds":[],"payment_url":"https://hitacamp.vn/checkout/order-pay/24613/?pay_for_order=true&key=wc_order_R9Qi4JDP2OCg4","is_editable":false,"needs_payment":false,"needs_processing":true,"date_created_gmt":"2023-07-13T05:03:47","date_modified_gmt":"2023-07-13T05:03:57","date_completed_gmt":"2023-07-13T05:03:57","date_paid_gmt":"2023-07-13T05:03:48","store_credit_used":0,"currency_symbol":"‚Ç´","_links":{"self":[{"href":"https://hitacamp.vn/wp-json/wc/v3/orders/24613"}],"collection":[{"href":"https://hitacamp.vn/wp-json/wc/v3/orders"}],"customer":[{"href":"https://hitacamp.vn/wp-json/wc/v3/customers/33"}]}},"pairedItem":{"item":0}}],"HTTP Request3":[{"json":{"version":"v2","set_attributes":{"coupon":"CG985767138","name":"L√™ H·ªìng Qu√¢n","phone":"0985767138","mail":"lehongquan@gmail.com","code":"KHT2687302"},"row":{"code":"KHT2687302","mail":"lehongquan@gmail.com","name":"L√™ H·ªìng Qu√¢n","phone":"0985767138","coupon":"CG985767138","rowId":588}},"pairedItem":{"item":0}}]},"versionId":"f4be3026-ccdc-45ea-a9aa-69551800dd18","triggerCount":0,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-07-19T04:20:22.166Z","updatedAt":"2023-07-19T04:20:22.166Z","id":"196","name":"Woo Thinkific","active":false,"nodes":[{"parameters":{"event":"order.updated"},"id":"4f11ecba-4ae7-430a-a542-218034a5e9ea","name":"WooCommerce Trigger","type":"n8n-nodes-base.wooCommerceTrigger","typeVersion":1,"position":[-780,640],"webhookId":"198a1f16-18f4-4a81-b65e-05c0f9e70db8","alwaysOutputData":false,"credentials":{"wooCommerceApi":{"id":"81","name":"HitaCamp.vn"}}},{"parameters":{"conditions":{"string":[{"value1":"={{ $json.status }}","value2":"completed"}]}},"id":"a8d56d8d-9a81-4432-92a2-e3ec4d8216e1","name":"IF","type":"n8n-nodes-base.if","typeVersion":1,"position":[-560,640]},{"parameters":{"url":"=https://hitacamp.vn/wp-json/woo_smaxbot/get_order?secret=6688&order_id={{ $json.id }}","options":{}},"id":"c21270ab-6598-4d6b-9f21-f845ab95de9a","name":"HTTP Request","type":"n8n-nodes-base.httpRequest","typeVersion":4,"position":[-360,640],"retryOnFail":true,"continueOnFail":true},{"parameters":{"fieldToSplitOut":"set_attributes.item_array","include":"selectedOtherFields","fieldsToInclude":{"fields":[{"fieldName":"set_attributes.first_name"},{"fieldName":"set_attributes.order_email"},{"fieldName":"set_attributes.order_phone"},{"fieldName":"set_attributes.messid"},{"fieldName":"set_attributes.order_id"},{"fieldName":"set_attributes.order_key"}]},"options":{}},"id":"f1a9ef0a-6a02-4335-bea0-f8d7bb96dc80","name":"Item Lists","type":"n8n-nodes-base.itemLists","typeVersion":2,"position":[-160,640]},{"parameters":{"method":"POST","url":"https://n8.quanchatbot.com/webhook/thinkific","sendBody":true,"specifyBody":"json","jsonBody":"={\n  \"first_name\": \"HV\",\n  \"last_name\": \"{{ $node[\"Item Lists\"].json[\"set_attributes.first_name\"] }}\",\n  \"email\": \"{{ $node[\"Item Lists\"].json[\"set_attributes.order_email\"] }}\",\n\"phone\": \"{{ $node[\"Item Lists\"].json[\"set_attributes.order_phone\"] }}\",\n\"messid\": \"{{ $node[\"Item Lists\"].json[\"set_attributes.messid\"] }}\",\n  \"password\": \"TG2023@TTL\",\n\"type\":\"{{ $json[\"set_attributes\"][\"learning_type\"] }}\",\n\"learning_id\":{{ $json[\"set_attributes\"][\"learning_id\"] }}\n}\n","options":{}},"id":"43b3c9a3-a94f-4885-825a-843af766e55c","name":"HTTP Request1","type":"n8n-nodes-base.httpRequest","typeVersion":4,"position":[740,640],"continueOnFail":true},{"parameters":{"url":"=https://hitacamp.vn/wp-json/woo_smaxbot/info_product?secret=6688&product_id={{ $json['set_attributes.item_array'] }}","options":{}},"id":"87aa0745-63fa-49b5-978f-b2d05ebb7ac8","name":"HTTP Request2","type":"n8n-nodes-base.httpRequest","typeVersion":4,"position":[40,640],"retryOnFail":true,"continueOnFail":true},{"parameters":{"conditions":{"string":[{"value1":"={{ $json.set_attributes.learning_type }}","operation":"isNotEmpty"},{"value1":"={{ $json.set_attributes.learning_id }}","operation":"isNotEmpty"}]}},"id":"785cfba5-8d2d-4f06-9039-0bb5f229cb1a","name":"IF1","type":"n8n-nodes-base.if","typeVersion":1,"position":[220,640]},{"parameters":{"operation":"appendOrUpdate","documentId":{"__rl":true,"value":"12460VAZX-Qpt_agGBn7J0EVpsW050Mp7FN2aFZlA8Vc","mode":"list","cachedResultName":"Data ƒê∆°n h√†ng Hitacamp.vn","cachedResultUrl":"https://docs.google.com/spreadsheets/d/12460VAZX-Qpt_agGBn7J0EVpsW050Mp7FN2aFZlA8Vc/edit?usp=drivesdk"},"sheetName":{"__rl":true,"value":"gid=0","mode":"list","cachedResultName":"Trang t√≠nh1","cachedResultUrl":"https://docs.google.com/spreadsheets/d/12460VAZX-Qpt_agGBn7J0EVpsW050Mp7FN2aFZlA8Vc/edit#gid=0"},"columnToMatchOn":"OrderID","valueToMatchOn":"={{ $json.set_attributes.order_id }}","fieldsUi":{"values":[{"column":"Date","fieldValue":"={{ $node['WooCommerce Trigger'].json.date_created }}"},{"column":"Name","fieldValue":"={{ $json.set_attributes.first_name }}  {{ $json.set_attributes.last_name }}"},{"column":"Phone","fieldValue":"={{ $json.set_attributes.order_phone }}"},{"column":"Email","fieldValue":"={{ $json.set_attributes.order_email }}"},{"column":"OrderKey","fieldValue":"={{ $json.set_attributes.order_key }}"},{"column":"Total","fieldValue":"={{ $json.set_attributes.order_total }}"},{"column":"Status","fieldValue":"={{ $json.set_attributes.order_status }}"},{"column":"Item","fieldValue":"={{ $json.set_attributes.item_id }}"},{"column":"MessID","fieldValue":"={{ $json.set_attributes.messid }}"},{"column":"RefID","fieldValue":"={{ $json.set_attributes.ref_id }}"},{"column":"SmaxChat","fieldValue":"=https://smax.chat/pages/267860490322486/conversation?tid=th_{{ $json.set_attributes.messid }}"},{"column":"OrderByPhone","fieldValue":"=https://hitacamp.vn/chi-tiet-don-hang-theo-dien-thoai/?phone={{ $json.set_attributes.order_phone }}"},{"column":"OrderByEmail","fieldValue":"=https://hitacamp.vn/chi-tiet-don-hang-theo-email/?mail={{ $json.set_attributes.order_email }}"},{"column":"OrderByMessID","fieldValue":"=https://hitacamp.vn/lich-su-don-hang/?messid={{ $json.set_attributes.messid }}"},{"column":"Nguon","fieldValue":"={{ $json.set_attributes.nguon }}"},{"column":"Note","fieldValue":"={{ $json.set_attributes.note }}"},{"column":"Coupon","fieldValue":"={{ $json.set_attributes.order_total_discount }}"}]},"options":{}},"id":"d35e46cb-7319-4d12-8e34-2b1a6a7f0543","name":"Google Sheets","type":"n8n-nodes-base.googleSheets","typeVersion":3,"position":[-340,820],"notesInFlow":false,"credentials":{"googleSheetsOAuth2Api":{"id":"2","name":"Google Sheets lehongquan@gmail.com"}},"continueOnFail":true},{"parameters":{"url":"=https://hitacamp.vn/wp-json/woo_smaxbot/get_order?secret=6688&order_id={{ $json.id }}","options":{}},"id":"2c18881c-e4f2-41d0-b29f-1ed1d4d0c595","name":"HTTP Request3","type":"n8n-nodes-base.httpRequest","typeVersion":4,"position":[-560,820],"retryOnFail":true,"continueOnFail":true},{"parameters":{"url":"=https://api.quanchatbot.com/tamtriluc/add-customer.php?fullName={{ $node[\"HTTP Request3\"].json[\"set_attributes\"][\"first_name\"] }}&phone={{ $node[\"HTTP Request3\"].json[\"set_attributes\"][\"order_phone\"] }}&email={{ $node[\"HTTP Request3\"].json[\"set_attributes\"][\"order_email\"] }}&ref_Code=KHT2687302","options":{}},"id":"35f2837a-bc13-427d-a7e7-471dcb0e0694","name":"HTTP Request4","type":"n8n-nodes-base.httpRequest","typeVersion":4,"position":[160,860],"continueOnFail":true},{"parameters":{"conditions":{"string":[{"value1":"={{ $json.set_attributes.nguon }}","operation":"isEmpty"}]}},"id":"416683c9-99af-49d1-b85d-93151734c1e8","name":"IF2","type":"n8n-nodes-base.if","typeVersion":1,"position":[-340,1000]},{"parameters":{"url":"=https://api.quanchatbot.com/tamtriluc/add-customer.php?fullName={{ $node[\"HTTP Request3\"].json[\"set_attributes\"][\"first_name\"] }}&phone={{ $node[\"HTTP Request3\"].json[\"set_attributes\"][\"order_phone\"] }}&email={{ $node[\"HTTP Request3\"].json[\"set_attributes\"][\"order_email\"] }}&ref_Code={{ $node[\"HTTP Request3\"].json[\"set_attributes\"][\"nguon\"] }}","options":{}},"id":"a9b2febd-28c4-4895-90ea-baf979b00a73","name":"HTTP Request5","type":"n8n-nodes-base.httpRequest","typeVersion":4,"position":[140,1060],"continueOnFail":true},{"parameters":{"conditions":{"string":[{"value1":"={{ $node['HTTP Request3'].json.set_attributes.nguon }}","operation":"contains","value2":"KH"}]}},"id":"91cf2a6d-9e81-4706-8281-4da13aef459f","name":"IF3","type":"n8n-nodes-base.if","typeVersion":1,"position":[-80,1060]},{"parameters":{"conditions":{"string":[{"value1":"={{ $json.set_attributes.learning_type }}","operation":"contains","value2":"course"},{"value1":"={{ $json.set_attributes.learning_type }}","operation":"contains","value2":"bundle"}]},"combineOperation":"any"},"id":"a11ab1ef-eddd-451a-a2fa-04a27feacd5b","name":"IF Course/Bundle","type":"n8n-nodes-base.if","typeVersion":1,"position":[400,620]},{"parameters":{"conditions":{"string":[{"value1":"={{ $json.set_attributes.learning_type }}","value2":"5ptb"}]},"combineOperation":"any"},"id":"20aac9fd-8e5f-4284-8748-bc9e1f4bf7ba","name":"IF 5ptb","type":"n8n-nodes-base.if","typeVersion":1,"position":[540,920]},{"parameters":{"method":"POST","url":"https://n8.quanchatbot.com/webhook/get-key-5ptb","sendBody":true,"contentType":"multipart-form-data","bodyParameters":{"parameters":[{"name":"order_id","value":"={{ $node[\"Item Lists\"].json[\"set_attributes.order_id\"] }}"},{"name":"order_key","value":"={{ $node[\"Item Lists\"].json[\"set_attributes.order_key\"] }}"},{"name":"full_name","value":"={{ $node[\"Item Lists\"].json[\"set_attributes.first_name\"] }}"},{"name":"order_email","value":"={{ $node[\"Item Lists\"].json[\"set_attributes.order_email\"] }}"},{"name":"order_phone","value":"={{ $node[\"Item Lists\"].json[\"set_attributes.order_phone\"] }}"},{"name":"messid","value":"={{ $node[\"Item Lists\"].json[\"set_attributes.messid\"] }}"},{"name":"class","value":"={{ $json[\"set_attributes\"][\"learning_id\"] }}"}]},"options":{}},"id":"5bb5f7b7-150b-4c4e-8599-3d3f4bc9397a","name":"Key 5PTB  theo m√¥n","type":"n8n-nodes-base.httpRequest","typeVersion":4,"position":[720,920],"continueOnFail":true},{"parameters":{"method":"POST","url":"https://api.tamtriluc.com/api/vi-VN/Order/AddShare","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9lbWFpbGFkZHJlc3MiOiI4MyIsImh0dHA6Ly9zY2hlbWFzLnhtbHNvYXAub3JnL3dzLzIwMDUvMDUvaWRlbnRpdHkvY2xhaW1zL2dpdmVubmFtZSI6IkFkbWluIiwiaHR0cDovL3NjaGVtYXMueG1sc29hcC5vcmcvd3MvMjAwNS8wNS9pZGVudGl0eS9jbGFpbXMvc2lkIjoiODMiLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9uYW1lIjoibGVob25ncXVhbiIsImh0dHA6Ly9zY2hlbWFzLnhtbHNvYXAub3JnL3dzLzIwMDUvMDUvaWRlbnRpdHkvY2xhaW1zL21vYmlsZXBob25lIjoiODMiLCJleHAiOjE3MTc5MjgxNzAsImlzcyI6Imh0dHBzOi8vc2lldXRyaW5ob2hvY2R1b25nLmNvbSIsImF1ZCI6Imh0dHBzOi8vc2lldXRyaW5ob2hvY2R1b25nLmNvbSJ9.fEcG5ssHtwWgi-vKJkbyheEMVxZBV4uHR2WPupS9hDw"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\n  \"salePhone\": \"0985767138\",\n  \"acceptedPhone\": \"0985767138\",\n  \"note\": \"Auto\",\n  \"totalAmount\": {{ $node[\"WooCommerce Trigger\"].json[\"total\"] }},\n  \"fullName\": \"{{ $node[\"Item Lists\"].json[\"set_attributes.first_name\"] }}\",\n  \"email\": \"{{ $node[\"Item Lists\"].json[\"set_attributes.order_email\"] }}\",\n  \"phone\": \"{{ $node[\"Item Lists\"].json[\"set_attributes.order_phone\"] }}\",\n  \"address\": \"\",\n  \"payTypeCode\": \"100\",\n\"orderCodeHitaBot\":\"{{ $node[\"WooCommerce Trigger\"].json[\"id\"] }}\",\n  \"orderDetail\": [\n    {\n      \"productId\": 333,\n      \"quantity\": 1\n    }\n  ]\n}","options":{}},"id":"ea715e72-dc29-45f5-9430-a81df9a1dac9","name":"HTTP Request6","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[940,480],"disabled":true},{"parameters":{"method":"POST","url":"https://api.tamtriluc.com/api/vi-VN/Order/AddShare","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9lbWFpbGFkZHJlc3MiOiI4MyIsImh0dHA6Ly9zY2hlbWFzLnhtbHNvYXAub3JnL3dzLzIwMDUvMDUvaWRlbnRpdHkvY2xhaW1zL2dpdmVubmFtZSI6IkFkbWluIiwiaHR0cDovL3NjaGVtYXMueG1sc29hcC5vcmcvd3MvMjAwNS8wNS9pZGVudGl0eS9jbGFpbXMvc2lkIjoiODMiLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9uYW1lIjoibGVob25ncXVhbiIsImh0dHA6Ly9zY2hlbWFzLnhtbHNvYXAub3JnL3dzLzIwMDUvMDUvaWRlbnRpdHkvY2xhaW1zL21vYmlsZXBob25lIjoiODMiLCJleHAiOjE3MTc5MjgxNzAsImlzcyI6Imh0dHBzOi8vc2lldXRyaW5ob2hvY2R1b25nLmNvbSIsImF1ZCI6Imh0dHBzOi8vc2lldXRyaW5ob2hvY2R1b25nLmNvbSJ9.fEcG5ssHtwWgi-vKJkbyheEMVxZBV4uHR2WPupS9hDw"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\n  \"salePhone\": \"0985767138\",\n  \"acceptedPhone\": \"0985767138\",\n  \"note\": \"Auto\",\n  \"totalAmount\": {{ $node[\"WooCommerce Trigger\"].json[\"total\"] }},\n  \"fullName\": \"{{ $node[\"Item Lists\"].json[\"set_attributes.first_name\"] }}\",\n  \"email\": \"{{ $node[\"Item Lists\"].json[\"set_attributes.order_email\"] }}\",\n  \"phone\": \"{{ $node[\"Item Lists\"].json[\"set_attributes.order_phone\"] }}\",\n  \"address\": \"\",\n  \"payTypeCode\": \"100\",\n\"orderCodeHitaBot\":\"{{ $node[\"WooCommerce Trigger\"].json[\"id\"] }}\",\n  \"orderDetail\": [\n    {\n      \"productId\": 333,\n      \"quantity\": 1\n    }\n  ]\n}","options":{}},"id":"3799bf4e-e6af-4553-9977-6b7a3931a309","name":"HTTP Request7","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[860,200],"disabled":true,"continueOnFail":true},{"parameters":{"conditions":{"string":[{"value1":"={{ $json.set_attributes.learning_type }}","value2":"bundle"},{"value1":"={{ $json.set_attributes.learning_id }}","value2":"114378"}]}},"id":"0659bb25-d9a9-4624-bc57-997af9b8725c","name":"IF Bundle Combo PHTT","type":"n8n-nodes-base.if","typeVersion":1,"position":[620,360],"disabled":true,"continueOnFail":true}],"connections":{"WooCommerce Trigger":{"main":[[{"node":"IF","type":"main","index":0},{"node":"HTTP Request3","type":"main","index":0}]]},"IF":{"main":[[{"node":"HTTP Request","type":"main","index":0}]]},"HTTP Request":{"main":[[{"node":"Item Lists","type":"main","index":0}]]},"Item Lists":{"main":[[{"node":"HTTP Request2","type":"main","index":0}]]},"HTTP Request2":{"main":[[{"node":"IF1","type":"main","index":0}]]},"IF1":{"main":[[{"node":"IF Course/Bundle","type":"main","index":0}]]},"HTTP Request3":{"main":[[{"node":"Google Sheets","type":"main","index":0},{"node":"IF2","type":"main","index":0}]]},"IF2":{"main":[[{"node":"HTTP Request4","type":"main","index":0}],[{"node":"IF3","type":"main","index":0}]]},"IF3":{"main":[[{"node":"HTTP Request5","type":"main","index":0}],[{"node":"HTTP Request4","type":"main","index":0}]]},"IF Course/Bundle":{"main":[[{"node":"HTTP Request1","type":"main","index":0},{"node":"IF Bundle Combo PHTT","type":"main","index":0}],[{"node":"IF 5ptb","type":"main","index":0}]]},"IF 5ptb":{"main":[[{"node":"Key 5PTB  theo m√¥n","type":"main","index":0}]]},"IF Bundle Combo PHTT":{"main":[[{"node":"HTTP Request7","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{"WooCommerce Trigger":[{"json":{"id":22072,"parent_id":0,"status":"completed","currency":"VND","version":"7.7.1","prices_include_tax":false,"date_created":"2023-06-09T14:25:28","date_modified":"2023-06-09T17:45:44","discount_total":"1","discount_tax":"0","shipping_total":"0","shipping_tax":"0","cart_tax":"0","total":"468000","total_tax":"0","customer_id":33,"order_key":"wc_order_fUpoGndlRh3Hh","billing":{"first_name":"X·ª≠ Test","last_name":"","company":"","address_1":"","address_2":"","city":"","state":"","postcode":"","country":"VN","email":"nguyenngocxu594@gmail.com","phone":"0909477729"},"shipping":{"first_name":"X·ª≠ Test","last_name":"","company":"","address_1":"","address_2":"","city":"","state":"","postcode":"","country":"VN","phone":"0909477729"},"payment_method":"bacs","payment_method_title":"Chuy·ªÉn kho·∫£n ng√¢n h√†ng","transaction_id":"","customer_ip_address":"115.79.199.39","customer_user_agent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.0.0 Safari/537.36","created_via":"checkout","customer_note":"","date_completed":"2023-06-09T17:45:44","date_paid":"2023-06-09T14:38:13","cart_hash":"328a0eff3b53f9a4f2477e404e25dc58","number":"22072","meta_data":[{"id":656455,"key":"is_vat_exempt","value":"no"},{"id":656456,"key":"marketing_status","value":"1"},{"id":656458,"key":"wvw_currency_rate","value":"1"},{"id":656459,"key":"wvw_price_format","value":{"ex_tax_label":false,"currency":"VND","decimal_separator":",","thousand_separator":".","decimals":0,"price_format":"%2$s&nbsp;%1$s"}},{"id":656462,"key":"_woofunnel_cid","value":"36"},{"id":656463,"key":"_wfacp_post_id","value":"20467"},{"id":656464,"key":"_wfacp_source","value":"https://hitacamp.vn/dang-ky/qua-tang-giup-con-khong-me-game/"},{"id":656465,"key":"_wfacp_timezone","value":""},{"id":656466,"key":"messid","value":"4501448519887732"},{"id":656467,"key":"nguon","value":""},{"id":656468,"key":"ref_id","value":"R_"},{"id":656469,"key":"_bwfan_order_total_base","value":"468000"},{"id":656470,"key":"_wfocu_funnel_id","value":"20469"},{"id":656471,"key":"_wfocu_funnel_key","value":"0a5f8aa1c88af6e620809d9f7615eb88"},{"id":656472,"key":"_wfocu_version","value":"3.6.0"},{"id":656474,"key":"_wfocu_schedule_status","value":{"order_status":"processing","source_status":"on-hold","time":1686295528}},{"id":656475,"key":"order_key","value":"wc_order_fUpoGndlRh3Hh"},{"id":656478,"key":"_wfocu_upsell_amount","value":"468000"},{"id":656479,"key":"_wfocu_upsell_amount_currency","value":"468000"},{"id":656483,"key":"_wfocu_thankyou_visited","value":"yes"},{"id":656551,"key":"_wfob_stats_ids","value":[]},{"id":656552,"key":"_woofunnel_custid","value":"36"},{"id":656678,"key":"_bwf_customer_refunded","value":"468000"},{"id":657221,"key":"lws_woovip_pro_membership_done","value":"2023-06-09T10:45:47+00:00"},{"id":657222,"key":"lws_woovirtualwallet_add_amount_done","value":"2023-06-09T10:45:47+00:00"},{"id":657223,"key":"lws_woovirtualwallet_add_gems_done","value":"2023-06-09T10:45:47+00:00"}],"line_items":[{"id":10077,"name":"GI√öP CON KH√îNG M√ä GAME","product_id":14563,"variation_id":0,"quantity":1,"tax_class":"","subtotal":"1","subtotal_tax":"0","total":"0","total_tax":"0","taxes":[],"meta_data":[{"id":86424,"key":"_wfacp_product","value":"1","display_key":"_wfacp_product","display_value":"1"},{"id":86425,"key":"_wfacp_product_key","value":"wfacp_6465af5413580","display_key":"_wfacp_product_key","display_value":"wfacp_6465af5413580"},{"id":86426,"key":"_wfacp_options","value":{"title":"GI√öP CON KH√îNG M√ä GAME","discount_type":"fixed_discount_reg","discount_amount":"167999","discount_price":"0","quantity":1,"type":"simple","id":"14563","parent_product_id":"0","stock":"true","is_sold_individually":"false","is_default":true,"org_quantity":1,"you_save_text":"","whats_included":"","enable_delete":"false","old_title":"GI√öP CON KH√îNG M√ä GAME","product_id":"14563","whats_include_heading":"GI√öP CON KH√îNG M√ä GAME","item_key":"wfacp_6465af5413580"},"display_key":"_wfacp_options","display_value":{"title":"GI√öP CON KH√îNG M√ä GAME","discount_type":"fixed_discount_reg","discount_amount":"167999","discount_price":"0","quantity":1,"type":"simple","id":"14563","parent_product_id":"0","stock":"true","is_sold_individually":"false","is_default":true,"org_quantity":1,"you_save_text":"","whats_included":"","enable_delete":"false","old_title":"GI√öP CON KH√îNG M√ä GAME","product_id":"14563","whats_include_heading":"GI√öP CON KH√îNG M√ä GAME","item_key":"wfacp_6465af5413580"}},{"id":86427,"key":"_wfacp_item_discount","value":{"VND":{"regular_price":"168000","sale_price":1}},"display_key":"_wfacp_item_discount","display_value":{"VND":{"regular_price":"168000","sale_price":1}}},{"id":86428,"key":"_lws_wvw_extra_mode","value":"wallet","display_key":"_lws_wvw_extra_mode","display_value":"wallet"}],"sku":"","price":0,"image":{"id":"14564","src":"https://hitacamp.vn/wp-content/uploads/2023/04/ttl_GCKMG_16X9.jpg"},"parent_name":null},{"id":10079,"name":"COMBO PH·ª§ HUYNH TH√îNG TH√ÅI","product_id":14748,"variation_id":0,"quantity":1,"tax_class":"","subtotal":"468000","subtotal_tax":"0","total":"468000","total_tax":"0","taxes":[],"meta_data":[{"id":86441,"key":"_upstroke_purchase","value":"yes","display_key":"_upstroke_purchase","display_value":"yes"}],"sku":"","price":468000,"image":{"id":"15482","src":"https://hitacamp.vn/wp-content/uploads/2023/04/NPP_CMHT_QTANG_2.jpg"},"parent_name":null}],"tax_lines":[],"shipping_lines":[],"fee_lines":[],"coupon_lines":[{"id":10078,"code":"megame0d","discount":"1","discount_tax":"0","meta_data":[{"id":86431,"key":"coupon_data","value":{"id":20464,"code":"megame0d","amount":"100","status":"publish","date_created":{"date":"2023-05-18 04:45:21.000000","timezone_type":1,"timezone":"+00:00"},"date_modified":{"date":"2023-05-18 04:45:21.000000","timezone_type":1,"timezone":"+00:00"},"date_expires":null,"discount_type":"percent","description":"","usage_count":496,"individual_use":false,"product_ids":[14563],"excluded_product_ids":[],"usage_limit":0,"usage_limit_per_user":0,"limit_usage_to_x_items":null,"free_shipping":false,"product_categories":[],"excluded_product_categories":[],"exclude_sale_items":false,"minimum_amount":"","maximum_amount":"","email_restrictions":[],"virtual":false,"meta_data":[{"id":598981,"key":"sa_cbl_locations_lookup_in","value":{"address":"billing"}},{"id":598995,"key":"sc_restrict_to_new_user","value":"no"},{"id":598996,"key":"auto_generate_coupon","value":"no"},{"id":598997,"key":"coupon_title_prefix","value":""},{"id":598998,"key":"coupon_title_suffix","value":""},{"id":598999,"key":"sc_coupon_validity","value":""},{"id":599000,"key":"validity_suffix","value":"days"},{"id":599001,"key":"sc_is_visible_storewide","value":"no"},{"id":599002,"key":"sc_disable_email_restriction","value":"no"},{"id":599003,"key":"is_pick_price_of_product","value":"no"},{"id":599004,"key":"wc_sc_add_product_details","value":[]},{"id":599005,"key":"wc_sc_max_discount","value":""},{"id":599006,"key":"wc_sc_expiry_time","value":""},{"id":599007,"key":"wc_sc_auto_apply_coupon","value":"no"},{"id":599008,"key":"sa_cbl_billing_locations","value":[]},{"id":599009,"key":"wc_sc_payment_method_ids","value":[]},{"id":599010,"key":"wc_sc_shipping_method_ids","value":[]},{"id":599011,"key":"wc_sc_user_role_ids","value":[]},{"id":599012,"key":"wc_sc_exclude_user_role_ids","value":[]},{"id":599013,"key":"wc_sc_product_attribute_ids","value":""},{"id":599014,"key":"wc_sc_exclude_product_attribute_ids","value":""},{"id":599015,"key":"wc_sc_taxonomy_restrictions","value":[]},{"id":599016,"key":"wc_sc_excluded_customer_email","value":[]},{"id":599017,"key":"wc_coupon_message","value":""},{"id":599018,"key":"wc_email_message","value":"no"},{"id":599019,"key":"wc_sc_product_quantity_restrictions","value":{"type":"cart","values":{"cart":{"min":"","max":""},"product":{"14563":{"min":"","max":""}},"product_category":[]},"condition":"any"}}]},"display_key":"coupon_data","display_value":{"id":20464,"code":"megame0d","amount":"100","status":"publish","date_created":{"date":"2023-05-18 04:45:21.000000","timezone_type":1,"timezone":"+00:00"},"date_modified":{"date":"2023-05-18 04:45:21.000000","timezone_type":1,"timezone":"+00:00"},"date_expires":null,"discount_type":"percent","description":"","usage_count":496,"individual_use":false,"product_ids":[14563],"excluded_product_ids":[],"usage_limit":0,"usage_limit_per_user":0,"limit_usage_to_x_items":null,"free_shipping":false,"product_categories":[],"excluded_product_categories":[],"exclude_sale_items":false,"minimum_amount":"","maximum_amount":"","email_restrictions":[],"virtual":false,"meta_data":[{"id":598981,"key":"sa_cbl_locations_lookup_in","value":{"address":"billing"}},{"id":598995,"key":"sc_restrict_to_new_user","value":"no"},{"id":598996,"key":"auto_generate_coupon","value":"no"},{"id":598997,"key":"coupon_title_prefix","value":""},{"id":598998,"key":"coupon_title_suffix","value":""},{"id":598999,"key":"sc_coupon_validity","value":""},{"id":599000,"key":"validity_suffix","value":"days"},{"id":599001,"key":"sc_is_visible_storewide","value":"no"},{"id":599002,"key":"sc_disable_email_restriction","value":"no"},{"id":599003,"key":"is_pick_price_of_product","value":"no"},{"id":599004,"key":"wc_sc_add_product_details","value":[]},{"id":599005,"key":"wc_sc_max_discount","value":""},{"id":599006,"key":"wc_sc_expiry_time","value":""},{"id":599007,"key":"wc_sc_auto_apply_coupon","value":"no"},{"id":599008,"key":"sa_cbl_billing_locations","value":[]},{"id":599009,"key":"wc_sc_payment_method_ids","value":[]},{"id":599010,"key":"wc_sc_shipping_method_ids","value":[]},{"id":599011,"key":"wc_sc_user_role_ids","value":[]},{"id":599012,"key":"wc_sc_exclude_user_role_ids","value":[]},{"id":599013,"key":"wc_sc_product_attribute_ids","value":""},{"id":599014,"key":"wc_sc_exclude_product_attribute_ids","value":""},{"id":599015,"key":"wc_sc_taxonomy_restrictions","value":[]},{"id":599016,"key":"wc_sc_excluded_customer_email","value":[]},{"id":599017,"key":"wc_coupon_message","value":""},{"id":599018,"key":"wc_email_message","value":"no"},{"id":599019,"key":"wc_sc_product_quantity_restrictions","value":{"type":"cart","values":{"cart":{"min":"","max":""},"product":{"14563":{"min":"","max":""}},"product_category":[]},"condition":"any"}}]}}]}],"refunds":[],"payment_url":"https://hitacamp.vn/checkout/order-pay/22072/?pay_for_order=true&key=wc_order_fUpoGndlRh3Hh","is_editable":false,"needs_payment":false,"needs_processing":true,"date_created_gmt":"2023-06-09T07:25:28","date_modified_gmt":"2023-06-09T10:45:44","date_completed_gmt":"2023-06-09T10:45:44","date_paid_gmt":"2023-06-09T07:38:13","store_credit_used":0,"currency_symbol":"‚Ç´","_links":{"self":[{"href":"https://hitacamp.vn/wp-json/wc/v3/orders/22072"}],"collection":[{"href":"https://hitacamp.vn/wp-json/wc/v3/orders"}],"customer":[{"href":"https://hitacamp.vn/wp-json/wc/v3/customers/33"}]}},"pairedItem":{"item":0}}]},"versionId":"9551524d-9a19-4ebf-885a-4fe7d2e856f7","triggerCount":0,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-07-19T04:22:39.496Z","updatedAt":"2023-07-26T03:43:08.000Z","id":"197","name":"KDIGI_BANK_BOT: Get list bank support","active":false,"nodes":[{"parameters":{"path":"kdigi-get-list-bank-support","responseMode":"responseNode","options":{}},"id":"67a39c1c-feed-4469-9fe0-5e2aef530af6","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[840,440],"webhookId":"4d9d3695-81e8-4ac1-9b52-01042cd66de1"},{"parameters":{"jsCode":"const bankSupports = [\n  'vietcombank',\n  'tpbank',\n  'vpbank',\n  'vib',\n  'seabank',\n  'bidv',\n  'ocb',\n  'techcombank'\n]\n\nreturn {\n  json :{\n    data: bankSupports\n  }\n}"},"id":"df1d1584-60ad-411d-975d-0a5edc2c9de4","name":"Code","type":"n8n-nodes-base.code","typeVersion":1,"position":[1060,440]},{"parameters":{"respondWith":"json","responseBody":"={{ JSON.stringify($input.item.json) }}","options":{"responseCode":200}},"id":"28700c62-3586-4ccf-a440-fcb769eaf78d","name":"Respond to Webhook","type":"n8n-nodes-base.respondToWebhook","typeVersion":1,"position":[1280,440]}],"connections":{"Webhook":{"main":[[{"node":"Code","type":"main","index":0}]]},"Code":{"main":[[{"node":"Respond to Webhook","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{},"versionId":"c849a47e-7094-417a-bad8-3c39a5fdc602","triggerCount":1,"tags":[{"createdAt":"2023-01-05T09:55:57.214Z","updatedAt":"2023-01-05T09:55:57.214Z","id":"1","name":"Lark"},{"createdAt":"2023-07-15T01:37:36.669Z","updatedAt":"2023-07-15T01:37:36.669Z","id":"27","name":"KDIGI"}]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-07-19T04:28:38.533Z","updatedAt":"2023-07-26T03:43:04.000Z","id":"198","name":"KDIGI_BANK_BOT: webhook catch balance sms & extract data version 2","active":false,"nodes":[{"parameters":{"httpMethod":"POST","path":"v2/template-kdigi-bank-bot-api","options":{}},"id":"1cd2f688-1eee-4f5a-937a-14986e1675c5","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[-720,2620],"webhookId":"4dc22ead-b2fa-4fcd-aab6-92ef44495c3b"},{"parameters":{"mode":"runOnceForEachItem","jsCode":"if (\n  ($('getBankData').item.json.result.transactionType.type === '-' &&\n    $input.item.json.enableOutgoing) ||\n  ($('getBankData').item.json.result.transactionType.type === '+' &&\n    $input.item.json.enableIncoming)\n) {\n  const data = $('getBankData').first().json.result;\n\n  // Convert to Lark Base format\n  const records = [\n    {\n      fields: {\n        ID: data.bankName + '-' + data.receiverAccount,\n        Bank: data.bankName.toUpperCase(),\n        Account: data.receiverAccount,\n        'Transaction Type': data.transactionType.typeText,\n        Debit:\n          data.transactionType.type === '+'\n            ? data.transactionAmount.amount\n            : undefined,\n        Credit:\n          data.transactionType.type === '-'\n            ? data.transactionAmount.amount\n            : undefined,\n        'Transaction ID': data.transactionId,\n        'Transaction Message': data.transactionMessage,\n        'Original Message': data.originalMessage,\n        'Time received': data.receivedTime.timestamp,\n      },\n    },\n  ];\n\n  // Ki·ªÉm tra enableBalance n·∫øu true th√¨ th√™m ph·∫ßn t·ª≠ \"Balance\" v√†o m·∫£ng fields\n  if ($input.item.json.enableBalance) {\n    records[0].fields = {\n      ...records[0].fields,\n      Balance: data.balance.amount,\n    };\n  }\n\n  return {\n    json: {\n      isSend: true,\n      records,\n      configs: {\n        baseId: $input.item.json.baseId,\n        tableId: $input.item.json.tableId,\n      },\n    },\n  };\n}\n\nreturn {\n  json: {\n    isSend: false,\n  },\n};\n"},"id":"e9a19e49-b1a0-42ce-b0da-afcc27b05d25","name":"Convert to Lark Base format","type":"n8n-nodes-base.code","typeVersion":1,"position":[1340,2280]},{"parameters":{"method":"POST","url":"=https://open.larksuite.com/open-apis/bitable/v1/apps/{{ $json[\"configs\"][\"baseId\"] }}/tables/{{  $json[\"configs\"][\"tableId\"]}}/records/batch_create","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $node[\"Get Lark tenant access token\"].json.tenant_access_token }}"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\"records\":{{ JSON.stringify($json[\"records\"]) }}}","options":{}},"id":"dd8b6d70-796d-4017-ae95-0613486efd8d","name":"[SMS Log] Add records to Bitable","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[1720,2200]},{"parameters":{},"id":"10eb935b-5804-4a17-b089-1319fe9666ad","name":"Start Actions","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[-280,2620]},{"parameters":{"mode":"runOnceForEachItem","jsCode":"if (\n  ($('getBankData').item.json.result.transactionType.type === '-' &&\n    $input.item.json.enableOutgoing) ||\n  ($('getBankData').item.json.result.transactionType.type === '+' &&\n    $input.item.json.enableIncoming)\n) {\n  const data = $('getBankData').first().json.result;\n\n  let message = [];\n\n  message.push(\n    `<b>${data.bankName.toUpperCase()}-${data.receiverAccount} (${\n      data.transactionType.type\n    }) ${data.transactionAmount.amountText}VND</b>\\n`,\n    `<b>Ng√¢n h√†ng:</b> ${data.bankName.toUpperCase()}`,\n    `<b>S·ªë t√†i kho·∫£n:</b> ${data.receiverAccount}`,\n    `<b>S·ªë d∆∞ thay ƒë·ªïi:</b> ${data.transactionType.type} ${data.transactionAmount.amountText} VND`\n  );\n\n  // Add balance\n  if ($input.item.json.enableBalance) {\n    message.push(`<b>S·ªë d∆∞ t·∫°m t√≠nh:</b> ${data.balance.amountText} VND`);\n  }\n\n  message.push(`<b>N·ªôi dung:</b>\\n ${data.transactionMessage}`);\n\n  // Check transaction ID\n  if (data.transactionId) {\n    message.push(`<b>M√£ giao d·ªãch:</b> ${data.transactionId}`);\n  }\n\n  message.push(`<b>Th·ªùi gian nh·∫≠n:</b> ${data.receivedTime.text}`);\n\n  return {\n    json: {\n      isSend: true,\n      botToken: $input.item.json.botToken,\n      payload: {\n        chat_id: $input.item.json.chatId,\n        parse_mode: 'HTML',\n        text: message.join('\\n'),\n      },\n    },\n  };\n}\n\nreturn {\n  json: {\n    isSend: false,\n  },\n};\n"},"id":"8c220139-51d0-453c-8107-f10d1dcecf64","name":"Create Telegram Message","type":"n8n-nodes-base.code","typeVersion":1,"position":[520,3240]},{"parameters":{"method":"POST","url":"=https://api.telegram.org/bot{{ $input.item.json.botToken }}/sendMessage ","sendBody":true,"specifyBody":"json","jsonBody":"={{ JSON.stringify($input.item.json.payload) }}","options":{}},"id":"0f3ebdaf-a996-4d48-bc50-59c29889cd0e","name":"Send to Telegram chat","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[980,3160]},{"parameters":{"values":{"string":[{"name":"appId","value":"cli_a33cd37530b8900a"},{"name":"appSecret","value":"qNz8YxoCCZoGm9Nlm2bOrcUriJsJtHHD"}]},"options":{}},"id":"9766a687-db80-4b31-a523-f252edb552d1","name":"Set Lark Configs","type":"n8n-nodes-base.set","typeVersion":2,"position":[180,2380]},{"parameters":{"values":{"string":[{"name":"acceptedBanks","value":"vietcombank,bidv,vib"},{"name":"customBotURL","value":"https://open.larksuite.com/open-apis/bot/v2/hook/b8407056-e8cc-45d0-bfc6-7893201c4ff4"}],"boolean":[{"name":"enableBalance","value":true},{"name":"enableOTP"},{"name":"enableOutgoing"},{"name":"enableIncoming","value":true}]},"options":{}},"id":"63dba413-0a96-4296-8e4b-86c6aa6c7fe0","name":"Set Lark Mess Config","type":"n8n-nodes-base.set","typeVersion":2,"position":[740,2520]},{"parameters":{"values":{"string":[{"name":"acceptedBanks","value":"vietcombank,bidv"},{"name":"baseId","value":"Vz9eb7avZa95IUsOk99uji8Fsdd"},{"name":"tableId","value":"tbl9prfOWONpDCbk"}],"boolean":[{"name":"enableBalance"},{"name":"enableOTP","value":true},{"name":"enableOutgoing"},{"name":"enableIncoming","value":true}]},"options":{}},"id":"fa2f9b7d-1cf7-45db-8b97-b70e5c9644db","name":"Set Lark Base Config","type":"n8n-nodes-base.set","typeVersion":2,"position":[740,2120]},{"parameters":{},"id":"905bb864-4fad-48bd-8db1-1f570031d24b","name":"Start Lark Actions","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[-40,2380]},{"parameters":{},"id":"3245c741-6c5e-44b4-ad76-145066faf385","name":"Start Lark Base","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[520,2240]},{"parameters":{},"id":"33b310c4-822c-4b4c-851a-70719abe17c8","name":"Start Lark Mess","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[520,2600]},{"parameters":{},"id":"6d711d20-b8f9-4dab-9ff0-c15b4176d206","name":"Start Telegram Actions","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[-280,3160]},{"parameters":{"values":{"string":[{"name":"botToken","value":"6141412510:AAEVEPZcCa7Hehbb9pfnX7M9cpd0f5rK1q4"},{"name":"chatId","value":"-1001958985351"}],"boolean":[{"name":"enableBalance"},{"name":"enableOTP"},{"name":"enableOutgoing"},{"name":"enableIncoming"}]},"options":{}},"id":"f1ddd135-ebb4-4710-b4d4-7a444fab95c8","name":"Set Telegram Config","type":"n8n-nodes-base.set","typeVersion":2,"position":[-80,3040]},{"parameters":{},"id":"164b5b3c-eaf3-45b9-9295-5a16002f30c4","name":"Start Lark Base Actions","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[960,2220]},{"parameters":{},"id":"496485af-d420-447d-b5d1-39bfaea0090d","name":"Start Lark Mess Actions","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[960,2580]},{"parameters":{},"id":"699b97b7-de7d-4ad7-88d5-07c07190d653","name":"Start Telegram Mess Actions","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[120,3160]},{"parameters":{"mode":"runOnceForEachItem","jsCode":"const smsContent = $('Webhook').first().json.body;\n\nlet message = [];\n\nmessage.push(\n  `<b>${smsContent.from.toUpperCase()}</b>\\n`,\n  `${smsContent.text.toString()}`\n);\n\nreturn {\n  json: {\n    botToken: $input.item.json.botToken,\n    payload: {\n      chat_id: $input.item.json.chatId,\n      parse_mode: 'HTML',\n      text: message.join('\\n'),\n    },\n  },\n};\n"},"id":"c824b5ce-a945-4f68-883d-122b6319f1ec","name":"Create Telegram Message for OTP","type":"n8n-nodes-base.code","typeVersion":1,"position":[520,3080]},{"parameters":{"values":{"string":[{"name":"acceptedBanks","value":"vietcombank,bidv,vib"},{"name":"customBotURL","value":"https://open.larksuite.com/open-apis/bot/v2/hook/e992e2f1-ab1d-42fd-b217-2277b9df58aa"}],"boolean":[{"name":"enableBalance","value":true},{"name":"enableOTP"},{"name":"enableOutgoing","value":true},{"name":"enableIncoming","value":true}]},"options":{}},"id":"abec4885-55af-416a-9027-df3164555235","name":"Set Lark Mess Config1","type":"n8n-nodes-base.set","typeVersion":2,"position":[740,2700]},{"parameters":{"conditions":{"boolean":[{"value1":"={{ $input.item.json.isSend }}","value2":true}]}},"id":"c03ede41-0e04-4a28-9bf2-0a343fcc2019","name":"ifSend1","type":"n8n-nodes-base.if","typeVersion":1,"position":[1520,2280]},{"parameters":{"values":{"string":[{"name":"acceptedBanks","value":"vietcombank,bidv"},{"name":"baseId","value":"Vz9eb7avZa95IUsOk99uji8Fsdd"},{"name":"tableId","value":"tbl9prfOWONpDCbk"}],"boolean":[{"name":"enableBalance"},{"name":"enableOTP"},{"name":"enableOutgoing"},{"name":"enableIncoming"}]},"options":{}},"id":"63e8f1db-13c1-4933-938f-a0828b0adcf9","name":"Set Lark Base Config1","type":"n8n-nodes-base.set","typeVersion":2,"position":[740,2280]},{"parameters":{"values":{"string":[{"name":"acceptedBanks","value":"vietcombank,bidv"},{"name":"botToken","value":"6380831923:AAFzYGZTFmXbqKWgNu6Drj6IbERm2j9XYQ8"},{"name":"chatId","value":"-1001958985351"}],"boolean":[{"name":"enableBalance"},{"name":"enableOTP"},{"name":"enableOutgoing"},{"name":"enableIncoming"}]},"options":{}},"id":"9549f654-8bb2-44b3-b106-1838a74424b1","name":"Set Telegram Config1","type":"n8n-nodes-base.set","typeVersion":2,"position":[-80,3280]},{"parameters":{"conditions":{"boolean":[{"value1":"={{ $input.item.json.isSend }}","value2":true}]}},"id":"6c2dc765-c600-41e4-8234-63bf3cc1786c","name":"ifSend2","type":"n8n-nodes-base.if","typeVersion":1,"position":[740,3240]},{"parameters":{"values":{"string":[{"name":"acceptedBanks","value":"vietcombank,bidv"},{"name":"botToken","value":"6319174707:AAGXbX_bYMcHUTK0gD6WT159QUL3RqMJ_lo"},{"name":"chatId","value":"-1001958985351"}],"boolean":[{"name":"enableBalance"},{"name":"enableOTP"},{"name":"enableOutgoing"},{"name":"enableIncoming"}]},"options":{}},"id":"f376f57e-f43a-4fe6-aaca-1d3df70e6a26","name":"Set Telegram Config2","type":"n8n-nodes-base.set","typeVersion":2,"position":[-80,3480]},{"parameters":{"values":{"string":[{"name":"acceptedBanks","value":"vietcombank,bidv,vib"},{"name":"customBotURL","value":"https://open.larksuite.com/open-apis/bot/v2/hook/3b18fb71-01b6-4429-8ff7-ab87c12cdad0"}],"boolean":[{"name":"enableBalance"},{"name":"enableOTP","value":true},{"name":"enableOutgoing"},{"name":"enableIncoming","value":true}]},"options":{}},"id":"4cf9022a-f45b-4170-85c2-1975070b1c85","name":"Set Lark Mess Config2","type":"n8n-nodes-base.set","typeVersion":2,"position":[740,2860]},{"parameters":{"mode":"runOnceForEachItem","jsCode":"const smsContent = $('Webhook').first().json.body;\n\n  // Convert to Lark Base format\n  const records = [\n    {\n      fields: {\n        ID: smsContent.from,\n        Bank: smsContent.from,\n        'Transaction Type': 'OTP',\n        'Transaction Message': smsContent.text.toString(),\n        'Original Message': smsContent.text.toString(),\n        'Time received': smsContent.sentStamp,\n      },\n    },\n  ];\n\n  return {\n    json: {\n      records,\n      configs: {\n        baseId: $input.item.json.baseId,\n        tableId: $input.item.json.tableId,\n      },\n    },\n  };\n"},"id":"8b90bceb-f4b3-4ef4-a9fe-913a0c3d3539","name":"Convert to Lark Base format OTP","type":"n8n-nodes-base.code","typeVersion":1,"position":[1340,2040]},{"parameters":{"conditions":{"string":[{"value1":"={{ $('Webhook').item.json.body.text }}","operation":"contains","value2":"OTP"}],"boolean":[{"value1":"={{ $input.item.json.enableOTP }}","value2":true}]}},"id":"03e7691a-ff41-45dd-a10c-be0df0380e4c","name":"ifOTPLarkBase","type":"n8n-nodes-base.if","typeVersion":1,"position":[1140,2220]},{"parameters":{"conditions":{"string":[{"value1":"={{ $('Webhook').item.json.body.text }}","operation":"contains","value2":"OTP"}],"boolean":[{"value1":"={{ $input.item.json.enableOTP }}","value2":true}]}},"id":"a2341d1d-ed1a-47f6-85c9-74e14da8cadf","name":"ifOTPTelegram","type":"n8n-nodes-base.if","typeVersion":1,"position":[300,3160]},{"parameters":{"jsCode":"return $input.first().json.body"},"id":"47a72a87-1d16-42aa-838b-baea19e1b0e7","name":"Get SMS data","type":"n8n-nodes-base.code","typeVersion":1,"position":[-500,2620]},{"parameters":{"method":"POST","url":"https://app.n8n.vn/webhook/v2/kdigi-bank-bot-lark-mess-send-message","sendBody":true,"specifyBody":"json","jsonBody":"={{ JSON.stringify($input.item.json) }}","options":{}},"id":"4eb81524-8fb2-4fe7-8ae2-f57260f60b54","name":"Call KDIGI Lark Mess API","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[1180,2580]}],"connections":{"Webhook":{"main":[[{"node":"Get SMS data","type":"main","index":0}]]},"Convert to Lark Base format":{"main":[[{"node":"ifSend1","type":"main","index":0}]]},"Start Actions":{"main":[[{"node":"Start Lark Actions","type":"main","index":0}]]},"Create Telegram Message":{"main":[[{"node":"ifSend2","type":"main","index":0}]]},"Set Lark Configs":{"main":[[{"node":"Start Lark Mess","type":"main","index":0}]]},"Set Lark Mess Config":{"main":[[{"node":"Start Lark Mess Actions","type":"main","index":0}]]},"Set Lark Base Config":{"main":[[{"node":"Start Lark Base Actions","type":"main","index":0}]]},"Start Lark Actions":{"main":[[{"node":"Set Lark Configs","type":"main","index":0}]]},"Start Lark Base":{"main":[[{"node":"Set Lark Base Config","type":"main","index":0},{"node":"Set Lark Base Config1","type":"main","index":0}]]},"Start Lark Mess":{"main":[[{"node":"Set Lark Mess Config","type":"main","index":0},{"node":"Set Lark Mess Config1","type":"main","index":0},{"node":"Set Lark Mess Config2","type":"main","index":0}]]},"Start Telegram Actions":{"main":[[{"node":"Set Telegram Config","type":"main","index":0},{"node":"Set Telegram Config1","type":"main","index":0},{"node":"Set Telegram Config2","type":"main","index":0}]]},"Set Telegram Config":{"main":[[{"node":"Start Telegram Mess Actions","type":"main","index":0}]]},"Start Lark Base Actions":{"main":[[{"node":"ifOTPLarkBase","type":"main","index":0}]]},"Start Lark Mess Actions":{"main":[[{"node":"Call KDIGI Lark Mess API","type":"main","index":0}]]},"Start Telegram Mess Actions":{"main":[[{"node":"ifOTPTelegram","type":"main","index":0}]]},"Create Telegram Message for OTP":{"main":[[{"node":"Send to Telegram chat","type":"main","index":0}]]},"ifSend1":{"main":[[{"node":"[SMS Log] Add records to Bitable","type":"main","index":0}]]},"Set Lark Base Config1":{"main":[[{"node":"Start Lark Base Actions","type":"main","index":0}]]},"Set Telegram Config1":{"main":[[{"node":"Start Telegram Mess Actions","type":"main","index":0}]]},"ifSend2":{"main":[[{"node":"Send to Telegram chat","type":"main","index":0}]]},"Set Telegram Config2":{"main":[[{"node":"Start Telegram Mess Actions","type":"main","index":0}]]},"Convert to Lark Base format OTP":{"main":[[{"node":"[SMS Log] Add records to Bitable","type":"main","index":0}]]},"ifOTPLarkBase":{"main":[[{"node":"Convert to Lark Base format OTP","type":"main","index":0}],[{"node":"Convert to Lark Base format","type":"main","index":0}]]},"ifOTPTelegram":{"main":[[{"node":"Create Telegram Message for OTP","type":"main","index":0}],[{"node":"Create Telegram Message","type":"main","index":0}]]},"Get SMS data":{"main":[[{"node":"Start Actions","type":"main","index":0}]]},"Set Lark Mess Config1":{"main":[[{"node":"Start Lark Mess Actions","type":"main","index":0}]]},"Set Lark Mess Config2":{"main":[[{"node":"Start Lark Mess Actions","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{"Webhook":[{"json":{"headers":{"host":"app.n8n.vn","user-agent":"SMS Forwarder App","transfer-encoding":"chunked","accept-encoding":"gzip","content-type":"application/json; charset=utf-8","x-forwarded-for":"14.179.3.141","x-forwarded-host":"app.n8n.vn","x-forwarded-port":"443","x-forwarded-proto":"https","x-forwarded-server":"f2605f992776","x-real-ip":"14.179.3.141"},"params":{},"query":{},"body":{"from":"Vietcombank","text":"SD TK 0691000313660 +770,007,700VND luc 17-07-2023 16:55:16. SD 9,414,532VND. Ref IBVCB.1707230013982001.XN3 THEP HA NOI TRA THEP HOA PHAT HUNG YEN","sentStamp":1689410517000,"receivedStamp":1689410517697,"sim":"sim1"}}}]},"versionId":"9910dfdd-c1e9-4d3e-8a8d-15f3853d88b5","triggerCount":1,"tags":[{"createdAt":"2023-01-05T09:55:57.214Z","updatedAt":"2023-01-05T09:55:57.214Z","id":"1","name":"Lark"},{"createdAt":"2023-07-15T01:37:36.669Z","updatedAt":"2023-07-15T01:37:36.669Z","id":"27","name":"KDIGI"}]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-07-19T04:30:04.366Z","updatedAt":"2023-07-26T03:43:02.000Z","id":"199","name":"KDIGI_BANK_BOT: process SMS banking API v2","active":false,"nodes":[{"parameters":{"httpMethod":"POST","path":"v2/kdigi-bank-bot-process-data","responseMode":"responseNode","options":{"ignoreBots":false}},"id":"906be869-0738-4b81-8f93-58f0213e1ba8","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[1460,340],"webhookId":"41106822-4ca9-4367-8150-b893b23c7335"},{"parameters":{"respondWith":"json","responseBody":"={{ JSON.stringify($(\"codeHandle\").first().json) }}","options":{}},"id":"d8aaa35f-2360-4b18-b123-7533c8284f0b","name":"Respond to Webhook","type":"n8n-nodes-base.respondToWebhook","typeVersion":1,"position":[2220,340]},{"parameters":{"jsCode":"const rawWebhook = $('Webhook').first().json;\n\nconst webhookBody = rawWebhook.body;\n\n// Create respond object\nlet respond = {};\n\n// const listBankSupport = $input.first().json.data;\nconst listBankSupport = [\n      \"vietcombank\",\n      \"tpbank\",\n      \"vpbank\",\n      \"vib\",\n      \"seabank\",\n      \"bidv\",\n      \"ocb\",\n      \"techcombank\"\n    ];\n\n// Check valid bank support\nconst bankName = webhookBody.from.toLowerCase();\nconst isBankSupport = listBankSupport.includes(bankName);\n\nrespond = {\n  ...respond,\n  isBankSupport,\n};\n\nif (!isBankSupport) {\n  return respond;\n}\n\n// If config accepted banks\nlet isBankAccepted = true;\n\nrespond = {\n  ...respond,\n  isBankAccepted,\n};\n\nif (webhookBody.acceptedBanks?.trim()?.length > 0) {\n  const acceptedBanks = webhookBody.acceptedBanks?.split(',') ?? [];\n  isBankAccepted = acceptedBanks.includes(bankName);\n\n  respond = {\n    ...respond,\n    isBankAccepted,\n  };\n\n  if (!isBankAccepted) {\n    return respond;\n  }\n}\n\n\n\nconst result = {\n  bankName: '',\n  receivedTime: {},\n  receiverAccount: '',\n  senderAccount: '',\n  transactionType: {},\n  transactionAmount: {},\n  balance: {},\n  transactionId: '',\n  transactionMessage: '',\n  originalMessage: '',\n  larkMessConfig: {\n    cardColor: 'blue',\n  },\n};\n\nresult.bankName = getBankName(bankName);\nresult.receivedTime = getReceivedTime(webhookBody.sentStamp);\nresult.receiverAccount = getReceiverAccount(webhookBody.text, bankName);\nresult.senderAccount = getSenderAccount(webhookBody.text, bankName);\nresult.transactionType = getTransactionType(webhookBody.text, bankName);\nresult.transactionAmount = getTransactionAmount(webhookBody.text, bankName);\nresult.balance = getBalance(webhookBody.text, bankName);\nresult.transactionId = getTransactionId(webhookBody.text, bankName);\nresult.transactionMessage = getTransactionMessage(webhookBody.text, bankName);\nresult.originalMessage = webhookBody.text.toString().replace(/\\n/g, '');\nresult.larkMessConfig = getLarkMessConfig(bankName);\n\nreturn {\n  ...respond,\n  result,\n};\n\nfunction getBankName(msg) {\n  return msg;\n}\n\nfunction getReceivedTime(timestamp) {\n  return {\n    text: new Date(timestamp).toLocaleString('vi-VN', {\n      timeZone: 'Asia/Ho_Chi_Minh',\n    }),\n    timestamp: timestamp,\n  };\n}\n\nfunction getReceiverAccount(msg, bankName) {\n  let regex;\n  let match;\n  let account = '-';\n\n  switch (bankName) {\n    case 'vietcombank':\n      regex = /SD TK (\\d+)/;\n      match = msg.match(regex);\n\n      if (match) {\n        account = match[1];\n      }\n      return account;\n\n    case 'vpbank':\n      regex = /TK (\\d+)/;\n      match = msg.match(regex);\n\n      if (match) {\n        account = match[1];\n      }\n      return account;\n\n    case 'tpbank':\n      regex = /TK: (\\w+)/;\n      match = msg.match(regex);\n\n      if (match) {\n        account = match[1];\n      }\n      return account;\n\n    case 'vib':\n      regex = /TK:(\\d+)/;\n      match = msg.match(regex);\n\n      if (match) {\n        account = match[1];\n      }\n      return account;\n\n    case 'seabank':\n      regex = /TK (\\d+)/;\n      match = msg.match(regex);\n\n      if (match) {\n        account = match[1];\n      }\n      return account;\n\n    case 'bidv':\n      regex = /TK(\\w+)/;\n      match = msg.match(regex);\n\n      if (match) {\n        account = match[1];\n      }\n      return account;\n\n    case 'ocb':\n      regex = /TK (\\w+)/;\n      match = msg.match(regex);\n\n      if (match) {\n        account = match[1];\n      }\n      return account;\n\n    case 'techcombank':\n      regex = /TK (\\w+)/;\n      match = msg.match(regex);\n\n      if (match) {\n        account = match[1];\n      }\n      return account;\n\n    default:\n      return account;\n  }\n}\n\nfunction getSenderAccount(msg, bankName) {\n  let regex;\n  let match;\n  let account = '-';\n\n  switch (bankName) {\n    case 'vietcombank':\n      return account;\n\n    case 'vpbank':\n      regex = /ND: NHAN TU (\\d+)/;\n      match = msg.match(regex);\n\n      if (match) {\n        account = match[1];\n      }\n      return account;\n\n    case 'tpbank':\n      return account;\n\n    case 'vib':\n      return account;\n\n    case 'seabank':\n      //   regex = /CT tu (\\d+)/;\n      //   match = msg.match(regex);\n\n      //   if (match) {\n      //     return match[1];\n      //   }\n      return account;\n\n    case 'bidv':\n      return account;\n\n    case 'ocb':\n      return account;\n\n    case 'techcombank':\n      return account;\n\n    default:\n      return account;\n  }\n}\n\nfunction getTransactionType(msg, bankName) {\n  let regex;\n  let match;\n  let transactionType = {\n    type: '-1',\n    typeText: '-',\n  };\n\n  switch (bankName) {\n    case 'vietcombank':\n      regex = /SD TK \\d+ ([+-])/;\n      match = msg.match(regex);\n      if (match) {\n        transactionType = {\n          type: match[1],\n          typeText: match[1] === '+' ? 'credit' : 'debit',\n        };\n      }\n      return transactionType;\n\n    case 'vpbank':\n      regex = /([\\+\\-])/;\n      match = msg.match(regex);\n      if (match) {\n        transactionType = {\n          type: match[1],\n          typeText: match[1] === '+' ? 'credit' : 'debit',\n        };\n      }\n      return transactionType;\n\n    case 'tpbank':\n      regex = /PS:([\\+\\-])/;\n      match = msg.match(regex);\n      if (match) {\n        transactionType = {\n          type: match[1],\n          typeText: match[1] === '+' ? 'credit' : 'debit',\n        };\n      }\n      return transactionType;\n\n    case 'vib':\n      regex = /PS:([\\+\\-])/;\n      match = msg.match(regex);\n      if (match) {\n        transactionType = {\n          type: match[1],\n          typeText: match[1] === '+' ? 'credit' : 'debit',\n        };\n      }\n      return transactionType;\n\n    case 'seabank':\n      regex = /phat sinh ([\\+\\-])/;\n      match = msg.match(regex);\n      if (match) {\n        transactionType = {\n          type: match[1],\n          typeText: match[1] === '+' ? 'credit' : 'debit',\n        };\n      }\n      return transactionType;\n\n    case 'bidv':\n      regex = /([\\+\\-])/;\n      match = msg.match(regex);\n      if (match) {\n        transactionType = {\n          type: match[1],\n          typeText: match[1] === '+' ? 'credit' : 'debit',\n        };\n      }\n      return transactionType;\n\n    case 'ocb':\n      regex = /\\(([\\+\\-])\\)/;\n      match = msg.match(regex);\n      if (match) {\n        transactionType = {\n          type: match[1],\n          typeText: match[1] === '+' ? 'credit' : 'debit',\n        };\n      }\n      return transactionType;\n\n    case 'techcombank':\n      regex = /([\\+\\-])/;\n      match = msg.match(regex);\n      if (match) {\n        transactionType = {\n          type: match[1],\n          typeText: match[1] === '+' ? 'credit' : 'debit',\n        };\n      }\n      return transactionType;\n\n    default:\n      return transactionType;\n  }\n}\n\nfunction getTransactionAmount(msg, bankName) {\n  let regex;\n  let match;\n  let transactionAmount = {\n    amount: -1,\n    amountText: '-',\n  };\n\n  switch (bankName) {\n    case 'vietcombank':\n      regex = /SD TK \\d+ [+-]?(\\d{1,3}(,\\d{3})*?)VND/;\n      match = msg.match(regex);\n\n      if (match) {\n        transactionAmount = {\n          amount: parseFloat(match[1].replace(/[\\.\\,]+/g, '')),\n          amountText: match[1],\n        };\n      }\n      return transactionAmount;\n\n    case 'vpbank':\n      regex = /[\\+\\-](\\d{1,3}(?:,\\d{3})*)VND/;\n      match = msg.match(regex);\n      if (match) {\n        transactionAmount = {\n          amount: Number(match[1].replace(/[\\.\\,]+/g, '')),\n          amountText: match[1],\n        };\n      }\n      return transactionAmount;\n\n    case 'tpbank':\n      regex = /PS:[+-]([\\d.,]+)VND/;\n      match = msg.match(regex);\n\n      if (match) {\n        transactionAmount = {\n          amount: Number(match[1].replace(/[\\.\\,]+/g, '')),\n          amountText: match[1],\n        };\n      }\n      return transactionAmount;\n\n    case 'vib':\n      regex = /PS:[+-]([\\d.,]+)/;\n      match = msg.match(regex);\n\n      if (match) {\n        transactionAmount = {\n          amount: Number(match[1].replace(/[\\.\\,]+/g, '')),\n          amountText: match[1],\n        };\n      }\n      return transactionAmount;\n\n    case 'seabank':\n      regex = /phat sinh [+-]([\\d.,]+)/;\n      match = msg.match(regex);\n\n      if (match) {\n        transactionAmount = {\n          amount: Number(match[1].replace(/[\\.\\,]+/g, '')),\n          amountText: match[1],\n        };\n      }\n      return transactionAmount;\n\n    case 'bidv':\n      regex = /[+-]([\\d.,]+)VND/;\n      match = msg.match(regex);\n\n      if (match) {\n        transactionAmount = {\n          amount: Number(match[1].replace(/[\\.\\,]+/g, '')),\n          amountText: match[1],\n        };\n      }\n      return transactionAmount;\n\n    case 'ocb':\n      regex = /\\([\\+\\-]\\) ([\\d.,]+) VND/;\n      match = msg.match(regex);\n\n      if (match) {\n        transactionAmount = {\n          amount: Number(match[1].replace(/[\\.\\,]+/g, '')),\n          amountText: match[1],\n        };\n      }\n      return transactionAmount;\n\n    case 'techcombank':\n      regex = /[\\+\\-]([\\d.,]+)/;\n      match = msg.match(regex);\n\n      if (match) {\n        transactionAmount = {\n          amount: Number(match[1].replace(/[\\.\\,]+/g, '')),\n          amountText: match[1],\n        };\n      }\n      return transactionAmount;\n\n    default:\n      return transactionAmount;\n  }\n}\n\nfunction getBalance(msg, bankName) {\n  let regex;\n  let match;\n  let balance = {\n    amount: -1,\n    amountText: '-',\n  };\n\n  switch (bankName) {\n    case 'vietcombank':\n      regex = /(?<=SD )\\d{1,3}(,\\d{3})*?(?=VND)/;\n      match = msg.match(regex);\n      if (match) {\n        balance = {\n          amount: parseFloat(match[0].replace(/[\\.\\,]+/g, '')),\n          amountText: match[0],\n        };\n      }\n      return balance;\n\n    case 'vpbank':\n      regex = /So du\\s?(\\d{1,3}(?:,\\d{3})*)VND/;\n      match = msg.match(regex);\n      if (match) {\n        balance = {\n          amount: Number(match[1].replace(/[\\.\\,]+/g, '')),\n          amountText: match[1],\n        };\n      }\n      return balance;\n\n    case 'tpbank':\n      regex = /SD:\\s?([\\d.,]+)VND/;\n      match = regex.exec(msg);\n      if (match) {\n        balance = {\n          amount: Number(match[1].replace(/[\\.\\,]+/g, '')),\n          amountText: match[1],\n        };\n      }\n      return balance;\n\n    case 'vib':\n      regex = /SODU:[+-]([\\d.,]+)/;\n      match = regex.exec(msg);\n      if (match) {\n        balance = {\n          amount: Number(match[1].replace(/[\\.\\,]+/g, '')),\n          amountText: match[1],\n        };\n      }\n      return balance;\n\n    case 'seabank':\n      regex = /SD:\\s?([\\d.,]+)VND/;\n      match = regex.exec(msg);\n      if (match) {\n        balance = {\n          amount: Number(match[1].replace(/[\\.\\,]+/g, '')),\n          amountText: match[1],\n        };\n      }\n      return balance;\n\n    case 'bidv':\n      regex = /So du:([\\d.,]+)VND/;\n      match = regex.exec(msg);\n      if (match) {\n        balance = {\n          amount: Number(match[1].replace(/[\\.\\,]+/g, '')),\n          amountText: match[1],\n        };\n      }\n      return balance;\n\n    case 'ocb':\n      regex = /So du:\\s?([\\d.,]+) VND/;\n      match = regex.exec(msg);\n      if (match) {\n        balance = {\n          amount: Number(match[1].replace(/[\\.\\,]+/g, '')),\n          amountText: match[1],\n        };\n      }\n      return balance;\n\n    case 'techcombank':\n      regex = /So du:\\s?([\\d.,]+)/;\n      match = regex.exec(msg);\n      if (match) {\n        balance = {\n          amount: Number(match[1].replace(/[\\.\\,]+/g, '')),\n          amountText: match[1],\n        };\n      }\n      return balance;\n\n    default:\n      return balance;\n  }\n}\n\nfunction getTransactionId(msg, bankName) {\n  let regex;\n  let match;\n  let transactionId;\n\n  switch (bankName) {\n    case 'vietcombank':\n      regex = /Ref (\\d{1,}\\.\\d{1,}\\.\\d{1,})/;\n      match = msg.match(regex);\n\n      if (match) {\n        transactionId = match[1];\n      }\n      return transactionId;\n\n    case 'vpbank':\n      return transactionId;\n\n    case 'tpbank':\n      regex = /ND:\\s*([A-Z0-9.-]+B-11\\.)/;\n      match = msg.match(regex);\n\n      if (match) {\n        return match[1];\n      }\n      return transactionId;\n\n    case 'vib':\n      return transactionId;\n\n    case 'seabank':\n      return transactionId;\n\n    case 'bidv':\n      return transactionId;\n\n    case 'ocb':\n      return transactionId;\n\n    case 'techcombank':\n      return transactionId;\n\n    default:\n      return transactionId;\n  }\n}\n\nfunction getTransactionMessage(msg, bankName) {\n  let regex;\n  let match;\n  let message = '-';\n\n  switch (bankName) {\n    case 'vietcombank':\n      regex = /VND. Ref (.*)/;\n      match = msg.match(regex);\n\n      if (match) {\n        message = match[1];\n      }\n      return message;\n\n    case 'vpbank':\n      regex = /ND:\\s*(.*)/;\n      match = msg.match(regex);\n\n      if (match) {\n        message = match[1];\n      }\n      return message;\n\n    case 'tpbank':\n      regex = /ND:\\s*(.*)/;\n      match = msg.match(regex);\n\n      if (match) {\n        message = match[1];\n      }\n      return message;\n\n    case 'vib':\n      regex = /ND:\\s*(.*)/;\n      match = msg.match(regex);\n\n      if (match) {\n        message = match[1];\n      }\n      return message;\n\n    case 'seabank':\n      regex = /ND:\\s*(.*)/;\n      match = msg.match(regex);\n\n      if (match) {\n        message = match[1];\n      }\n      return message;\n\n    case 'bidv':\n      regex = /ND:\\s*(.*)/;\n      match = msg.match(regex);\n\n      if (match) {\n        message = match[1];\n      }\n      return message;\n\n    case 'ocb':\n      regex = /N\\/dung:\\s*(.*)\\.\\.\\./;\n      match = msg.match(regex);\n\n      if (match) {\n        message = match[1];\n      }\n      return message;\n\n    case 'techcombank':\n      regex = /So du:\\s?[\\d.,]+\\n(.*)/;\n      match = msg.match(regex);\n\n      if (match) {\n        message = match[1];\n      }\n      return message;\n\n    default:\n      return message;\n  }\n}\n\n/**\n * Set config for Lark Messenger\n * Card header color reference: https://open.larksuite.com/document/common-capabilities/message-card/message-cards-content/card-header\n * @param bankName Name of bank\n * @returns\n */\nfunction getLarkMessConfig(bankName) {\n  let larkMessConfig = {\n    cardColor: 'blue',\n  };\n  switch (bankName) {\n    case 'vietcombank':\n      larkMessConfig = {\n        cardColor: 'green',\n      };\n      return larkMessConfig;\n\n    case 'vpbank':\n      larkMessConfig = {\n        cardColor: 'turquoise',\n      };\n      return larkMessConfig;\n\n    case 'tpbank':\n      larkMessConfig = {\n        cardColor: 'violet',\n      };\n      return larkMessConfig;\n\n    case 'vib':\n      larkMessConfig = {\n        cardColor: 'orange',\n      };\n      return larkMessConfig;\n\n    case 'seabank':\n      larkMessConfig = {\n        cardColor: 'red',\n      };\n      return larkMessConfig;\n\n    case 'bidv':\n      larkMessConfig = {\n        cardColor: 'turquoise',\n      };\n      return larkMessConfig;\n\n    case 'ocb':\n      larkMessConfig = {\n        cardColor: 'green',\n      };\n      return larkMessConfig;\n\n    case 'techcombank':\n      larkMessConfig = {\n        cardColor: 'red',\n      };\n      return larkMessConfig;\n\n    default:\n      return larkMessConfig;\n  }\n}\n\n// function template(msg, bankName) {\n//   let regex;\n//   let match;\n//   switch (bankName) {\n//     case 'vietcombank':\n//       regex = /ND: NHAN TU (\\d+)/;\n//       match = msg.match(regex);\n\n//       if (match) {\n//         return match[1];\n//       }\n//       return '-';\n//     case 'vpbank':\n//       return '-';\n//     case 'tpbank':\n//       return '-';\n//     case 'vib':\n//       return '-';\n//     case 'seabank':\n//       return '-';\n\n//     default:\n//       return '-';\n//   }\n// }\n"},"id":"5015a95a-d58d-489c-beba-bd7fac3c7a44","name":"codeHandle","type":"n8n-nodes-base.code","typeVersion":1,"position":[1960,340]},{"parameters":{"url":"https://app.n8n.vn/webhook/kdigi-get-list-bank-support","options":{}},"id":"0e1fb189-1bf7-4d27-9daf-c3a44ae64e3c","name":"Get list bank support","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[1660,120]}],"connections":{"Webhook":{"main":[[{"node":"codeHandle","type":"main","index":0}]]},"codeHandle":{"main":[[{"node":"Respond to Webhook","type":"main","index":0}]]},"Get list bank support":{"main":[[]]}},"settings":{},"staticData":null,"pinData":{"Webhook":[{"json":{"headers":{"host":"app.n8n.vn","user-agent":"axios/0.21.4","content-length":"615","accept":"application/json,text/html,application/xhtml+xml,application/xml,text/*;q=0.9, image/*;q=0.8, */*;q=0.7","content-type":"application/json","x-forwarded-for":"172.23.0.1","x-forwarded-host":"app.n8n.vn","x-forwarded-port":"443","x-forwarded-proto":"https","x-forwarded-server":"f2605f992776","x-real-ip":"172.23.0.1","accept-encoding":"gzip"},"params":{},"query":{},"body":{"from":"Techcombank","text":"TK 168816881688\nSo tien GD:+468,000\nSo du:11,038,677\nMBVCB.3865659241.078855.VU HAI SON chuyen tien.CT tu 0591000340457 VU HAI SON toi 168816881688 DANG THI T HANH HUE Ngan hang Ky thuong Viet N am (TECHCOMBANK)","sentStamp":1689410517000,"receivedStamp":1689410517697,"sim":"sim1","appId":"cli_a33cd37530b8900a","appSecret":"qNz8YxoCCZoGm9Nlm2bOrcUriJsJtHHD","enableBalance":true,"enableOTP":false,"enableOutgoing":false,"enableIncoming":true,"acceptedBanks":"vietcombank,bidv,techcombank","customBotURL":"https://open.larksuite.com/open-apis/bot/v2/hook/b8407056-e8cc-45d0-bfc6-7893201c4ff4"}}}],"Get list bank support":[{"json":{"data":["vietcombank","tpbank","vpbank","vib","seabank","bidv","ocb","techcombank"]}}]},"versionId":"69e29700-c55e-443e-ac30-f4c3e57c40b4","triggerCount":1,"tags":[{"createdAt":"2023-07-15T01:37:36.669Z","updatedAt":"2023-07-15T01:37:36.669Z","id":"27","name":"KDIGI"}]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-07-19T04:40:00.876Z","updatedAt":"2023-07-26T03:43:05.000Z","id":"200","name":"KDIGI_BANK_BOT:  send message to Lark Mess","active":false,"nodes":[{"parameters":{"httpMethod":"POST","path":"v2/kdigi-bank-bot-lark-mess-send-message","responseMode":"responseNode","options":{}},"id":"f97b49d3-73d6-4605-af75-ba940e1dfe6d","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[520,440],"webhookId":"8064ad7a-47a0-498c-b3f4-18a3afa54439"},{"parameters":{"mode":"runOnceForEachItem","jsCode":"if (\n  ($('getBankData').item.json.result.transactionType.type === '-' &&\n    $('Webhook').item.json.body.enableOutgoing) ||\n  ($('getBankData').item.json.result.transactionType.type === '+' &&\n    $('Webhook').item.json.body.enableIncoming)\n) {\n  const data = $('getBankData').first().json.result;\n\n  let elements = [];\n\n  elements.push({\n    tag: 'div',\n    fields: [\n      {\n        is_short: false,\n        text: {\n          tag: 'lark_md',\n          content: `**Ng√¢n h√†ng**: ${data.bankName.toUpperCase()}`,\n        },\n      },\n      {\n        is_short: false,\n        text: {\n          tag: 'lark_md',\n          content: `**S·ªë t√†i kho·∫£n**: ${data.receiverAccount}`,\n        },\n      },\n      {\n        is_short: false,\n        text: {\n          tag: 'lark_md',\n          content: `**S·ªë d∆∞ thay ƒë·ªïi:** ${data.transactionType.type} ${data.transactionAmount.amountText} VND`,\n        },\n      },\n      {\n        is_short: false,\n        text: {\n          tag: 'lark_md',\n          content: `**N·ªôi dung:** ${data.transactionMessage}`,\n        },\n      },\n    ],\n  });\n\n  // Append transaction ID if exist\n  if (data.transactionId) {\n    elements[0].fields.push({\n      is_short: false,\n      text: {\n        tag: 'lark_md',\n        content: `**M√£ giao d·ªãch:** ${data.transactionId}`,\n      },\n    });\n  }\n\n  // Append received time\n  elements[0].fields.push({\n    is_short: false,\n    text: {\n      tag: 'lark_md',\n      content: `**Th·ªùi gian nh·∫≠n:** ${data.receivedTime.text}`,\n    },\n  });\n\n  // Ki·ªÉm tra enableBalance n·∫øu true th√¨ th√™m ph·∫ßn t·ª≠ \"S·ªë d∆∞ t·∫°m t√≠nh\" v√†o m·∫£ng fields\n  if ($('Webhook').item.json.body.enableBalance) {\n    const balanceIndex = elements[0].fields.findIndex((field) =>\n      field?.text?.content?.includes('S·ªë d∆∞ thay ƒë·ªïi')\n    );\n    if (balanceIndex !== -1) {\n      elements[0].fields.splice(balanceIndex + 1, 0, {\n        is_short: false,\n        text: {\n          tag: 'lark_md',\n          content: `**S·ªë d∆∞ t·∫°m t√≠nh**: ${data.balance.amountText} VND`,\n        },\n      });\n    }\n  }\n\n  // create message card\n  let result = {\n    msg_type: 'interactive',\n    card: {\n      config: {\n        wide_screen_mode: true,\n      },\n      header: {\n        template: data.larkMessConfig?.cardColor ?? 'blue',\n        title: {\n          content: `${data.bankName.toUpperCase()}-${data.receiverAccount} (${\n            data.transactionType.type\n          }) ${data.transactionAmount.amountText}VND`,\n          tag: 'plain_text',\n        },\n      },\n      elements,\n    },\n  };\n\n  return {\n    json: {\n      isSend: true,\n      data: result,\n      customBotURL: $('Webhook').item.json.body.customBotURL,\n    },\n  };\n}\n\nreturn {\n  json: {\n    isSend: false,\n  },\n};\n"},"id":"347acb37-e7df-44db-9d2b-3caff1b566d9","name":"Convert to Lark Message Card","type":"n8n-nodes-base.code","typeVersion":1,"position":[1840,480]},{"parameters":{"method":"POST","url":"={{ $input.item.json.customBotURL }}","sendBody":true,"specifyBody":"json","jsonBody":"={{ JSON.stringify($input.item.json.data)}}","options":{}},"id":"e1646f99-14c0-43fa-98ab-520cb4368481","name":"[Lark] Send noti to group chat","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[2220,340]},{"parameters":{"mode":"runOnceForEachItem","jsCode":"const smsContent = $('Webhook').item.json.body;\n\n// create message card\nlet result = {\n  msg_type: 'text',\n  content: {\n    text: `T·ª´: ${smsContent.from}\\n${smsContent.text.toString()}`,\n  },\n};\n\nreturn {\n  json: {\n    data: result,\n    customBotURL: $('Webhook').item.json.body.customBotURL,\n  },\n};\n"},"id":"f8f37b86-c2fb-4925-ae49-284161851171","name":"Convert to Message Card for OTP","type":"n8n-nodes-base.code","typeVersion":1,"position":[1840,320]},{"parameters":{"conditions":{"boolean":[{"value1":"={{ $input.item.json.isSend }}","value2":true}]}},"id":"90b9eb75-3b63-4144-9f6d-e24c28c6e40c","name":"ifSend","type":"n8n-nodes-base.if","typeVersion":1,"position":[2040,480]},{"parameters":{"conditions":{"string":[{"value1":"={{ $('Webhook').item.json.body.text }}","operation":"contains","value2":"OTP"}],"boolean":[{"value1":"={{ $('Webhook').item.json.body.enableOTP }}","value2":true}]}},"id":"10161f19-8400-4e43-89f6-4f081a7046b9","name":"ifOTPLarkMess","type":"n8n-nodes-base.if","typeVersion":1,"position":[1620,400]},{"parameters":{"conditions":{"boolean":[{"value1":"={{ $json.isBankSupport }}","value2":true}]}},"id":"06bc057b-99f4-463a-b08e-3bfac946bbbd","name":"ifBankSupport","type":"n8n-nodes-base.if","typeVersion":1,"position":[940,440]},{"parameters":{"method":"POST","url":"https://app.n8n.vn/webhook/v2/kdigi-bank-bot-process-data","sendBody":true,"specifyBody":"json","jsonBody":"={{ JSON.stringify($input.first().json.body) }}","options":{}},"id":"94272f69-3d6d-462f-825a-13cf125950b3","name":"getBankData","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[740,440]},{"parameters":{},"id":"6a9463bf-1fd9-43ca-ad78-2bf04b85d267","name":"Start Actions","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[1400,400]},{"parameters":{"respondWith":"json","responseBody":"{\"result\": \"Success\"}","options":{}},"id":"a8ea915d-94de-41b1-abf4-b1f5482e3312","name":"Respond to Webhook","type":"n8n-nodes-base.respondToWebhook","typeVersion":1,"position":[2440,340]},{"parameters":{"respondWith":"json","responseBody":"{\"result\": \"Error: Bank Not Supported\"}","options":{}},"id":"1856fd31-a658-4cf4-b8f3-c1900f2c3482","name":"Respond Bank not Support","type":"n8n-nodes-base.respondToWebhook","typeVersion":1,"position":[1120,660]},{"parameters":{"conditions":{"boolean":[{"value1":"={{ $('getBankData').first().json.isBankAccepted }}","value2":true}]}},"id":"5be66fad-4f26-4afc-8b2d-bf9ba62cc860","name":"ifBankAccepted","type":"n8n-nodes-base.if","typeVersion":1,"position":[1160,420]},{"parameters":{"respondWith":"json","responseBody":"{\"result\": \"Canceled: Bank Not Accepted\"}","options":{}},"id":"5ef5873f-21cb-4514-8d09-dc9fadbd8b79","name":"Respond Bank not accepted","type":"n8n-nodes-base.respondToWebhook","typeVersion":1,"position":[1320,580]}],"connections":{"Convert to Lark Message Card":{"main":[[{"node":"ifSend","type":"main","index":0}]]},"Convert to Message Card for OTP":{"main":[[{"node":"[Lark] Send noti to group chat","type":"main","index":0}]]},"ifSend":{"main":[[{"node":"[Lark] Send noti to group chat","type":"main","index":0}]]},"ifOTPLarkMess":{"main":[[{"node":"Convert to Message Card for OTP","type":"main","index":0}],[{"node":"Convert to Lark Message Card","type":"main","index":0}]]},"ifBankSupport":{"main":[[{"node":"ifBankAccepted","type":"main","index":0}],[{"node":"Respond Bank not Support","type":"main","index":0}]]},"getBankData":{"main":[[{"node":"ifBankSupport","type":"main","index":0}]]},"Webhook":{"main":[[{"node":"getBankData","type":"main","index":0}]]},"[Lark] Send noti to group chat":{"main":[[{"node":"Respond to Webhook","type":"main","index":0}]]},"ifBankAccepted":{"main":[[{"node":"Start Actions","type":"main","index":0}],[{"node":"Respond Bank not accepted","type":"main","index":0}]]},"Start Actions":{"main":[[{"node":"ifOTPLarkMess","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{"Webhook":[{"json":{"headers":{"host":"app.n8n.vn","user-agent":"axios/0.21.4","content-length":"615","accept":"application/json,text/html,application/xhtml+xml,application/xml,text/*;q=0.9, image/*;q=0.8, */*;q=0.7","content-type":"application/json","x-forwarded-for":"172.23.0.1","x-forwarded-host":"app.n8n.vn","x-forwarded-port":"443","x-forwarded-proto":"https","x-forwarded-server":"f2605f992776","x-real-ip":"172.23.0.1","accept-encoding":"gzip"},"params":{},"query":{},"body":{"from":"Techcombank","text":"Ma OTP cho giao dich truc tuyen cua the 4...3961 la: 742691. Ma OTP co hieu luc trong 10 phut. Vui long bao mat thong tin. Hotline: 1800588822.","sentStamp":1689410517000,"receivedStamp":1689410517697,"sim":"sim1","appId":"cli_a33cd37530b8900a","appSecret":"qNz8YxoCCZoGm9Nlm2bOrcUriJsJtHHD","enableBalance":true,"enableOTP":true,"enableOutgoing":false,"enableIncoming":true,"customBotURL":"https://open.larksuite.com/open-apis/bot/v2/hook/b8407056-e8cc-45d0-bfc6-7893201c4ff4"}}}]},"versionId":"b50c01e2-4eaa-4a08-a166-a8b73388e894","triggerCount":1,"tags":[{"createdAt":"2023-07-15T01:37:36.669Z","updatedAt":"2023-07-15T01:37:36.669Z","id":"27","name":"KDIGI"}]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-07-19T05:03:42.702Z","updatedAt":"2023-07-19T13:28:40.000Z","id":"201","name":"2- Sms banking -> Bot / Base ( Flow chu·∫©n: 19/07/2023 )","active":true,"nodes":[{"parameters":{"httpMethod":"POST","path":"thg-sms-bank-bot-api","options":{}},"id":"e918c1c7-be90-4baf-a4f8-9389fcae130f","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[-1640,1120],"webhookId":"b459d9da-c462-43e0-880c-12b8d6304763"},{"parameters":{"mode":"runOnceForEachItem","jsCode":"if (\n  ($('getBankData').item.json.result.transactionType.type === '-' &&\n    $input.item.json.enableOutgoing) ||\n  ($('getBankData').item.json.result.transactionType.type === '+' &&\n    $input.item.json.enableIncoming)\n) {\n  const data = $('getBankData').first().json.result;\n\n  let elements = [];\n\n  elements.push({\n    tag: 'div',\n    fields: [\n      {\n        is_short: false,\n        text: {\n          tag: 'lark_md',\n          content: `**Ng√¢n h√†ng**: ${data.bankName.toUpperCase()}`,\n        },\n      },\n      {\n        is_short: false,\n        text: {\n          tag: 'lark_md',\n          content: `**S·ªë t√†i kho·∫£n**: ${data.receiverAccount}`,\n        },\n      },\n      {\n        is_short: false,\n        text: {\n          tag: 'lark_md',\n          content: `**S·ªë d∆∞ thay ƒë·ªïi:** ${data.transactionType.type} ${data.transactionAmount.amountText} VND`,\n        },\n      },\n      {\n        is_short: false,\n        text: {\n          tag: 'lark_md',\n          content: `**N·ªôi dung:** ${data.transactionMessage}`,\n        },\n      },\n    ],\n  });\n\n  // Append transaction ID if exist\n  if (data.transactionId) {\n    elements[0].fields.push({\n      is_short: false,\n      text: {\n        tag: 'lark_md',\n        content: `**M√£ giao d·ªãch:** ${data.transactionId}`,\n      },\n    });\n  }\n\n  // Append received time\n  elements[0].fields.push({\n    is_short: false,\n    text: {\n      tag: 'lark_md',\n      content: `**Th·ªùi gian nh·∫≠n:** ${data.receivedTime.text}`,\n    },\n  });\n\n  // Ki·ªÉm tra enableBalance n·∫øu true th√¨ th√™m ph·∫ßn t·ª≠ \"S·ªë d∆∞ t·∫°m t√≠nh\" v√†o m·∫£ng fields\n  if ($input.item.json.enableBalance) {\n    const balanceIndex = elements[0].fields.findIndex((field) =>\n      field?.text?.content?.includes('S·ªë d∆∞ thay ƒë·ªïi')\n    );\n    if (balanceIndex !== -1) {\n      elements[0].fields.splice(balanceIndex + 1, 0, {\n        is_short: false,\n        text: {\n          tag: 'lark_md',\n          content: `**S·ªë d∆∞ t·∫°m t√≠nh**: ${data.balance.amountText} VND`,\n        },\n      });\n    }\n  }\n\n  // create message card\n  let result = {\n    msg_type: 'interactive',\n    card: {\n      config: {\n        wide_screen_mode: true,\n      },\n      header: {\n        template: data.larkMessConfig?.cardColor ?? 'blue',\n        title: {\n          content: `${data.bankName.toUpperCase()}-${data.receiverAccount} (${\n            data.transactionType.type\n          }) ${data.transactionAmount.amountText}VND`,\n          tag: 'plain_text',\n        },\n      },\n      elements,\n    },\n  };\n\n  return {\n    json: {\n      isSend: true,\n      data: result,\n      customBotURL: $input.item.json.customBotURL,\n    },\n  };\n}\n\nreturn {\n  json: {\n    isSend: false,\n  },\n};\n"},"id":"fdadeb4b-5dba-43b8-a384-8c6c14d3bdd5","name":"Convert to Lark Message Card","type":"n8n-nodes-base.code","typeVersion":1,"position":[660,1160]},{"parameters":{"method":"POST","url":"=https://open.larksuite.com/open-apis/auth/v3/tenant_access_token/internal/","sendBody":true,"specifyBody":"json","jsonBody":"={ \"app_id\" : \"{{ $input.item.json[\"appId\"] }}\", \"app_secret\" : \"{{ $input.item.json[\"appSecret\"] }}\" }","options":{}},"id":"5e1b39f3-435d-4709-b77d-aa5e3fe165f7","name":"Get Lark tenant access token","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[-400,860]},{"parameters":{"method":"POST","url":"={{ $input.item.json.customBotURL }}","sendBody":true,"specifyBody":"json","jsonBody":"={{ JSON.stringify($input.item.json.data)}}","options":{}},"id":"fc77b959-6c85-43de-b628-73783ac190c7","name":"[Lark] Send noti to group chat","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[1080,1020]},{"parameters":{"mode":"runOnceForEachItem","jsCode":"if (\n  ($('getBankData').item.json.result.transactionType.type === '-' &&\n    $input.item.json.enableOutgoing) ||\n  ($('getBankData').item.json.result.transactionType.type === '+' &&\n    $input.item.json.enableIncoming)\n) {\n  const data = $('getBankData').first().json.result;\n\n  // Convert to Lark Base format\n  const records = [\n    {\n      fields: {\n        ID: data.bankName + '-' + data.receiverAccount,\n        Bank: data.bankName.toUpperCase(),\n        Account: data.receiverAccount,\n        'Transaction Type': data.transactionType.typeText,\n        Debit:\n          data.transactionType.type === '+'\n            ? data.transactionAmount.amount\n            : undefined,\n        Credit:\n          data.transactionType.type === '-'\n            ? data.transactionAmount.amount\n            : undefined,\n        'Transaction ID': data.transactionId,\n        'Transaction Message': data.transactionMessage,\n        'Original Message': data.originalMessage,\n        'Time received': data.receivedTime.timestamp,\n      },\n    },\n  ];\n\n  // Ki·ªÉm tra enableBalance n·∫øu true th√¨ th√™m ph·∫ßn t·ª≠ \"Balance\" v√†o m·∫£ng fields\n  if ($input.item.json.enableBalance) {\n    records[0].fields = {\n      ...records[0].fields,\n      Balance: data.balance.amount,\n    };\n  }\n\n  return {\n    json: {\n      isSend: true,\n      records,\n      configs: {\n        baseId: $input.item.json.baseId,\n        tableId: $input.item.json.tableId,\n      },\n    },\n  };\n}\n\nreturn {\n  json: {\n    isSend: false,\n  },\n};\n"},"id":"982ee7d4-2c90-4854-8173-f658a20f36e5","name":"Convert to Lark Base format","type":"n8n-nodes-base.code","typeVersion":1,"position":[640,760]},{"parameters":{"method":"POST","url":"=https://open.larksuite.com/open-apis/bitable/v1/apps/{{ $json[\"configs\"][\"baseId\"] }}/tables/{{  $json[\"configs\"][\"tableId\"]}}/records/batch_create","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $node[\"Get Lark tenant access token\"].json.tenant_access_token }}"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\"records\":{{ JSON.stringify($json[\"records\"]) }}}","options":{}},"id":"1d3451f0-f590-4ed7-8b75-aeb55455641b","name":"[SMS Log] Add records to Bitable","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[1060,700]},{"parameters":{"conditions":{"boolean":[{"value1":"={{ $json.isBankSupport }}","value2":true}]}},"id":"d7653088-be72-481b-b00c-6b3b5e227dd4","name":"ifBankSupport","type":"n8n-nodes-base.if","typeVersion":1,"position":[-1220,1120]},{"parameters":{"method":"POST","url":"https://app.n8n.vn/webhook/kdigi-bank-bot-process-data","sendBody":true,"specifyBody":"json","jsonBody":"={{ JSON.stringify($input.first().json.body) }}","options":{}},"id":"7829ce0e-8740-486a-9960-720de54489f2","name":"getBankData","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[-1440,1120]},{"parameters":{},"id":"4a726a73-3929-4099-b52d-aef216e9544e","name":"Start Actions","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[-1020,1100]},{"parameters":{"values":{"string":[{"name":"appId","value":"cli_a43de77666b9d009"},{"name":"appSecret","value":"90BzblYO0KqaflN2WjeVskjsu7U0gRz2"}]},"options":{}},"id":"a914030f-3ad4-4930-a8d8-6571ff348d6f","name":"Set Lark Configs","type":"n8n-nodes-base.set","typeVersion":2,"position":[-580,860]},{"parameters":{"keepOnlySet":true,"values":{"string":[{"name":"customBotURL","value":"https://open.larksuite.com/open-apis/bot/v2/hook/7f5b2236-09f1-49d7-8b83-e9f5c053a67c"}],"boolean":[{"name":"enableBalance","value":true},{"name":"enableOTP","value":true},{"name":"enableOutgoing","value":true},{"name":"enableIncoming","value":true}]},"options":{"dotNotation":true}},"id":"be999486-a64e-4f95-95ba-a2ed4b7850d1","name":"Set Lark Mess Config","type":"n8n-nodes-base.set","typeVersion":2,"position":[20,1120]},{"parameters":{"values":{"string":[{"name":"baseId","value":"QeEUbcUVwaj2IVs4fVGuv33XsLb"},{"name":"tableId","value":"tblOVlFoMmLGa2S6"}],"boolean":[{"name":"enableBalance","value":true},{"name":"enableOTP","value":true},{"name":"enableOutgoing","value":true},{"name":"enableIncoming","value":true}]},"options":{}},"id":"851b4cc7-4afb-4303-832b-64a662ffe569","name":"Set Lark Base Config","type":"n8n-nodes-base.set","typeVersion":2,"position":[40,700]},{"parameters":{},"id":"4e60ac3f-73cb-40b5-b05c-3db47bdfbcb4","name":"Start Lark Actions","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[-740,860]},{"parameters":{},"id":"2366e887-d2a1-4c06-aa59-ec9c3eeb8592","name":"Start Lark Base","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[-180,720]},{"parameters":{},"id":"99e71929-cf51-456b-8a35-adb4358ea22c","name":"Start Lark Mess","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[-200,1120]},{"parameters":{},"id":"022bf6e4-f991-423e-82de-3784249da218","name":"Start Lark Base Actions","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[260,700]},{"parameters":{},"id":"ce953520-a2a7-4147-9587-35cc43c51720","name":"Start Lark Mess Actions","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[240,1100]},{"parameters":{"mode":"runOnceForEachItem","jsCode":"const smsContent = $('Webhook').first().json.body;\n\n// create message card\nlet result = {\n  msg_type: 'text',\n  content: {\n    text: `T·ª´: ${smsContent.from}\\n${smsContent.text.toString()}`,\n  },\n};\n\nreturn {\n  json: {\n    data: result,\n    customBotURL: $input.item.json.customBotURL,\n  },\n};\n"},"id":"551de48e-ef8c-4c70-b770-e13208f92e3a","name":"Convert to Message Card for OTP","type":"n8n-nodes-base.code","typeVersion":1,"position":[660,1000]},{"parameters":{"conditions":{"boolean":[{"value1":"={{ $input.item.json.isSend }}","value2":true}]}},"id":"7b1af501-f034-4cd4-ba17-18423b28d58f","name":"ifSend","type":"n8n-nodes-base.if","typeVersion":1,"position":[860,1160]},{"parameters":{"conditions":{"boolean":[{"value1":"={{ $input.item.json.isSend }}","value2":true}]}},"id":"dc52767d-b1b9-4c3a-9fb4-27173c8dd6e6","name":"ifSend1","type":"n8n-nodes-base.if","typeVersion":1,"position":[820,760]},{"parameters":{"mode":"runOnceForEachItem","jsCode":"const smsContent = $('Webhook').first().json.body;\n\n  // Convert to Lark Base format\n  const records = [\n    {\n      fields: {\n        ID: smsContent.from,\n        Bank: smsContent.from,\n        'Transaction Type': 'OTP',\n        'Transaction Message': smsContent.text.toString(),\n        'Original Message': smsContent.text.toString(),\n        'Time received': smsContent.sentStamp,\n      },\n    },\n  ];\n\n  return {\n    json: {\n      records,\n      configs: {\n        baseId: $input.item.json.baseId,\n        tableId: $input.item.json.tableId,\n      },\n    },\n  };\n"},"id":"246a93cf-857f-4524-90f6-c302f31817e3","name":"Convert to Lark Base format OTP","type":"n8n-nodes-base.code","typeVersion":1,"position":[640,520]},{"parameters":{"conditions":{"string":[{"value1":"={{ $('Webhook').item.json.body.text }}","operation":"contains","value2":"OTP"}],"boolean":[{"value1":"={{ $input.item.json.enableOTP }}","value2":true}]}},"id":"ef4ad612-a91c-44d3-b841-7e62c1732591","name":"ifOTPLarkBase","type":"n8n-nodes-base.if","typeVersion":1,"position":[440,700]},{"parameters":{"conditions":{"string":[{"value1":"={{ $('Webhook').item.json.body.text }}","operation":"contains","value2":"OTP"}],"boolean":[{"value1":"={{ $input.item.json.enableOTP }}","value2":true}]}},"id":"66f4424e-99bd-4ccd-a3f2-42cdfb3dfd74","name":"ifOTPLarkMess","type":"n8n-nodes-base.if","typeVersion":1,"position":[400,1100]}],"connections":{"Webhook":{"main":[[{"node":"getBankData","type":"main","index":0}]]},"Convert to Lark Message Card":{"main":[[{"node":"ifSend","type":"main","index":0}]]},"Get Lark tenant access token":{"main":[[{"node":"Start Lark Base","type":"main","index":0},{"node":"Start Lark Mess","type":"main","index":0}]]},"Convert to Lark Base format":{"main":[[{"node":"ifSend1","type":"main","index":0}]]},"ifBankSupport":{"main":[[{"node":"Start Actions","type":"main","index":0}]]},"getBankData":{"main":[[{"node":"ifBankSupport","type":"main","index":0}]]},"Start Actions":{"main":[[{"node":"Start Lark Actions","type":"main","index":0}]]},"Set Lark Configs":{"main":[[{"node":"Get Lark tenant access token","type":"main","index":0}]]},"Set Lark Mess Config":{"main":[[{"node":"Start Lark Mess Actions","type":"main","index":0}]]},"Set Lark Base Config":{"main":[[{"node":"Start Lark Base Actions","type":"main","index":0}]]},"Start Lark Actions":{"main":[[{"node":"Set Lark Configs","type":"main","index":0}]]},"Start Lark Base":{"main":[[{"node":"Set Lark Base Config","type":"main","index":0}]]},"Start Lark Mess":{"main":[[{"node":"Set Lark Mess Config","type":"main","index":0}]]},"Start Lark Base Actions":{"main":[[{"node":"ifOTPLarkBase","type":"main","index":0}]]},"Start Lark Mess Actions":{"main":[[{"node":"ifOTPLarkMess","type":"main","index":0}]]},"Convert to Message Card for OTP":{"main":[[{"node":"[Lark] Send noti to group chat","type":"main","index":0}]]},"ifSend":{"main":[[{"node":"[Lark] Send noti to group chat","type":"main","index":0}]]},"ifSend1":{"main":[[{"node":"[SMS Log] Add records to Bitable","type":"main","index":0}]]},"Convert to Lark Base format OTP":{"main":[[{"node":"[SMS Log] Add records to Bitable","type":"main","index":0}]]},"ifOTPLarkBase":{"main":[[{"node":"Convert to Lark Base format OTP","type":"main","index":0}],[{"node":"Convert to Lark Base format","type":"main","index":0}]]},"ifOTPLarkMess":{"main":[[{"node":"Convert to Message Card for OTP","type":"main","index":0}],[{"node":"Convert to Lark Message Card","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{},"versionId":"7274304d-9882-46f8-af93-7a2132fa74f7","triggerCount":1,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-07-19T05:14:31.579Z","updatedAt":"2023-07-19T05:14:31.579Z","id":"202","name":"My workflow 25","active":false,"nodes":[{"parameters":{"httpMethod":"POST","path":"template-kdigi-bank-bot-api","options":{}},"id":"39616c14-7a1e-4583-a84e-3c0fdc670f64","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[-1760,820],"webhookId":"b459d9da-c462-43e0-880c-12b8d6304763"},{"parameters":{"mode":"runOnceForEachItem","jsCode":"if (\n  ($('getBankData').item.json.result.transactionType.type === '-' &&\n    $input.item.json.enableOutgoing) ||\n  ($('getBankData').item.json.result.transactionType.type === '+' &&\n    $input.item.json.enableIncoming)\n) {\n  const data = $('getBankData').first().json.result;\n\n  let elements = [];\n\n  elements.push({\n    tag: 'div',\n    fields: [\n      {\n        is_short: false,\n        text: {\n          tag: 'lark_md',\n          content: `**Ng√¢n h√†ng**: ${data.bankName.toUpperCase()}`,\n        },\n      },\n      {\n        is_short: false,\n        text: {\n          tag: 'lark_md',\n          content: `**S·ªë t√†i kho·∫£n**: ${data.receiverAccount}`,\n        },\n      },\n      {\n        is_short: false,\n        text: {\n          tag: 'lark_md',\n          content: `**S·ªë d∆∞ thay ƒë·ªïi:** ${data.transactionType.type} ${data.transactionAmount.amountText} VND`,\n        },\n      },\n      {\n        is_short: false,\n        text: {\n          tag: 'lark_md',\n          content: `**N·ªôi dung:** ${data.transactionMessage}`,\n        },\n      },\n    ],\n  });\n\n  // Append transaction ID if exist\n  if (data.transactionId) {\n    elements[0].fields.push({\n      is_short: false,\n      text: {\n        tag: 'lark_md',\n        content: `**M√£ giao d·ªãch:** ${data.transactionId}`,\n      },\n    });\n  }\n\n  // Append received time\n  elements[0].fields.push({\n    is_short: false,\n    text: {\n      tag: 'lark_md',\n      content: `**Th·ªùi gian nh·∫≠n:** ${data.receivedTime.text}`,\n    },\n  });\n\n  // Ki·ªÉm tra enableBalance n·∫øu true th√¨ th√™m ph·∫ßn t·ª≠ \"S·ªë d∆∞ t·∫°m t√≠nh\" v√†o m·∫£ng fields\n  if ($input.item.json.enableBalance) {\n    const balanceIndex = elements[0].fields.findIndex((field) =>\n      field?.text?.content?.includes('S·ªë d∆∞ thay ƒë·ªïi')\n    );\n    if (balanceIndex !== -1) {\n      elements[0].fields.splice(balanceIndex + 1, 0, {\n        is_short: false,\n        text: {\n          tag: 'lark_md',\n          content: `**S·ªë d∆∞ t·∫°m t√≠nh**: ${data.balance.amountText} VND`,\n        },\n      });\n    }\n  }\n\n  // create message card\n  let result = {\n    msg_type: 'interactive',\n    card: {\n      config: {\n        wide_screen_mode: true,\n      },\n      header: {\n        template: data.larkMessConfig?.cardColor ?? 'blue',\n        title: {\n          content: `${data.bankName.toUpperCase()}-${data.receiverAccount} (${\n            data.transactionType.type\n          }) ${data.transactionAmount.amountText}VND`,\n          tag: 'plain_text',\n        },\n      },\n      elements,\n    },\n  };\n\n  return {\n    json: {\n      isSend: true,\n      data: result,\n      customBotURL: $input.item.json.customBotURL,\n    },\n  };\n}\n\nreturn {\n  json: {\n    isSend: false,\n  },\n};\n"},"id":"80fe64f5-f9e8-4552-9f81-5e7b866128d1","name":"Convert to Lark Message Card","type":"n8n-nodes-base.code","typeVersion":1,"position":[540,860]},{"parameters":{"method":"POST","url":"=https://open.larksuite.com/open-apis/auth/v3/tenant_access_token/internal/","sendBody":true,"specifyBody":"json","jsonBody":"={ \"app_id\" : \"{{ $input.item.json[\"appId\"] }}\", \"app_secret\" : \"{{ $input.item.json[\"appSecret\"] }}\" }","options":{}},"id":"478244be-5246-45f1-8848-98260bac9e32","name":"Get Lark tenant access token","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[-520,560]},{"parameters":{"method":"POST","url":"={{ $input.item.json.customBotURL }}","sendBody":true,"specifyBody":"json","jsonBody":"={{ JSON.stringify($input.item.json.data)}}","options":{}},"id":"e6a9349f-1eea-4f9b-96b4-d84147a924d4","name":"[Lark] Send noti to group chat","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[960,720]},{"parameters":{"mode":"runOnceForEachItem","jsCode":"if (\n  ($('getBankData').item.json.result.transactionType.type === '-' &&\n    $input.item.json.enableOutgoing) ||\n  ($('getBankData').item.json.result.transactionType.type === '+' &&\n    $input.item.json.enableIncoming)\n) {\n  const data = $('getBankData').first().json.result;\n\n  // Convert to Lark Base format\n  const records = [\n    {\n      fields: {\n        ID: data.bankName + '-' + data.receiverAccount,\n        Bank: data.bankName.toUpperCase(),\n        Account: data.receiverAccount,\n        'Transaction Type': data.transactionType.typeText,\n        Debit:\n          data.transactionType.type === '+'\n            ? data.transactionAmount.amount\n            : undefined,\n        Credit:\n          data.transactionType.type === '-'\n            ? data.transactionAmount.amount\n            : undefined,\n        'Transaction ID': data.transactionId,\n        'Transaction Message': data.transactionMessage,\n        'Original Message': data.originalMessage,\n        'Time received': data.receivedTime.timestamp,\n      },\n    },\n  ];\n\n  // Ki·ªÉm tra enableBalance n·∫øu true th√¨ th√™m ph·∫ßn t·ª≠ \"Balance\" v√†o m·∫£ng fields\n  if ($input.item.json.enableBalance) {\n    records[0].fields = {\n      ...records[0].fields,\n      Balance: data.balance.amount,\n    };\n  }\n\n  return {\n    json: {\n      isSend: true,\n      records,\n      configs: {\n        baseId: $input.item.json.baseId,\n        tableId: $input.item.json.tableId,\n      },\n    },\n  };\n}\n\nreturn {\n  json: {\n    isSend: false,\n  },\n};\n"},"id":"3cff83dc-6739-4687-9ebd-6c4570ce5eab","name":"Convert to Lark Base format","type":"n8n-nodes-base.code","typeVersion":1,"position":[520,460]},{"parameters":{"method":"POST","url":"=https://open.larksuite.com/open-apis/bitable/v1/apps/{{ $json[\"configs\"][\"baseId\"] }}/tables/{{  $json[\"configs\"][\"tableId\"]}}/records/batch_create","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $node[\"Get Lark tenant access token\"].json.tenant_access_token }}"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\"records\":{{ JSON.stringify($json[\"records\"]) }}}","options":{}},"id":"3aa73533-8f8e-4d14-a473-0d53a79b59fc","name":"[SMS Log] Add records to Bitable","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[940,400]},{"parameters":{"conditions":{"boolean":[{"value1":"={{ $json.isBankSupport }}","value2":true}]}},"id":"282294c2-22b2-444f-af3a-c3db78349e77","name":"ifBankSupport","type":"n8n-nodes-base.if","typeVersion":1,"position":[-1340,820]},{"parameters":{"method":"POST","url":"https://app.n8n.vn/webhook/kdigi-bank-bot-process-data","sendBody":true,"specifyBody":"json","jsonBody":"={{ JSON.stringify($input.first().json.body) }}","options":{}},"id":"c3d8ae00-2462-4fbc-96b3-b4334a957a89","name":"getBankData","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[-1560,820]},{"parameters":{},"id":"272b8568-ff1e-42dc-bc44-ceffa592c8db","name":"Start Actions","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[-1140,800]},{"parameters":{"mode":"runOnceForEachItem","jsCode":"if (\n  ($('getBankData').item.json.result.transactionType.type === '-' &&\n    $input.item.json.enableOutgoing) ||\n  ($('getBankData').item.json.result.transactionType.type === '+' &&\n    $input.item.json.enableIncoming)\n) {\n  const data = $('getBankData').first().json.result;\n\n  let message = [];\n\n  message.push(\n    `<b>${data.bankName.toUpperCase()}-${data.receiverAccount} (${\n      data.transactionType.type\n    }) ${data.transactionAmount.amountText}VND</b>\\n`,\n    `<b>Ng√¢n h√†ng:</b> ${data.bankName.toUpperCase()}`,\n    `<b>S·ªë t√†i kho·∫£n:</b> ${data.receiverAccount}`,\n    `<b>S·ªë d∆∞ thay ƒë·ªïi:</b> ${data.transactionType.type} ${data.transactionAmount.amountText} VND`\n  );\n\n  // Add balance\n  if ($input.item.json.enableBalance) {\n    message.push(`<b>S·ªë d∆∞ t·∫°m t√≠nh:</b> ${data.balance.amountText} VND`);\n  }\n\n  message.push(`<b>N·ªôi dung:</b>\\n ${data.transactionMessage}`);\n\n  // Check transaction ID\n  if (data.transactionId) {\n    message.push(`<b>M√£ giao d·ªãch:</b> ${data.transactionId}`);\n  }\n\n  message.push(`<b>Th·ªùi gian nh·∫≠n:</b> ${data.receivedTime.text}`);\n\n  return {\n    json: {\n      isSend: true,\n      botToken: $input.item.json.botToken,\n      payload: {\n        chat_id: $input.item.json.chatId,\n        parse_mode: 'HTML',\n        text: message.join('\\n'),\n      },\n    },\n  };\n}\n\nreturn {\n  json: {\n    isSend: false,\n  },\n};\n"},"id":"29590a94-2ec4-456b-b8a4-6f3f55ea0664","name":"Create Telegram Message","type":"n8n-nodes-base.code","typeVersion":1,"position":[-20,1300]},{"parameters":{"method":"POST","url":"=https://api.telegram.org/bot{{ $input.item.json.botToken }}/sendMessage ","sendBody":true,"specifyBody":"json","jsonBody":"={{ JSON.stringify($input.item.json.payload) }}","options":{}},"id":"e86e13f3-54a6-4708-b83a-987d9ee1f32b","name":"Send to Telegram chat","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[440,1220]},{"parameters":{"values":{"string":[{"name":"appId","value":"set-app-id"},{"name":"appSecret","value":"set-app-secret"}]},"options":{}},"id":"93020eda-75f2-454e-be21-0f45e1965cf9","name":"Set Lark Configs","type":"n8n-nodes-base.set","typeVersion":2,"position":[-700,560]},{"parameters":{"values":{"string":[{"name":"customBotURL","value":"set-bot-url"}],"boolean":[{"name":"enableBalance","value":true},{"name":"enableOTP","value":true},{"name":"enableOutgoing","value":true},{"name":"enableIncoming","value":true}]},"options":{}},"id":"37b0358e-fce9-40e6-8f0c-9ecd95a9e223","name":"Set Lark Mess Config","type":"n8n-nodes-base.set","typeVersion":2,"position":[-100,820]},{"parameters":{"values":{"string":[{"name":"baseId","value":"set-base-id"},{"name":"tableId","value":"set-table-id"}],"boolean":[{"name":"enableBalance","value":true},{"name":"enableOTP","value":true},{"name":"enableOutgoing","value":true},{"name":"enableIncoming","value":true}]},"options":{}},"id":"643598fb-a80e-430f-9b13-88560217c9b9","name":"Set Lark Base Config","type":"n8n-nodes-base.set","typeVersion":2,"position":[-80,420]},{"parameters":{},"id":"47035fa0-b6ff-41de-9278-f184d6ae8a9d","name":"Start Lark Actions","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[-860,560]},{"parameters":{},"id":"681a20e3-1b6c-403b-9e73-56805bf7c83b","name":"Start Lark Base","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[-300,420]},{"parameters":{},"id":"96d49e9d-0ee9-4fb4-b9b8-eedc9288e334","name":"Start Lark Mess","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[-320,820]},{"parameters":{},"id":"dc27df87-7f0a-4ebe-a181-c7c13fac0621","name":"Start Telegram Actions","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[-820,1220]},{"parameters":{"values":{"string":[{"name":"botToken","value":"set-bot-token"},{"name":"chatId","value":"set-chat-id"}],"boolean":[{"name":"enableBalance","value":true},{"name":"enableOTP","value":true},{"name":"enableOutgoing","value":true},{"name":"enableIncoming","value":true}]},"options":{}},"id":"a046c9ca-406b-4cbd-810e-ce8402efce78","name":"Set Telegram Config","type":"n8n-nodes-base.set","typeVersion":2,"position":[-620,1220]},{"parameters":{},"id":"d4997618-fffe-4662-8a96-de0dff868c6d","name":"Start Lark Base Actions","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[140,400]},{"parameters":{},"id":"5b61229a-0ceb-48d9-8b3a-8dd3066c5cb3","name":"Start Lark Mess Actions","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[120,800]},{"parameters":{"mode":"runOnceForEachItem","jsCode":"const smsContent = $('Webhook').first().json.body;\n\n// create message card\nlet result = {\n  msg_type: 'text',\n  content: {\n    text: `T·ª´: ${smsContent.from}\\n${smsContent.text.toString()}`,\n  },\n};\n\nreturn {\n  json: {\n    data: result,\n    customBotURL: $input.item.json.customBotURL,\n  },\n};\n"},"id":"15250981-9e6e-4782-bde7-bb68423a165e","name":"Convert to Message Card for OTP","type":"n8n-nodes-base.code","typeVersion":1,"position":[540,700]},{"parameters":{},"id":"dfa7befb-4fa4-4c60-a4ef-8778bb294367","name":"Start Telegram Mess Actions","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[-420,1220]},{"parameters":{"mode":"runOnceForEachItem","jsCode":"const smsContent = $('Webhook').first().json.body;\n\nlet message = [];\n\nmessage.push(\n  `<b>${smsContent.from.toUpperCase()}</b>\\n`,\n  `${smsContent.text.toString()}`\n);\n\nreturn {\n  json: {\n    botToken: $input.item.json.botToken,\n    payload: {\n      chat_id: $input.item.json.chatId,\n      parse_mode: 'HTML',\n      text: message.join('\\n'),\n    },\n  },\n};\n"},"id":"92e86b62-6f13-4c19-b013-e7a61f8d492c","name":"Create Telegram Message for OTP","type":"n8n-nodes-base.code","typeVersion":1,"position":[-20,1140]},{"parameters":{"conditions":{"boolean":[{"value1":"={{ $input.item.json.isSend }}","value2":true}]}},"id":"ee4ae9a7-3a0c-420d-bcfa-224e542954ae","name":"ifSend","type":"n8n-nodes-base.if","typeVersion":1,"position":[740,860]},{"parameters":{"conditions":{"boolean":[{"value1":"={{ $input.item.json.isSend }}","value2":true}]}},"id":"eaf3ef69-8ca7-4078-aa97-b6e6c7ddc9e3","name":"ifSend1","type":"n8n-nodes-base.if","typeVersion":1,"position":[700,460]},{"parameters":{"conditions":{"boolean":[{"value1":"={{ $input.item.json.isSend }}","value2":true}]}},"id":"db8e8ac1-b63b-420f-8325-454288e66d21","name":"ifSend2","type":"n8n-nodes-base.if","typeVersion":1,"position":[200,1300]},{"parameters":{"mode":"runOnceForEachItem","jsCode":"const smsContent = $('Webhook').first().json.body;\n\n  // Convert to Lark Base format\n  const records = [\n    {\n      fields: {\n        ID: smsContent.from,\n        Bank: smsContent.from,\n        'Transaction Type': 'OTP',\n        'Transaction Message': smsContent.text.toString(),\n        'Original Message': smsContent.text.toString(),\n        'Time received': smsContent.sentStamp,\n      },\n    },\n  ];\n\n  return {\n    json: {\n      records,\n      configs: {\n        baseId: $input.item.json.baseId,\n        tableId: $input.item.json.tableId,\n      },\n    },\n  };\n"},"id":"d7e0383a-61f8-437b-acf6-1787c53b99d0","name":"Convert to Lark Base format OTP","type":"n8n-nodes-base.code","typeVersion":1,"position":[520,220]},{"parameters":{"conditions":{"string":[{"value1":"={{ $('Webhook').item.json.body.text }}","operation":"contains","value2":"OTP"}],"boolean":[{"value1":"={{ $input.item.json.enableOTP }}","value2":true}]}},"id":"785ac81a-500c-4190-b52a-115d320f7875","name":"ifOTPLarkBase","type":"n8n-nodes-base.if","typeVersion":1,"position":[320,400]},{"parameters":{"conditions":{"string":[{"value1":"={{ $('Webhook').item.json.body.text }}","operation":"contains","value2":"OTP"}],"boolean":[{"value1":"={{ $input.item.json.enableOTP }}","value2":true}]}},"id":"25eb70be-5a8f-4548-9f53-9ed0fd6a0c03","name":"ifOTPLarkMess","type":"n8n-nodes-base.if","typeVersion":1,"position":[280,800]},{"parameters":{"conditions":{"string":[{"value1":"={{ $('Webhook').item.json.body.text }}","operation":"contains","value2":"OTP"}],"boolean":[{"value1":"={{ $input.item.json.enableOTP }}","value2":true}]}},"id":"1a5a98a1-2f1c-470d-b644-b52e4624fecb","name":"ifOTPTelegram","type":"n8n-nodes-base.if","typeVersion":1,"position":[-240,1220]}],"connections":{"Webhook":{"main":[[{"node":"getBankData","type":"main","index":0}]]},"Convert to Lark Message Card":{"main":[[{"node":"ifSend","type":"main","index":0}]]},"Get Lark tenant access token":{"main":[[{"node":"Start Lark Base","type":"main","index":0},{"node":"Start Lark Mess","type":"main","index":0}]]},"Convert to Lark Base format":{"main":[[{"node":"ifSend1","type":"main","index":0}]]},"ifBankSupport":{"main":[[{"node":"Start Actions","type":"main","index":0}]]},"getBankData":{"main":[[{"node":"ifBankSupport","type":"main","index":0}]]},"Start Actions":{"main":[[{"node":"Start Telegram Actions","type":"main","index":0},{"node":"Start Lark Actions","type":"main","index":0}]]},"Create Telegram Message":{"main":[[{"node":"ifSend2","type":"main","index":0}]]},"Set Lark Configs":{"main":[[{"node":"Get Lark tenant access token","type":"main","index":0}]]},"Set Lark Mess Config":{"main":[[{"node":"Start Lark Mess Actions","type":"main","index":0}]]},"Set Lark Base Config":{"main":[[{"node":"Start Lark Base Actions","type":"main","index":0}]]},"Start Lark Actions":{"main":[[{"node":"Set Lark Configs","type":"main","index":0}]]},"Start Lark Base":{"main":[[{"node":"Set Lark Base Config","type":"main","index":0}]]},"Start Lark Mess":{"main":[[{"node":"Set Lark Mess Config","type":"main","index":0}]]},"Start Telegram Actions":{"main":[[{"node":"Set Telegram Config","type":"main","index":0}]]},"Set Telegram Config":{"main":[[{"node":"Start Telegram Mess Actions","type":"main","index":0}]]},"Start Lark Base Actions":{"main":[[{"node":"ifOTPLarkBase","type":"main","index":0}]]},"Start Lark Mess Actions":{"main":[[{"node":"ifOTPLarkMess","type":"main","index":0}]]},"Convert to Message Card for OTP":{"main":[[{"node":"[Lark] Send noti to group chat","type":"main","index":0}]]},"Start Telegram Mess Actions":{"main":[[{"node":"ifOTPTelegram","type":"main","index":0}]]},"Create Telegram Message for OTP":{"main":[[{"node":"Send to Telegram chat","type":"main","index":0}]]},"ifSend":{"main":[[{"node":"[Lark] Send noti to group chat","type":"main","index":0}]]},"ifSend1":{"main":[[{"node":"[SMS Log] Add records to Bitable","type":"main","index":0}]]},"ifSend2":{"main":[[{"node":"Send to Telegram chat","type":"main","index":0}]]},"Convert to Lark Base format OTP":{"main":[[{"node":"[SMS Log] Add records to Bitable","type":"main","index":0}]]},"ifOTPLarkBase":{"main":[[{"node":"Convert to Lark Base format OTP","type":"main","index":0}],[{"node":"Convert to Lark Base format","type":"main","index":0}]]},"ifOTPLarkMess":{"main":[[{"node":"Convert to Message Card for OTP","type":"main","index":0}],[{"node":"Convert to Lark Message Card","type":"main","index":0}]]},"ifOTPTelegram":{"main":[[{"node":"Create Telegram Message for OTP","type":"main","index":0}],[{"node":"Create Telegram Message","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{},"versionId":"2bfe22d2-fff2-4ace-95f5-dee06140bc00","triggerCount":0,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-07-19T05:14:31.588Z","updatedAt":"2023-07-19T05:14:31.588Z","id":"203","name":"B·∫Øn th√¥ng b√°o bank v·ªÅ Lark","active":false,"nodes":[{"parameters":{"httpMethod":"POST","path":"template-kdigi-bank-bot-api","options":{}},"id":"39616c14-7a1e-4583-a84e-3c0fdc670f64","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[-1760,820],"webhookId":"b459d9da-c462-43e0-880c-12b8d6304763"},{"parameters":{"mode":"runOnceForEachItem","jsCode":"if (\n  ($('getBankData').item.json.result.transactionType.type === '-' &&\n    $input.item.json.enableOutgoing) ||\n  ($('getBankData').item.json.result.transactionType.type === '+' &&\n    $input.item.json.enableIncoming)\n) {\n  const data = $('getBankData').first().json.result;\n\n  let elements = [];\n\n  elements.push({\n    tag: 'div',\n    fields: [\n      {\n        is_short: false,\n        text: {\n          tag: 'lark_md',\n          content: `**Ng√¢n h√†ng**: ${data.bankName.toUpperCase()}`,\n        },\n      },\n      {\n        is_short: false,\n        text: {\n          tag: 'lark_md',\n          content: `**S·ªë t√†i kho·∫£n**: ${data.receiverAccount}`,\n        },\n      },\n      {\n        is_short: false,\n        text: {\n          tag: 'lark_md',\n          content: `**S·ªë d∆∞ thay ƒë·ªïi:** ${data.transactionType.type} ${data.transactionAmount.amountText} VND`,\n        },\n      },\n      {\n        is_short: false,\n        text: {\n          tag: 'lark_md',\n          content: `**N·ªôi dung:** ${data.transactionMessage}`,\n        },\n      },\n    ],\n  });\n\n  // Append transaction ID if exist\n  if (data.transactionId) {\n    elements[0].fields.push({\n      is_short: false,\n      text: {\n        tag: 'lark_md',\n        content: `**M√£ giao d·ªãch:** ${data.transactionId}`,\n      },\n    });\n  }\n\n  // Append received time\n  elements[0].fields.push({\n    is_short: false,\n    text: {\n      tag: 'lark_md',\n      content: `**Th·ªùi gian nh·∫≠n:** ${data.receivedTime.text}`,\n    },\n  });\n\n  // Ki·ªÉm tra enableBalance n·∫øu true th√¨ th√™m ph·∫ßn t·ª≠ \"S·ªë d∆∞ t·∫°m t√≠nh\" v√†o m·∫£ng fields\n  if ($input.item.json.enableBalance) {\n    const balanceIndex = elements[0].fields.findIndex((field) =>\n      field?.text?.content?.includes('S·ªë d∆∞ thay ƒë·ªïi')\n    );\n    if (balanceIndex !== -1) {\n      elements[0].fields.splice(balanceIndex + 1, 0, {\n        is_short: false,\n        text: {\n          tag: 'lark_md',\n          content: `**S·ªë d∆∞ t·∫°m t√≠nh**: ${data.balance.amountText} VND`,\n        },\n      });\n    }\n  }\n\n  // create message card\n  let result = {\n    msg_type: 'interactive',\n    card: {\n      config: {\n        wide_screen_mode: true,\n      },\n      header: {\n        template: data.larkMessConfig?.cardColor ?? 'blue',\n        title: {\n          content: `${data.bankName.toUpperCase()}-${data.receiverAccount} (${\n            data.transactionType.type\n          }) ${data.transactionAmount.amountText}VND`,\n          tag: 'plain_text',\n        },\n      },\n      elements,\n    },\n  };\n\n  return {\n    json: {\n      isSend: true,\n      data: result,\n      customBotURL: $input.item.json.customBotURL,\n    },\n  };\n}\n\nreturn {\n  json: {\n    isSend: false,\n  },\n};\n"},"id":"80fe64f5-f9e8-4552-9f81-5e7b866128d1","name":"Convert to Lark Message Card","type":"n8n-nodes-base.code","typeVersion":1,"position":[540,860]},{"parameters":{"method":"POST","url":"=https://open.larksuite.com/open-apis/auth/v3/tenant_access_token/internal/","sendBody":true,"specifyBody":"json","jsonBody":"={ \"app_id\" : \"{{ $input.item.json[\"appId\"] }}\", \"app_secret\" : \"{{ $input.item.json[\"appSecret\"] }}\" }","options":{}},"id":"478244be-5246-45f1-8848-98260bac9e32","name":"Get Lark tenant access token","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[-520,560]},{"parameters":{"method":"POST","url":"={{ $input.item.json.customBotURL }}","sendBody":true,"specifyBody":"json","jsonBody":"={{ JSON.stringify($input.item.json.data)}}","options":{}},"id":"e6a9349f-1eea-4f9b-96b4-d84147a924d4","name":"[Lark] Send noti to group chat","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[960,720]},{"parameters":{"mode":"runOnceForEachItem","jsCode":"if (\n  ($('getBankData').item.json.result.transactionType.type === '-' &&\n    $input.item.json.enableOutgoing) ||\n  ($('getBankData').item.json.result.transactionType.type === '+' &&\n    $input.item.json.enableIncoming)\n) {\n  const data = $('getBankData').first().json.result;\n\n  // Convert to Lark Base format\n  const records = [\n    {\n      fields: {\n        ID: data.bankName + '-' + data.receiverAccount,\n        Bank: data.bankName.toUpperCase(),\n        Account: data.receiverAccount,\n        'Transaction Type': data.transactionType.typeText,\n        Debit:\n          data.transactionType.type === '+'\n            ? data.transactionAmount.amount\n            : undefined,\n        Credit:\n          data.transactionType.type === '-'\n            ? data.transactionAmount.amount\n            : undefined,\n        'Transaction ID': data.transactionId,\n        'Transaction Message': data.transactionMessage,\n        'Original Message': data.originalMessage,\n        'Time received': data.receivedTime.timestamp,\n      },\n    },\n  ];\n\n  // Ki·ªÉm tra enableBalance n·∫øu true th√¨ th√™m ph·∫ßn t·ª≠ \"Balance\" v√†o m·∫£ng fields\n  if ($input.item.json.enableBalance) {\n    records[0].fields = {\n      ...records[0].fields,\n      Balance: data.balance.amount,\n    };\n  }\n\n  return {\n    json: {\n      isSend: true,\n      records,\n      configs: {\n        baseId: $input.item.json.baseId,\n        tableId: $input.item.json.tableId,\n      },\n    },\n  };\n}\n\nreturn {\n  json: {\n    isSend: false,\n  },\n};\n"},"id":"3cff83dc-6739-4687-9ebd-6c4570ce5eab","name":"Convert to Lark Base format","type":"n8n-nodes-base.code","typeVersion":1,"position":[520,460]},{"parameters":{"method":"POST","url":"=https://open.larksuite.com/open-apis/bitable/v1/apps/{{ $json[\"configs\"][\"baseId\"] }}/tables/{{  $json[\"configs\"][\"tableId\"]}}/records/batch_create","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $node[\"Get Lark tenant access token\"].json.tenant_access_token }}"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\"records\":{{ JSON.stringify($json[\"records\"]) }}}","options":{}},"id":"3aa73533-8f8e-4d14-a473-0d53a79b59fc","name":"[SMS Log] Add records to Bitable","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[940,400]},{"parameters":{"conditions":{"boolean":[{"value1":"={{ $json.isBankSupport }}","value2":true}]}},"id":"282294c2-22b2-444f-af3a-c3db78349e77","name":"ifBankSupport","type":"n8n-nodes-base.if","typeVersion":1,"position":[-1340,820]},{"parameters":{"method":"POST","url":"https://app.n8n.vn/webhook/kdigi-bank-bot-process-data","sendBody":true,"specifyBody":"json","jsonBody":"={{ JSON.stringify($input.first().json.body) }}","options":{}},"id":"c3d8ae00-2462-4fbc-96b3-b4334a957a89","name":"getBankData","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[-1560,820]},{"parameters":{},"id":"272b8568-ff1e-42dc-bc44-ceffa592c8db","name":"Start Actions","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[-1140,800]},{"parameters":{"mode":"runOnceForEachItem","jsCode":"if (\n  ($('getBankData').item.json.result.transactionType.type === '-' &&\n    $input.item.json.enableOutgoing) ||\n  ($('getBankData').item.json.result.transactionType.type === '+' &&\n    $input.item.json.enableIncoming)\n) {\n  const data = $('getBankData').first().json.result;\n\n  let message = [];\n\n  message.push(\n    `<b>${data.bankName.toUpperCase()}-${data.receiverAccount} (${\n      data.transactionType.type\n    }) ${data.transactionAmount.amountText}VND</b>\\n`,\n    `<b>Ng√¢n h√†ng:</b> ${data.bankName.toUpperCase()}`,\n    `<b>S·ªë t√†i kho·∫£n:</b> ${data.receiverAccount}`,\n    `<b>S·ªë d∆∞ thay ƒë·ªïi:</b> ${data.transactionType.type} ${data.transactionAmount.amountText} VND`\n  );\n\n  // Add balance\n  if ($input.item.json.enableBalance) {\n    message.push(`<b>S·ªë d∆∞ t·∫°m t√≠nh:</b> ${data.balance.amountText} VND`);\n  }\n\n  message.push(`<b>N·ªôi dung:</b>\\n ${data.transactionMessage}`);\n\n  // Check transaction ID\n  if (data.transactionId) {\n    message.push(`<b>M√£ giao d·ªãch:</b> ${data.transactionId}`);\n  }\n\n  message.push(`<b>Th·ªùi gian nh·∫≠n:</b> ${data.receivedTime.text}`);\n\n  return {\n    json: {\n      isSend: true,\n      botToken: $input.item.json.botToken,\n      payload: {\n        chat_id: $input.item.json.chatId,\n        parse_mode: 'HTML',\n        text: message.join('\\n'),\n      },\n    },\n  };\n}\n\nreturn {\n  json: {\n    isSend: false,\n  },\n};\n"},"id":"29590a94-2ec4-456b-b8a4-6f3f55ea0664","name":"Create Telegram Message","type":"n8n-nodes-base.code","typeVersion":1,"position":[-20,1300]},{"parameters":{"method":"POST","url":"=https://api.telegram.org/bot{{ $input.item.json.botToken }}/sendMessage ","sendBody":true,"specifyBody":"json","jsonBody":"={{ JSON.stringify($input.item.json.payload) }}","options":{}},"id":"e86e13f3-54a6-4708-b83a-987d9ee1f32b","name":"Send to Telegram chat","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[440,1220]},{"parameters":{"values":{"string":[{"name":"appId","value":"set-app-id"},{"name":"appSecret","value":"set-app-secret"}]},"options":{}},"id":"93020eda-75f2-454e-be21-0f45e1965cf9","name":"Set Lark Configs","type":"n8n-nodes-base.set","typeVersion":2,"position":[-700,560]},{"parameters":{"values":{"string":[{"name":"customBotURL","value":"set-bot-url"}],"boolean":[{"name":"enableBalance","value":true},{"name":"enableOTP","value":true},{"name":"enableOutgoing","value":true},{"name":"enableIncoming","value":true}]},"options":{}},"id":"37b0358e-fce9-40e6-8f0c-9ecd95a9e223","name":"Set Lark Mess Config","type":"n8n-nodes-base.set","typeVersion":2,"position":[-100,820]},{"parameters":{"values":{"string":[{"name":"baseId","value":"set-base-id"},{"name":"tableId","value":"set-table-id"}],"boolean":[{"name":"enableBalance","value":true},{"name":"enableOTP","value":true},{"name":"enableOutgoing","value":true},{"name":"enableIncoming","value":true}]},"options":{}},"id":"643598fb-a80e-430f-9b13-88560217c9b9","name":"Set Lark Base Config","type":"n8n-nodes-base.set","typeVersion":2,"position":[-80,420]},{"parameters":{},"id":"47035fa0-b6ff-41de-9278-f184d6ae8a9d","name":"Start Lark Actions","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[-860,560]},{"parameters":{},"id":"681a20e3-1b6c-403b-9e73-56805bf7c83b","name":"Start Lark Base","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[-300,420]},{"parameters":{},"id":"96d49e9d-0ee9-4fb4-b9b8-eedc9288e334","name":"Start Lark Mess","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[-320,820]},{"parameters":{},"id":"dc27df87-7f0a-4ebe-a181-c7c13fac0621","name":"Start Telegram Actions","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[-820,1220]},{"parameters":{"values":{"string":[{"name":"botToken","value":"set-bot-token"},{"name":"chatId","value":"set-chat-id"}],"boolean":[{"name":"enableBalance","value":true},{"name":"enableOTP","value":true},{"name":"enableOutgoing","value":true},{"name":"enableIncoming","value":true}]},"options":{}},"id":"a046c9ca-406b-4cbd-810e-ce8402efce78","name":"Set Telegram Config","type":"n8n-nodes-base.set","typeVersion":2,"position":[-620,1220]},{"parameters":{},"id":"d4997618-fffe-4662-8a96-de0dff868c6d","name":"Start Lark Base Actions","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[140,400]},{"parameters":{},"id":"5b61229a-0ceb-48d9-8b3a-8dd3066c5cb3","name":"Start Lark Mess Actions","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[120,800]},{"parameters":{"mode":"runOnceForEachItem","jsCode":"const smsContent = $('Webhook').first().json.body;\n\n// create message card\nlet result = {\n  msg_type: 'text',\n  content: {\n    text: `T·ª´: ${smsContent.from}\\n${smsContent.text.toString()}`,\n  },\n};\n\nreturn {\n  json: {\n    data: result,\n    customBotURL: $input.item.json.customBotURL,\n  },\n};\n"},"id":"15250981-9e6e-4782-bde7-bb68423a165e","name":"Convert to Message Card for OTP","type":"n8n-nodes-base.code","typeVersion":1,"position":[540,700]},{"parameters":{},"id":"dfa7befb-4fa4-4c60-a4ef-8778bb294367","name":"Start Telegram Mess Actions","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[-420,1220]},{"parameters":{"mode":"runOnceForEachItem","jsCode":"const smsContent = $('Webhook').first().json.body;\n\nlet message = [];\n\nmessage.push(\n  `<b>${smsContent.from.toUpperCase()}</b>\\n`,\n  `${smsContent.text.toString()}`\n);\n\nreturn {\n  json: {\n    botToken: $input.item.json.botToken,\n    payload: {\n      chat_id: $input.item.json.chatId,\n      parse_mode: 'HTML',\n      text: message.join('\\n'),\n    },\n  },\n};\n"},"id":"92e86b62-6f13-4c19-b013-e7a61f8d492c","name":"Create Telegram Message for OTP","type":"n8n-nodes-base.code","typeVersion":1,"position":[-20,1140]},{"parameters":{"conditions":{"boolean":[{"value1":"={{ $input.item.json.isSend }}","value2":true}]}},"id":"ee4ae9a7-3a0c-420d-bcfa-224e542954ae","name":"ifSend","type":"n8n-nodes-base.if","typeVersion":1,"position":[740,860]},{"parameters":{"conditions":{"boolean":[{"value1":"={{ $input.item.json.isSend }}","value2":true}]}},"id":"eaf3ef69-8ca7-4078-aa97-b6e6c7ddc9e3","name":"ifSend1","type":"n8n-nodes-base.if","typeVersion":1,"position":[700,460]},{"parameters":{"conditions":{"boolean":[{"value1":"={{ $input.item.json.isSend }}","value2":true}]}},"id":"db8e8ac1-b63b-420f-8325-454288e66d21","name":"ifSend2","type":"n8n-nodes-base.if","typeVersion":1,"position":[200,1300]},{"parameters":{"mode":"runOnceForEachItem","jsCode":"const smsContent = $('Webhook').first().json.body;\n\n  // Convert to Lark Base format\n  const records = [\n    {\n      fields: {\n        ID: smsContent.from,\n        Bank: smsContent.from,\n        'Transaction Type': 'OTP',\n        'Transaction Message': smsContent.text.toString(),\n        'Original Message': smsContent.text.toString(),\n        'Time received': smsContent.sentStamp,\n      },\n    },\n  ];\n\n  return {\n    json: {\n      records,\n      configs: {\n        baseId: $input.item.json.baseId,\n        tableId: $input.item.json.tableId,\n      },\n    },\n  };\n"},"id":"d7e0383a-61f8-437b-acf6-1787c53b99d0","name":"Convert to Lark Base format OTP","type":"n8n-nodes-base.code","typeVersion":1,"position":[520,220]},{"parameters":{"conditions":{"string":[{"value1":"={{ $('Webhook').item.json.body.text }}","operation":"contains","value2":"OTP"}],"boolean":[{"value1":"={{ $input.item.json.enableOTP }}","value2":true}]}},"id":"785ac81a-500c-4190-b52a-115d320f7875","name":"ifOTPLarkBase","type":"n8n-nodes-base.if","typeVersion":1,"position":[320,400]},{"parameters":{"conditions":{"string":[{"value1":"={{ $('Webhook').item.json.body.text }}","operation":"contains","value2":"OTP"}],"boolean":[{"value1":"={{ $input.item.json.enableOTP }}","value2":true}]}},"id":"25eb70be-5a8f-4548-9f53-9ed0fd6a0c03","name":"ifOTPLarkMess","type":"n8n-nodes-base.if","typeVersion":1,"position":[280,800]},{"parameters":{"conditions":{"string":[{"value1":"={{ $('Webhook').item.json.body.text }}","operation":"contains","value2":"OTP"}],"boolean":[{"value1":"={{ $input.item.json.enableOTP }}","value2":true}]}},"id":"1a5a98a1-2f1c-470d-b644-b52e4624fecb","name":"ifOTPTelegram","type":"n8n-nodes-base.if","typeVersion":1,"position":[-240,1220]}],"connections":{"Webhook":{"main":[[{"node":"getBankData","type":"main","index":0}]]},"Convert to Lark Message Card":{"main":[[{"node":"ifSend","type":"main","index":0}]]},"Get Lark tenant access token":{"main":[[{"node":"Start Lark Base","type":"main","index":0},{"node":"Start Lark Mess","type":"main","index":0}]]},"Convert to Lark Base format":{"main":[[{"node":"ifSend1","type":"main","index":0}]]},"ifBankSupport":{"main":[[{"node":"Start Actions","type":"main","index":0}]]},"getBankData":{"main":[[{"node":"ifBankSupport","type":"main","index":0}]]},"Start Actions":{"main":[[{"node":"Start Telegram Actions","type":"main","index":0},{"node":"Start Lark Actions","type":"main","index":0}]]},"Create Telegram Message":{"main":[[{"node":"ifSend2","type":"main","index":0}]]},"Set Lark Configs":{"main":[[{"node":"Get Lark tenant access token","type":"main","index":0}]]},"Set Lark Mess Config":{"main":[[{"node":"Start Lark Mess Actions","type":"main","index":0}]]},"Set Lark Base Config":{"main":[[{"node":"Start Lark Base Actions","type":"main","index":0}]]},"Start Lark Actions":{"main":[[{"node":"Set Lark Configs","type":"main","index":0}]]},"Start Lark Base":{"main":[[{"node":"Set Lark Base Config","type":"main","index":0}]]},"Start Lark Mess":{"main":[[{"node":"Set Lark Mess Config","type":"main","index":0}]]},"Start Telegram Actions":{"main":[[{"node":"Set Telegram Config","type":"main","index":0}]]},"Set Telegram Config":{"main":[[{"node":"Start Telegram Mess Actions","type":"main","index":0}]]},"Start Lark Base Actions":{"main":[[{"node":"ifOTPLarkBase","type":"main","index":0}]]},"Start Lark Mess Actions":{"main":[[{"node":"ifOTPLarkMess","type":"main","index":0}]]},"Convert to Message Card for OTP":{"main":[[{"node":"[Lark] Send noti to group chat","type":"main","index":0}]]},"Start Telegram Mess Actions":{"main":[[{"node":"ifOTPTelegram","type":"main","index":0}]]},"Create Telegram Message for OTP":{"main":[[{"node":"Send to Telegram chat","type":"main","index":0}]]},"ifSend":{"main":[[{"node":"[Lark] Send noti to group chat","type":"main","index":0}]]},"ifSend1":{"main":[[{"node":"[SMS Log] Add records to Bitable","type":"main","index":0}]]},"ifSend2":{"main":[[{"node":"Send to Telegram chat","type":"main","index":0}]]},"Convert to Lark Base format OTP":{"main":[[{"node":"[SMS Log] Add records to Bitable","type":"main","index":0}]]},"ifOTPLarkBase":{"main":[[{"node":"Convert to Lark Base format OTP","type":"main","index":0}],[{"node":"Convert to Lark Base format","type":"main","index":0}]]},"ifOTPLarkMess":{"main":[[{"node":"Convert to Message Card for OTP","type":"main","index":0}],[{"node":"Convert to Lark Message Card","type":"main","index":0}]]},"ifOTPTelegram":{"main":[[{"node":"Create Telegram Message for OTP","type":"main","index":0}],[{"node":"Create Telegram Message","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{},"versionId":"bc5a692e-d2bc-4b00-9e9a-a341033594e2","triggerCount":0,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-07-19T07:30:23.109Z","updatedAt":"2023-07-19T11:09:39.000Z","id":"204","name":"QuaTang CMH-CTT","active":true,"nodes":[{"parameters":{"path":"cmh-ctt","options":{"rawBody":true,"responseData":"<style>|\t@media screen and (max-width:480px) {\t\t.main-table {\t\t\twidth: 300px !important; margin: 0 auto;\t\t}\t}</style><table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" style=\"background-color: #f3f3f3; font-family: Arial, Helvetica, sans-serif;\" width=\"100%\">\t<tbody>\t\t<tr>\t\t\t<td align=\"center\">\t\t\t\t<table cellpadding=\"0\" cellspacing=\"0\" class=\"main-table\" style=\"margin: 25px auto; background:#ffffff; -webkit-border-radius: 3px; -moz-border-radius: 3px; border-radius: 3px; -moz-box-shadow: 1px 1px 0 #eaeaea; -webkit-box-shadow: 1px 1px 0 #eaeaea; box-shadow: 1px 1px 0 #eaeaea; width: 500px;\">\t\t\t\t\t<tbody>\t\t\t\t\t\t<tr style=\"border: 0;\">\t\t\t\t\t\t\t<td style=\"padding: 20px; border-top-left-radius: 3px; border-top-right-radius: 3px; text-align: left; border: 0px; background-color: rgb(21, 169, 241);\"><a href=\"https://edu.hitacamp.vn\" style=\"border: none; text-decoration: none; font-size: 22px;\" target=\"_blank\"><span style=\"font-size: 18px;\">&nbsp;<strong><span style=\"color: rgb(255, 255, 255);\">HITA LEARNING</span>&nbsp;</strong></span></a><span style=\"font-size: 18px;\">&zwnj;</span></td>\t\t\t\t\t\t</tr>\t\t\t\t\t\t<tr style=\"border: 0;\">\t\t\t\t\t\t\t<td style=\"padding: 20px; background: #fff; border: 0;\">\t\t\t\t\t\t\t\t<h1><span style=\"font-family: Arial, Helvetica, sans-serif; font-size: 18px;\">Xin ch&agrave;o b·∫°n,</span></h1>\t\t\t\t\t\t\t\t<p><span style=\"font-family: Arial, Helvetica, sans-serif; font-size: 18px;\">Ch&uacute;c m·ª´ng B·∫°n ƒë&atilde; ƒë√£ nh·∫≠n ƒë∆∞·ª£c Kho&aacute; h·ªçc online <strong>CHA M·∫∏ H·ªåC - CON TH√ÄNH T√ÄI</strong>.</span></p>\t\t\t\t\t\t\t\t<p><span style=\"font-family: Arial, Helvetica, sans-serif; font-size: 18px;\">Ngay b&acirc;y gi·ªù, b·∫°n h&atilde;y truy c·∫≠p kho&aacute; h·ªçc ƒë·ªÉ ƒë&oacute;n nh·∫≠n nh·ªØng b&agrave;i h·ªçc, kinh nghi·ªám th&uacute; v·ªã v&agrave; gi&aacute; tr·ªã t·ª´ Th·∫ßy Nguy·ªÖn Ph&ugrave;ng Phong nh&eacute;!</span><span style=\"font-size: 18px;\"><br></span></p>\t\t\t\t\t\t\t</td>\t\t\t\t\t\t</tr>\t\t\t\t\t\t<tr style=\"border: 0;\">\t\t\t\t\t\t\t<td style=\"padding: 20px; background: #fff; border: 0;\">\t\t\t\t\t\t\t\t<div class=\"fr-view\">\t\t\t\t\t\t\t\t\t<div class=\"fr-view\" style=\"margin-bottom: 24px;\">\t\t\t\t\t\t\t\t\t\t<p><span style=\"font-size: 24px;\"><a href=\"https://edu.hitacamp.vn/courses/cha-me-hoc-con-thanh-tai\" rel=\"noopener noreferrer\" target=\"_blank\">B·∫Øt ƒë·∫ßu ngay th&ocirc;i!</a></span></p>\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t<p>------------------------------</p>\t\t\t\t\t\t\t\t\t<style type=\"text/css\" id=\"isPasted\">\t\t\t\t\t\t\t\t\t\tp.p1 {\t\t\t\t\t\t\t\t\t\t\tmargin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px 'Helvetica Neue'\t\t\t\t\t\t\t\t\t\t}\t\t\t\t\t\t\t\t\t</style>\t\t\t\t\t\t\t\t\t<style type=\"text/css\" id=\"isPasted\">\t\t\t\t\t\t\t\t\t\tp.p1 {\t\t\t\t\t\t\t\t\t\t\tmargin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px 'Helvetica Neue'\t\t\t\t\t\t\t\t\t\t}\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tp.p2 {\t\t\t\t\t\t\t\t\t\t\tmargin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px 'Helvetica Neue'; min-height: 14.0px\t\t\t\t\t\t\t\t\t\t}\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tspan.s1 {\t\t\t\t\t\t\t\t\t\t\tfont: 13.0px 'Helvetica Neue'\t\t\t\t\t\t\t\t\t\t}\t\t\t\t\t\t\t\t\t</style>\t\t\t\t\t\t\t\t\t<p><strong>URL ƒëƒÉng nh·∫≠p</strong>: <a href=\"https://edu.hitacamp.vn/users/sign_in\" rel=\"noopener noreferrer\" target=\"_blank\">https://edu.hitacamp.vn/users/sign_in</a></p>\t\t\t\t\t\t\t\t\t<p><strong>Email</strong>: email c·ªßa b·∫°n</p>\t\t\t\t\t\t\t\t\t<p><strong>M·∫≠t kh·∫©u m·∫∑c ƒë·ªãnh</strong>: TG2023@TTL&nbsp;</p>\t\t\t\t\t\t\t\t\t<p>(N·∫øu b·∫°n kh&ocirc;ng ƒëƒÉng nh·∫≠p ƒë∆∞·ª£c v·ªõi m·∫≠t kh·∫©u n&agrave;y, h&atilde;y d&ugrave;ng t&iacute;nh nƒÉng qu&ecirc;n m·∫≠t kh·∫©u: <a href=\"https://edu.hitacamp.vn/users/password/new\" rel=\"noopener noreferrer\" target=\"_blank\">https://edu.hitacamp.vn/users/password/new</a></p>\t\t\t\t\t\t\t\t\t</td>\t\t\t\t\t\t</tr>\t\t\t\t\t</tbody>\t\t\t\t</table>\t\t\t</td>\t\t</tr>\t</tbody></table>"}},"id":"dfe97925-e784-4c69-9379-c8721c167da5","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[600,460],"webhookId":"c29826ca-a8fb-4f1f-9e08-718a3b7ee38c"},{"parameters":{"method":"POST","url":"https://app.n8n.vn/webhook/thinkific","sendBody":true,"bodyParameters":{"parameters":[{"name":"first_name","value":"HV"},{"name":"last_name","value":"={{ $json.hoten }}"},{"name":"email","value":"={{ $json.mail }}"},{"name":"phone","value":"={{ $json.dienthoai }}"},{"name":"type","value":"course"},{"name":"learning_id","value":"2238939"}]},"options":{}},"id":"5aaad3f0-7cf6-4edf-9a82-ade0c1a35631","name":"HTTP Request","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[1300,460]},{"parameters":{"url":"=https://hitacamp.vn/wp-content/plugins/listeruption2/inc/points.php?id={{ $json.query.camp }}&lead={{ $json.query.lead_id }}&token=cggqcdct","options":{"response":{"response":{"responseFormat":"json"}}}},"id":"bb4ffb38-5a64-46ff-b5a0-de0034f89731","name":"HTTP Request1","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[840,460]},{"parameters":{"conditions":{"string":[{"value1":"={{ $json.mail }}","operation":"isNotEmpty"}]}},"id":"b7ef3f08-10ed-4f6f-8acb-e78726f40459","name":"IF","type":"n8n-nodes-base.if","typeVersion":1,"position":[1080,460]}],"connections":{"Webhook":{"main":[[{"node":"HTTP Request1","type":"main","index":0}]]},"HTTP Request1":{"main":[[{"node":"IF","type":"main","index":0}]]},"IF":{"main":[[{"node":"HTTP Request","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{},"versionId":"c7f3f3f6-0290-4b57-8330-372071eaafb6","triggerCount":1,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-07-19T10:47:13.412Z","updatedAt":"2023-07-19T11:13:49.000Z","id":"205","name":"QuaTang Combo PHTT","active":true,"nodes":[{"parameters":{"method":"POST","url":"https://app.n8n.vn/webhook/thinkific","sendBody":true,"bodyParameters":{"parameters":[{"name":"first_name","value":"HV"},{"name":"last_name","value":"={{ $json.hoten }}"},{"name":"email","value":"={{ $json.mail }}"},{"name":"phone","value":"={{ $json.dienthoai }}"},{"name":"type","value":"bundle"},{"name":"learning_id","value":"114378"}]},"options":{}},"id":"c4957396-8768-4d36-8c2f-d120fbb6e65c","name":"HTTP Request","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[1280,460]},{"parameters":{"url":"=https://hitacamp.vn/wp-content/plugins/listeruption2/inc/points.php?id={{ $json.query.camp }}&lead={{ $json.query.lead_id }}&token=cggqcdct","options":{"response":{"response":{"responseFormat":"json"}}}},"id":"e3f69b90-189a-4e24-ac58-e34521e79588","name":"HTTP Request1","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[840,460]},{"parameters":{"path":"combo-phtt","options":{"rawBody":true,"responseData":"<style>|\t@media screen and (max-width:480px) {\t\t.main-table {\t\t\twidth: 300px !important; margin: 0 auto;\t\t}\t}</style><table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" style=\"background-color: #f3f3f3; font-family: Arial, Helvetica, sans-serif;\" width=\"100%\">\t<tbody>\t\t<tr>\t\t\t<td align=\"center\">\t\t\t\t<table cellpadding=\"0\" cellspacing=\"0\" class=\"main-table\" style=\"margin: 25px auto; background:#ffffff; -webkit-border-radius: 3px; -moz-border-radius: 3px; border-radius: 3px; -moz-box-shadow: 1px 1px 0 #eaeaea; -webkit-box-shadow: 1px 1px 0 #eaeaea; box-shadow: 1px 1px 0 #eaeaea; width: 500px;\">\t\t\t\t\t<tbody>\t\t\t\t\t\t<tr style=\"border: 0;\">\t\t\t\t\t\t\t<td style=\"padding: 20px; border-top-left-radius: 3px; border-top-right-radius: 3px; text-align: left; border: 0px; background-color: rgb(21, 169, 241);\"><a href=\"https://edu.hitacamp.vn\" style=\"border: none; text-decoration: none; font-size: 22px;\" target=\"_blank\"><span style=\"font-size: 18px;\">&nbsp;<strong><span style=\"color: rgb(255, 255, 255);\">HITA LEARNING</span>&nbsp;</strong></span></a><span style=\"font-size: 18px;\">&zwnj;</span></td>\t\t\t\t\t\t</tr>\t\t\t\t\t\t<tr style=\"border: 0;\">\t\t\t\t\t\t\t<td style=\"padding: 20px; background: #fff; border: 0;\">\t\t\t\t\t\t\t\t<h1><span style=\"font-family: Arial, Helvetica, sans-serif; font-size: 18px;\">Xin ch&agrave;o b·∫°n,</span></h1>\t\t\t\t\t\t\t\t<p><span style=\"font-family: Arial, Helvetica, sans-serif; font-size: 18px;\">Ch&uacute;c m·ª´ng B·∫°n ƒë&atilde; ƒë√£ nh·∫≠n ƒë∆∞·ª£c Combo Kho&aacute; h·ªçc online <strong>PH·ª§ HUYNH TH√îNG TH√ÅI</strong>.</span></p>\t\t\t\t\t\t\t\t<p><span style=\"font-family: Arial, Helvetica, sans-serif; font-size: 18px;\">Ngay b&acirc;y gi·ªù, b·∫°n h&atilde;y truy c·∫≠p kho&aacute; h·ªçc ƒë·ªÉ ƒë&oacute;n nh·∫≠n nh·ªØng b&agrave;i h·ªçc, kinh nghi·ªám th&uacute; v·ªã v&agrave; gi&aacute; tr·ªã t·ª´ Th·∫ßy Nguy·ªÖn Ph&ugrave;ng Phong nh&eacute;!</span><span style=\"font-size: 18px;\"><br></span></p>\t\t\t\t\t\t\t</td>\t\t\t\t\t\t</tr>\t\t\t\t\t\t<tr style=\"border: 0;\">\t\t\t\t\t\t\t<td style=\"padding: 20px; background: #fff; border: 0;\">\t\t\t\t\t\t\t\t<div class=\"fr-view\">\t\t\t\t\t\t\t\t\t<div class=\"fr-view\" style=\"margin-bottom: 24px;\">\t\t\t\t\t\t\t\t\t\t<p><span style=\"font-size: 24px;\"><a href=\"https://edu.hitacamp.vn/bundles/combo-phu-huynh-thong-thai\" rel=\"noopener noreferrer\" target=\"_blank\">B·∫Øt ƒë·∫ßu ngay th&ocirc;i!</a></span></p>\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t<p>------------------------------</p>\t\t\t\t\t\t\t\t\t<style type=\"text/css\" id=\"isPasted\">\t\t\t\t\t\t\t\t\t\tp.p1 {\t\t\t\t\t\t\t\t\t\t\tmargin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px 'Helvetica Neue'\t\t\t\t\t\t\t\t\t\t}\t\t\t\t\t\t\t\t\t</style>\t\t\t\t\t\t\t\t\t<style type=\"text/css\" id=\"isPasted\">\t\t\t\t\t\t\t\t\t\tp.p1 {\t\t\t\t\t\t\t\t\t\t\tmargin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px 'Helvetica Neue'\t\t\t\t\t\t\t\t\t\t}\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tp.p2 {\t\t\t\t\t\t\t\t\t\t\tmargin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px 'Helvetica Neue'; min-height: 14.0px\t\t\t\t\t\t\t\t\t\t}\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tspan.s1 {\t\t\t\t\t\t\t\t\t\t\tfont: 13.0px 'Helvetica Neue'\t\t\t\t\t\t\t\t\t\t}\t\t\t\t\t\t\t\t\t</style>\t\t\t\t\t\t\t\t\t<p><strong>URL ƒëƒÉng nh·∫≠p</strong>: <a href=\"https://edu.hitacamp.vn/users/sign_in\" rel=\"noopener noreferrer\" target=\"_blank\">https://edu.hitacamp.vn/users/sign_in</a></p>\t\t\t\t\t\t\t\t\t<p><strong>Email</strong>: email c·ªßa b·∫°n</p>\t\t\t\t\t\t\t\t\t<p><strong>M·∫≠t kh·∫©u m·∫∑c ƒë·ªãnh</strong>: TG2023@TTL&nbsp;</p>\t\t\t\t\t\t\t\t\t<p>(N·∫øu b·∫°n kh&ocirc;ng ƒëƒÉng nh·∫≠p ƒë∆∞·ª£c v·ªõi m·∫≠t kh·∫©u n&agrave;y, h&atilde;y d&ugrave;ng t&iacute;nh nƒÉng qu&ecirc;n m·∫≠t kh·∫©u: <a href=\"https://edu.hitacamp.vn/users/password/new\" rel=\"noopener noreferrer\" target=\"_blank\">https://edu.hitacamp.vn/users/password/new</a></p>\t\t\t\t\t\t\t\t\t</td>\t\t\t\t\t\t</tr>\t\t\t\t\t</tbody>\t\t\t\t</table>\t\t\t</td>\t\t</tr>\t</tbody></table>"}},"id":"417dff7f-eeb7-40a8-b6b1-f1ac385b4008","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[600,460],"webhookId":"6ad7ce1e-d32a-4237-bd4f-2bd5dd052b59"},{"parameters":{"conditions":{"string":[{"value1":"={{ $json.mail }}","operation":"isNotEmpty"}]}},"id":"e987da6e-f419-43e4-a0a4-4257f0d3349b","name":"IF","type":"n8n-nodes-base.if","typeVersion":1,"position":[1060,460]}],"connections":{"HTTP Request1":{"main":[[{"node":"IF","type":"main","index":0}]]},"Webhook":{"main":[[{"node":"HTTP Request1","type":"main","index":0}]]},"IF":{"main":[[{"node":"HTTP Request","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{"HTTP Request1":[{"json":{"campaign":"3","hoten":"L√™ H·ªìng Qu√¢n","mail":"lehongquan@gmail.com","date":"July 18, 2023","dienthoai":"0985767138","messid":"","city":"","state":"N/A","address":"N/A","IP":"bfa68a6d375419c1aad66ab82e42adc6","ref_id":"1","lead_id":"18","ref_code":"c18Le","points":"0","views":"37"},"pairedItem":{"item":0}}]},"versionId":"6fcb666b-0c47-4ae8-a384-736ebc304466","triggerCount":1,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-07-19T11:15:06.627Z","updatedAt":"2023-07-19T12:07:56.000Z","id":"206","name":"Viral CMH-CTT 0723","active":true,"nodes":[{"parameters":{"httpMethod":"POST","path":"viral-cmh-ctt-0723","options":{}},"id":"da9bc163-a3cb-4a95-86bb-5bf3c08de476","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[480,420],"webhookId":"d57b1210-7bd7-43c8-8a0f-e1fb5f339314"},{"parameters":{"url":"=https://hitacamp.vn/wp-content/plugins/listeruption2/inc/points.php?id={{ $json.body.campaign }}&lead={{ $json.body.ref_id }}&token=cggqcdct","options":{"response":{"response":{"responseFormat":"json"}}}},"id":"adf3ac1a-d6dd-4fa7-9ca4-81e0265bcc5e","name":"Get Info Ref","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[700,540]},{"parameters":{"method":"POST","url":"=https://app.n8n.vn/webhook/thinkific","sendBody":true,"bodyParameters":{"parameters":[{"name":"first_name","value":"HV"},{"name":"last_name","value":"={{ $json.body.name }}"},{"name":"email","value":"={{ $json.body.email }}"},{"name":"phone","value":"={{ $json.body.phone }}"},{"name":"type","value":"course"},{"name":"learning_id","value":"2238939"}]},"options":{}},"id":"08304083-fd86-4333-8a08-07d4cd95ae73","name":"Enroll Thinkific","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[700,240],"continueOnFail":true},{"parameters":{"method":"POST","url":"=https://api.quanchatbot.com/tamtriluc/add-customer.php","sendBody":true,"contentType":"form-urlencoded","bodyParameters":{"parameters":[{"name":"fullName","value":"={{ $json.hoten }}"},{"name":"phone","value":"={{ $json.dienthoai }}"},{"name":"email","value":"={{ $json.mail }}"},{"name":"ref_Code","value":"=KHT2687302"}]},"options":{"response":{"response":{"responseFormat":"json"}}}},"id":"ee68a4ca-77d3-41d7-ba26-541654e5a67b","name":"Get Code Ref","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[920,540],"continueOnFail":true},{"parameters":{"method":"POST","url":"=https://api.quanchatbot.com/tamtriluc/add-customer.php","sendBody":true,"contentType":"form-urlencoded","bodyParameters":{"parameters":[{"name":"fullName","value":"={{ $('Webhook').item.json.body.name }}"},{"name":"phone","value":"={{ $('Webhook').item.json.body.phone }}"},{"name":"email","value":"={{ $('Webhook').item.json.body.email }}"},{"name":"ref_Code","value":"={{ $json.data.code }}"}]},"options":{"response":{"response":{"responseFormat":"json"}}}},"id":"9e96ffac-3824-429f-bbec-44fff2dbf3f8","name":"Create New Customer","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[1100,540]},{"parameters":{"url":"https://api.quanchatbot.com/tamtriluc/add-customer.php?fullName=Test&phone=0999999996&email=test@email.com","options":{"response":{"response":{"responseFormat":"json"}}}},"id":"da583008-95f0-46cf-94e7-bc8ea9aa3087","name":"HTTP Request","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[920,360],"disabled":true},{"parameters":{"values":{"string":[{"value":"={{ $json.data.code }}"}]},"options":{}},"id":"f08333f1-f074-4f54-8f08-f3379d938680","name":"Set","type":"n8n-nodes-base.set","typeVersion":2,"position":[1140,360],"disabled":true}],"connections":{"Webhook":{"main":[[{"node":"Get Info Ref","type":"main","index":0},{"node":"Enroll Thinkific","type":"main","index":0}]]},"Get Info Ref":{"main":[[{"node":"Get Code Ref","type":"main","index":0}]]},"Get Code Ref":{"main":[[{"node":"Create New Customer","type":"main","index":0}]]},"HTTP Request":{"main":[[]]}},"settings":{},"staticData":null,"pinData":{"Webhook":[{"json":{"headers":{"host":"app.n8n.vn","user-agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.0.0 Safari/537.36","content-length":"101","accept":"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7","accept-encoding":"gzip, deflate, br","accept-language":"en-US,en;q=0.9","cache-control":"max-age=0","content-type":"application/x-www-form-urlencoded","origin":"https://hitacamp.vn","referer":"https://hitacamp.vn/","sec-ch-ua":"\"Not.A/Brand\";v=\"8\", \"Chromium\";v=\"114\", \"Google Chrome\";v=\"114\"","sec-ch-ua-mobile":"?0","sec-ch-ua-platform":"\"Windows\"","sec-fetch-dest":"iframe","sec-fetch-mode":"navigate","sec-fetch-site":"cross-site","upgrade-insecure-requests":"1","x-forwarded-for":"115.79.199.39","x-forwarded-host":"app.n8n.vn","x-forwarded-port":"443","x-forwarded-proto":"https","x-forwarded-server":"f2605f992776","x-real-ip":"115.79.199.39"},"params":{},"query":{},"body":{"name":"Qu√¢n Chatbot","email":"quanchatbot@gmail.com","phone":"0866088807","campaign":"3","lead_id":"19","ref_id":"18"}},"pairedItem":{"item":0}}],"Get Info Ref":[{"json":{"campaign":"3","hoten":"L√™ H·ªìng Qu√¢n","mail":"lehongquan@gmail.com","date":"July 18, 2023","dienthoai":"0985767138","messid":"","city":"","state":"N/A","address":"N/A","IP":"bfa68a6d375419c1aad66ab82e42adc6","ref_id":"","lead_id":"18","ref_code":"c18Le","points":"2","views":"42"},"pairedItem":{"item":0}}]},"versionId":"2b6ae5e3-8255-4d08-9824-f9b38b7d40d0","triggerCount":1,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-07-19T23:52:02.690Z","updatedAt":"2023-07-20T03:17:08.000Z","id":"207","name":"Noti Qua VQMM Webinar 07.23","active":true,"nodes":[{"parameters":{"httpMethod":"POST","path":"vqmm-webinar-0723","options":{}},"id":"c806cbc3-3b56-404a-bf33-896c4feecdc1","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[820,400],"webhookId":"947ff5c8-2a03-4329-9551-359274aa87b3"},{"parameters":{"url":"=https://hitacamp.vn/wp-content/plugins/listeruption2/inc/points.php?id=3&lead={{ $json.body.userId.split(\"-\")[0] }}&token=cggqcdct","options":{"response":{"response":{"responseFormat":"json"}}}},"id":"168a8011-e06f-4b2b-a12b-260ca0bfe403","name":"Get info Lead","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[1040,400]},{"parameters":{"conditions":{"string":[{"value1":"={{ $('Webhook').item.json.body.gift_name }}","operation":"contains","value2":"Th·∫ª c√†o"}]}},"id":"ed923d1e-2089-4b37-bce0-9a06552c8997","name":"Th·∫ª c√†o","type":"n8n-nodes-base.if","typeVersion":1,"position":[1260,240]},{"parameters":{"conditions":{"string":[{"value1":"={{ $('Webhook').item.json.body.gift_name }}","operation":"contains","value2":"Combo 14"}]}},"id":"5e5ff639-22af-48d8-8c31-2f7ddd678563","name":"Combo 14","type":"n8n-nodes-base.if","typeVersion":1,"position":[1260,400]},{"parameters":{"conditions":{"string":[{"value1":"={{ $('Webhook').item.json.body.gift_name }}","operation":"contains","value2":"webinar"}]}},"id":"12e8907b-734e-4387-9468-169e630985f2","name":"webinar","type":"n8n-nodes-base.if","typeVersion":1,"position":[1260,560]},{"parameters":{"method":"POST","url":"https://app.n8n.vn/webhook/thinkific","sendBody":true,"bodyParameters":{"parameters":[{"name":"first_name","value":"HV"},{"name":"last_name","value":"={{ $('Get info Lead').first().json.hoten }}"},{"name":"email","value":"={{ $('Get info Lead').first().json.mail }}"},{"name":"phone","value":"={{ $('Get info Lead').first().json.dienthoai }}"},{"name":"password","value":"TG2023@TTL"},{"name":"type","value":"bundle"},{"name":"learning_id","value":"113803"}]},"options":{}},"id":"d63c520d-8754-4b07-a2b9-4c6616bc47d4","name":"HTTP Request","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[1500,380]},{"parameters":{"chatId":"-832099157","text":"=üéÅC√≥ l∆∞·ª£t quay nh·∫≠n qu√† Webinar 07.23:\n ‚îú Lead_id: {{ $json.lead_id }}\n ‚îú H·ªç t√™n: {{ $json.hoten }}\n ‚îú ƒêi·ªán tho·∫°i: {{ $json.dienthoai }}\n ‚îú Email: {{ $json.mail }}\n ‚îú Qu√† t·∫∑ng: {{ $('Webhook').item.json.body.gift_name }}\n ‚îî Th·ªùi gian: {{ $('Webhook').item.json.body.gift_at.toDate().format('yyyy-MM-dd HH:mm:ss') }}","additionalFields":{}},"id":"21c30bd1-9950-4b30-84c9-c4fdba5bff62","name":"Telegram","type":"n8n-nodes-base.telegram","typeVersion":1,"position":[1260,720],"credentials":{"telegramApi":{"id":"87","name":"hita_5ptb_bot"}}}],"connections":{"Webhook":{"main":[[{"node":"Get info Lead","type":"main","index":0}]]},"Get info Lead":{"main":[[{"node":"Th·∫ª c√†o","type":"main","index":0},{"node":"Combo 14","type":"main","index":0},{"node":"webinar","type":"main","index":0},{"node":"Telegram","type":"main","index":0}]]},"Combo 14":{"main":[[{"node":"HTTP Request","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{"Webhook":[{"json":{"headers":{"host":"app.n8n.vn","user-agent":"axios/0.19.2","content-length":"173","accept":"application/json, text/plain, */*","content-type":"application/json","x-forwarded-for":"34.87.3.106","x-forwarded-host":"app.n8n.vn","x-forwarded-port":"443","x-forwarded-proto":"https","x-forwarded-server":"f2605f992776","x-real-ip":"34.87.3.106","accept-encoding":"gzip"},"params":{},"query":{},"body":{"gift_name":"Th·∫ª c√†o 50k","gift_at":"2023-07-20T01:10:42.193Z","gift_received":"true","gift_id":"5f9fdd23bf17bc6c1869aa81","userId":"18-0985767138-lehongquan@gmail.com"}},"pairedItem":{"item":0}}]},"versionId":"7ec88d2f-a586-4cb8-b802-df8a0c56dc70","triggerCount":1,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-07-20T00:31:04.752Z","updatedAt":"2023-07-24T09:05:10.000Z","id":"208","name":"Open VQMM 07.23","active":true,"nodes":[{"parameters":{"path":"nhan-luot-vqmm-0723","responseMode":"responseNode","options":{}},"id":"66d727e2-0255-435c-bbf0-74c2369f4b3d","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[200,400],"webhookId":"fe8cdabf-17e0-41f3-b0df-03e79b22119c"},{"parameters":{"respondWith":"text","responseBody":"=<!doctype html>\n<html lang=\"en\">\n  <head>\n    <!-- Required meta tags -->\n    <meta charset=\"utf-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\n\n    <!-- Bootstrap CSS -->\n    <link href=\"https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css\" rel=\"stylesheet\" integrity=\"sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3\" crossorigin=\"anonymous\">\n\n    <title>V√≤ng quay may m·∫Øn</title>\n<meta http-equiv=\"Refresh\" content=\"0; url='https://elm.botplus.asia/64b65dd970f9cf178eeb5367?userId={{ $('HTTP Request1').first().json[\"lead_id\"] }}-{{ $('HTTP Request1').first().json[\"dienthoai\"] }}-{{ $('HTTP Request1').first().json[\"mail\"] }}'\" />\n  </head>\n  <body>\n    <h1>ƒêang m·ªü V√≤ng quay may m·∫Øn, xin h√£y ƒë·ª£i...</h1>\n\n    <!-- Optional JavaScript; choose one of the two! -->\n\n    <!-- Option 1: Bootstrap Bundle with Popper -->\n    <script src=\"https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js\" integrity=\"sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p\" crossorigin=\"anonymous\"></script>\n\n    <!-- Option 2: Separate Popper and Bootstrap JS -->\n    <!--\n    <script src=\"https://cdn.jsdelivr.net/npm/@popperjs/core@2.10.2/dist/umd/popper.min.js\" integrity=\"sha384-7+zCNj/IqJ95wo16oMtfsKbZ9ccEh31eOz1HGyDuCQ6wgnyJNSYdrPa03rtR1zdB\" crossorigin=\"anonymous\"></script>\n    <script src=\"https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.min.js\" integrity=\"sha384-QJHtvGhmr9XOIpI6YVutG+2QOK9T+ZnN4kzFN1RtK3zEFEIsxhlmWl5/YESvpZ13\" crossorigin=\"anonymous\"></script>\n    -->\n  </body>\n</html>","options":{"responseHeaders":{"entries":[{"name":"Content-Type","value":"text/html; charset=UTF-8"}]}}},"id":"19a9b153-3c59-410a-aace-94b9ab77de4b","name":"Respond to Webhook","type":"n8n-nodes-base.respondToWebhook","typeVersion":1,"position":[1420,260]},{"parameters":{"method":"POST","url":"https://public.botplus.io/table/64b87f64080dd017aa90575b?secret=5555","sendBody":true,"specifyBody":"json","jsonBody":"={\n  \"findRow\": {\n    \"lead\": \"{{ $('Webhook').item.json[\"query\"][\"lead_id\"] }}\"\n  },\n  \"response\": true\n}","options":{}},"id":"507929a5-d3f5-4630-b34d-5020b9e4306b","name":"HTTP Request","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[680,280],"notesInFlow":false,"alwaysOutputData":true,"continueOnFail":true},{"parameters":{"url":"=https://hitacamp.vn/wp-content/plugins/listeruption2/inc/points.php?id={{ $json.query.camp }}&lead={{ $json.query.lead_id }}&token=cggqcdct","options":{"response":{"response":{"responseFormat":"json"}}}},"id":"bdc69d90-594b-4e49-a658-53af1f3b9de8","name":"HTTP Request1","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[360,400]},{"parameters":{"conditions":{"string":[{"value1":"={{ $json.mail }}","operation":"isNotEmpty"}],"number":[{"value1":"={{ $json.points }}","operation":"largerEqual","value2":10}]}},"id":"fbd236ce-6706-429e-a39d-115674695c53","name":"IF","type":"n8n-nodes-base.if","typeVersion":1,"position":[500,400]},{"parameters":{"respondWith":"text","responseBody":"=<!doctype html>\n<html lang=\"en\">\n  <head>\n    <!-- Required meta tags -->\n    <meta charset=\"utf-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\n\n    <!-- Bootstrap CSS -->\n    <link href=\"https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css\" rel=\"stylesheet\" integrity=\"sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3\" crossorigin=\"anonymous\">\n\n    <title>Hello, world!</title>\n  </head>\n  <body>\n    <h1>Kh√¥ng t√¨m th·∫•y d·ªØ li·ªáu c·ªßa b·∫°n, ho·∫∑c b·∫°n ch∆∞a ƒë·ªß ƒëi·ªÉm ƒë·ªÉ nh·∫≠n l∆∞·ª£t ch∆°i!</h1>\n\n    <!-- Optional JavaScript; choose one of the two! -->\n\n    <!-- Option 1: Bootstrap Bundle with Popper -->\n    <script src=\"https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js\" integrity=\"sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p\" crossorigin=\"anonymous\"></script>\n\n    <!-- Option 2: Separate Popper and Bootstrap JS -->\n    <!--\n    <script src=\"https://cdn.jsdelivr.net/npm/@popperjs/core@2.10.2/dist/umd/popper.min.js\" integrity=\"sha384-7+zCNj/IqJ95wo16oMtfsKbZ9ccEh31eOz1HGyDuCQ6wgnyJNSYdrPa03rtR1zdB\" crossorigin=\"anonymous\"></script>\n    <script src=\"https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.min.js\" integrity=\"sha384-QJHtvGhmr9XOIpI6YVutG+2QOK9T+ZnN4kzFN1RtK3zEFEIsxhlmWl5/YESvpZ13\" crossorigin=\"anonymous\"></script>\n    -->\n  </body>\n</html>","options":{"responseHeaders":{"entries":[{"name":"Content-Type","value":"text/html; charset=UTF-8"}]}}},"id":"8ebcbf33-aa93-4f78-aa8c-abd263757645","name":"Not found Lead_id","type":"n8n-nodes-base.respondToWebhook","typeVersion":1,"position":[680,580]},{"parameters":{"conditions":{"string":[{"value1":"={{ $json.row.lead }}","operation":"isNotEmpty"}]}},"id":"b6dbbb5b-dea6-4f10-ac99-1eff05637150","name":"IF1","type":"n8n-nodes-base.if","typeVersion":1,"position":[860,280]},{"parameters":{"method":"POST","url":"https://public.botplus.io/table/64b87f64080dd017aa90575b?secret=5555","sendBody":true,"specifyBody":"json","jsonBody":"={\n  \"newRow\": {\n    \"lead\": \"{{ $('Webhook').first().json[\"query\"][\"lead_id\"] }}\",\n\"time\": \"{{ $now.format(\"yyyy-MM-dd hh:mm:ss\") }}\"\n  },\n  \"response\": true\n}","options":{}},"id":"808a14c4-6ba6-47ba-a5f8-2c23db565708","name":"Luu Table","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[1020,460]},{"parameters":{"method":"POST","url":"=https://elm.botplus.asia/64b65dd970f9cf178eeb5367?secret=5555&userId={{ $('HTTP Request1').first().json[\"lead_id\"] }}-{{ $('HTTP Request1').first().json[\"dienthoai\"] }}-{{ $('HTTP Request1').first().json[\"mail\"] }}","sendBody":true,"bodyParameters":{"parameters":[{"name":"turnNumber","value":"3"},{"name":"userName","value":"={{ $('HTTP Request1').first().json[\"hoten\"] }}"}]},"options":{}},"id":"a66ecec2-f75d-470a-af2e-0286eaafe616","name":"Them luot quay","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[1220,460]}],"connections":{"Webhook":{"main":[[{"node":"HTTP Request1","type":"main","index":0}]]},"HTTP Request1":{"main":[[{"node":"IF","type":"main","index":0}]]},"IF":{"main":[[{"node":"HTTP Request","type":"main","index":0}],[{"node":"Not found Lead_id","type":"main","index":0}]]},"HTTP Request":{"main":[[{"node":"IF1","type":"main","index":0}]]},"IF1":{"main":[[{"node":"Respond to Webhook","type":"main","index":0}],[{"node":"Luu Table","type":"main","index":0}]]},"Luu Table":{"main":[[{"node":"Them luot quay","type":"main","index":0}]]},"Them luot quay":{"main":[[{"node":"Respond to Webhook","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{"Webhook":[{"json":{"headers":{"host":"app.n8n.vn","user-agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.0.0 Safari/537.36","accept":"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7","accept-encoding":"gzip, deflate, br","accept-language":"en-US,en;q=0.9,vi-VN;q=0.8,vi;q=0.7","cookie":"rl_page_init_referrer=RudderEncrypt%3AU2FsdGVkX1%2Bk6e6eVyykz1shSZQXSorERbwRAL2yEAk%3D; rl_page_init_referring_domain=RudderEncrypt%3AU2FsdGVkX1%2Bg1ISQy3CW5tYMaHSVMpMPs1YkdWl6DUk%3D; n8n-auth=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjVjOTI4YTJlLTE2NjgtNGMzMS1hYTE1LTM1NzM0Yzc0YTM3NiIsImVtYWlsIjoibWFya2V0aW5nLmhpdGFib3RAZ21haWwuY29tIiwicGFzc3dvcmQiOiJhMjM2NjUwM2ZlZmRhYmE2ZTc5MjBlODBiNjY4MThmMWQyMDc1MzVjNmM5YjE0NzRkN2Q4M2JjMWEyMTBiMDY2IiwiaWF0IjoxNjg5NTg1MDkyLCJleHAiOjE2OTAxODk4OTJ9.uC-cGVtXoWz4dUEojrEIk-M8ZLUv9bThB19OVfZj9NI; rl_anonymous_id=RudderEncrypt%3AU2FsdGVkX1%2FKmww8ayBrHCX1TjJIhsuBN6%2FtrckN1bEVXz28tsP0LB%2F%2BdTY8IUSXE8lQRP0hOsa%2FciKHASsejQ%3D%3D; rl_group_id=RudderEncrypt%3AU2FsdGVkX1%2B5PaJSRDoZvMzjFHQbC6NCp4ELdRrPAe0%3D; rl_group_trait=RudderEncrypt%3AU2FsdGVkX1%2Bl0uygmOvlpdLxvdmsPYJtfHHhkrX36iY%3D; rl_user_id=RudderEncrypt%3AU2FsdGVkX19VyjXQzC%2FHrS1WdN%2FAgi37XBRpZeDdLlWetEkibYM%2F6FSa4ufEkrKk9wzh%2Bc5RQ4ndijqvFsD73dq1sYucKxYgwmM%2F5LaxfbIn9ZiYAaWpqDbv7bolNHltheHVWlDtOM0hiFUYxRTadWCUxgdjKJxsKGRgYy8WOFM%3D; rl_trait=RudderEncrypt%3AU2FsdGVkX19e0939UqxCKKjbw5ifT6h6PUIdiXWgQTQGioSkz9fpERD2YvKbO9z0vb8M57nJ6jWkGiBNECz%2FoLMM6rV9V11rrKBAmLj36imDxiX393dtoR4S%2F9VBC5tyxZqD74YGOHwDTViQ9eKMsp%2BN5jAcklaO3r0ZemX%2BRfU%3D; ph_phc_4URIAm1uYfJO7j8kWSe0J8lc8IqnstRLS7Jx8NcakHo_posthog=%7B%22%24active_feature_flags%22%3A%5B%22007_user_motivation%22%2C%22schema-view%22%5D%2C%22%24enabled_feature_flags%22%3A%7B%22007_user_motivation%22%3A%22variant%22%2C%22004_checklist%22%3Afalse%2C%22003_auto_insert_action%22%3Afalse%2C%22schema-view%22%3Atrue%7D%2C%22%24feature_flag_payloads%22%3A%7B%7D%2C%22distinct_id%22%3A%2264a38b9b44838d7f40e62a857615246be15ea55c65a4232ba8f3a75cd176b811%235c928a2e-1668-4c31-aa15-35734c74a376%22%2C%22%24device_id%22%3A%22189631e73ac98410d0-04e37328f28ed4-26031d51-1fa400-189631e73ac98410d0%22%2C%22%24user_state%22%3A%22identified%22%2C%22%24user_id%22%3A%2264a38b9b44838d7f40e62a857615246be15ea55c65a4232ba8f3a75cd176b811%235c928a2e-1668-4c31-aa15-35734c74a376%22%2C%22%24stored_person_properties%22%3A%7B%22instance_id%22%3A%2264a38b9b44838d7f40e62a857615246be15ea55c65a4232ba8f3a75cd176b811%22%2C%22created_at_timestamp%22%3A1689569970679%7D%2C%22%24sesid%22%3A%5B1689812433309%2C%221897091281215b8ca8-05077b77e34f04-26031d51-1fa400-1897091281215b9090%22%2C1689810708498%5D%2C%22%24session_recording_enabled_server_side%22%3Afalse%2C%22%24autocapture_disabled_server_side%22%3Afalse%7D; rl_session=RudderEncrypt%3AU2FsdGVkX1%2FBW5KJvKZ%2Fw8nq0PKbXK3Uh44ytOktUZmnVdxvXjisWIg6cnRhL6y5tqUJHXW2vSBx%2FbTGEGp0BUkcFP1zz68o4PK8yLIJqJuoKTOtpKc95%2B%2FIEfClKkPD5H%2F7sXH4e693ciu8Cs%2BJAg%3D%3D","sec-ch-ua":"\"Not.A/Brand\";v=\"8\", \"Chromium\";v=\"114\", \"Google Chrome\";v=\"114\"","sec-ch-ua-mobile":"?0","sec-ch-ua-platform":"\"Windows\"","sec-fetch-dest":"document","sec-fetch-mode":"navigate","sec-fetch-site":"none","sec-fetch-user":"?1","upgrade-insecure-requests":"1","x-forwarded-for":"115.73.222.88","x-forwarded-host":"app.n8n.vn","x-forwarded-port":"443","x-forwarded-proto":"https","x-forwarded-server":"f2605f992776","x-real-ip":"115.73.222.88"},"params":{},"query":{"lead_id":"18","camp":"3"},"body":{}},"pairedItem":{"item":0}}],"HTTP Request1":[{"json":{"campaign":"3","hoten":"L√™ H·ªìng Qu√¢n","mail":"lehongquan@gmail.com","date":"July 18, 2023","dienthoai":"0985767138","messid":"","city":"","state":"N/A","address":"N/A","IP":"bfa68a6d375419c1aad66ab82e42adc6","ref_id":"","lead_id":"18","ref_code":"c18Le","points":"2","views":"49"},"pairedItem":{"item":0}}]},"versionId":"73227312-fb4f-4633-a28e-405be9463a04","triggerCount":1,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-07-20T02:22:13.107Z","updatedAt":"2023-07-21T04:33:55.000Z","id":"210","name":"da_bank_bot","active":true,"nodes":[{"parameters":{"httpMethod":"POST","path":"da-bank-bot","options":{}},"id":"aa370401-fb19-4d6e-9cdf-35734f4bea77","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[-260,1600],"webhookId":"b459d9da-c462-43e0-880c-12b8d6304763"},{"parameters":{"mode":"runOnceForEachItem","jsCode":"if (\n  ($('getBankData').item.json.result.transactionType.type === '-' &&\n    $input.item.json.enableOutgoing) ||\n  ($('getBankData').item.json.result.transactionType.type === '+' &&\n    $input.item.json.enableIncoming)\n) {\n  const data = $('getBankData').first().json.result;\n\n  let elements = [];\n\n  elements.push({\n    tag: 'div',\n    fields: [\n      {\n        is_short: false,\n        text: {\n          tag: 'lark_md',\n          content: `**Ng√¢n h√†ng**: ${data.bankName.toUpperCase()}`,\n        },\n      },\n      {\n        is_short: false,\n        text: {\n          tag: 'lark_md',\n          content: `**S·ªë t√†i kho·∫£n**: ${data.receiverAccount}`,\n        },\n      },\n      {\n        is_short: false,\n        text: {\n          tag: 'lark_md',\n          content: `**S·ªë d∆∞ thay ƒë·ªïi:** ${data.transactionType.type} ${data.transactionAmount.amountText} VND`,\n        },\n      },\n      {\n        is_short: false,\n        text: {\n          tag: 'lark_md',\n          content: `**N·ªôi dung:** ${data.transactionMessage}`,\n        },\n      },\n    ],\n  });\n\n  // Append transaction ID if exist\n  if (data.transactionId) {\n    elements[0].fields.push({\n      is_short: false,\n      text: {\n        tag: 'lark_md',\n        content: `**M√£ giao d·ªãch:** ${data.transactionId}`,\n      },\n    });\n  }\n\n  // Append received time\n  elements[0].fields.push({\n    is_short: false,\n    text: {\n      tag: 'lark_md',\n      content: `**Th·ªùi gian nh·∫≠n:** ${data.receivedTime.text}`,\n    },\n  });\n\n  // Ki·ªÉm tra enableBalance n·∫øu true th√¨ th√™m ph·∫ßn t·ª≠ \"S·ªë d∆∞ t·∫°m t√≠nh\" v√†o m·∫£ng fields\n  if ($input.item.json.enableBalance) {\n    const balanceIndex = elements[0].fields.findIndex((field) =>\n      field?.text?.content?.includes('S·ªë d∆∞ thay ƒë·ªïi')\n    );\n    if (balanceIndex !== -1) {\n      elements[0].fields.splice(balanceIndex + 1, 0, {\n        is_short: false,\n        text: {\n          tag: 'lark_md',\n          content: `**S·ªë d∆∞ t·∫°m t√≠nh**: ${data.balance.amountText} VND`,\n        },\n      });\n    }\n  }\n\n  // create message card\n  let result = {\n    msg_type: 'interactive',\n    card: {\n      config: {\n        wide_screen_mode: true,\n      },\n      header: {\n        template: data.larkMessConfig?.cardColor ?? 'blue',\n        title: {\n          content: `${data.bankName.toUpperCase()}-${data.receiverAccount} (${\n            data.transactionType.type\n          }) ${data.transactionAmount.amountText}VND`,\n          tag: 'plain_text',\n        },\n      },\n      elements,\n    },\n  };\n\n  return {\n    json: {\n      isSend: true,\n      data: result,\n      customBotURL: $input.item.json.customBotURL,\n    },\n  };\n}\n\nreturn {\n  json: {\n    isSend: false,\n  },\n};\n"},"id":"65146de3-79f8-493b-a6dd-8260859819c0","name":"Convert to Lark Message Card","type":"n8n-nodes-base.code","typeVersion":1,"position":[2040,1640]},{"parameters":{"method":"POST","url":"=https://open.larksuite.com/open-apis/auth/v3/tenant_access_token/internal/","sendBody":true,"specifyBody":"json","jsonBody":"={ \"app_id\" : \"{{ $input.item.json[\"appId\"] }}\", \"app_secret\" : \"{{ $input.item.json[\"appSecret\"] }}\" }","options":{}},"id":"ead4649d-6005-49b8-bb68-5c72d814b67b","name":"Get Lark tenant access token","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[980,1340]},{"parameters":{"method":"POST","url":"={{ $input.item.json.customBotURL }}","sendBody":true,"specifyBody":"json","jsonBody":"={{ JSON.stringify($input.item.json.data)}}","options":{}},"id":"427bc753-37da-4468-9287-8194f9d0a4e7","name":"[Lark] Send noti to group chat","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[2460,1500]},{"parameters":{"mode":"runOnceForEachItem","jsCode":"if (\n  ($('getBankData').item.json.result.transactionType.type === '-' &&\n    $input.item.json.enableOutgoing) ||\n  ($('getBankData').item.json.result.transactionType.type === '+' &&\n    $input.item.json.enableIncoming)\n) {\n  const data = $('getBankData').first().json.result;\n\n  // Convert to Lark Base format\n  const records = [\n    {\n      fields: {\n        ID: data.bankName + '-' + data.receiverAccount,\n        Bank: data.bankName.toUpperCase(),\n        Account: data.receiverAccount,\n        'Transaction Type': data.transactionType.typeText,\n        Debit:\n          data.transactionType.type === '+'\n            ? data.transactionAmount.amount\n            : undefined,\n        Credit:\n          data.transactionType.type === '-'\n            ? data.transactionAmount.amount\n            : undefined,\n        'Transaction ID': data.transactionId,\n        'Transaction Message': data.transactionMessage,\n        'Original Message': data.originalMessage,\n        'Time received': data.receivedTime.timestamp,\n      },\n    },\n  ];\n\n  // Ki·ªÉm tra enableBalance n·∫øu true th√¨ th√™m ph·∫ßn t·ª≠ \"Balance\" v√†o m·∫£ng fields\n  if ($input.item.json.enableBalance) {\n    records[0].fields = {\n      ...records[0].fields,\n      Balance: data.balance.amount,\n    };\n  }\n\n  return {\n    json: {\n      isSend: true,\n      records,\n      configs: {\n        baseId: $input.item.json.baseId,\n        tableId: $input.item.json.tableId,\n      },\n    },\n  };\n}\n\nreturn {\n  json: {\n    isSend: false,\n  },\n};\n"},"id":"5b315515-3e5e-4a74-a9db-6565f4a6cf23","name":"Convert to Lark Base format","type":"n8n-nodes-base.code","typeVersion":1,"position":[2020,1240]},{"parameters":{"method":"POST","url":"=https://open.larksuite.com/open-apis/bitable/v1/apps/{{ $json[\"configs\"][\"baseId\"] }}/tables/{{  $json[\"configs\"][\"tableId\"]}}/records/batch_create","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $node[\"Get Lark tenant access token\"].json.tenant_access_token }}"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\"records\":{{ JSON.stringify($json[\"records\"]) }}}","options":{}},"id":"6649a3f5-e0ae-43b5-859a-437dad00af61","name":"[SMS Log] Add records to Bitable","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[2440,1180]},{"parameters":{"conditions":{"boolean":[{"value1":"={{ $json.isBankSupport }}","value2":true}]}},"id":"687b885e-ff1d-42e0-8826-9918287ed714","name":"ifBankSupport","type":"n8n-nodes-base.if","typeVersion":1,"position":[160,1600]},{"parameters":{"method":"POST","url":"https://app.n8n.vn/webhook/kdigi-bank-bot-process-data","sendBody":true,"specifyBody":"json","jsonBody":"={{ JSON.stringify($input.first().json.body) }}","options":{}},"id":"c419ca0d-43eb-4783-8ecf-51c2396a6cd3","name":"getBankData","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[-60,1600]},{"parameters":{},"id":"02135bcb-8499-40ac-b32c-776696a5adc4","name":"Start Actions","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[380,1580]},{"parameters":{"mode":"runOnceForEachItem","jsCode":"if (\n  ($('getBankData').item.json.result.transactionType.type === '-' &&\n    $input.item.json.enableOutgoing) ||\n  ($('getBankData').item.json.result.transactionType.type === '+' &&\n    $input.item.json.enableIncoming)\n) {\n  const data = $('getBankData').first().json.result;\n\n  let message = [];\n\n  message.push(\n    `<b>${data.bankName.toUpperCase()}-${data.receiverAccount} (${\n      data.transactionType.type\n    }) ${data.transactionAmount.amountText}VND</b>\\n`,\n    `<b>Ng√¢n h√†ng:</b> ${data.bankName.toUpperCase()}`,\n    `<b>S·ªë t√†i kho·∫£n:</b> ${data.receiverAccount}`,\n    `<b>S·ªë d∆∞ thay ƒë·ªïi:</b> ${data.transactionType.type} ${data.transactionAmount.amountText} VND`\n  );\n\n  // Add balance\n  if ($input.item.json.enableBalance) {\n    message.push(`<b>S·ªë d∆∞ t·∫°m t√≠nh:</b> ${data.balance.amountText} VND`);\n  }\n\n  message.push(`<b>N·ªôi dung:</b>\\n ${data.transactionMessage}`);\n\n  // Check transaction ID\n  if (data.transactionId) {\n    message.push(`<b>M√£ giao d·ªãch:</b> ${data.transactionId}`);\n  }\n\n  message.push(`<b>Th·ªùi gian nh·∫≠n:</b> ${data.receivedTime.text}`);\n\n  return {\n    json: {\n      isSend: true,\n      botToken: $input.item.json.botToken,\n      payload: {\n        chat_id: $input.item.json.chatId,\n        parse_mode: 'HTML',\n        text: message.join('\\n'),\n      },\n    },\n  };\n}\n\nreturn {\n  json: {\n    isSend: false,\n  },\n};\n"},"id":"b0d9e746-4976-4d3f-8c8b-f941e4dd2246","name":"Create Telegram Message","type":"n8n-nodes-base.code","typeVersion":1,"position":[1480,2080]},{"parameters":{"method":"POST","url":"=https://api.telegram.org/bot{{ $input.item.json.botToken }}/sendMessage ","sendBody":true,"specifyBody":"json","jsonBody":"={{ JSON.stringify($input.item.json.payload) }}","options":{}},"id":"06c66190-5a86-43dd-b793-dfaa34f2618b","name":"Send to Telegram chat","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[1940,2000]},{"parameters":{"values":{"string":[{"name":"appId","value":"cli_a433b1fc86b8d010"},{"name":"appSecret","value":"67vJJE2qavoe3E3hNzaDWfJ6fxOMouxy"}],"number":[{}]},"options":{}},"id":"da34ef91-9c59-4eee-9197-4647512d2de2","name":"Set Lark Configs","type":"n8n-nodes-base.set","typeVersion":2,"position":[800,1340]},{"parameters":{"values":{"string":[{"name":"customBotURL","value":"https://open.larksuite.com/open-apis/bot/v2/hook/30bdba70-ba3a-448b-aa23-a6d8d28ee313"}],"boolean":[{"name":"enableBalance"},{"name":"enableOTP"},{"name":"enableOutgoing"},{"name":"enableIncoming","value":true}]},"options":{}},"id":"feb94974-5548-493e-a9d9-e712cbe98d32","name":"Set Lark Mess Config","type":"n8n-nodes-base.set","typeVersion":2,"position":[1400,1600]},{"parameters":{"values":{"string":[{"name":"baseId","value":"QNRlbe0W5aDO3MsllwmlB26jgeb"},{"name":"tableId","value":"tblw7dlyY8tXHkmH"}],"boolean":[{"name":"enableBalance","value":true},{"name":"enableOTP"},{"name":"enableOutgoing","value":true},{"name":"enableIncoming","value":true}]},"options":{}},"id":"2995bd5b-0a91-4bec-8976-ed402b2a9ada","name":"Set Lark Base Config","type":"n8n-nodes-base.set","typeVersion":2,"position":[1420,1200]},{"parameters":{},"id":"161bf7e1-3e1e-45a2-86a7-be51ee52d001","name":"Start Lark Actions","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[640,1340]},{"parameters":{},"id":"5c61d3d9-2c40-4c0d-818f-c80d9f02d96e","name":"Start Lark Base","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[1200,1200]},{"parameters":{},"id":"7a113a75-8e47-49fc-8f67-2b8cd2bd9eb5","name":"Start Lark Mess","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[1180,1600]},{"parameters":{},"id":"a4827fa7-2635-4ab0-ae3f-e7bc70f66e7d","name":"Start Telegram Actions","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[680,2000]},{"parameters":{"values":{"string":[{"name":"botToken","value":"6298161185:AAF7NpLGQ_-hKSt5NeDUlJEGsRg1htFqE84"},{"name":"chatId","value":"-977173652"}],"boolean":[{"name":"enableBalance"},{"name":"enableOTP"},{"name":"enableOutgoing"},{"name":"enableIncoming","value":true}]},"options":{}},"id":"2ff79e6d-9968-4104-914e-38422c4d51a7","name":"Set Telegram Config","type":"n8n-nodes-base.set","typeVersion":2,"position":[880,2000]},{"parameters":{},"id":"7606c1e1-5a57-436c-a275-733cec0e2e4d","name":"Start Lark Base Actions","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[1640,1180]},{"parameters":{},"id":"62e27db0-2f6a-4b8f-8f8a-53312ca556d4","name":"Start Lark Mess Actions","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[1620,1580]},{"parameters":{"mode":"runOnceForEachItem","jsCode":"const smsContent = $('Webhook').first().json.body;\n\n// create message card\nlet result = {\n  msg_type: 'text',\n  content: {\n    text: `T·ª´: ${smsContent.from}\\n${smsContent.text.toString()}`,\n  },\n};\n\nreturn {\n  json: {\n    data: result,\n    customBotURL: $input.item.json.customBotURL,\n  },\n};\n"},"id":"8c0fe066-dea5-4cdc-b5f0-272345b3efeb","name":"Convert to Message Card for OTP","type":"n8n-nodes-base.code","typeVersion":1,"position":[2040,1480]},{"parameters":{},"id":"53d31011-d3aa-4f62-b476-068259e7109f","name":"Start Telegram Mess Actions","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[1080,2000]},{"parameters":{"mode":"runOnceForEachItem","jsCode":"const smsContent = $('Webhook').first().json.body;\n\nlet message = [];\n\nmessage.push(\n  `<b>${smsContent.from.toUpperCase()}</b>\\n`,\n  `${smsContent.text.toString()}`\n);\n\nreturn {\n  json: {\n    botToken: $input.item.json.botToken,\n    payload: {\n      chat_id: $input.item.json.chatId,\n      parse_mode: 'HTML',\n      text: message.join('\\n'),\n    },\n  },\n};\n"},"id":"047d454f-5f7b-4518-916d-42e135a3651f","name":"Create Telegram Message for OTP","type":"n8n-nodes-base.code","typeVersion":1,"position":[1480,1920]},{"parameters":{"conditions":{"boolean":[{"value1":"={{ $input.item.json.isSend }}","value2":true}]}},"id":"999ed1d1-435e-45e7-b963-b206b92d24f0","name":"ifSend","type":"n8n-nodes-base.if","typeVersion":1,"position":[2240,1640]},{"parameters":{"conditions":{"boolean":[{"value1":"={{ $input.item.json.isSend }}","value2":true}]}},"id":"af71b16c-d88e-4996-ab91-c90467be4d51","name":"ifSend1","type":"n8n-nodes-base.if","typeVersion":1,"position":[2200,1240]},{"parameters":{"conditions":{"boolean":[{"value1":"={{ $input.item.json.isSend }}","value2":true}]}},"id":"04b304b7-ce94-4b97-ad59-e3ff51df1a64","name":"ifSend2","type":"n8n-nodes-base.if","typeVersion":1,"position":[1700,2080]},{"parameters":{"mode":"runOnceForEachItem","jsCode":"const smsContent = $('Webhook').first().json.body;\n\n  // Convert to Lark Base format\n  const records = [\n    {\n      fields: {\n        ID: smsContent.from,\n        Bank: smsContent.from,\n        'Transaction Type': 'OTP',\n        'Transaction Message': smsContent.text.toString(),\n        'Original Message': smsContent.text.toString(),\n        'Time received': smsContent.sentStamp,\n      },\n    },\n  ];\n\n  return {\n    json: {\n      records,\n      configs: {\n        baseId: $input.item.json.baseId,\n        tableId: $input.item.json.tableId,\n      },\n    },\n  };\n"},"id":"404d0073-8f91-4e6b-9845-90c01988bfb9","name":"Convert to Lark Base format OTP","type":"n8n-nodes-base.code","typeVersion":1,"position":[2020,1000]},{"parameters":{"conditions":{"string":[{"value1":"={{ $('Webhook').item.json.body.text }}","operation":"contains","value2":"OTP"}],"boolean":[{"value1":"={{ $input.item.json.enableOTP }}","value2":true}]}},"id":"7b8f1eb0-2bba-4e22-83d0-598217731307","name":"ifOTPLarkBase","type":"n8n-nodes-base.if","typeVersion":1,"position":[1820,1180]},{"parameters":{"conditions":{"string":[{"value1":"={{ $('Webhook').item.json.body.text }}","operation":"contains","value2":"OTP"}],"boolean":[{"value1":"={{ $input.item.json.enableOTP }}","value2":true}]}},"id":"c45cdb35-f4d7-414f-9426-b0bde3ffc77d","name":"ifOTPLarkMess","type":"n8n-nodes-base.if","typeVersion":1,"position":[1780,1580]},{"parameters":{"conditions":{"string":[{"value1":"={{ $('Webhook').item.json.body.text }}","operation":"contains","value2":"OTP"}],"boolean":[{"value1":"={{ $input.item.json.enableOTP }}","value2":true}]}},"id":"e8019257-bdef-4704-9058-81c58b6d4d38","name":"ifOTPTelegram","type":"n8n-nodes-base.if","typeVersion":1,"position":[1260,2000]}],"connections":{"Webhook":{"main":[[{"node":"getBankData","type":"main","index":0}]]},"Convert to Lark Message Card":{"main":[[{"node":"ifSend","type":"main","index":0}]]},"Get Lark tenant access token":{"main":[[{"node":"Start Lark Base","type":"main","index":0},{"node":"Start Lark Mess","type":"main","index":0}]]},"Convert to Lark Base format":{"main":[[{"node":"ifSend1","type":"main","index":0}]]},"ifBankSupport":{"main":[[{"node":"Start Actions","type":"main","index":0}]]},"getBankData":{"main":[[{"node":"ifBankSupport","type":"main","index":0}]]},"Start Actions":{"main":[[{"node":"Start Telegram Actions","type":"main","index":0},{"node":"Start Lark Actions","type":"main","index":0}]]},"Create Telegram Message":{"main":[[{"node":"ifSend2","type":"main","index":0}]]},"Set Lark Configs":{"main":[[{"node":"Get Lark tenant access token","type":"main","index":0}]]},"Set Lark Mess Config":{"main":[[{"node":"Start Lark Mess Actions","type":"main","index":0}]]},"Set Lark Base Config":{"main":[[{"node":"Start Lark Base Actions","type":"main","index":0}]]},"Start Lark Actions":{"main":[[{"node":"Set Lark Configs","type":"main","index":0}]]},"Start Lark Base":{"main":[[{"node":"Set Lark Base Config","type":"main","index":0}]]},"Start Lark Mess":{"main":[[{"node":"Set Lark Mess Config","type":"main","index":0}]]},"Start Telegram Actions":{"main":[[{"node":"Set Telegram Config","type":"main","index":0}]]},"Set Telegram Config":{"main":[[{"node":"Start Telegram Mess Actions","type":"main","index":0}]]},"Start Lark Base Actions":{"main":[[{"node":"ifOTPLarkBase","type":"main","index":0}]]},"Start Lark Mess Actions":{"main":[[{"node":"ifOTPLarkMess","type":"main","index":0}]]},"Convert to Message Card for OTP":{"main":[[{"node":"[Lark] Send noti to group chat","type":"main","index":0}]]},"Start Telegram Mess Actions":{"main":[[{"node":"ifOTPTelegram","type":"main","index":0}]]},"Create Telegram Message for OTP":{"main":[[{"node":"Send to Telegram chat","type":"main","index":0}]]},"ifSend":{"main":[[{"node":"[Lark] Send noti to group chat","type":"main","index":0}]]},"ifSend1":{"main":[[{"node":"[SMS Log] Add records to Bitable","type":"main","index":0}]]},"ifSend2":{"main":[[{"node":"Send to Telegram chat","type":"main","index":0}]]},"Convert to Lark Base format OTP":{"main":[[{"node":"[SMS Log] Add records to Bitable","type":"main","index":0}]]},"ifOTPLarkBase":{"main":[[{"node":"Convert to Lark Base format OTP","type":"main","index":0}],[{"node":"Convert to Lark Base format","type":"main","index":0}]]},"ifOTPLarkMess":{"main":[[{"node":"Convert to Message Card for OTP","type":"main","index":0}],[{"node":"Convert to Lark Message Card","type":"main","index":0}]]},"ifOTPTelegram":{"main":[[{"node":"Create Telegram Message for OTP","type":"main","index":0}],[{"node":"Create Telegram Message","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{},"versionId":"f9ab0849-950b-4dc8-aaa8-f9954517e743","triggerCount":1,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-07-20T05:32:10.348Z","updatedAt":"2023-07-20T16:14:48.000Z","id":"213","name":"[DC Media] Nh·∫≠n chuy·ªÉn kho·∫£n","active":true,"nodes":[{"parameters":{"httpMethod":"POST","path":"dcmedia-bank-bot","options":{}},"id":"9c73a054-6972-4914-9b54-0a7b7807766e","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[-1860,1200],"webhookId":"b459d9da-c462-43e0-880c-12b8d6304763"},{"parameters":{"mode":"runOnceForEachItem","jsCode":"if (\n  ($('getBankData').item.json.result.transactionType.type === '-' &&\n    $input.item.json.enableOutgoing) ||\n  ($('getBankData').item.json.result.transactionType.type === '+' &&\n    $input.item.json.enableIncoming)\n) {\n  const data = $('getBankData').first().json.result;\n\n  let elements = [];\n\n  elements.push({\n    tag: 'div',\n    fields: [\n      {\n        is_short: false,\n        text: {\n          tag: 'lark_md',\n          content: `**Ng√¢n h√†ng**: ${data.bankName.toUpperCase()}`,\n        },\n      },\n      {\n        is_short: false,\n        text: {\n          tag: 'lark_md',\n          content: `**S·ªë t√†i kho·∫£n**: ${data.receiverAccount}`,\n        },\n      },\n      {\n        is_short: false,\n        text: {\n          tag: 'lark_md',\n          content: `**S·ªë d∆∞ thay ƒë·ªïi:** ${data.transactionType.type} ${data.transactionAmount.amountText} VND`,\n        },\n      },\n      {\n        is_short: false,\n        text: {\n          tag: 'lark_md',\n          content: `**N·ªôi dung:** ${data.transactionMessage}`,\n        },\n      },\n    ],\n  });\n\n  // Append transaction ID if exist\n  if (data.transactionId) {\n    elements[0].fields.push({\n      is_short: false,\n      text: {\n        tag: 'lark_md',\n        content: `**M√£ giao d·ªãch:** ${data.transactionId}`,\n      },\n    });\n  }\n\n  // Append received time\n  elements[0].fields.push({\n    is_short: false,\n    text: {\n      tag: 'lark_md',\n      content: `**Th·ªùi gian nh·∫≠n:** ${data.receivedTime.text}`,\n    },\n  });\n\n  // Ki·ªÉm tra enableBalance n·∫øu true th√¨ th√™m ph·∫ßn t·ª≠ \"S·ªë d∆∞ t·∫°m t√≠nh\" v√†o m·∫£ng fields\n  if ($input.item.json.enableBalance) {\n    const balanceIndex = elements[0].fields.findIndex((field) =>\n      field?.text?.content?.includes('S·ªë d∆∞ thay ƒë·ªïi')\n    );\n    if (balanceIndex !== -1) {\n      elements[0].fields.splice(balanceIndex + 1, 0, {\n        is_short: false,\n        text: {\n          tag: 'lark_md',\n          content: `**S·ªë d∆∞ t·∫°m t√≠nh**: ${data.balance.amountText} VND`,\n        },\n      });\n    }\n  }\n\n  // create message card\n  let result = {\n    msg_type: 'interactive',\n    card: {\n      config: {\n        wide_screen_mode: true,\n      },\n      header: {\n        template: data.larkMessConfig?.cardColor ?? 'blue',\n        title: {\n          content: `${data.bankName.toUpperCase()}-${data.receiverAccount} (${\n            data.transactionType.type\n          }) ${data.transactionAmount.amountText}VND`,\n          tag: 'plain_text',\n        },\n      },\n      elements,\n    },\n  };\n\n  return {\n    json: {\n      isSend: true,\n      data: result,\n      customBotURL: $input.item.json.customBotURL,\n    },\n  };\n}\n\nreturn {\n  json: {\n    isSend: false,\n  },\n};\n"},"id":"4fb0225f-fb63-4fb6-b098-94c1ecba8b02","name":"Convert to Lark Message Card","type":"n8n-nodes-base.code","typeVersion":1,"position":[440,1240]},{"parameters":{"method":"POST","url":"=https://open.larksuite.com/open-apis/auth/v3/tenant_access_token/internal/","sendBody":true,"specifyBody":"json","jsonBody":"={ \"app_id\" : \"{{ $input.item.json[\"appId\"] }}\", \"app_secret\" : \"{{ $input.item.json[\"appSecret\"] }}\" }","options":{}},"id":"afef7d70-c6d4-4d88-909f-45ec96e8e5ac","name":"Get Lark tenant access token","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[-620,940]},{"parameters":{"method":"POST","url":"={{ $input.item.json.customBotURL }}","sendBody":true,"specifyBody":"json","jsonBody":"={{ JSON.stringify($input.item.json.data)}}","options":{}},"id":"76b54eac-8db2-48bf-bbb0-40057b1025f3","name":"[Lark] Send noti to group chat","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[860,1100]},{"parameters":{"mode":"runOnceForEachItem","jsCode":"if (\n  ($('getBankData').item.json.result.transactionType.type === '-' &&\n    $input.item.json.enableOutgoing) ||\n  ($('getBankData').item.json.result.transactionType.type === '+' &&\n    $input.item.json.enableIncoming)\n) {\n  const data = $('getBankData').first().json.result;\n\n  // Convert to Lark Base format\n  const records = [\n    {\n      fields: {\n        ID: data.bankName + '-' + data.receiverAccount,\n        Bank: data.bankName.toUpperCase(),\n        Account: data.receiverAccount,\n        'Transaction Type': data.transactionType.typeText,\n        Debit:\n          data.transactionType.type === '+'\n            ? data.transactionAmount.amount\n            : undefined,\n        Credit:\n          data.transactionType.type === '-'\n            ? data.transactionAmount.amount\n            : undefined,\n        'Transaction ID': data.transactionId,\n        'Transaction Message': data.transactionMessage,\n        'Original Message': data.originalMessage,\n        'Time received': data.receivedTime.timestamp,\n      },\n    },\n  ];\n\n  // Ki·ªÉm tra enableBalance n·∫øu true th√¨ th√™m ph·∫ßn t·ª≠ \"Balance\" v√†o m·∫£ng fields\n  if ($input.item.json.enableBalance) {\n    records[0].fields = {\n      ...records[0].fields,\n      Balance: data.balance.amount,\n    };\n  }\n\n  return {\n    json: {\n      isSend: true,\n      records,\n      configs: {\n        baseId: $input.item.json.baseId,\n        tableId: $input.item.json.tableId,\n      },\n    },\n  };\n}\n\nreturn {\n  json: {\n    isSend: false,\n  },\n};\n"},"id":"92725260-21ed-4a54-954b-b4979769b59b","name":"Convert to Lark Base format","type":"n8n-nodes-base.code","typeVersion":1,"position":[420,840]},{"parameters":{"method":"POST","url":"=https://open.larksuite.com/open-apis/bitable/v1/apps/{{ $json[\"configs\"][\"baseId\"] }}/tables/{{  $json[\"configs\"][\"tableId\"]}}/records/batch_create","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $node[\"Get Lark tenant access token\"].json.tenant_access_token }}"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\"records\":{{ JSON.stringify($json[\"records\"]) }}}","options":{}},"id":"825f31ba-a961-464f-b5a2-46eb6896331e","name":"[SMS Log] Add records to Bitable","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[840,780]},{"parameters":{"conditions":{"boolean":[{"value1":"={{ $json.isBankSupport }}","value2":true}]}},"id":"6b99acad-2041-4164-9a24-e45b4f1488e7","name":"ifBankSupport","type":"n8n-nodes-base.if","typeVersion":1,"position":[-1440,1200]},{"parameters":{"method":"POST","url":"https://app.n8n.vn/webhook/kdigi-bank-bot-process-data","sendBody":true,"specifyBody":"json","jsonBody":"={{ JSON.stringify($input.first().json.body) }}","options":{}},"id":"879801c1-a77f-444e-a348-57e2e78c16cc","name":"getBankData","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[-1660,1200]},{"parameters":{},"id":"09ab6654-2a2e-4402-8a77-db0313f13158","name":"Start Actions","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[-1240,1180]},{"parameters":{"mode":"runOnceForEachItem","jsCode":"if (\n  ($('getBankData').item.json.result.transactionType.type === '-' &&\n    $input.item.json.enableOutgoing) ||\n  ($('getBankData').item.json.result.transactionType.type === '+' &&\n    $input.item.json.enableIncoming)\n) {\n  const data = $('getBankData').first().json.result;\n\n  let message = [];\n\n  message.push(\n    `<b>${data.bankName.toUpperCase()}-${data.receiverAccount} (${\n      data.transactionType.type\n    }) ${data.transactionAmount.amountText}VND</b>\\n`,\n    `<b>Ng√¢n h√†ng:</b> ${data.bankName.toUpperCase()}`,\n    `<b>S·ªë t√†i kho·∫£n:</b> ${data.receiverAccount}`,\n    `<b>S·ªë d∆∞ thay ƒë·ªïi:</b> ${data.transactionType.type} ${data.transactionAmount.amountText} VND`\n  );\n\n  // Add balance\n  if ($input.item.json.enableBalance) {\n    message.push(`<b>S·ªë d∆∞ t·∫°m t√≠nh:</b> ${data.balance.amountText} VND`);\n  }\n\n  message.push(`<b>N·ªôi dung:</b>\\n ${data.transactionMessage}`);\n\n  // Check transaction ID\n  if (data.transactionId) {\n    message.push(`<b>M√£ giao d·ªãch:</b> ${data.transactionId}`);\n  }\n\n  message.push(`<b>Th·ªùi gian nh·∫≠n:</b> ${data.receivedTime.text}`);\n\n  return {\n    json: {\n      isSend: true,\n      botToken: $input.item.json.botToken,\n      payload: {\n        chat_id: $input.item.json.chatId,\n        parse_mode: 'HTML',\n        text: message.join('\\n'),\n      },\n    },\n  };\n}\n\nreturn {\n  json: {\n    isSend: false,\n  },\n};\n"},"id":"e1384b70-bb87-4379-9ef2-0ad900d87d65","name":"Create Telegram Message","type":"n8n-nodes-base.code","typeVersion":1,"position":[-120,1680]},{"parameters":{"method":"POST","url":"=https://api.telegram.org/bot{{ $input.item.json.botToken }}/sendMessage ","sendBody":true,"specifyBody":"json","jsonBody":"={{ JSON.stringify($input.item.json.payload) }}","options":{}},"id":"970f1a66-e160-424c-a15e-766e3bec3b47","name":"Send to Telegram chat","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[340,1600]},{"parameters":{"values":{"string":[{"name":"appId","value":"cli_a4054c355978d009"},{"name":"appSecret","value":"gIBdgOBBQVCQeRpQw1y7Zencd2sOqigf"}]},"options":{}},"id":"34b7a335-237c-4e6d-8606-0046da108888","name":"Set Lark Configs","type":"n8n-nodes-base.set","typeVersion":2,"position":[-800,940]},{"parameters":{"values":{"string":[{"name":"customBotURL","value":"https://open.larksuite.com/open-apis/bot/v2/hook/bceec975-568b-4918-8e46-78cd5cb9e0c0"}],"boolean":[{"name":"enableBalance"},{"name":"enableOTP"},{"name":"enableOutgoing"},{"name":"enableIncoming","value":true}]},"options":{}},"id":"16183a44-f42f-4381-b442-e440f7a80431","name":"Set Lark Mess Config","type":"n8n-nodes-base.set","typeVersion":2,"position":[-200,1200]},{"parameters":{"values":{"string":[{"name":"baseId","value":"QgjqbjcZTadaV8sOKvIuuyb3sue"},{"name":"tableId","value":"tbl9sSLAu37au2qP"}],"boolean":[{"name":"enableBalance","value":true},{"name":"enableOTP","value":true},{"name":"enableOutgoing","value":true},{"name":"enableIncoming","value":true}]},"options":{}},"id":"310c3654-da19-4908-b1dc-4975688edfdc","name":"Set Lark Base Config","type":"n8n-nodes-base.set","typeVersion":2,"position":[-180,800]},{"parameters":{},"id":"e80f6afa-bc31-4ac1-8258-1f6a3b670e66","name":"Start Lark Actions","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[-960,940]},{"parameters":{},"id":"2e7cb2d7-9f1f-4a0f-a857-123768564e9e","name":"Start Lark Base","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[-400,800]},{"parameters":{},"id":"665ce889-7b55-4af2-bde4-685f9bcbdf07","name":"Start Lark Mess","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[-420,1200]},{"parameters":{},"id":"e36c0526-b0e6-41fb-b660-1a7cd5885edc","name":"Start Telegram Actions","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[-920,1600]},{"parameters":{"values":{"string":[{"name":"botToken","value":"set-bot-token"},{"name":"chatId","value":"set-chat-id"}],"boolean":[{"name":"enableBalance","value":true},{"name":"enableOTP","value":true},{"name":"enableOutgoing","value":true},{"name":"enableIncoming","value":true}]},"options":{}},"id":"3ba1be6c-204f-4100-a78b-113090bce899","name":"Set Telegram Config","type":"n8n-nodes-base.set","typeVersion":2,"position":[-720,1600]},{"parameters":{},"id":"89050dfa-d3fb-4503-8bc3-ac9c8c54aca8","name":"Start Lark Base Actions","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[40,780]},{"parameters":{},"id":"0ed7aec3-d88b-4cd5-9edc-563d13176c30","name":"Start Lark Mess Actions","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[20,1180]},{"parameters":{"mode":"runOnceForEachItem","jsCode":"const smsContent = $('Webhook').first().json.body;\n\n// create message card\nlet result = {\n  msg_type: 'text',\n  content: {\n    text: `T·ª´: ${smsContent.from}\\n${smsContent.text.toString()}`,\n  },\n};\n\nreturn {\n  json: {\n    data: result,\n    customBotURL: $input.item.json.customBotURL,\n  },\n};\n"},"id":"bd87c16c-ab7e-48a1-8b70-b6c0c4feb593","name":"Convert to Message Card for OTP","type":"n8n-nodes-base.code","typeVersion":1,"position":[440,1080]},{"parameters":{},"id":"a7020cfb-6ae9-4ca1-9962-45d5a651030a","name":"Start Telegram Mess Actions","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[-520,1600]},{"parameters":{"mode":"runOnceForEachItem","jsCode":"const smsContent = $('Webhook').first().json.body;\n\nlet message = [];\n\nmessage.push(\n  `<b>${smsContent.from.toUpperCase()}</b>\\n`,\n  `${smsContent.text.toString()}`\n);\n\nreturn {\n  json: {\n    botToken: $input.item.json.botToken,\n    payload: {\n      chat_id: $input.item.json.chatId,\n      parse_mode: 'HTML',\n      text: message.join('\\n'),\n    },\n  },\n};\n"},"id":"1467ad7f-b603-4e40-81d0-fc1e226fa309","name":"Create Telegram Message for OTP","type":"n8n-nodes-base.code","typeVersion":1,"position":[-120,1520]},{"parameters":{"conditions":{"boolean":[{"value1":"={{ $input.item.json.isSend }}","value2":true}]}},"id":"a09aedc5-a7d3-46f9-9249-970c7d69fd45","name":"ifSend","type":"n8n-nodes-base.if","typeVersion":1,"position":[640,1240]},{"parameters":{"conditions":{"boolean":[{"value1":"={{ $input.item.json.isSend }}","value2":true}]}},"id":"704811b8-7a40-41ee-9701-e1e78aa269dc","name":"ifSend1","type":"n8n-nodes-base.if","typeVersion":1,"position":[600,840]},{"parameters":{"conditions":{"boolean":[{"value1":"={{ $input.item.json.isSend }}","value2":true}]}},"id":"abb28609-5f26-4c5a-870e-6a256e52ad4d","name":"ifSend2","type":"n8n-nodes-base.if","typeVersion":1,"position":[100,1680]},{"parameters":{"mode":"runOnceForEachItem","jsCode":"const smsContent = $('Webhook').first().json.body;\n\n  // Convert to Lark Base format\n  const records = [\n    {\n      fields: {\n        ID: smsContent.from,\n        Bank: smsContent.from,\n        'Transaction Type': 'OTP',\n        'Transaction Message': smsContent.text.toString(),\n        'Original Message': smsContent.text.toString(),\n        'Time received': smsContent.sentStamp,\n      },\n    },\n  ];\n\n  return {\n    json: {\n      records,\n      configs: {\n        baseId: $input.item.json.baseId,\n        tableId: $input.item.json.tableId,\n      },\n    },\n  };\n"},"id":"7685a26b-33a8-4bec-a240-dc0152636b1d","name":"Convert to Lark Base format OTP","type":"n8n-nodes-base.code","typeVersion":1,"position":[420,600]},{"parameters":{"conditions":{"string":[{"value1":"={{ $('Webhook').item.json.body.text }}","operation":"contains","value2":"OTP"}],"boolean":[{"value1":"={{ $input.item.json.enableOTP }}","value2":true}]}},"id":"7b450e71-7fc1-4043-bac9-360cfee751b4","name":"ifOTPLarkBase","type":"n8n-nodes-base.if","typeVersion":1,"position":[220,780]},{"parameters":{"conditions":{"string":[{"value1":"={{ $('Webhook').item.json.body.text }}","operation":"contains","value2":"OTP"}],"boolean":[{"value1":"={{ $input.item.json.enableOTP }}","value2":true}]}},"id":"ba3c9497-44b0-4a2c-b184-bc235cd1fd6a","name":"ifOTPLarkMess","type":"n8n-nodes-base.if","typeVersion":1,"position":[180,1180]},{"parameters":{"conditions":{"string":[{"value1":"={{ $('Webhook').item.json.body.text }}","operation":"contains","value2":"OTP"}],"boolean":[{"value1":"={{ $input.item.json.enableOTP }}","value2":true}]}},"id":"443b9c30-26c8-4ebe-87fc-4d834462f834","name":"ifOTPTelegram","type":"n8n-nodes-base.if","typeVersion":1,"position":[-340,1600]},{"parameters":{},"id":"8f6d64f1-1e22-4de2-8c7d-4d388f93be80","name":"Start Pre-order √°o","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[-960,1300]},{"parameters":{"method":"POST","url":"https://app.n8n.vn/webhook/dcgr/preorder2023/nhan-chuyen-khoan","sendBody":true,"bodyParameters":{"parameters":[{"name":"bankName","value":"={{ $('getBankData').item.json.result.bankName }}"},{"name":"bank_sub_acc_id","value":"={{ $('getBankData').item.json.result.receiverAccount }}"},{"name":"amount","value":"={{ $('getBankData').item.json.result.transactionAmount.amount }}"},{"name":"cusum_balance","value":"={{ $('getBankData').item.json.result.balance.amount }}"},{"name":"description","value":"={{ $('getBankData').item.json.result.transactionMessage }}"},{"name":"when","value":"={{ $('getBankData').item.json.result.receivedTime.text }}"}]},"options":{}},"id":"3d79ad8d-4478-4cec-abf6-8589f2f772ca","name":"HTTP Request","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[-720,1320]}],"connections":{"Webhook":{"main":[[{"node":"getBankData","type":"main","index":0}]]},"Convert to Lark Message Card":{"main":[[{"node":"ifSend","type":"main","index":0}]]},"Get Lark tenant access token":{"main":[[{"node":"Start Lark Base","type":"main","index":0},{"node":"Start Lark Mess","type":"main","index":0}]]},"Convert to Lark Base format":{"main":[[{"node":"ifSend1","type":"main","index":0}]]},"ifBankSupport":{"main":[[{"node":"Start Actions","type":"main","index":0}]]},"getBankData":{"main":[[{"node":"ifBankSupport","type":"main","index":0}]]},"Start Actions":{"main":[[{"node":"Start Lark Actions","type":"main","index":0},{"node":"Start Pre-order √°o","type":"main","index":0}]]},"Create Telegram Message":{"main":[[{"node":"ifSend2","type":"main","index":0}]]},"Set Lark Configs":{"main":[[{"node":"Get Lark tenant access token","type":"main","index":0}]]},"Set Lark Mess Config":{"main":[[{"node":"Start Lark Mess Actions","type":"main","index":0}]]},"Set Lark Base Config":{"main":[[{"node":"Start Lark Base Actions","type":"main","index":0}]]},"Start Lark Actions":{"main":[[{"node":"Set Lark Configs","type":"main","index":0}]]},"Start Lark Base":{"main":[[{"node":"Set Lark Base Config","type":"main","index":0}]]},"Start Lark Mess":{"main":[[{"node":"Set Lark Mess Config","type":"main","index":0}]]},"Start Telegram Actions":{"main":[[{"node":"Set Telegram Config","type":"main","index":0}]]},"Set Telegram Config":{"main":[[{"node":"Start Telegram Mess Actions","type":"main","index":0}]]},"Start Lark Base Actions":{"main":[[{"node":"ifOTPLarkBase","type":"main","index":0}]]},"Start Lark Mess Actions":{"main":[[{"node":"ifOTPLarkMess","type":"main","index":0}]]},"Convert to Message Card for OTP":{"main":[[{"node":"[Lark] Send noti to group chat","type":"main","index":0}]]},"Start Telegram Mess Actions":{"main":[[{"node":"ifOTPTelegram","type":"main","index":0}]]},"Create Telegram Message for OTP":{"main":[[{"node":"Send to Telegram chat","type":"main","index":0}]]},"ifSend":{"main":[[{"node":"[Lark] Send noti to group chat","type":"main","index":0}]]},"ifSend1":{"main":[[{"node":"[SMS Log] Add records to Bitable","type":"main","index":0}]]},"ifSend2":{"main":[[{"node":"Send to Telegram chat","type":"main","index":0}]]},"Convert to Lark Base format OTP":{"main":[[{"node":"[SMS Log] Add records to Bitable","type":"main","index":0}]]},"ifOTPLarkBase":{"main":[[{"node":"Convert to Lark Base format OTP","type":"main","index":0}],[{"node":"Convert to Lark Base format","type":"main","index":0}]]},"ifOTPLarkMess":{"main":[[{"node":"Convert to Message Card for OTP","type":"main","index":0}],[{"node":"Convert to Lark Message Card","type":"main","index":0}]]},"ifOTPTelegram":{"main":[[{"node":"Create Telegram Message for OTP","type":"main","index":0}],[{"node":"Create Telegram Message","type":"main","index":0}]]},"Start Pre-order √°o":{"main":[[{"node":"HTTP Request","type":"main","index":0}]]}},"settings":{"saveManualExecutions":true,"callerPolicy":"workflowsFromSameOwner"},"staticData":null,"pinData":{"Webhook":[{"json":{"headers":{"host":"app.n8n.vn","user-agent":"SMS Forwarder App","transfer-encoding":"chunked","accept-encoding":"gzip","content-type":"application/json; charset=utf-8","x-forwarded-for":"125.235.237.18","x-forwarded-host":"app.n8n.vn","x-forwarded-port":"443","x-forwarded-proto":"https","x-forwarded-server":"f2605f992776","x-real-ip":"125.235.237.18"},"params":{},"query":{},"body":{"from":"Vietcombank","text":"SD TK 6681888888 +10,000VND luc 20-07-2023 12:46:52. SD 23,191,071VND. Ref 836878.200723.124651.test","sentStamp":1689832012000,"receivedStamp":1689832012772,"sim":"sim1"}},"pairedItem":{"item":0}}]},"versionId":"75f74da2-4f2d-48f4-a4bc-095b9260bf82","triggerCount":1,"tags":[{"createdAt":"2023-07-14T18:38:08.838Z","updatedAt":"2023-07-14T18:38:08.838Z","id":"26","name":"dcgr"}]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-07-20T13:01:53.854Z","updatedAt":"2023-07-20T13:06:58.000Z","id":"214","name":"3- Workflow Test","active":true,"nodes":[{"parameters":{"httpMethod":"POST","path":"test-bank-thg-kdigi-bank-bot-api","options":{}},"id":"e76be3d8-8943-4368-9a23-6e97435e3af7","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[-1700,1040],"webhookId":"b459d9da-c462-43e0-880c-12b8d6304763"},{"parameters":{"mode":"runOnceForEachItem","jsCode":"if (\n  ($('getBankData').item.json.result.transactionType.type === '-' &&\n    $input.item.json.enableOutgoing) ||\n  ($('getBankData').item.json.result.transactionType.type === '+' &&\n    $input.item.json.enableIncoming)\n) {\n  const data = $('getBankData').first().json.result;\n\n  let elements = [];\n\n  elements.push({\n    tag: 'div',\n    fields: [\n      {\n        is_short: false,\n        text: {\n          tag: 'lark_md',\n          content: `**Ng√¢n h√†ng**: ${data.bankName.toUpperCase()}`,\n        },\n      },\n      {\n        is_short: false,\n        text: {\n          tag: 'lark_md',\n          content: `**S·ªë t√†i kho·∫£n**: ${data.receiverAccount}`,\n        },\n      },\n      {\n        is_short: false,\n        text: {\n          tag: 'lark_md',\n          content: `**S·ªë d∆∞ thay ƒë·ªïi:** ${data.transactionType.type} ${data.transactionAmount.amountText} VND`,\n        },\n      },\n      {\n        is_short: false,\n        text: {\n          tag: 'lark_md',\n          content: `**N·ªôi dung:** ${data.transactionMessage}`,\n        },\n      },\n    ],\n  });\n\n  // Append transaction ID if exist\n  if (data.transactionId) {\n    elements[0].fields.push({\n      is_short: false,\n      text: {\n        tag: 'lark_md',\n        content: `**M√£ giao d·ªãch:** ${data.transactionId}`,\n      },\n    });\n  }\n\n  // Append received time\n  elements[0].fields.push({\n    is_short: false,\n    text: {\n      tag: 'lark_md',\n      content: `**Th·ªùi gian nh·∫≠n:** ${data.receivedTime.text}`,\n    },\n  });\n\n  // Ki·ªÉm tra enableBalance n·∫øu true th√¨ th√™m ph·∫ßn t·ª≠ \"S·ªë d∆∞ t·∫°m t√≠nh\" v√†o m·∫£ng fields\n  if ($input.item.json.enableBalance) {\n    const balanceIndex = elements[0].fields.findIndex((field) =>\n      field?.text?.content?.includes('S·ªë d∆∞ thay ƒë·ªïi')\n    );\n    if (balanceIndex !== -1) {\n      elements[0].fields.splice(balanceIndex + 1, 0, {\n        is_short: false,\n        text: {\n          tag: 'lark_md',\n          content: `**S·ªë d∆∞ t·∫°m t√≠nh**: ${data.balance.amountText} VND`,\n        },\n      });\n    }\n  }\n\n  // create message card\n  let result = {\n    msg_type: 'interactive',\n    card: {\n      config: {\n        wide_screen_mode: true,\n      },\n      header: {\n        template: data.larkMessConfig?.cardColor ?? 'blue',\n        title: {\n          content: `${data.bankName.toUpperCase()}-${data.receiverAccount} (${\n            data.transactionType.type\n          }) ${data.transactionAmount.amountText}VND`,\n          tag: 'plain_text',\n        },\n      },\n      elements,\n    },\n  };\n\n  return {\n    json: {\n      isSend: true,\n      data: result,\n      customBotURL: $input.item.json.customBotURL,\n    },\n  };\n}\n\nreturn {\n  json: {\n    isSend: false,\n  },\n};\n"},"id":"4681f665-5315-46f2-8bfa-f8f17011da10","name":"Convert to Lark Message Card","type":"n8n-nodes-base.code","typeVersion":1,"position":[600,1080]},{"parameters":{"method":"POST","url":"=https://open.larksuite.com/open-apis/auth/v3/tenant_access_token/internal/","sendBody":true,"specifyBody":"json","jsonBody":"={ \"app_id\" : \"{{ $input.item.json[\"appId\"] }}\", \"app_secret\" : \"{{ $input.item.json[\"appSecret\"] }}\" }","options":{}},"id":"475b2f69-c60d-4933-8f13-63142e53e40e","name":"Get Lark tenant access token","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[-460,780]},{"parameters":{"method":"POST","url":"={{ $input.item.json.customBotURL }}","sendBody":true,"specifyBody":"json","jsonBody":"={{ JSON.stringify($input.item.json.data)}}","options":{}},"id":"b03674d9-1f70-4faf-b0da-abd9c7d09c6c","name":"[Lark] Send noti to group chat","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[1020,940]},{"parameters":{"mode":"runOnceForEachItem","jsCode":"if (\n  ($('getBankData').item.json.result.transactionType.type === '-' &&\n    $input.item.json.enableOutgoing) ||\n  ($('getBankData').item.json.result.transactionType.type === '+' &&\n    $input.item.json.enableIncoming)\n) {\n  const data = $('getBankData').first().json.result;\n\n  // Convert to Lark Base format\n  const records = [\n    {\n      fields: {\n        ID: data.bankName + '-' + data.receiverAccount,\n        Bank: data.bankName.toUpperCase(),\n        Account: data.receiverAccount,\n        'Transaction Type': data.transactionType.typeText,\n        Debit:\n          data.transactionType.type === '+'\n            ? data.transactionAmount.amount\n            : undefined,\n        Credit:\n          data.transactionType.type === '-'\n            ? data.transactionAmount.amount\n            : undefined,\n        'Transaction ID': data.transactionId,\n        'Transaction Message': data.transactionMessage,\n        'Original Message': data.originalMessage,\n        'Time received': data.receivedTime.timestamp,\n      },\n    },\n  ];\n\n  // Ki·ªÉm tra enableBalance n·∫øu true th√¨ th√™m ph·∫ßn t·ª≠ \"Balance\" v√†o m·∫£ng fields\n  if ($input.item.json.enableBalance) {\n    records[0].fields = {\n      ...records[0].fields,\n      Balance: data.balance.amount,\n    };\n  }\n\n  return {\n    json: {\n      isSend: true,\n      records,\n      configs: {\n        baseId: $input.item.json.baseId,\n        tableId: $input.item.json.tableId,\n      },\n    },\n  };\n}\n\nreturn {\n  json: {\n    isSend: false,\n  },\n};\n"},"id":"6aba55bd-7a05-42b9-af70-6d0093ed3b97","name":"Convert to Lark Base format","type":"n8n-nodes-base.code","typeVersion":1,"position":[580,680]},{"parameters":{"method":"POST","url":"=https://open.larksuite.com/open-apis/bitable/v1/apps/{{ $json[\"configs\"][\"baseId\"] }}/tables/{{  $json[\"configs\"][\"tableId\"]}}/records/batch_create","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $node[\"Get Lark tenant access token\"].json.tenant_access_token }}"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\"records\":{{ JSON.stringify($json[\"records\"]) }}}","options":{}},"id":"7425a9dc-6277-42a2-b270-77d520b4dc3b","name":"[SMS Log] Add records to Bitable","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[1000,620]},{"parameters":{"conditions":{"boolean":[{"value1":"={{ $json.isBankSupport }}","value2":true}]}},"id":"9b93e600-3ef7-4756-8961-9f3895ee40cf","name":"ifBankSupport","type":"n8n-nodes-base.if","typeVersion":1,"position":[-1280,1040]},{"parameters":{"method":"POST","url":"https://app.n8n.vn/webhook/kdigi-bank-bot-process-data","sendBody":true,"specifyBody":"json","jsonBody":"={{ JSON.stringify($input.first().json.body) }}","options":{}},"id":"6b09741c-c20a-446a-ab7d-0d6f0c682731","name":"getBankData","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[-1500,1040]},{"parameters":{},"id":"7daa5e30-a05d-4ae2-b7aa-61123965ea61","name":"Start Actions","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[-1080,1020]},{"parameters":{"values":{"string":[{"name":"appId","value":"cli_a432b2ea14b8d00a"},{"name":"appSecret","value":"qMWk8s1wMwUg535xPyUKkclJD4sW5kqp"}]},"options":{}},"id":"5ccd0813-9c4b-4e27-84fa-c056784f36f9","name":"Set Lark Configs","type":"n8n-nodes-base.set","typeVersion":2,"position":[-640,780]},{"parameters":{"values":{"string":[{"name":"customBotURL","value":"https://open.larksuite.com/open-apis/bot/v2/hook/55dcaa38-b878-4a2e-add7-b64c83c0f61f"}],"boolean":[{"name":"enableBalance","value":true},{"name":"enableOTP","value":true},{"name":"enableOutgoing","value":true},{"name":"enableIncoming","value":true}]},"options":{}},"id":"7a3b641d-9c7f-4644-a784-d2990ddc938f","name":"Set Lark Mess Config","type":"n8n-nodes-base.set","typeVersion":2,"position":[-40,1040]},{"parameters":{"values":{"string":[{"name":"baseId","value":"QqHlbsThJasXp9s183Wu92v5sYf"},{"name":"tableId","value":"tbloNTC6VkMNeKs4"}],"boolean":[{"name":"enableBalance","value":true},{"name":"enableOTP","value":true},{"name":"enableOutgoing","value":true},{"name":"enableIncoming","value":true}]},"options":{}},"id":"4ffcce52-3eb7-4ee3-9764-faaf266e23da","name":"Set Lark Base Config","type":"n8n-nodes-base.set","typeVersion":2,"position":[-20,640]},{"parameters":{},"id":"5ac9495b-a82a-4a9f-914f-eef23e921a72","name":"Start Lark Actions","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[-800,780]},{"parameters":{},"id":"79eead4d-5744-4387-9ef9-b7efb9cdccb1","name":"Start Lark Base","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[-240,640]},{"parameters":{},"id":"7323156c-fd8e-4de7-bd39-c29955c7c119","name":"Start Lark Mess","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[-260,1040]},{"parameters":{},"id":"a14fcfbd-2e08-400f-9595-50b716ffeacb","name":"Start Lark Base Actions","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[200,620]},{"parameters":{},"id":"be0fb4ea-7130-4f87-9c55-8ad374aacee3","name":"Start Lark Mess Actions","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[180,1020]},{"parameters":{"mode":"runOnceForEachItem","jsCode":"const smsContent = $('Webhook').first().json.body;\n\n// create message card\nlet result = {\n  msg_type: 'text',\n  content: {\n    text: `T·ª´: ${smsContent.from}\\n${smsContent.text.toString()}`,\n  },\n};\n\nreturn {\n  json: {\n    data: result,\n    customBotURL: $input.item.json.customBotURL,\n  },\n};\n"},"id":"6a616b74-4dde-4597-bcaf-5a3ee7aaeed8","name":"Convert to Message Card for OTP","type":"n8n-nodes-base.code","typeVersion":1,"position":[600,920]},{"parameters":{"conditions":{"boolean":[{"value1":"={{ $input.item.json.isSend }}","value2":true}]}},"id":"52326d89-7226-458a-8e07-92d4c0dfb407","name":"ifSend","type":"n8n-nodes-base.if","typeVersion":1,"position":[800,1080]},{"parameters":{"conditions":{"boolean":[{"value1":"={{ $input.item.json.isSend }}","value2":true}]}},"id":"42a37b99-e26d-4b2f-a25e-e59befcf1195","name":"ifSend1","type":"n8n-nodes-base.if","typeVersion":1,"position":[760,680]},{"parameters":{"mode":"runOnceForEachItem","jsCode":"const smsContent = $('Webhook').first().json.body;\n\n  // Convert to Lark Base format\n  const records = [\n    {\n      fields: {\n        ID: smsContent.from,\n        Bank: smsContent.from,\n        'Transaction Type': 'OTP',\n        'Transaction Message': smsContent.text.toString(),\n        'Original Message': smsContent.text.toString(),\n        'Time received': smsContent.sentStamp,\n      },\n    },\n  ];\n\n  return {\n    json: {\n      records,\n      configs: {\n        baseId: $input.item.json.baseId,\n        tableId: $input.item.json.tableId,\n      },\n    },\n  };\n"},"id":"140b2f4a-2d0e-400c-a781-9fdde0dc0360","name":"Convert to Lark Base format OTP","type":"n8n-nodes-base.code","typeVersion":1,"position":[580,440]},{"parameters":{"conditions":{"string":[{"value1":"={{ $('Webhook').item.json.body.text }}","operation":"contains","value2":"OTP"}],"boolean":[{"value1":"={{ $input.item.json.enableOTP }}","value2":true}]}},"id":"53861d1a-6842-4945-961d-db2b4652e111","name":"ifOTPLarkBase","type":"n8n-nodes-base.if","typeVersion":1,"position":[380,620]},{"parameters":{"conditions":{"string":[{"value1":"={{ $('Webhook').item.json.body.text }}","operation":"contains","value2":"OTP"}],"boolean":[{"value1":"={{ $input.item.json.enableOTP }}","value2":true}]}},"id":"53fa4682-5e4c-4f38-a98f-f64745af0fbe","name":"ifOTPLarkMess","type":"n8n-nodes-base.if","typeVersion":1,"position":[340,1020]}],"connections":{"Webhook":{"main":[[{"node":"getBankData","type":"main","index":0}]]},"Convert to Lark Message Card":{"main":[[{"node":"ifSend","type":"main","index":0}]]},"Get Lark tenant access token":{"main":[[{"node":"Start Lark Base","type":"main","index":0},{"node":"Start Lark Mess","type":"main","index":0}]]},"Convert to Lark Base format":{"main":[[{"node":"ifSend1","type":"main","index":0}]]},"ifBankSupport":{"main":[[{"node":"Start Actions","type":"main","index":0}]]},"getBankData":{"main":[[{"node":"ifBankSupport","type":"main","index":0}]]},"Start Actions":{"main":[[{"node":"Start Lark Actions","type":"main","index":0}]]},"Set Lark Configs":{"main":[[{"node":"Get Lark tenant access token","type":"main","index":0}]]},"Set Lark Mess Config":{"main":[[{"node":"Start Lark Mess Actions","type":"main","index":0}]]},"Set Lark Base Config":{"main":[[{"node":"Start Lark Base Actions","type":"main","index":0}]]},"Start Lark Actions":{"main":[[{"node":"Set Lark Configs","type":"main","index":0}]]},"Start Lark Base":{"main":[[{"node":"Set Lark Base Config","type":"main","index":0}]]},"Start Lark Mess":{"main":[[{"node":"Set Lark Mess Config","type":"main","index":0}]]},"Start Lark Base Actions":{"main":[[{"node":"ifOTPLarkBase","type":"main","index":0}]]},"Start Lark Mess Actions":{"main":[[{"node":"ifOTPLarkMess","type":"main","index":0}]]},"Convert to Message Card for OTP":{"main":[[{"node":"[Lark] Send noti to group chat","type":"main","index":0}]]},"ifSend":{"main":[[{"node":"[Lark] Send noti to group chat","type":"main","index":0}]]},"ifSend1":{"main":[[{"node":"[SMS Log] Add records to Bitable","type":"main","index":0}]]},"Convert to Lark Base format OTP":{"main":[[{"node":"[SMS Log] Add records to Bitable","type":"main","index":0}]]},"ifOTPLarkBase":{"main":[[{"node":"Convert to Lark Base format OTP","type":"main","index":0}],[{"node":"Convert to Lark Base format","type":"main","index":0}]]},"ifOTPLarkMess":{"main":[[{"node":"Convert to Message Card for OTP","type":"main","index":0}],[{"node":"Convert to Lark Message Card","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{},"versionId":"8df5d91b-50aa-4b2c-a86f-de831d12324c","triggerCount":1,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-07-20T14:39:14.215Z","updatedAt":"2023-07-20T16:30:05.000Z","id":"215","name":"[Preorder √°o] Send email thanh to√°n 1 ph·∫ßn","active":true,"nodes":[{"parameters":{"httpMethod":"POST","path":"/dcgr/preorder2023/email-thanh-toan-mot-phan","options":{}},"id":"87224ccd-16a5-4c40-8b0f-dc0d49e8db6e","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[620,600],"webhookId":"ce13cb3f-f538-4761-b006-23c811550610"},{"parameters":{"jsCode":"const data = $('Webhook').first().json.body\nlet moneyReceive = data.moneyReceive.toLocaleString(\"en-US\") + \" VND\"\nlet moneyPayment = data.moneyPayment.toLocaleString(\"en-US\") + \" VND\"\nlet moneyTotal = data.moneyTotal.toLocaleString(\"en-US\") + \" VND\"\nlet moneyRest = data.moneyRest.toLocaleString(\"en-US\") + \" VND\"\nlet status = data.status == \"on-hold\" ? \"ƒê√£ thanh to√°n m·ªôt ph·∫ßn\": \"ƒê√£ thanh to√°n qu√° s·ªë ti·ªÅn\"\nlet url_payment = `https://img.vietqr.io/image/VCB-6681888888-compact.png?amount=${Number(data.moneyRest)}&addInfo=${data.order_id}&accountName=Le%20Quoc%20Khoi`\nif (data.style === 'M·∫´u 1') {\n  url_img = 'https://s3.kdigi.app/dcgr/mau-1.jpg'\n} else if (data.style === 'M·∫´u 2') {\n  url_img = 'https://s3.kdigi.app/dcgr/mau-2.jpg'\n} else {\n  url_img = 'https://s3.kdigi.app/dcgr/mau-3.jpg'\n}\nreturn {\n  moneyReceive,\n  moneyPayment,\n  moneyTotal,\n  moneyRest,\n  status,\n  url_img,\n  url_payment\n}"},"id":"dfe44a98-dd48-4fbc-8e7d-d05421184ba6","name":"Code","type":"n8n-nodes-base.code","typeVersion":1,"position":[840,600]},{"parameters":{"fromEmail":"DC Media <no-reply@dcmedia.vn>","toEmail":"={{ $('Webhook').item.json.body.email }}","subject":"=[DC Media] X√°c nh·∫≠n ƒê∆°n h√†ng #{{ $('Webhook').item.json.body.order_id }}","emailFormat":"html","html":"=\n    <!doctype html>\n    <html xmlns=\"http://www.w3.org/1999/xhtml\" xmlns:v=\"urn:schemas-microsoft-com:vml\" xmlns:o=\"urn:schemas-microsoft-com:office:office\">\n      <head>\n        <title>\n          \n        </title>\n        <!--[if !mso]><!-->\n        <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\n        <!--<![endif]-->\n        <meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\">\n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\n        <style type=\"text/css\">\n          #outlook a { padding:0; }\n          body { margin:0;padding:0;-webkit-text-size-adjust:100%;-ms-text-size-adjust:100%; }\n          table, td { border-collapse:collapse;mso-table-lspace:0pt;mso-table-rspace:0pt; }\n          img { border:0;height:auto;line-height:100%; outline:none;text-decoration:none;-ms-interpolation-mode:bicubic; }\n          p { display:block;margin:13px 0; }\n        </style>\n        <!--[if mso]>\n        <noscript>\n        <xml>\n        <o:OfficeDocumentSettings>\n          <o:AllowPNG/>\n          <o:PixelsPerInch>96</o:PixelsPerInch>\n        </o:OfficeDocumentSettings>\n        </xml>\n        </noscript>\n        <![endif]-->\n        <!--[if lte mso 11]>\n        <style type=\"text/css\">\n          .mj-outlook-group-fix { width:100% !important; }\n        </style>\n        <![endif]-->\n        \n      <!--[if !mso]><!-->\n        <link href=\"https://fonts.googleapis.com/css?family=Roboto:300,400,500,700\" rel=\"stylesheet\" type=\"text/css\">\n        <style type=\"text/css\">\n          @import url(https://fonts.googleapis.com/css?family=Roboto:300,400,500,700);\n        </style>\n      <!--<![endif]-->\n\n    \n        \n    <style type=\"text/css\">\n      @media only screen and (min-width:480px) {\n        .mj-column-px-250 { width:250px !important; max-width: 250px; }\n.mj-column-per-100 { width:100% !important; max-width: 100%; }\n.mj-column-per-50 { width:50% !important; max-width: 50%; }\n      }\n    </style>\n    <style media=\"screen and (min-width:480px)\">\n      .moz-text-html .mj-column-px-250 { width:250px !important; max-width: 250px; }\n.moz-text-html .mj-column-per-100 { width:100% !important; max-width: 100%; }\n.moz-text-html .mj-column-per-50 { width:50% !important; max-width: 50%; }\n    </style>\n  \n        <style type=\"text/css\">\n        \n        \n\n    @media only screen and (max-width:480px) {\n      table.mj-full-width-mobile { width: 100% !important; }\n      td.mj-full-width-mobile { width: auto !important; }\n    }\n  \n        </style>\n        \n        \n      </head>\n      <body style=\"word-spacing:normal;\">\n        \n        \n      <div\n         style=\"\"\n      >\n        \n      \n      <!--[if mso | IE]><table align=\"center\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" class=\"\" style=\"width:600px;\" width=\"600\" ><tr><td style=\"line-height:0px;font-size:0px;mso-line-height-rule:exactly;\"><v:rect style=\"width:600px;\" xmlns:v=\"urn:schemas-microsoft-com:vml\" fill=\"true\" stroke=\"false\"><v:fill origin=\"0.5, 0\" position=\"0.5, 0\" src=\"https://s3.kdigi.app/dcgr/dc-abstract.jpeg\" type=\"tile\" /><v:textbox style=\"mso-fit-shape-to-text:true\" inset=\"0,0,0,0\"><![endif]-->\n          \n      <div  style=\"background:url(https://s3.kdigi.app/dcgr/dc-abstract.jpeg) center top / auto repeat;background-position:center top;background-repeat:repeat;background-size:auto;margin:0px auto;max-width:600px;\">\n        <div  style=\"line-height:0;font-size:0;\">\n        <table\n           align=\"center\" background=\"https://s3.kdigi.app/dcgr/dc-abstract.jpeg\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\" style=\"background:url(https://s3.kdigi.app/dcgr/dc-abstract.jpeg) center top / auto repeat;background-position:center top;background-repeat:repeat;background-size:auto;width:100%;\"\n        >\n          <tbody>\n            <tr>\n              <td\n                 style=\"direction:ltr;font-size:0px;padding:20px;text-align:center;\"\n              >\n                <!--[if mso | IE]><table role=\"presentation\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"><tr><td class=\"\" style=\"vertical-align:top;width:250px;\" ><![endif]-->\n            \n      <div\n         class=\"mj-column-px-250 mj-outlook-group-fix\" style=\"font-size:0px;text-align:left;direction:ltr;display:inline-block;vertical-align:top;width:100%;\"\n      >\n        \n      <table\n         border=\"0\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\" style=\"vertical-align:top;\" width=\"100%\"\n      >\n        <tbody>\n          \n              <tr>\n                <td\n                   align=\"center\" style=\"font-size:0px;padding:10px 25px;word-break:break-word;\"\n                >\n                  \n      <table\n         border=\"0\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\" style=\"border-collapse:collapse;border-spacing:0px;\"\n      >\n        <tbody>\n          <tr>\n            <td  style=\"width:200px;\">\n              \n      <img\n         height=\"auto\" src=\"https://s3.kdigi.app/dcgr/logo-dc-media.png\" style=\"border:0;display:block;outline:none;text-decoration:none;height:auto;width:100%;font-size:13px;\" width=\"200\"\n      />\n    \n            </td>\n          </tr>\n        </tbody>\n      </table>\n    \n                </td>\n              </tr>\n            \n        </tbody>\n      </table>\n    \n      </div>\n    \n          <!--[if mso | IE]></td></tr></table><![endif]-->\n              </td>\n            </tr>\n          </tbody>\n        </table>\n        </div>\n      </div>\n    \n        <!--[if mso | IE]></v:textbox></v:rect></td></tr></table><table align=\"center\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" class=\"\" style=\"width:600px;\" width=\"600\" ><tr><td style=\"line-height:0px;font-size:0px;mso-line-height-rule:exactly;\"><![endif]-->\n    \n      \n      <div  style=\"margin:0px auto;max-width:600px;\">\n        \n        <table\n           align=\"center\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\" style=\"width:100%;\"\n        >\n          <tbody>\n            <tr>\n              <td\n                 style=\"direction:ltr;font-size:0px;padding:0px 0px;text-align:center;\"\n              >\n                <!--[if mso | IE]><table role=\"presentation\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"><tr><td class=\"\" style=\"vertical-align:top;width:600px;\" ><![endif]-->\n            \n      <div\n         class=\"mj-column-per-100 mj-outlook-group-fix\" style=\"font-size:0px;text-align:left;direction:ltr;display:inline-block;vertical-align:top;width:100%;\"\n      >\n        \n      <table\n         border=\"0\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\" style=\"vertical-align:top;\" width=\"100%\"\n      >\n        <tbody>\n          \n              <tr>\n                <td\n                   align=\"center\" style=\"font-size:0px;padding:0px 25px;word-break:break-word;\"\n                >\n                  \n      <div\n         style=\"font-family:Roboto, Helvetica Neue, Helvetica, Arial, sans-serif;font-size:13px;line-height:1;text-align:center;color:#000000;\"\n      ><h1>X√°c nh·∫≠n thanh to√°n m·ªôt ph·∫ßn ƒë∆°n h√†ng</h1></div>\n    \n                </td>\n              </tr>\n            \n              <tr>\n                <td\n                   align=\"left\" style=\"font-size:0px;padding:0px 25px;word-break:break-word;\"\n                >\n                  \n      <div\n         style=\"font-family:Roboto, Helvetica Neue, Helvetica, Arial, sans-serif;font-size:13px;line-height:1;text-align:left;color:#000000;\"\n      ><div><font face=\"Roboto\" size=\"3\"><span>Xin ch√†o {{ $('Webhook').item.json[\"body\"][\"name\"] }}, ch√∫ng t√¥i</span><span style=\"background-color: transparent;\">&nbsp;v·ª´a nh·∫≠n ƒë∆∞·ª£c m·ªôt kho·∫£n thanh to√°n cho ƒë∆°n h√†ng #{{ $('Webhook').item.json[\"body\"][\"order_id\"] }} c·ªßa b·∫°n.</span></font></div></div>\n    \n                </td>\n              </tr>\n            \n        </tbody>\n      </table>\n    \n      </div>\n    \n          <!--[if mso | IE]></td></tr></table><![endif]-->\n              </td>\n            </tr>\n          </tbody>\n        </table>\n        \n      </div>\n    \n      \n      <!--[if mso | IE]></td></tr></table><table align=\"center\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" class=\"\" style=\"width:600px;\" width=\"600\" ><tr><td style=\"line-height:0px;font-size:0px;mso-line-height-rule:exactly;\"><![endif]-->\n    \n      \n      <div  style=\"margin:0px auto;max-width:600px;\">\n        \n        <table\n           align=\"center\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\" style=\"width:100%;\"\n        >\n          <tbody>\n            <tr>\n              <td\n                 style=\"direction:ltr;font-size:0px;padding:10px 150px;text-align:center;\"\n              >\n                <!--[if mso | IE]><table role=\"presentation\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"><tr><td class=\"\" style=\"vertical-align:top;width:300px;\" ><![endif]-->\n            \n      <div\n         class=\"mj-column-per-100 mj-outlook-group-fix\" style=\"font-size:0px;text-align:left;direction:ltr;display:inline-block;vertical-align:top;width:100%;\"\n      >\n        \n      <table\n         border=\"0\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\" style=\"vertical-align:top;\" width=\"100%\"\n      >\n        <tbody>\n          \n              <tr>\n                <td\n                   align=\"left\" style=\"font-size:0px;padding:10px 25px;word-break:break-word;\"\n                >\n                  \n      <div\n         style=\"font-family:Roboto, Helvetica Neue, Helvetica, Arial, sans-serif;font-size:13px;line-height:1;text-align:left;color:#000000;\"\n      ><font size=\"3\"><b>Nh·∫≠n thanh to√°n:</b> {{ $('Code').item.json[\"moneyReceive\"] }}</font><div><font size=\"3\"><b>Gi√° tr·ªã ƒë∆°n h√†ng:</b> {{ $('Code').item.json[\"moneyTotal\"] }}</font></div><div><font size=\"3\"><b>ƒê√£ thanh to√°n:</b> {{ $('Code').item.json[\"moneyPayment\"] }}</font></div><div><font size=\"3\"><b>C√≤n l·∫°i:</b> {{ $('Code').item.json[\"moneyRest\"] }}</font></div></div>\n    \n                </td>\n              </tr>\n            \n        </tbody>\n      </table>\n    \n      </div>\n    \n          <!--[if mso | IE]></td></tr></table><![endif]-->\n              </td>\n            </tr>\n          </tbody>\n        </table>\n        \n      </div>\n    \n      \n      <!--[if mso | IE]></td></tr></table><table align=\"center\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" class=\"\" style=\"width:600px;\" width=\"600\" ><tr><td style=\"line-height:0px;font-size:0px;mso-line-height-rule:exactly;\"><![endif]-->\n    \n      \n      <div  style=\"margin:0px auto;max-width:600px;\">\n        \n        <table\n           align=\"center\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\" style=\"width:100%;\"\n        >\n          <tbody>\n            <tr>\n              <td\n                 style=\"direction:ltr;font-size:0px;padding:0px 0px;text-align:center;\"\n              >\n                <!--[if mso | IE]><table role=\"presentation\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"><tr><td class=\"\" style=\"vertical-align:top;width:300px;\" ><![endif]-->\n            \n      <div\n         class=\"mj-column-per-50 mj-outlook-group-fix\" style=\"font-size:0px;text-align:left;direction:ltr;display:inline-block;vertical-align:top;width:100%;\"\n      >\n        \n      <table\n         border=\"0\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\" style=\"vertical-align:top;\" width=\"100%\"\n      >\n        <tbody>\n          \n              <tr>\n                <td\n                   align=\"left\" style=\"font-size:0px;padding:0px 25px;word-break:break-word;\"\n                >\n                  \n      <div\n         style=\"font-family:Roboto, Helvetica Neue, Helvetica, Arial, sans-serif;font-size:13px;line-height:1;text-align:left;color:#000000;\"\n      ><h2>Th√¥ng tin thanh to√°n</h2></div>\n    \n                </td>\n              </tr>\n            \n              <tr>\n                <td\n                   align=\"left\" style=\"font-size:0px;padding:0px 25px;word-break:break-word;\"\n                >\n                  \n      <div\n         style=\"font-family:Roboto, Helvetica Neue, Helvetica, Arial, sans-serif;font-size:13px;line-height:1;text-align:left;color:#000000;\"\n      ><div><font size=\"3\">Vui l√≤ng chuy·ªÉn kho·∫£n theo th√¥ng tin d∆∞·ªõi ƒë√¢y:</font></div><div><font size=\"3\"><b>Ng√¢n h√†ng:</b> Vietcombank</font></div><div><font size=\"3\"><b>S·ªë t√†i kho·∫£n:</b> 6681888888</font></div><div><font size=\"3\"><b>T√™n t√†i kho·∫£n:</b> L√™ Qu·ªëc Kh√¥i</font></div><div><font size=\"3\"><b>S·ªë ti·ªÅn:</b> {{ $('Code').item.json[\"moneyRest\"] }}</font></div><div><font size=\"3\"><b>N·ªôi dung:</b> <span style=\"background-color: rgb(251, 255, 0);\">{{ $('Webhook').item.json[\"body\"][\"order_id\"] }}</span></font></div><div><font size=\"3\"><br></font></div><div><font size=\"3\">L∆∞u √Ω: ƒê∆°n h√†ng n√†y ƒë∆∞·ª£c x√°c nh·∫≠n t·ª± ƒë·ªông. Vui l√≤ng chuy·ªÉn kho·∫£n ƒë√∫ng n·ªôi dung v√† s·ªë ti·ªÅn ƒë·ªÉ ƒë∆°n h√†ng ƒë∆∞·ª£c x·ª≠ l√Ω nhanh nh·∫•t.</font></div></div>\n    \n                </td>\n              </tr>\n            \n        </tbody>\n      </table>\n    \n      </div>\n    \n          <!--[if mso | IE]></td><td class=\"\" style=\"vertical-align:top;width:300px;\" ><![endif]-->\n            \n      <div\n         class=\"mj-column-per-50 mj-outlook-group-fix\" style=\"font-size:0px;text-align:left;direction:ltr;display:inline-block;vertical-align:top;width:100%;\"\n      >\n        \n      <table\n         border=\"0\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\" style=\"vertical-align:top;\" width=\"100%\"\n      >\n        <tbody>\n          \n              <tr>\n                <td\n                   align=\"center\" style=\"font-size:0px;padding:10px 25px;word-break:break-word;\"\n                >\n                  \n      <table\n         border=\"0\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\" style=\"border-collapse:collapse;border-spacing:0px;\"\n      >\n        <tbody>\n          <tr>\n            <td  style=\"width:250px;\">\n              \n      <img\n         height=\"auto\" src=\"{{ $('Code').item.json[\"url_payment\"] }}\" style=\"border:0;display:block;outline:none;text-decoration:none;height:auto;width:100%;font-size:13px;\" width=\"250\"\n      />\n    \n            </td>\n          </tr>\n        </tbody>\n      </table>\n    \n                </td>\n              </tr>\n            \n        </tbody>\n      </table>\n    \n      </div>\n    \n          <!--[if mso | IE]></td></tr></table><![endif]-->\n              </td>\n            </tr>\n          </tbody>\n        </table>\n        \n      </div>\n    \n      \n      <!--[if mso | IE]></td></tr></table><table align=\"center\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" class=\"\" style=\"width:600px;\" width=\"600\" ><tr><td style=\"line-height:0px;font-size:0px;mso-line-height-rule:exactly;\"><![endif]-->\n    \n      \n      <div  style=\"margin:0px auto;max-width:600px;\">\n        \n        <table\n           align=\"center\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\" style=\"width:100%;\"\n        >\n          <tbody>\n            <tr>\n              <td\n                 style=\"direction:ltr;font-size:0px;padding:0px;text-align:center;\"\n              >\n                <!--[if mso | IE]><table role=\"presentation\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"><tr><td class=\"\" style=\"vertical-align:top;width:600px;\" ><![endif]-->\n            \n      <div\n         class=\"mj-column-per-100 mj-outlook-group-fix\" style=\"font-size:0px;text-align:left;direction:ltr;display:inline-block;vertical-align:top;width:100%;\"\n      >\n        \n      <table\n         border=\"0\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\" style=\"vertical-align:top;\" width=\"100%\"\n      >\n        <tbody>\n          \n              <tr>\n                <td\n                   align=\"center\" style=\"font-size:0px;padding:10px 25px;word-break:break-word;\"\n                >\n                  \n      <table\n         border=\"0\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\" style=\"border-collapse:collapse;border-spacing:0px;\"\n      >\n        <tbody>\n          <tr>\n            <td  style=\"width:550px;\">\n              \n      <img\n         height=\"auto\" src=\"{{ $('Code').item.json[\"url_img\"] }}\" style=\"border:0;border-radius:8px;display:block;outline:none;text-decoration:none;height:auto;width:100%;font-size:13px;\" width=\"550\"\n      />\n    \n            </td>\n          </tr>\n        </tbody>\n      </table>\n    \n                </td>\n              </tr>\n            \n        </tbody>\n      </table>\n    \n      </div>\n    \n          <!--[if mso | IE]></td></tr></table><![endif]-->\n              </td>\n            </tr>\n          </tbody>\n        </table>\n        \n      </div>\n    \n      \n      <!--[if mso | IE]></td></tr></table><table align=\"center\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" class=\"\" style=\"width:600px;\" width=\"600\" ><tr><td style=\"line-height:0px;font-size:0px;mso-line-height-rule:exactly;\"><![endif]-->\n    \n      \n      <div  style=\"margin:0px auto;max-width:600px;\">\n        \n        <table\n           align=\"center\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\" style=\"width:100%;\"\n        >\n          <tbody>\n            <tr>\n              <td\n                 style=\"direction:ltr;font-size:0px;padding:0px 0px;text-align:center;\"\n              >\n                <!--[if mso | IE]><table role=\"presentation\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"><tr><td class=\"\" style=\"vertical-align:top;width:300px;\" ><![endif]-->\n            \n      <div\n         class=\"mj-column-per-50 mj-outlook-group-fix\" style=\"font-size:0px;text-align:left;direction:ltr;display:inline-block;vertical-align:top;width:100%;\"\n      >\n        \n      <table\n         border=\"0\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\" style=\"vertical-align:top;\" width=\"100%\"\n      >\n        <tbody>\n          \n              <tr>\n                <td\n                   align=\"left\" style=\"font-size:0px;padding:0px 25px;word-break:break-word;\"\n                >\n                  \n      <div\n         style=\"font-family:Roboto, Helvetica Neue, Helvetica, Arial, sans-serif;font-size:13px;line-height:1;text-align:left;color:#000000;\"\n      ><h2>Th√¥ng tin ƒë∆°n h√†ng</h2></div>\n    \n                </td>\n              </tr>\n            \n              <tr>\n                <td\n                   align=\"left\" style=\"font-size:0px;padding:10px 25px;word-break:break-word;\"\n                >\n                  \n      <div\n         style=\"font-family:Roboto, Helvetica Neue, Helvetica, Arial, sans-serif;font-size:13px;line-height:1;text-align:left;color:#000000;\"\n      ><b><font size=\"3\">√Åo DCGR 2023</font></b><div><font size=\"3\"><b>M·∫´u:</b> {{ $('Webhook').item.json[\"body\"][\"style\"] }}</font></div><div><font size=\"3\"><b>K√≠ch c·ª°: </b>Size {{ $('Webhook').item.json[\"body\"][\"size\"] }}</font></div><div><font size=\"3\"><b>Gi√° Pre-order:</b> {{ $('Webhook').item.json[\"body\"][\"price\"] }}</font></div><div><font size=\"3\"><b>S·ªë l∆∞·ª£ng:</b> {{ $('Webhook').item.json[\"body\"][\"amount\"] }}</font></div><div><font size=\"3\"><b>Th√†nh ti·ªÅn:</b> {{ $('Webhook').item.json[\"body\"][\"total\"] }}</font></div></div>\n    \n                </td>\n              </tr>\n            \n        </tbody>\n      </table>\n    \n      </div>\n    \n          <!--[if mso | IE]></td><td class=\"\" style=\"vertical-align:top;width:300px;\" ><![endif]-->\n            \n      <div\n         class=\"mj-column-per-50 mj-outlook-group-fix\" style=\"font-size:0px;text-align:left;direction:ltr;display:inline-block;vertical-align:top;width:100%;\"\n      >\n        \n      <table\n         border=\"0\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\" style=\"vertical-align:top;\" width=\"100%\"\n      >\n        <tbody>\n          \n              <tr>\n                <td\n                   align=\"left\" style=\"font-size:0px;padding:0px 25px;word-break:break-word;\"\n                >\n                  \n      <div\n         style=\"font-family:Roboto, Helvetica Neue, Helvetica, Arial, sans-serif;font-size:13px;line-height:1;text-align:left;color:#000000;\"\n      ><h2 style=\"color: rgb(0, 0, 0); text-transform: none;\">ƒê·ªãa ch·ªâ giao h√†ng</h2></div>\n    \n                </td>\n              </tr>\n            \n              <tr>\n                <td\n                   align=\"left\" style=\"font-size:0px;padding:10px 25px;word-break:break-word;\"\n                >\n                  \n      <div\n         style=\"font-family:Roboto, Helvetica Neue, Helvetica, Arial, sans-serif;font-size:13px;line-height:1;text-align:left;color:#000000;\"\n      ><div><font size=\"3\"><b>T√™n ng∆∞·ªùi nh·∫≠n:</b> {{ $('Webhook').item.json[\"body\"][\"name\"] }}</font></div><div><font size=\"3\"><b>S·ªë ƒëi·ªán tho·∫°i:</b> {{ $('Webhook').item.json[\"body\"][\"phone\"] }}</font></div><div><font size=\"3\"><b>ƒê·ªãa ch·ªâ:</b> {{ $('Webhook').item.json[\"body\"][\"address\"] }}</font></div><div><font size=\"3\"><br></font></div><div><span style=\"background-color: transparent;\"><font size=\"3\">Th·ªùi gian d·ª± ki·∫øn nh·∫≠n h√†ng: t·ª´ 2-4 ng√†y</font></span></div></div>\n    \n                </td>\n              </tr>\n            \n        </tbody>\n      </table>\n    \n      </div>\n    \n          <!--[if mso | IE]></td></tr></table><![endif]-->\n              </td>\n            </tr>\n          </tbody>\n        </table>\n        \n      </div>\n    \n      \n      <!--[if mso | IE]></td></tr></table><table align=\"center\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" class=\"\" style=\"width:600px;\" width=\"600\" ><tr><td style=\"line-height:0px;font-size:0px;mso-line-height-rule:exactly;\"><![endif]-->\n    \n      \n      <div  style=\"margin:0px auto;max-width:600px;\">\n        \n        <table\n           align=\"center\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\" style=\"width:100%;\"\n        >\n          <tbody>\n            <tr>\n              <td\n                 style=\"direction:ltr;font-size:0px;padding:20px 0;text-align:center;\"\n              >\n                <!--[if mso | IE]><table role=\"presentation\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"><tr><td class=\"\" style=\"vertical-align:top;width:600px;\" ><![endif]-->\n            \n      <div\n         class=\"mj-column-per-100 mj-outlook-group-fix\" style=\"font-size:0px;text-align:left;direction:ltr;display:inline-block;vertical-align:top;width:100%;\"\n      >\n        \n      <table\n         border=\"0\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\" style=\"vertical-align:top;\" width=\"100%\"\n      >\n        <tbody>\n          \n              <tr>\n                <td\n                   align=\"left\" style=\"font-size:0px;padding:10px 25px;word-break:break-word;\"\n                >\n                  \n      <div\n         style=\"font-family:Roboto, Helvetica Neue, Helvetica, Arial, sans-serif;font-size:13px;line-height:1;text-align:left;color:#000000;\"\n      ><div><span><b><font size=\"3\">DC MEDIA</font></b></span></div><div><font size=\"3\">H·ªó tr·ª£: 0333111868</font></div></div>\n    \n                </td>\n              </tr>\n            \n              <tr>\n                <td\n                   align=\"center\" style=\"font-size:0px;padding:10px 0px;word-break:break-word;\"\n                >\n                  \n      <p\n         style=\"border-top:solid 4px #2980b9;font-size:1px;margin:0px auto;width:100%;\"\n      >\n      </p>\n      \n      <!--[if mso | IE]><table align=\"center\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" style=\"border-top:solid 4px #2980b9;font-size:1px;margin:0px auto;width:600px;\" role=\"presentation\" width=\"600px\" ><tr><td style=\"height:0;line-height:0;\"> &nbsp;\n</td></tr></table><![endif]-->\n    \n    \n                </td>\n              </tr>\n            \n        </tbody>\n      </table>\n    \n      </div>\n    \n          <!--[if mso | IE]></td></tr></table><![endif]-->\n              </td>\n            </tr>\n          </tbody>\n        </table>\n        \n      </div>\n    \n      \n      <!--[if mso | IE]></td></tr></table><![endif]-->\n    \n    \n      </div>\n    \n      </body>\n    </html>\n  ","options":{}},"id":"b9cf793d-2532-4166-b068-0298608ab418","name":"Send Email","type":"n8n-nodes-base.emailSend","typeVersion":2,"position":[1040,600],"credentials":{"smtp":{"id":"62","name":"SMTP no-reply@dcmedia.vn"}}}],"connections":{"Webhook":{"main":[[{"node":"Code","type":"main","index":0}]]},"Code":{"main":[[{"node":"Send Email","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{},"versionId":"5c91f990-12bf-4bbf-aae9-5fc9a2126c31","triggerCount":1,"tags":[{"createdAt":"2023-07-14T18:38:08.838Z","updatedAt":"2023-07-14T18:38:08.838Z","id":"26","name":"dcgr"}]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-07-20T14:41:34.176Z","updatedAt":"2023-07-26T08:29:06.000Z","id":"216","name":"TMHN - B√°o Ti·ªÅn - N8N 200723","active":false,"nodes":[{"parameters":{"httpMethod":"POST","path":"tmhn-xn3-baotien","options":{}},"id":"e88a520f-706c-4bb3-81e9-f157a9a6197b","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[-1980,880],"webhookId":"b459d9da-c462-43e0-880c-12b8d6304763"},{"parameters":{"mode":"runOnceForEachItem","jsCode":"if (\n  ($('getBankData').item.json.result.transactionType.type === '-' &&\n    $input.item.json.enableOutgoing) ||\n  ($('getBankData').item.json.result.transactionType.type === '+' &&\n    $input.item.json.enableIncoming)\n) {\n  const data = $('getBankData').first().json.result;\n\n  let elements = [];\n\n  elements.push({\n    tag: 'div',\n    fields: [\n      {\n        is_short: false,\n        text: {\n          tag: 'lark_md',\n          content: `**Ng√¢n h√†ng**: ${data.bankName.toUpperCase()}`,\n        },\n      },\n      {\n        is_short: false,\n        text: {\n          tag: 'lark_md',\n          content: `**S·ªë t√†i kho·∫£n**: ${data.receiverAccount}`,\n        },\n      },\n      {\n        is_short: false,\n        text: {\n          tag: 'lark_md',\n          content: `**S·ªë d∆∞ thay ƒë·ªïi:** ${data.transactionType.type} ${data.transactionAmount.amountText} VND`,\n        },\n      },\n      {\n        is_short: false,\n        text: {\n          tag: 'lark_md',\n          content: `**N·ªôi dung:** ${data.transactionMessage}`,\n        },\n      },\n    ],\n  });\n\n  // Append transaction ID if exist\n  if (data.transactionId) {\n    elements[0].fields.push({\n      is_short: false,\n      text: {\n        tag: 'lark_md',\n        content: `**M√£ giao d·ªãch:** ${data.transactionId}`,\n      },\n    });\n  }\n\n  // Append received time\n  elements[0].fields.push({\n    is_short: false,\n    text: {\n      tag: 'lark_md',\n      content: `**Th·ªùi gian nh·∫≠n:** ${data.receivedTime.text}`,\n    },\n  });\n\n  // Ki·ªÉm tra enableBalance n·∫øu true th√¨ th√™m ph·∫ßn t·ª≠ \"S·ªë d∆∞ t·∫°m t√≠nh\" v√†o m·∫£ng fields\n  if ($input.item.json.enableBalance) {\n    const balanceIndex = elements[0].fields.findIndex((field) =>\n      field?.text?.content?.includes('S·ªë d∆∞ thay ƒë·ªïi')\n    );\n    if (balanceIndex !== -1) {\n      elements[0].fields.splice(balanceIndex + 1, 0, {\n        is_short: false,\n        text: {\n          tag: 'lark_md',\n          content: `**S·ªë d∆∞ t·∫°m t√≠nh**: ${data.balance.amountText} VND`,\n        },\n      });\n    }\n  }\n\n  // create message card\n  let result = {\n    msg_type: 'interactive',\n    card: {\n      config: {\n        wide_screen_mode: true,\n      },\n      header: {\n        template: data.larkMessConfig?.cardColor ?? 'blue',\n        title: {\n          content: `${data.bankName.toUpperCase()}-${data.receiverAccount} (${\n            data.transactionType.type\n          }) ${data.transactionAmount.amountText}VND`,\n          tag: 'plain_text',\n        },\n      },\n      elements,\n    },\n  };\n\n  return {\n    json: {\n      isSend: true,\n      data: result,\n      customBotURL: $input.item.json.customBotURL,\n    },\n  };\n}\n\nreturn {\n  json: {\n    isSend: false,\n  },\n};\n"},"id":"9943613f-1005-4b5c-bd0b-23052e6c0259","name":"Convert to Lark Message Card","type":"n8n-nodes-base.code","typeVersion":1,"position":[320,920]},{"parameters":{"method":"POST","url":"=https://open.larksuite.com/open-apis/auth/v3/tenant_access_token/internal/","sendBody":true,"specifyBody":"json","jsonBody":"={ \"app_id\" : \"{{ $input.item.json[\"appId\"] }}\", \"app_secret\" : \"{{ $input.item.json[\"appSecret\"] }}\" }","options":{}},"id":"0d2755c2-5381-44f8-976a-7bd4b6434ab8","name":"Get Lark tenant access token","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[-740,620]},{"parameters":{"method":"POST","url":"={{ $input.item.json.customBotURL }}","sendBody":true,"specifyBody":"json","jsonBody":"={{ JSON.stringify($input.item.json.data)}}","options":{}},"id":"6651a6c4-4e3e-4233-a3a4-8dc0a38644f1","name":"[Lark] Send noti to group chat","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[740,780]},{"parameters":{"mode":"runOnceForEachItem","jsCode":"if (\n  ($('getBankData').item.json.result.transactionType.type === '-' &&\n    $input.item.json.enableOutgoing) ||\n  ($('getBankData').item.json.result.transactionType.type === '+' &&\n    $input.item.json.enableIncoming)\n) {\n  const data = $('getBankData').first().json.result;\n\n  // Convert to Lark Base format\n  const records = [\n    {\n      fields: {\n        ID: data.bankName + '-' + data.receiverAccount,\n        Bank: data.bankName.toUpperCase(),\n        Account: data.receiverAccount,\n        'Transaction Type': data.transactionType.typeText,\n        Debit:\n          data.transactionType.type === '+'\n            ? data.transactionAmount.amount\n            : undefined,\n        Credit:\n          data.transactionType.type === '-'\n            ? data.transactionAmount.amount\n            : undefined,\n        'Transaction ID': data.transactionId,\n        'Transaction Message': data.transactionMessage,\n        'Original Message': data.originalMessage,\n        'Time received': data.receivedTime.timestamp,\n      },\n    },\n  ];\n\n  // Ki·ªÉm tra enableBalance n·∫øu true th√¨ th√™m ph·∫ßn t·ª≠ \"Balance\" v√†o m·∫£ng fields\n  if ($input.item.json.enableBalance) {\n    records[0].fields = {\n      ...records[0].fields,\n      Balance: data.balance.amount,\n    };\n  }\n\n  return {\n    json: {\n      isSend: true,\n      records,\n      configs: {\n        baseId: $input.item.json.baseId,\n        tableId: $input.item.json.tableId,\n      },\n    },\n  };\n}\n\nreturn {\n  json: {\n    isSend: false,\n  },\n};\n"},"id":"8929f771-2ad4-4ec4-91e4-aba898680c2f","name":"Convert to Lark Base format","type":"n8n-nodes-base.code","typeVersion":1,"position":[300,520]},{"parameters":{"method":"POST","url":"=https://open.larksuite.com/open-apis/bitable/v1/apps/{{ $json[\"configs\"][\"baseId\"] }}/tables/{{  $json[\"configs\"][\"tableId\"]}}/records/batch_create","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $node[\"Get Lark tenant access token\"].json.tenant_access_token }}"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\"records\":{{ JSON.stringify($json[\"records\"]) }}}","options":{}},"id":"ffacdea7-4d5f-491e-9544-6b9ee3ad187c","name":"[SMS Log] Add records to Bitable","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[720,460]},{"parameters":{"conditions":{"boolean":[{"value1":"={{ $json.isBankSupport }}","value2":true}]}},"id":"b7020efa-7b8f-4b00-847c-30cc6e91bafe","name":"ifBankSupport","type":"n8n-nodes-base.if","typeVersion":1,"position":[-1560,880]},{"parameters":{"method":"POST","url":"https://app.n8n.vn/webhook/kdigi-bank-bot-process-data","sendBody":true,"specifyBody":"json","jsonBody":"={{ JSON.stringify($input.first().json.body) }}","options":{}},"id":"1f913df2-45a6-4490-b225-4b093f7cc697","name":"getBankData","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[-1780,880]},{"parameters":{},"id":"d11f9ecf-0cc2-4887-9436-890b31e711a0","name":"Start Actions","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[-1360,860]},{"parameters":{"mode":"runOnceForEachItem","jsCode":"if (\n  ($('getBankData').item.json.result.transactionType.type === '-' &&\n    $input.item.json.enableOutgoing) ||\n  ($('getBankData').item.json.result.transactionType.type === '+' &&\n    $input.item.json.enableIncoming)\n) {\n  const data = $('getBankData').first().json.result;\n\n  let message = [];\n\n  message.push(\n    `<b>${data.bankName.toUpperCase()}-${data.receiverAccount} (${\n      data.transactionType.type\n    }) ${data.transactionAmount.amountText}VND</b>\\n`,\n    `<b>Ng√¢n h√†ng:</b> ${data.bankName.toUpperCase()}`,\n    `<b>S·ªë t√†i kho·∫£n:</b> ${data.receiverAccount}`,\n    `<b>S·ªë d∆∞ thay ƒë·ªïi:</b> ${data.transactionType.type} ${data.transactionAmount.amountText} VND`\n  );\n\n  // Add balance\n  if ($input.item.json.enableBalance) {\n    message.push(`<b>S·ªë d∆∞ t·∫°m t√≠nh:</b> ${data.balance.amountText} VND`);\n  }\n\n  message.push(`<b>N·ªôi dung:</b>\\n ${data.transactionMessage}`);\n\n  // Check transaction ID\n  if (data.transactionId) {\n    message.push(`<b>M√£ giao d·ªãch:</b> ${data.transactionId}`);\n  }\n\n  message.push(`<b>Th·ªùi gian nh·∫≠n:</b> ${data.receivedTime.text}`);\n\n  return {\n    json: {\n      isSend: true,\n      botToken: $input.item.json.botToken,\n      payload: {\n        chat_id: $input.item.json.chatId,\n        parse_mode: 'HTML',\n        text: message.join('\\n'),\n      },\n    },\n  };\n}\n\nreturn {\n  json: {\n    isSend: false,\n  },\n};\n"},"id":"3368202b-c403-4887-b31e-ae0754628222","name":"Create Telegram Message","type":"n8n-nodes-base.code","typeVersion":1,"position":[-300,1700]},{"parameters":{"method":"POST","url":"=https://api.telegram.org/bot{{ $input.item.json.botToken }}/sendMessage ","sendBody":true,"specifyBody":"json","jsonBody":"={{ JSON.stringify($input.item.json.payload) }}","options":{}},"id":"8f39e817-354b-4d8b-b958-5bd4d643d65e","name":"Send to Telegram chat","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[160,1620]},{"parameters":{"values":{"string":[{"name":"appId","value":"cli_a433ff4a74f89009"},{"name":"appSecret","value":"LL8RUtLIixRrw3t5qLUkwcdBhbgOWpIr"}]},"options":{}},"id":"ce34b53a-ffb0-4eef-bfba-ef5b9ac26575","name":"Set Lark Configs","type":"n8n-nodes-base.set","typeVersion":2,"position":[-920,620]},{"parameters":{"values":{"string":[{"name":"customBotURL","value":"https://open.larksuite.com/open-apis/bot/v2/hook/27387efd-c40b-44c1-9872-6983f4f687c9"}],"boolean":[{"name":"enableBalance","value":true},{"name":"enableOTP","value":true},{"name":"enableOutgoing","value":true},{"name":"enableIncoming","value":true}]},"options":{}},"id":"dd449e58-7d04-4b11-9548-c084ccd3074b","name":"Set Lark Mess Config","type":"n8n-nodes-base.set","typeVersion":2,"position":[-320,880]},{"parameters":{"values":{"string":[{"name":"baseId","value":"LIx9b5n6wazCqns1euGuCOthsyh"},{"name":"tableId","value":"tblK7k96kQfosl5C"}],"boolean":[{"name":"enableBalance","value":true},{"name":"enableOTP","value":true},{"name":"enableOutgoing","value":true},{"name":"enableIncoming","value":true}]},"options":{}},"id":"0cdb64ca-4536-47f2-a31f-70bfe1159a6c","name":"Set Lark Base Config","type":"n8n-nodes-base.set","typeVersion":2,"position":[-300,480]},{"parameters":{},"id":"a81eb898-1732-403a-a1a1-ddc95eedc302","name":"Start Lark Actions","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[-1080,620]},{"parameters":{},"id":"650e01d0-bc7d-4859-a750-d739c50e2715","name":"Start Lark Base","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[-520,480]},{"parameters":{},"id":"1950ee4a-5a13-4abe-9adc-dc0ea7e81a49","name":"Start Lark Mess","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[-540,880]},{"parameters":{},"id":"17ffdc6d-0a98-4bb7-9092-e580c9e1f336","name":"Start Telegram Actions","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[-1080,1620]},{"parameters":{"values":{"string":[{"name":"botToken","value":"set-bot-token"},{"name":"chatId","value":"set-chat-id"}],"boolean":[{"name":"enableBalance","value":true},{"name":"enableOTP","value":true},{"name":"enableOutgoing","value":true},{"name":"enableIncoming","value":true}]},"options":{}},"id":"1cf412fe-fe69-4db7-a176-1e3ac5ca0e72","name":"Set Telegram Config","type":"n8n-nodes-base.set","typeVersion":2,"position":[-900,1620]},{"parameters":{},"id":"83af4cae-7d99-4924-871e-614d2567a64f","name":"Start Lark Base Actions","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[-80,460]},{"parameters":{},"id":"3519a537-2ef5-44ee-b0ca-7bdead459400","name":"Start Lark Mess Actions","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[-100,860]},{"parameters":{"mode":"runOnceForEachItem","jsCode":"const smsContent = $('Webhook').first().json.body;\n\n// create message card\nlet result = {\n  msg_type: 'text',\n  content: {\n    text: `T·ª´: ${smsContent.from}\\n${smsContent.text.toString()}`,\n  },\n};\n\nreturn {\n  json: {\n    data: result,\n    customBotURL: $input.item.json.customBotURL,\n  },\n};\n"},"id":"edbde0fe-1bbd-45c9-892d-0641a213bbd7","name":"Convert to Message Card for OTP","type":"n8n-nodes-base.code","typeVersion":1,"position":[320,760]},{"parameters":{},"id":"b1f7e46e-8e3f-498a-9c63-bf34ba18abfa","name":"Start Telegram Mess Actions","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[-700,1620]},{"parameters":{"mode":"runOnceForEachItem","jsCode":"const smsContent = $('Webhook').first().json.body;\n\nlet message = [];\n\nmessage.push(\n  `<b>${smsContent.from.toUpperCase()}</b>\\n`,\n  `${smsContent.text.toString()}`\n);\n\nreturn {\n  json: {\n    botToken: $input.item.json.botToken,\n    payload: {\n      chat_id: $input.item.json.chatId,\n      parse_mode: 'HTML',\n      text: message.join('\\n'),\n    },\n  },\n};\n"},"id":"3b1c3a52-83d7-4df2-ba68-872798dbaab4","name":"Create Telegram Message for OTP","type":"n8n-nodes-base.code","typeVersion":1,"position":[-180,1480]},{"parameters":{"conditions":{"boolean":[{"value1":"={{ $input.item.json.isSend }}","value2":true}]}},"id":"297ccbae-c773-46e6-9411-cc0ca9b3da0f","name":"ifSend","type":"n8n-nodes-base.if","typeVersion":1,"position":[520,920]},{"parameters":{"conditions":{"boolean":[{"value1":"={{ $input.item.json.isSend }}","value2":true}]}},"id":"6c135da0-b4d4-41e4-8833-b633d053a519","name":"ifSend1","type":"n8n-nodes-base.if","typeVersion":1,"position":[480,520]},{"parameters":{"conditions":{"boolean":[{"value1":"={{ $input.item.json.isSend }}","value2":true}]}},"id":"76ce2916-a35f-4b03-af06-8f3f54d382e7","name":"ifSend2","type":"n8n-nodes-base.if","typeVersion":1,"position":[-80,1700]},{"parameters":{"mode":"runOnceForEachItem","jsCode":"const smsContent = $('Webhook').first().json.body;\n\n  // Convert to Lark Base format\n  const records = [\n    {\n      fields: {\n        ID: smsContent.from,\n        Bank: smsContent.from,\n        'Transaction Type': 'OTP',\n        'Transaction Message': smsContent.text.toString(),\n        'Original Message': smsContent.text.toString(),\n        'Time received': smsContent.sentStamp,\n      },\n    },\n  ];\n\n  return {\n    json: {\n      records,\n      configs: {\n        baseId: $input.item.json.baseId,\n        tableId: $input.item.json.tableId,\n      },\n    },\n  };\n"},"id":"98a08057-4a8a-4f71-b110-189621867577","name":"Convert to Lark Base format OTP","type":"n8n-nodes-base.code","typeVersion":1,"position":[300,280]},{"parameters":{"conditions":{"string":[{"value1":"={{ $('Webhook').item.json.body.text }}","operation":"contains","value2":"OTP"}],"boolean":[{"value1":"={{ $input.item.json.enableOTP }}","value2":true}]}},"id":"a475a2fa-dff8-412a-9e7a-45d1579be325","name":"ifOTPLarkBase","type":"n8n-nodes-base.if","typeVersion":1,"position":[100,460]},{"parameters":{"conditions":{"string":[{"value1":"={{ $('Webhook').item.json.body.text }}","operation":"contains","value2":"OTP"}],"boolean":[{"value1":"={{ $input.item.json.enableOTP }}","value2":true}]}},"id":"49806a06-fe29-487f-8d16-d7d18f040882","name":"ifOTPLarkMess","type":"n8n-nodes-base.if","typeVersion":1,"position":[60,860]},{"parameters":{"conditions":{"string":[{"value1":"={{ $('Webhook').item.json.body.text }}","operation":"contains","value2":"OTP"}],"boolean":[{"value1":"={{ $input.item.json.enableOTP }}","value2":true}]}},"id":"65f2c80f-fd89-4e62-a0ca-a41bfb968869","name":"ifOTPTelegram","type":"n8n-nodes-base.if","typeVersion":1,"position":[-520,1620]},{"parameters":{"values":{"string":[{"name":"customBotURL","value":"https://open.larksuite.com/open-apis/bot/v2/hook/27387efd-c40b-44c1-9872-6983f4f687c9"}]},"options":{}},"id":"12dfbb19-54f3-4c45-9ba3-68ad377526a9","name":"Set Lark Mess Config1","type":"n8n-nodes-base.set","typeVersion":2,"position":[-1080,1180]},{"parameters":{"method":"POST","url":"={{ $input.item.json.customBotURL }}","sendBody":true,"specifyBody":"json","jsonBody":"={{ JSON.stringify($input.item.json.data)}}","options":{}},"id":"404f5d48-9ad2-4830-a1f4-70adfa54e62a","name":"[Lark] Send noti to group chat1","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[-660,1180]},{"parameters":{"mode":"runOnceForEachItem","jsCode":"const smsContent = $('Webhook').first().json.body;\n\n// create message card\nlet result = {\n  msg_type: 'text',\n  content: {\n    text: `T·ª´: ${smsContent.from}\\nN·ªôi dung: \\n${smsContent.text.toString()}`,\n  },\n};\n\nreturn {\n  json: {\n    data: result,\n    customBotURL: $input.item.json.customBotURL,\n  },\n};\n"},"id":"5fdccc26-ac26-4668-83e3-ba23a9a5b83c","name":"Convert to Message Card","type":"n8n-nodes-base.code","typeVersion":1,"position":[-880,1180]}],"connections":{"Webhook":{"main":[[{"node":"getBankData","type":"main","index":0}]]},"Convert to Lark Message Card":{"main":[[{"node":"ifSend","type":"main","index":0}]]},"Get Lark tenant access token":{"main":[[{"node":"Start Lark Base","type":"main","index":0},{"node":"Start Lark Mess","type":"main","index":0}]]},"Convert to Lark Base format":{"main":[[{"node":"ifSend1","type":"main","index":0}]]},"ifBankSupport":{"main":[[{"node":"Start Actions","type":"main","index":0}],[{"node":"Set Lark Mess Config1","type":"main","index":0}]]},"getBankData":{"main":[[{"node":"ifBankSupport","type":"main","index":0}]]},"Create Telegram Message":{"main":[[{"node":"ifSend2","type":"main","index":0}]]},"Set Lark Configs":{"main":[[{"node":"Get Lark tenant access token","type":"main","index":0}]]},"Set Lark Mess Config":{"main":[[{"node":"Start Lark Mess Actions","type":"main","index":0}]]},"Set Lark Base Config":{"main":[[{"node":"Start Lark Base Actions","type":"main","index":0}]]},"Start Lark Actions":{"main":[[{"node":"Set Lark Configs","type":"main","index":0}]]},"Start Lark Base":{"main":[[{"node":"Set Lark Base Config","type":"main","index":0}]]},"Start Lark Mess":{"main":[[{"node":"Set Lark Mess Config","type":"main","index":0}]]},"Start Telegram Actions":{"main":[[{"node":"Set Telegram Config","type":"main","index":0}]]},"Set Telegram Config":{"main":[[{"node":"Start Telegram Mess Actions","type":"main","index":0}]]},"Start Lark Base Actions":{"main":[[{"node":"ifOTPLarkBase","type":"main","index":0}]]},"Start Lark Mess Actions":{"main":[[{"node":"ifOTPLarkMess","type":"main","index":0}]]},"Convert to Message Card for OTP":{"main":[[{"node":"[Lark] Send noti to group chat","type":"main","index":0}]]},"Start Telegram Mess Actions":{"main":[[{"node":"ifOTPTelegram","type":"main","index":0}]]},"Create Telegram Message for OTP":{"main":[[{"node":"Send to Telegram chat","type":"main","index":0}]]},"ifSend":{"main":[[{"node":"[Lark] Send noti to group chat","type":"main","index":0}]]},"ifSend1":{"main":[[{"node":"[SMS Log] Add records to Bitable","type":"main","index":0}]]},"ifSend2":{"main":[[{"node":"Send to Telegram chat","type":"main","index":0}]]},"Convert to Lark Base format OTP":{"main":[[{"node":"[SMS Log] Add records to Bitable","type":"main","index":0}]]},"ifOTPLarkBase":{"main":[[{"node":"Convert to Lark Base format OTP","type":"main","index":0}],[{"node":"Convert to Lark Base format","type":"main","index":0}]]},"ifOTPLarkMess":{"main":[[{"node":"Convert to Message Card for OTP","type":"main","index":0}],[{"node":"Convert to Lark Message Card","type":"main","index":0}]]},"ifOTPTelegram":{"main":[[{"node":"Create Telegram Message for OTP","type":"main","index":0}],[{"node":"Create Telegram Message","type":"main","index":0}]]},"Set Lark Mess Config1":{"main":[[{"node":"Convert to Message Card","type":"main","index":0}]]},"Start Actions":{"main":[[{"node":"Start Lark Actions","type":"main","index":0}]]},"Convert to Message Card":{"main":[[{"node":"[Lark] Send noti to group chat1","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{"Webhook":[{"json":{"headers":{"host":"app.n8n.vn","user-agent":"SMS Forwarder App","transfer-encoding":"chunked","accept-encoding":"gzip","content-type":"application/json; charset=utf-8","x-forwarded-for":"171.224.177.18","x-forwarded-host":"app.n8n.vn","x-forwarded-port":"443","x-forwarded-proto":"https","x-forwarded-server":"f2605f992776","x-real-ip":"171.224.177.18"},"params":{},"query":{},"body":{"from":"ABBank","text":"TK268xxx0922 tai BIDV +400,000,000VND vao 10:48 21/07/2023. So du:412,040,620VND. ND: TKThe :2207201008449, tai Agribank. hx tra xn3 -CTLNHIDI000005159896347-11","sentStamp":1689912578000,"receivedStamp":1689912580093,"sim":"sim2"}}}]},"versionId":"84d50078-49e7-4cde-a28a-2ad9f7f43d43","triggerCount":1,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-07-20T16:00:48.043Z","updatedAt":"2023-07-24T10:01:03.000Z","id":"217","name":"baking","active":true,"nodes":[{"parameters":{"httpMethod":"POST","path":"az-bank-bot-api","options":{}},"id":"d9ab1efa-d1db-444d-ab20-308e890cd868","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[-1200,1200],"webhookId":"b459d9da-c462-43e0-880c-12b8d6304763"},{"parameters":{"mode":"runOnceForEachItem","jsCode":"if (\n  ($('getBankData').item.json.result.transactionType.type === '-' &&\n    $input.item.json.enableOutgoing) ||\n  ($('getBankData').item.json.result.transactionType.type === '+' &&\n    $input.item.json.enableIncoming)\n) {\n  const data = $('getBankData').first().json.result;\n\n  let elements = [];\n\n  elements.push({\n    tag: 'div',\n    fields: [\n      {\n        is_short: false,\n        text: {\n          tag: 'lark_md',\n          content: `**Ng√¢n h√†ng**: ${data.bankName.toUpperCase()}`,\n        },\n      },\n      {\n        is_short: false,\n        text: {\n          tag: 'lark_md',\n          content: `**S·ªë t√†i kho·∫£n**: ${data.receiverAccount}`,\n        },\n      },\n      {\n        is_short: false,\n        text: {\n          tag: 'lark_md',\n          content: `**S·ªë d∆∞ thay ƒë·ªïi:** ${data.transactionType.type} ${data.transactionAmount.amountText} VND`,\n        },\n      },\n      {\n        is_short: false,\n        text: {\n          tag: 'lark_md',\n          content: `**N·ªôi dung:** ${data.transactionMessage}`,\n        },\n      },\n    ],\n  });\n\n  // Append transaction ID if exist\n  if (data.transactionId) {\n    elements[0].fields.push({\n      is_short: false,\n      text: {\n        tag: 'lark_md',\n        content: `**M√£ giao d·ªãch:** ${data.transactionId}`,\n      },\n    });\n  }\n\n  // Append received time\n  elements[0].fields.push({\n    is_short: false,\n    text: {\n      tag: 'lark_md',\n      content: `**Th·ªùi gian nh·∫≠n:** ${data.receivedTime.text}`,\n    },\n  });\n\n  // Ki·ªÉm tra enableBalance n·∫øu true th√¨ th√™m ph·∫ßn t·ª≠ \"S·ªë d∆∞ t·∫°m t√≠nh\" v√†o m·∫£ng fields\n  if ($input.item.json.enableBalance) {\n    const balanceIndex = elements[0].fields.findIndex((field) =>\n      field?.text?.content?.includes('S·ªë d∆∞ thay ƒë·ªïi')\n    );\n    if (balanceIndex !== -1) {\n      elements[0].fields.splice(balanceIndex + 1, 0, {\n        is_short: false,\n        text: {\n          tag: 'lark_md',\n          content: `**S·ªë d∆∞ t·∫°m t√≠nh**: ${data.balance.amountText} VND`,\n        },\n      });\n    }\n  }\n\n  // create message card\n  let result = {\n    msg_type: 'interactive',\n    card: {\n      config: {\n        wide_screen_mode: true,\n      },\n      header: {\n        template: data.larkMessConfig?.cardColor ?? 'blue',\n        title: {\n          content: `${data.bankName.toUpperCase()}-${data.receiverAccount} (${\n            data.transactionType.type\n          }) ${data.transactionAmount.amountText}VND`,\n          tag: 'plain_text',\n        },\n      },\n      elements,\n    },\n  };\n\n  return {\n    json: {\n      isSend: true,\n      data: result,\n      customBotURL: $input.item.json.customBotURL,\n    },\n  };\n}\n\nreturn {\n  json: {\n    isSend: false,\n  },\n};\n"},"id":"0cfcf152-6e92-479c-845e-caf9d6f4d11b","name":"Convert to Lark Message Card","type":"n8n-nodes-base.code","typeVersion":1,"position":[1100,1240]},{"parameters":{"method":"POST","url":"=https://open.larksuite.com/open-apis/auth/v3/tenant_access_token/internal/","sendBody":true,"specifyBody":"json","jsonBody":"={ \"app_id\" : \"{{ $input.item.json[\"appId\"] }}\", \"app_secret\" : \"{{ $input.item.json[\"appSecret\"] }}\" }","options":{}},"id":"289f8a38-7670-4ffe-8881-cef5c49ea1e0","name":"Get Lark tenant access token","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[40,940]},{"parameters":{"method":"POST","url":"={{ $input.item.json.customBotURL }}","sendBody":true,"specifyBody":"json","jsonBody":"={{ JSON.stringify($input.item.json.data)}}","options":{}},"id":"f475e422-7cbf-4c99-a0c8-98fbf9e042f0","name":"[Lark] Send noti to group chat","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[1520,1100]},{"parameters":{"mode":"runOnceForEachItem","jsCode":"if (\n  ($('getBankData').item.json.result.transactionType.type === '-' &&\n    $input.item.json.enableOutgoing) ||\n  ($('getBankData').item.json.result.transactionType.type === '+' &&\n    $input.item.json.enableIncoming)\n) {\n  const data = $('getBankData').first().json.result;\n\n  // Convert to Lark Base format\n  const records = [\n    {\n      fields: {\n        ID: data.bankName + '-' + data.receiverAccount,\n        Bank: data.bankName.toUpperCase(),\n        Account: data.receiverAccount,\n        'Transaction Type': data.transactionType.typeText,\n        Debit:\n          data.transactionType.type === '+'\n            ? data.transactionAmount.amount\n            : undefined,\n        Credit:\n          data.transactionType.type === '-'\n            ? data.transactionAmount.amount\n            : undefined,\n        'Transaction ID': data.transactionId,\n        'Transaction Message': data.transactionMessage,\n        'Original Message': data.originalMessage,\n        'Time received': data.receivedTime.timestamp,\n      },\n    },\n  ];\n\n  // Ki·ªÉm tra enableBalance n·∫øu true th√¨ th√™m ph·∫ßn t·ª≠ \"Balance\" v√†o m·∫£ng fields\n  if ($input.item.json.enableBalance) {\n    records[0].fields = {\n      ...records[0].fields,\n      Balance: data.balance.amount,\n    };\n  }\n\n  return {\n    json: {\n      isSend: true,\n      records,\n      configs: {\n        baseId: $input.item.json.baseId,\n        tableId: $input.item.json.tableId,\n      },\n    },\n  };\n}\n\nreturn {\n  json: {\n    isSend: false,\n  },\n};\n"},"id":"2ee7ad35-523d-4c0c-b564-448610e30718","name":"Convert to Lark Base format","type":"n8n-nodes-base.code","typeVersion":1,"position":[1080,840]},{"parameters":{"method":"POST","url":"=https://open.larksuite.com/open-apis/bitable/v1/apps/{{ $json[\"configs\"][\"baseId\"] }}/tables/{{  $json[\"configs\"][\"tableId\"]}}/records/batch_create","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $node[\"Get Lark tenant access token\"].json.tenant_access_token }}"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\"records\":{{ JSON.stringify($json[\"records\"]) }}}","options":{}},"id":"51890b38-2da2-40f2-bd3a-9997e36154e2","name":"[SMS Log] Add records to Bitable","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[1500,780]},{"parameters":{"conditions":{"boolean":[{"value1":"={{ $json.isBankSupport }}","value2":true}]}},"id":"03139001-1a43-432d-935f-64a766c3e34d","name":"ifBankSupport","type":"n8n-nodes-base.if","typeVersion":1,"position":[-780,1200]},{"parameters":{"method":"POST","url":"https://app.n8n.vn/webhook/kdigi-bank-bot-process-data","sendBody":true,"specifyBody":"json","jsonBody":"={{ JSON.stringify($input.first().json.body) }}","options":{}},"id":"9ba5b6d7-f440-4abf-a602-93c2a3b00cee","name":"getBankData","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[-1000,1200]},{"parameters":{},"id":"318e58a2-b04e-4df2-b13b-4bc6ea0d24a3","name":"Start Actions","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[-580,1180]},{"parameters":{"mode":"runOnceForEachItem","jsCode":"if (\n  ($('getBankData').item.json.result.transactionType.type === '-' &&\n    $input.item.json.enableOutgoing) ||\n  ($('getBankData').item.json.result.transactionType.type === '+' &&\n    $input.item.json.enableIncoming)\n) {\n  const data = $('getBankData').first().json.result;\n\n  let message = [];\n\n  message.push(\n    `<b>${data.bankName.toUpperCase()}-${data.receiverAccount} (${\n      data.transactionType.type\n    }) ${data.transactionAmount.amountText}VND</b>\\n`,\n    `<b>Ng√¢n h√†ng:</b> ${data.bankName.toUpperCase()}`,\n    `<b>S·ªë t√†i kho·∫£n:</b> ${data.receiverAccount}`,\n    `<b>S·ªë d∆∞ thay ƒë·ªïi:</b> ${data.transactionType.type} ${data.transactionAmount.amountText} VND`\n  );\n\n  // Add balance\n  if ($input.item.json.enableBalance) {\n    message.push(`<b>S·ªë d∆∞ t·∫°m t√≠nh:</b> ${data.balance.amountText} VND`);\n  }\n\n  message.push(`<b>N·ªôi dung:</b>\\n ${data.transactionMessage}`);\n\n  // Check transaction ID\n  if (data.transactionId) {\n    message.push(`<b>M√£ giao d·ªãch:</b> ${data.transactionId}`);\n  }\n\n  message.push(`<b>Th·ªùi gian nh·∫≠n:</b> ${data.receivedTime.text}`);\n\n  return {\n    json: {\n      isSend: true,\n      botToken: $input.item.json.botToken,\n      payload: {\n        chat_id: $input.item.json.chatId,\n        parse_mode: 'HTML',\n        text: message.join('\\n'),\n      },\n    },\n  };\n}\n\nreturn {\n  json: {\n    isSend: false,\n  },\n};\n"},"id":"a92738bf-351b-4ad5-9063-0145ffbc1f73","name":"Create Telegram Message","type":"n8n-nodes-base.code","typeVersion":1,"position":[540,1680]},{"parameters":{"method":"POST","url":"=https://api.telegram.org/bot{{ $input.item.json.botToken }}/sendMessage ","sendBody":true,"specifyBody":"json","jsonBody":"={{ JSON.stringify($input.item.json.payload) }}","options":{}},"id":"13dfa099-f875-4008-a698-31a160d381d4","name":"Send to Telegram chat","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[1000,1600]},{"parameters":{"values":{"string":[{"name":"appId","value":"set-app-id"},{"name":"appSecret","value":"set-app-secret"}]},"options":{}},"id":"62ab396a-7a81-4505-afc1-ba8827456eb7","name":"Set Lark Configs","type":"n8n-nodes-base.set","typeVersion":2,"position":[-140,940]},{"parameters":{"values":{"string":[{"name":"customBotURL","value":"set-bot-url"}],"boolean":[{"name":"enableBalance","value":true},{"name":"enableOTP","value":true},{"name":"enableOutgoing","value":true},{"name":"enableIncoming","value":true}]},"options":{}},"id":"22e9c1ac-e144-481a-9630-6c4969fbbc6e","name":"Set Lark Mess Config","type":"n8n-nodes-base.set","typeVersion":2,"position":[460,1200]},{"parameters":{"values":{"string":[{"name":"baseId","value":"set-base-id"},{"name":"tableId","value":"set-table-id"}],"boolean":[{"name":"enableBalance","value":true},{"name":"enableOTP","value":true},{"name":"enableOutgoing","value":true},{"name":"enableIncoming","value":true}]},"options":{}},"id":"3c499e16-2c8d-4b2a-acf4-e0b417fcba5e","name":"Set Lark Base Config","type":"n8n-nodes-base.set","typeVersion":2,"position":[480,800]},{"parameters":{},"id":"4147d962-cc38-48fa-94d5-656e57d0d7f5","name":"Start Lark Actions","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[-300,940]},{"parameters":{},"id":"a59d757b-eb98-40fa-860c-dd71afbaf00c","name":"Start Lark Base","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[260,800]},{"parameters":{},"id":"dbb0adf1-3043-423d-99f8-0854ee36633d","name":"Start Lark Mess","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[240,1200]},{"parameters":{},"id":"60d026a0-03d0-4c9b-bfd7-341954a07d74","name":"Start Telegram Actions","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[-260,1600]},{"parameters":{"values":{"string":[{"name":"botToken","value":"set-bot-token"},{"name":"chatId","value":"set-chat-id"}],"boolean":[{"name":"enableBalance","value":true},{"name":"enableOTP","value":true},{"name":"enableOutgoing","value":true},{"name":"enableIncoming","value":true}]},"options":{}},"id":"67381484-b77e-40da-8320-a7cb31e62569","name":"Set Telegram Config","type":"n8n-nodes-base.set","typeVersion":2,"position":[-60,1600]},{"parameters":{},"id":"2a3e3854-d3cf-4032-bf7c-a0104c4e4879","name":"Start Lark Base Actions","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[700,780]},{"parameters":{},"id":"a6516260-bb51-486a-b66f-62f70ccfbc81","name":"Start Lark Mess Actions","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[680,1180]},{"parameters":{"mode":"runOnceForEachItem","jsCode":"const smsContent = $('Webhook').first().json.body;\n\n// create message card\nlet result = {\n  msg_type: 'text',\n  content: {\n    text: `T·ª´: ${smsContent.from}\\n${smsContent.text.toString()}`,\n  },\n};\n\nreturn {\n  json: {\n    data: result,\n    customBotURL: $input.item.json.customBotURL,\n  },\n};\n"},"id":"e2cfa286-4b38-463a-80c3-20285105b223","name":"Convert to Message Card for OTP","type":"n8n-nodes-base.code","typeVersion":1,"position":[1100,1080]},{"parameters":{},"id":"fc06e24b-d2f0-4af7-b6c3-2829be3c9ea7","name":"Start Telegram Mess Actions","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[140,1600]},{"parameters":{"mode":"runOnceForEachItem","jsCode":"const smsContent = $('Webhook').first().json.body;\n\nlet message = [];\n\nmessage.push(\n  `<b>${smsContent.from.toUpperCase()}</b>\\n`,\n  `${smsContent.text.toString()}`\n);\n\nreturn {\n  json: {\n    botToken: $input.item.json.botToken,\n    payload: {\n      chat_id: $input.item.json.chatId,\n      parse_mode: 'HTML',\n      text: message.join('\\n'),\n    },\n  },\n};\n"},"id":"617fc654-3680-4eda-82b3-4855e64c5901","name":"Create Telegram Message for OTP","type":"n8n-nodes-base.code","typeVersion":1,"position":[540,1520]},{"parameters":{"conditions":{"boolean":[{"value1":"={{ $input.item.json.isSend }}","value2":true}]}},"id":"395d5aec-e67f-4ca0-9cb3-e6c1294d0a3b","name":"ifSend","type":"n8n-nodes-base.if","typeVersion":1,"position":[1300,1240]},{"parameters":{"conditions":{"boolean":[{"value1":"={{ $input.item.json.isSend }}","value2":true}]}},"id":"693e2639-f7c3-482b-ad3d-a911af32b76b","name":"ifSend1","type":"n8n-nodes-base.if","typeVersion":1,"position":[1260,840]},{"parameters":{"conditions":{"boolean":[{"value1":"={{ $input.item.json.isSend }}","value2":true}]}},"id":"74e39910-d9e2-4c63-86fd-308541b54466","name":"ifSend2","type":"n8n-nodes-base.if","typeVersion":1,"position":[760,1680]},{"parameters":{"mode":"runOnceForEachItem","jsCode":"const smsContent = $('Webhook').first().json.body;\n\n  // Convert to Lark Base format\n  const records = [\n    {\n      fields: {\n        ID: smsContent.from,\n        Bank: smsContent.from,\n        'Transaction Type': 'OTP',\n        'Transaction Message': smsContent.text.toString(),\n        'Original Message': smsContent.text.toString(),\n        'Time received': smsContent.sentStamp,\n      },\n    },\n  ];\n\n  return {\n    json: {\n      records,\n      configs: {\n        baseId: $input.item.json.baseId,\n        tableId: $input.item.json.tableId,\n      },\n    },\n  };\n"},"id":"7567f0e4-14d7-4c78-ab82-a5edc54ecc17","name":"Convert to Lark Base format OTP","type":"n8n-nodes-base.code","typeVersion":1,"position":[1080,600]},{"parameters":{"conditions":{"string":[{"value1":"={{ $('Webhook').item.json.body.text }}","operation":"contains","value2":"OTP"}],"boolean":[{"value1":"={{ $input.item.json.enableOTP }}","value2":true}]}},"id":"70c43d6d-0547-4bf2-8f1b-af749fc47047","name":"ifOTPLarkBase","type":"n8n-nodes-base.if","typeVersion":1,"position":[880,780]},{"parameters":{"conditions":{"string":[{"value1":"={{ $('Webhook').item.json.body.text }}","operation":"contains","value2":"OTP"}],"boolean":[{"value1":"={{ $input.item.json.enableOTP }}","value2":true}]}},"id":"3d6cfc6a-cefe-4ff2-93c0-271348ce5952","name":"ifOTPLarkMess","type":"n8n-nodes-base.if","typeVersion":1,"position":[840,1180]},{"parameters":{"conditions":{"string":[{"value1":"={{ $('Webhook').item.json.body.text }}","operation":"contains","value2":"OTP"}],"boolean":[{"value1":"={{ $input.item.json.enableOTP }}","value2":true}]}},"id":"3c9457d4-8612-4200-9861-1a9b158ed5a0","name":"ifOTPTelegram","type":"n8n-nodes-base.if","typeVersion":1,"position":[320,1600]}],"connections":{"Webhook":{"main":[[{"node":"getBankData","type":"main","index":0}]]},"Convert to Lark Message Card":{"main":[[{"node":"ifSend","type":"main","index":0}]]},"Get Lark tenant access token":{"main":[[{"node":"Start Lark Base","type":"main","index":0},{"node":"Start Lark Mess","type":"main","index":0}]]},"Convert to Lark Base format":{"main":[[{"node":"ifSend1","type":"main","index":0}]]},"ifBankSupport":{"main":[[{"node":"Start Actions","type":"main","index":0}]]},"getBankData":{"main":[[{"node":"ifBankSupport","type":"main","index":0}]]},"Start Actions":{"main":[[{"node":"Start Telegram Actions","type":"main","index":0},{"node":"Start Lark Actions","type":"main","index":0}]]},"Create Telegram Message":{"main":[[{"node":"ifSend2","type":"main","index":0}]]},"Set Lark Configs":{"main":[[{"node":"Get Lark tenant access token","type":"main","index":0}]]},"Set Lark Mess Config":{"main":[[{"node":"Start Lark Mess Actions","type":"main","index":0}]]},"Set Lark Base Config":{"main":[[{"node":"Start Lark Base Actions","type":"main","index":0}]]},"Start Lark Actions":{"main":[[{"node":"Set Lark Configs","type":"main","index":0}]]},"Start Lark Base":{"main":[[{"node":"Set Lark Base Config","type":"main","index":0}]]},"Start Lark Mess":{"main":[[{"node":"Set Lark Mess Config","type":"main","index":0}]]},"Start Telegram Actions":{"main":[[{"node":"Set Telegram Config","type":"main","index":0}]]},"Set Telegram Config":{"main":[[{"node":"Start Telegram Mess Actions","type":"main","index":0}]]},"Start Lark Base Actions":{"main":[[{"node":"ifOTPLarkBase","type":"main","index":0}]]},"Start Lark Mess Actions":{"main":[[{"node":"ifOTPLarkMess","type":"main","index":0}]]},"Convert to Message Card for OTP":{"main":[[{"node":"[Lark] Send noti to group chat","type":"main","index":0}]]},"Start Telegram Mess Actions":{"main":[[{"node":"ifOTPTelegram","type":"main","index":0}]]},"Create Telegram Message for OTP":{"main":[[{"node":"Send to Telegram chat","type":"main","index":0}]]},"ifSend":{"main":[[{"node":"[Lark] Send noti to group chat","type":"main","index":0}]]},"ifSend1":{"main":[[{"node":"[SMS Log] Add records to Bitable","type":"main","index":0}]]},"ifSend2":{"main":[[{"node":"Send to Telegram chat","type":"main","index":0}]]},"Convert to Lark Base format OTP":{"main":[[{"node":"[SMS Log] Add records to Bitable","type":"main","index":0}]]},"ifOTPLarkBase":{"main":[[{"node":"Convert to Lark Base format OTP","type":"main","index":0}],[{"node":"Convert to Lark Base format","type":"main","index":0}]]},"ifOTPLarkMess":{"main":[[{"node":"Convert to Message Card for OTP","type":"main","index":0}],[{"node":"Convert to Lark Message Card","type":"main","index":0}]]},"ifOTPTelegram":{"main":[[{"node":"Create Telegram Message for OTP","type":"main","index":0}],[{"node":"Create Telegram Message","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{},"versionId":"df218921-ed0d-4843-9af0-6728199cbbc9","triggerCount":1,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-07-22T04:14:34.430Z","updatedAt":"2023-07-25T04:26:31.000Z","id":"218","name":"Lark Banking","active":true,"nodes":[{"parameters":{"httpMethod":"POST","path":"bot-ngan-hang-vung-cao","options":{}},"id":"0043d144-2381-4cba-902c-f6443762ec51","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[-1740,840],"webhookId":"b459d9da-c462-43e0-880c-12b8d6304763"},{"parameters":{"mode":"runOnceForEachItem","jsCode":"if (\n  ($('getBankData').item.json.result.transactionType.type === '-' &&\n    $input.item.json.enableOutgoing) ||\n  ($('getBankData').item.json.result.transactionType.type === '+' &&\n    $input.item.json.enableIncoming)\n) {\n  const data = $('getBankData').first().json.result;\n\n  let elements = [];\n\n  elements.push({\n    tag: 'div',\n    fields: [\n      {\n        is_short: false,\n        text: {\n          tag: 'lark_md',\n          content: `**Ng√¢n h√†ng**: ${data.bankName.toUpperCase()}`,\n        },\n      },\n      {\n        is_short: false,\n        text: {\n          tag: 'lark_md',\n          content: `**S·ªë t√†i kho·∫£n**: ${data.receiverAccount}`,\n        },\n      },\n      {\n        is_short: false,\n        text: {\n          tag: 'lark_md',\n          content: `**S·ªë d∆∞ thay ƒë·ªïi:** ${data.transactionType.type} ${data.transactionAmount.amountText} VND`,\n        },\n      },\n      {\n        is_short: false,\n        text: {\n          tag: 'lark_md',\n          content: `**N·ªôi dung:** ${data.transactionMessage}`,\n        },\n      },\n    ],\n  });\n\n  // Append transaction ID if exist\n  if (data.transactionId) {\n    elements[0].fields.push({\n      is_short: false,\n      text: {\n        tag: 'lark_md',\n        content: `**M√£ giao d·ªãch:** ${data.transactionId}`,\n      },\n    });\n  }\n\n  // Append received time\n  elements[0].fields.push({\n    is_short: false,\n    text: {\n      tag: 'lark_md',\n      content: `**Th·ªùi gian nh·∫≠n:** ${data.receivedTime.text}`,\n    },\n  });\n\n  // Ki·ªÉm tra enableBalance n·∫øu true th√¨ th√™m ph·∫ßn t·ª≠ \"S·ªë d∆∞ t·∫°m t√≠nh\" v√†o m·∫£ng fields\n  if ($input.item.json.enableBalance) {\n    const balanceIndex = elements[0].fields.findIndex((field) =>\n      field?.text?.content?.includes('S·ªë d∆∞ thay ƒë·ªïi')\n    );\n    if (balanceIndex !== -1) {\n      elements[0].fields.splice(balanceIndex + 1, 0, {\n        is_short: false,\n        text: {\n          tag: 'lark_md',\n          content: `**S·ªë d∆∞ t·∫°m t√≠nh**: ${data.balance.amountText} VND`,\n        },\n      });\n    }\n  }\n\n  // create message card\n  let result = {\n    msg_type: 'interactive',\n    card: {\n      config: {\n        wide_screen_mode: true,\n      },\n      header: {\n        template: data.larkMessConfig?.cardColor ?? 'blue',\n        title: {\n          content: `${data.bankName.toUpperCase()}-${data.receiverAccount} (${\n            data.transactionType.type\n          }) ${data.transactionAmount.amountText}VND`,\n          tag: 'plain_text',\n        },\n      },\n      elements,\n    },\n  };\n\n  return {\n    json: {\n      isSend: true,\n      data: result,\n      customBotURL: $input.item.json.customBotURL,\n    },\n  };\n}\n\nreturn {\n  json: {\n    isSend: false,\n  },\n};\n"},"id":"57b1ad46-38b3-4f9b-8548-7f5130889798","name":"Convert to Lark Message Card","type":"n8n-nodes-base.code","typeVersion":1,"position":[560,880]},{"parameters":{"method":"POST","url":"=https://open.larksuite.com/open-apis/auth/v3/tenant_access_token/internal/","sendBody":true,"specifyBody":"json","jsonBody":"={ \"app_id\" : \"{{ $input.item.json[\"appId\"] }}\", \"app_secret\" : \"{{ $input.item.json[\"appSecret\"] }}\" }","options":{}},"id":"db257f98-2fb1-4a22-b7b9-103110c10461","name":"Get Lark tenant access token","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[-500,580]},{"parameters":{"method":"POST","url":"={{ $input.item.json.customBotURL }}","sendBody":true,"specifyBody":"json","jsonBody":"={{ JSON.stringify($input.item.json.data)}}","options":{}},"id":"e0e859a8-71b4-41c6-af3d-4240b8f119a7","name":"[Lark] Send noti to group chat","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[980,740]},{"parameters":{"mode":"runOnceForEachItem","jsCode":"if (\n  ($('getBankData').item.json.result.transactionType.type === '-' &&\n    $input.item.json.enableOutgoing) ||\n  ($('getBankData').item.json.result.transactionType.type === '+' &&\n    $input.item.json.enableIncoming)\n) {\n  const data = $('getBankData').first().json.result;\n\n  // Convert to Lark Base format\n  const records = [\n    {\n      fields: {\n        ID: data.bankName + '-' + data.receiverAccount,\n        Bank: data.bankName.toUpperCase(),\n        Account: data.receiverAccount,\n        'Transaction Type': data.transactionType.typeText,\n        Debit:\n          data.transactionType.type === '+'\n            ? data.transactionAmount.amount\n            : undefined,\n        Credit:\n          data.transactionType.type === '-'\n            ? data.transactionAmount.amount\n            : undefined,\n        'Transaction ID': data.transactionId,\n        'Transaction Message': data.transactionMessage,\n        'Original Message': data.originalMessage,\n        'Time received': data.receivedTime.timestamp,\n      },\n    },\n  ];\n\n  // Ki·ªÉm tra enableBalance n·∫øu true th√¨ th√™m ph·∫ßn t·ª≠ \"Balance\" v√†o m·∫£ng fields\n  if ($input.item.json.enableBalance) {\n    records[0].fields = {\n      ...records[0].fields,\n      Balance: data.balance.amount,\n    };\n  }\n\n  return {\n    json: {\n      isSend: true,\n      records,\n      configs: {\n        baseId: $input.item.json.baseId,\n        tableId: $input.item.json.tableId,\n      },\n    },\n  };\n}\n\nreturn {\n  json: {\n    isSend: false,\n  },\n};\n"},"id":"22287d6e-bdc7-410c-974c-b708eb44efa3","name":"Convert to Lark Base format","type":"n8n-nodes-base.code","typeVersion":1,"position":[540,480]},{"parameters":{"method":"POST","url":"=https://open.larksuite.com/open-apis/bitable/v1/apps/{{ $json[\"configs\"][\"baseId\"] }}/tables/{{  $json[\"configs\"][\"tableId\"]}}/records/batch_create","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $node[\"Get Lark tenant access token\"].json.tenant_access_token }}"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\"records\":{{ JSON.stringify($json[\"records\"]) }}}","options":{}},"id":"c21ececa-3bf5-492f-9c02-74bb6e6f82d4","name":"[SMS Log] Add records to Bitable","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[960,420]},{"parameters":{"conditions":{"boolean":[{"value1":"={{ $json.isBankSupport }}","value2":true}]}},"id":"61d17918-8e5a-4d14-a130-b30a80694cf5","name":"ifBankSupport","type":"n8n-nodes-base.if","typeVersion":1,"position":[-1320,840]},{"parameters":{"method":"POST","url":"https://app.n8n.vn/webhook/kdigi-bank-bot-process-data","sendBody":true,"specifyBody":"json","jsonBody":"={{ JSON.stringify($input.first().json.body) }}","options":{}},"id":"b57378fe-e994-4445-879a-80b9d1e4ccb9","name":"getBankData","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[-1540,840]},{"parameters":{},"id":"68e08078-856b-4adc-b14d-6aebeb411260","name":"Start Actions","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[-1120,820]},{"parameters":{"mode":"runOnceForEachItem","jsCode":"if (\n  ($('getBankData').item.json.result.transactionType.type === '-' &&\n    $input.item.json.enableOutgoing) ||\n  ($('getBankData').item.json.result.transactionType.type === '+' &&\n    $input.item.json.enableIncoming)\n) {\n  const data = $('getBankData').first().json.result;\n\n  let message = [];\n\n  message.push(\n    `<b>${data.bankName.toUpperCase()}-${data.receiverAccount} (${\n      data.transactionType.type\n    }) ${data.transactionAmount.amountText}VND</b>\\n`,\n    `<b>Ng√¢n h√†ng:</b> ${data.bankName.toUpperCase()}`,\n    `<b>S·ªë t√†i kho·∫£n:</b> ${data.receiverAccount}`,\n    `<b>S·ªë d∆∞ thay ƒë·ªïi:</b> ${data.transactionType.type} ${data.transactionAmount.amountText} VND`\n  );\n\n  // Add balance\n  if ($input.item.json.enableBalance) {\n    message.push(`<b>S·ªë d∆∞ t·∫°m t√≠nh:</b> ${data.balance.amountText} VND`);\n  }\n\n  message.push(`<b>N·ªôi dung:</b>\\n ${data.transactionMessage}`);\n\n  // Check transaction ID\n  if (data.transactionId) {\n    message.push(`<b>M√£ giao d·ªãch:</b> ${data.transactionId}`);\n  }\n\n  message.push(`<b>Th·ªùi gian nh·∫≠n:</b> ${data.receivedTime.text}`);\n\n  return {\n    json: {\n      isSend: true,\n      botToken: $input.item.json.botToken,\n      payload: {\n        chat_id: $input.item.json.chatId,\n        parse_mode: 'HTML',\n        text: message.join('\\n'),\n      },\n    },\n  };\n}\n\nreturn {\n  json: {\n    isSend: false,\n  },\n};\n"},"id":"7efe53ab-afa2-4a98-b301-2ab1abe98977","name":"Create Telegram Message","type":"n8n-nodes-base.code","typeVersion":1,"position":[0,1320]},{"parameters":{"method":"POST","url":"=https://api.telegram.org/bot{{ $input.item.json.botToken }}/sendMessage ","sendBody":true,"specifyBody":"json","jsonBody":"={{ JSON.stringify($input.item.json.payload) }}","options":{}},"id":"a9f4bfa3-be88-4f82-af99-a94043aa23d9","name":"Send to Telegram chat","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[460,1240]},{"parameters":{"values":{"string":[{"name":"appId","value":"cli_a42e504a2878900a"},{"name":"appSecret","value":"4V5q5bMjcHWKYHW3O2WHVgJhKKZBOUd2"}]},"options":{}},"id":"25dc9a50-605d-4810-b16d-e6824f0046b7","name":"Set Lark Configs","type":"n8n-nodes-base.set","typeVersion":2,"position":[-680,580]},{"parameters":{"values":{"string":[{"name":"customBotURL","value":"https://open.larksuite.com/open-apis/bot/v2/hook/cb8e0c51-b7fe-4342-8f80-cbb6865b84b5"}],"boolean":[{"name":"enableBalance","value":true},{"name":"enableOTP","value":true},{"name":"enableOutgoing","value":true},{"name":"enableIncoming","value":true}]},"options":{}},"id":"dd0d2ff2-f293-40a6-bb1a-11ba74394a7e","name":"Set Lark Mess Config","type":"n8n-nodes-base.set","typeVersion":2,"position":[-80,840]},{"parameters":{"values":{"string":[{"name":"baseId","value":"UT0WbzeGiaGxhAsMGpYupQEnsTc"},{"name":"tableId","value":"tblB4B7sdwFvQS6R"}],"boolean":[{"name":"enableBalance","value":true},{"name":"enableOTP","value":true},{"name":"enableOutgoing","value":true},{"name":"enableIncoming","value":true}]},"options":{}},"id":"c51c88f7-525e-4aca-a960-cd5727a9d6d0","name":"Set Lark Base Config","type":"n8n-nodes-base.set","typeVersion":2,"position":[-60,440]},{"parameters":{},"id":"b45b3aaf-5a16-40df-8527-a33aa4ee7457","name":"Start Lark Actions","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[-840,580]},{"parameters":{},"id":"0ae37a53-288a-4f33-bf7f-78408053bdb4","name":"Start Lark Base","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[-280,440]},{"parameters":{},"id":"29db1da4-4dca-4554-8495-0ed95d26e25d","name":"Start Lark Mess","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[-300,840]},{"parameters":{},"id":"f1553405-0bba-4821-b096-5cf52062c469","name":"Start Telegram Actions","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[-800,1240]},{"parameters":{"values":{"string":[{"name":"botToken","value":"set-bot-token"},{"name":"chatId","value":"set-chat-id"}],"boolean":[{"name":"enableBalance","value":true},{"name":"enableOTP","value":true},{"name":"enableOutgoing","value":true},{"name":"enableIncoming","value":true}]},"options":{}},"id":"257ae404-e4d0-46c9-a019-74f45455fe6e","name":"Set Telegram Config","type":"n8n-nodes-base.set","typeVersion":2,"position":[-600,1240]},{"parameters":{},"id":"496e695c-158b-415d-901b-3620f1fd1919","name":"Start Lark Base Actions","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[160,420]},{"parameters":{},"id":"2f1287a2-4ca5-4d34-b599-a4fa07e65357","name":"Start Lark Mess Actions","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[140,820]},{"parameters":{"mode":"runOnceForEachItem","jsCode":"const smsContent = $('Webhook').first().json.body;\n\n// create message card\nlet result = {\n  msg_type: 'text',\n  content: {\n    text: `T·ª´: ${smsContent.from}\\n${smsContent.text.toString()}`,\n  },\n};\n\nreturn {\n  json: {\n    data: result,\n    customBotURL: $input.item.json.customBotURL,\n  },\n};\n"},"id":"695c7049-4995-42bb-8bac-3f5c57aea40c","name":"Convert to Message Card for OTP","type":"n8n-nodes-base.code","typeVersion":1,"position":[560,720]},{"parameters":{},"id":"92642461-b736-4345-ac3a-d2aa8569580a","name":"Start Telegram Mess Actions","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[-400,1240]},{"parameters":{"mode":"runOnceForEachItem","jsCode":"const smsContent = $('Webhook').first().json.body;\n\nlet message = [];\n\nmessage.push(\n  `<b>${smsContent.from.toUpperCase()}</b>\\n`,\n  `${smsContent.text.toString()}`\n);\n\nreturn {\n  json: {\n    botToken: $input.item.json.botToken,\n    payload: {\n      chat_id: $input.item.json.chatId,\n      parse_mode: 'HTML',\n      text: message.join('\\n'),\n    },\n  },\n};\n"},"id":"b8b1e2fa-7003-4af2-84ee-73cbc38975ef","name":"Create Telegram Message for OTP","type":"n8n-nodes-base.code","typeVersion":1,"position":[0,1160]},{"parameters":{"conditions":{"boolean":[{"value1":"={{ $input.item.json.isSend }}","value2":true}]}},"id":"874574ca-c44a-441c-b0c0-921f65114f42","name":"ifSend","type":"n8n-nodes-base.if","typeVersion":1,"position":[760,880]},{"parameters":{"conditions":{"boolean":[{"value1":"={{ $input.item.json.isSend }}","value2":true}]}},"id":"e71272db-461f-42e9-a59e-c925fa7cda08","name":"ifSend1","type":"n8n-nodes-base.if","typeVersion":1,"position":[720,480]},{"parameters":{"conditions":{"boolean":[{"value1":"={{ $input.item.json.isSend }}","value2":true}]}},"id":"b0b27100-099e-46a9-abdc-c20b22b07889","name":"ifSend2","type":"n8n-nodes-base.if","typeVersion":1,"position":[220,1320]},{"parameters":{"mode":"runOnceForEachItem","jsCode":"const smsContent = $('Webhook').first().json.body;\n\n  // Convert to Lark Base format\n  const records = [\n    {\n      fields: {\n        ID: smsContent.from,\n        Bank: smsContent.from,\n        'Transaction Type': 'OTP',\n        'Transaction Message': smsContent.text.toString(),\n        'Original Message': smsContent.text.toString(),\n        'Time received': smsContent.sentStamp,\n      },\n    },\n  ];\n\n  return {\n    json: {\n      records,\n      configs: {\n        baseId: $input.item.json.baseId,\n        tableId: $input.item.json.tableId,\n      },\n    },\n  };\n"},"id":"35114e2f-c327-4da1-9106-6364715b34e4","name":"Convert to Lark Base format OTP","type":"n8n-nodes-base.code","typeVersion":1,"position":[540,240]},{"parameters":{"conditions":{"string":[{"value1":"={{ $('Webhook').item.json.body.text }}","operation":"contains","value2":"OTP"}],"boolean":[{"value1":"={{ $input.item.json.enableOTP }}","value2":true}]}},"id":"7b585e0f-52e4-4364-9baa-9031ac01e4da","name":"ifOTPLarkBase","type":"n8n-nodes-base.if","typeVersion":1,"position":[340,420]},{"parameters":{"conditions":{"string":[{"value1":"={{ $('Webhook').item.json.body.text }}","operation":"contains","value2":"OTP"}],"boolean":[{"value1":"={{ $input.item.json.enableOTP }}","value2":true}]}},"id":"e46d6443-acba-455f-9c4e-2067ce880ab6","name":"ifOTPLarkMess","type":"n8n-nodes-base.if","typeVersion":1,"position":[300,820]},{"parameters":{"conditions":{"string":[{"value1":"={{ $('Webhook').item.json.body.text }}","operation":"contains","value2":"OTP"}],"boolean":[{"value1":"={{ $input.item.json.enableOTP }}","value2":true}]}},"id":"b0ca4970-b44a-4dd0-ad60-8576c3f26a90","name":"ifOTPTelegram","type":"n8n-nodes-base.if","typeVersion":1,"position":[-220,1240]}],"connections":{"Webhook":{"main":[[{"node":"getBankData","type":"main","index":0}]]},"Convert to Lark Message Card":{"main":[[{"node":"ifSend","type":"main","index":0}]]},"Get Lark tenant access token":{"main":[[{"node":"Start Lark Base","type":"main","index":0},{"node":"Start Lark Mess","type":"main","index":0}]]},"Convert to Lark Base format":{"main":[[{"node":"ifSend1","type":"main","index":0}]]},"ifBankSupport":{"main":[[{"node":"Start Actions","type":"main","index":0}]]},"getBankData":{"main":[[{"node":"ifBankSupport","type":"main","index":0}]]},"Start Actions":{"main":[[{"node":"Start Lark Actions","type":"main","index":0}]]},"Create Telegram Message":{"main":[[{"node":"ifSend2","type":"main","index":0}]]},"Set Lark Configs":{"main":[[{"node":"Get Lark tenant access token","type":"main","index":0}]]},"Set Lark Mess Config":{"main":[[{"node":"Start Lark Mess Actions","type":"main","index":0}]]},"Set Lark Base Config":{"main":[[{"node":"Start Lark Base Actions","type":"main","index":0}]]},"Start Lark Actions":{"main":[[{"node":"Set Lark Configs","type":"main","index":0}]]},"Start Lark Base":{"main":[[{"node":"Set Lark Base Config","type":"main","index":0}]]},"Start Lark Mess":{"main":[[{"node":"Set Lark Mess Config","type":"main","index":0}]]},"Start Telegram Actions":{"main":[[{"node":"Set Telegram Config","type":"main","index":0}]]},"Set Telegram Config":{"main":[[{"node":"Start Telegram Mess Actions","type":"main","index":0}]]},"Start Lark Base Actions":{"main":[[{"node":"ifOTPLarkBase","type":"main","index":0}]]},"Start Lark Mess Actions":{"main":[[{"node":"ifOTPLarkMess","type":"main","index":0}]]},"Convert to Message Card for OTP":{"main":[[{"node":"[Lark] Send noti to group chat","type":"main","index":0}]]},"Start Telegram Mess Actions":{"main":[[{"node":"ifOTPTelegram","type":"main","index":0}]]},"Create Telegram Message for OTP":{"main":[[{"node":"Send to Telegram chat","type":"main","index":0}]]},"ifSend":{"main":[[{"node":"[Lark] Send noti to group chat","type":"main","index":0}]]},"ifSend1":{"main":[[{"node":"[SMS Log] Add records to Bitable","type":"main","index":0}]]},"ifSend2":{"main":[[{"node":"Send to Telegram chat","type":"main","index":0}]]},"Convert to Lark Base format OTP":{"main":[[{"node":"[SMS Log] Add records to Bitable","type":"main","index":0}]]},"ifOTPLarkBase":{"main":[[{"node":"Convert to Lark Base format OTP","type":"main","index":0}],[{"node":"Convert to Lark Base format","type":"main","index":0}]]},"ifOTPLarkMess":{"main":[[{"node":"Convert to Message Card for OTP","type":"main","index":0}],[{"node":"Convert to Lark Message Card","type":"main","index":0}]]},"ifOTPTelegram":{"main":[[{"node":"Create Telegram Message for OTP","type":"main","index":0}],[{"node":"Create Telegram Message","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{},"versionId":"8542ae0b-25ea-45b2-89c8-1a707b676b0c","triggerCount":1,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-07-22T06:29:08.242Z","updatedAt":"2023-07-26T17:08:08.000Z","id":"219","name":"Test haravan n√®","active":true,"nodes":[{"parameters":{"httpMethod":"POST","path":"giaybom-haravan","options":{}},"id":"9032c08a-b1aa-44af-8f7c-8f780314f216","name":"NhanInfo","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[820,380],"webhookId":"78a11c7a-b6e4-4dfd-a91c-82be627c2360"},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/auth/v3/app_access_token/internal","sendBody":true,"specifyBody":"json","jsonBody":"{   \"app_id\": \"cli_a4313e90bd789010\",   \"app_secret\": \"PlJYMhhxGkiR2pCKWzzCKb4r8o8SQl8z\" }","options":{}},"id":"83432de2-f859-4ac9-b97a-54b180277804","name":"Tenant","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[1040,380]},{"parameters":{"method":"POST","url":"https://open-sg.larksuite.com/anycross/trigger/callback/ZmYxN2QyMDc4ZTZiZTFiODRkMDJmZmFkNjEzYzcyYzQw","sendBody":true,"contentType":"raw","body":"={{ $('NhanInfo').item.json[\"body\"] }}","options":{}},"id":"eb1d676b-d5a3-4b16-8711-14227b4ccde2","name":"HTTP Request","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[1260,380]}],"connections":{"NhanInfo":{"main":[[{"node":"Tenant","type":"main","index":0}]]},"Tenant":{"main":[[{"node":"HTTP Request","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{"NhanInfo":[{"json":{"headers":{"host":"app.n8n.vn","user-agent":"Haravan-Flow","content-length":"308","content-type":"text/plain; charset=utf-8","traceparent":"00-f74c6fd69782184f6c7681bb1ddca9d4-c99ab2976c69638e-01","x-forwarded-for":"210.245.125.84","x-forwarded-host":"app.n8n.vn","x-forwarded-port":"443","x-forwarded-proto":"https","x-forwarded-server":"f2605f992776","x-real-ip":"210.245.125.84","accept-encoding":"gzip"},"params":{},"query":{},"body":"{\"locationId\":1138348,\n\"orderId\":\"1476094031\",\n\"orderlocationid\":1138348,\n\"closedAt\":\"\",\n\"totalPrice\":\"269000\",\n\"name\":\"N******g \",\n\"phone\":\"\",\n\"discountCodes\":\"[\"GIAYBS227\"]\",\n\"CustomerId\":\"1050631614\",\n\"channelName\":\"shopee\",\n\"locationName\":\"Kho Online\",\n\"note\":\"\",\n\"paidAt\":\"2023-07-22T07:42:38.7820000\"\n}"}}]},"versionId":"be750052-ee4e-4198-8665-69864fffc00f","triggerCount":1,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-07-22T08:50:08.882Z","updatedAt":"2023-07-22T08:50:08.882Z","id":"220","name":"My workflow 27","active":false,"nodes":[{"parameters":{"path":"960d854c-c526-4029-b9ef-2d7de31365fe","options":{}},"id":"25abfd6a-547c-4f42-973a-57ea9dc77ef9","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[580,260],"webhookId":"960d854c-c526-4029-b9ef-2d7de31365fe"}],"connections":{},"settings":{},"staticData":null,"pinData":{},"versionId":"a3dfff1d-13a7-41e8-afd9-94bdc1fa0a2a","triggerCount":0,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-07-22T10:56:35.035Z","updatedAt":"2023-07-22T15:48:13.000Z","id":"221","name":"SMS BANKING FROM SMS FORWARDER","active":false,"nodes":[{"parameters":{"httpMethod":"POST","path":"forwarder-sms","options":{}},"id":"060edf5d-0f11-43c6-bd15-9033e65eebef","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[-1640,960],"webhookId":"b459d9da-c462-43e0-880c-12b8d6304763"},{"parameters":{"mode":"runOnceForEachItem","jsCode":"if (\n  ($('getBankData').item.json.result.transactionType.type === '-' &&\n    $input.item.json.enableOutgoing) ||\n  ($('getBankData').item.json.result.transactionType.type === '+' &&\n    $input.item.json.enableIncoming)\n) {\n  const data = $('getBankData').first().json.result;\n\n  let elements = [];\n\n  elements.push({\n    tag: 'div',\n    fields: [\n      {\n        is_short: false,\n        text: {\n          tag: 'lark_md',\n          content: `**Ng√É¬¢n h√É ng**: ${data.bankName.toUpperCase()}`,\n        },\n      },\n      {\n        is_short: false,\n        text: {\n          tag: 'lark_md',\n          content: `**S√°¬ª‚Äò t√É i kho√°¬∫¬£n**: ${data.receiverAccount}`,\n        },\n      },\n      {\n        is_short: false,\n        text: {\n          tag: 'lark_md',\n          content: `**S√°¬ª‚Äò d√Ü¬∞ thay √Ñ‚Äò√°¬ª‚Ä¢i:** ${data.transactionType.type} ${data.transactionAmount.amountText} VND`,\n        },\n      },\n      {\n        is_short: false,\n        text: {\n          tag: 'lark_md',\n          content: `**N√°¬ª‚Ñ¢i dung:** ${data.transactionMessage}`,\n        },\n      },\n    ],\n  });\n\n  // Append transaction ID if exist\n  if (data.transactionId) {\n    elements[0].fields.push({\n      is_short: false,\n      text: {\n        tag: 'lark_md',\n        content: `**M√É¬£ giao d√°¬ª‚Äπch:** ${data.transactionId}`,\n      },\n    });\n  }\n\n  // Append received time\n  elements[0].fields.push({\n    is_short: false,\n    text: {\n      tag: 'lark_md',\n      content: `**Th√°¬ª¬ùi gian nh√°¬∫¬≠n:** ${data.receivedTime.text}`,\n    },\n  });\n\n  // Ki√°¬ª∆ím tra enableBalance n√°¬∫¬øu true th√É¬¨ th√É¬™m ph√°¬∫¬ßn t√°¬ª¬≠ \"S√°¬ª‚Äò d√Ü¬∞ t√°¬∫¬°m t√É¬≠nh\" v√É o m√°¬∫¬£ng fields\n  if ($input.item.json.enableBalance) {\n    const balanceIndex = elements[0].fields.findIndex((field) =>\n      field?.text?.content?.includes('S√°¬ª‚Äò d√Ü¬∞ thay √Ñ‚Äò√°¬ª‚Ä¢i')\n    );\n    if (balanceIndex !== -1) {\n      elements[0].fields.splice(balanceIndex + 1, 0, {\n        is_short: false,\n        text: {\n          tag: 'lark_md',\n          content: `**S√°¬ª‚Äò d√Ü¬∞ t√°¬∫¬°m t√É¬≠nh**: ${data.balance.amountText} VND`,\n        },\n      });\n    }\n  }\n\n  // create message card\n  let result = {\n    msg_type: 'interactive',\n    card: {\n      config: {\n        wide_screen_mode: true,\n      },\n      header: {\n        template: data.larkMessConfig?.cardColor ?? 'blue',\n        title: {\n          content: `${data.bankName.toUpperCase()}-${data.receiverAccount} (${\n            data.transactionType.type\n          }) ${data.transactionAmount.amountText}VND`,\n          tag: 'plain_text',\n        },\n      },\n      elements,\n    },\n  };\n\n  return {\n    json: {\n      isSend: true,\n      data: result,\n      customBotURL: $input.item.json.customBotURL,\n    },\n  };\n}\n\nreturn {\n  json: {\n    isSend: false,\n  },\n};\n"},"id":"4e076f56-7f22-4083-b93f-d5925083c0f5","name":"Convert to Lark Message Card","type":"n8n-nodes-base.code","typeVersion":1,"position":[660,1000]},{"parameters":{"method":"POST","url":"=https://open.larksuite.com/open-apis/auth/v3/tenant_access_token/internal/","sendBody":true,"specifyBody":"json","jsonBody":"={ \"app_id\" : \"{{ $input.item.json[\"appId\"] }}\", \"app_secret\" : \"{{ $input.item.json[\"appSecret\"] }}\" }","options":{}},"id":"cc302259-ad86-4638-b99a-26e05bf947f0","name":"Get Lark tenant access token","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[-400,700]},{"parameters":{"method":"POST","url":"={{ $input.item.json.customBotURL }}","sendBody":true,"specifyBody":"json","jsonBody":"={{ JSON.stringify($input.item.json.data)}}","options":{}},"id":"2f163fbe-bd05-498d-b370-749c89270001","name":"[Lark] Send noti to group chat","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[1080,860]},{"parameters":{"mode":"runOnceForEachItem","jsCode":"if (\n  ($('getBankData').item.json.result.transactionType.type === '-' &&\n    $input.item.json.enableOutgoing) ||\n  ($('getBankData').item.json.result.transactionType.type === '+' &&\n    $input.item.json.enableIncoming)\n) {\n  const data = $('getBankData').first().json.result;\n\n  // Convert to Lark Base format\n  const records = [\n    {\n      fields: {\n        ID: data.bankName + '-' + data.receiverAccount,\n        Bank: data.bankName.toUpperCase(),\n        Account: data.receiverAccount,\n        'Transaction Type': data.transactionType.typeText,\n        Debit:\n          data.transactionType.type === '+'\n            ? data.transactionAmount.amount\n            : undefined,\n        Credit:\n          data.transactionType.type === '-'\n            ? data.transactionAmount.amount\n            : undefined,\n        'Transaction ID': data.transactionId,\n        'Transaction Message': data.transactionMessage,\n        'Original Message': data.originalMessage,\n        'Time received': data.receivedTime.timestamp,\n      },\n    },\n  ];\n\n  // Ki√°¬ª∆ím tra enableBalance n√°¬∫¬øu true th√É¬¨ th√É¬™m ph√°¬∫¬ßn t√°¬ª¬≠ \"Balance\" v√É o m√°¬∫¬£ng fields\n  if ($input.item.json.enableBalance) {\n    records[0].fields = {\n      ...records[0].fields,\n      Balance: data.balance.amount,\n    };\n  }\n\n  return {\n    json: {\n      isSend: true,\n      records,\n      configs: {\n        baseId: $input.item.json.baseId,\n        tableId: $input.item.json.tableId,\n      },\n    },\n  };\n}\n\nreturn {\n  json: {\n    isSend: false,\n  },\n};\n"},"id":"5e9dd9a0-0bb8-488c-a769-46ee7b4dc212","name":"Convert to Lark Base format","type":"n8n-nodes-base.code","typeVersion":1,"position":[640,600]},{"parameters":{"method":"POST","url":"=https://open.larksuite.com/open-apis/bitable/v1/apps/{{ $json[\"configs\"][\"baseId\"] }}/tables/{{  $json[\"configs\"][\"tableId\"]}}/records/batch_create","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $node[\"Get Lark tenant access token\"].json.tenant_access_token }}"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\"records\":{{ JSON.stringify($json[\"records\"]) }}}","options":{}},"id":"c825e01e-eeff-4b10-a12a-c6db49610329","name":"[SMS Log] Add records to Bitable","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[1060,540]},{"parameters":{"conditions":{"boolean":[{"value1":"={{ $json.isBankSupport }}","value2":true}]}},"id":"0a322418-b806-4b4b-8f81-ec3ab8072865","name":"ifBankSupport","type":"n8n-nodes-base.if","typeVersion":1,"position":[-1220,960]},{"parameters":{"method":"POST","url":"https://app.n8n.vn/webhook/kdigi-bank-bot-process-data","sendBody":true,"specifyBody":"json","jsonBody":"={{ JSON.stringify($input.first().json.body) }}","options":{}},"id":"a6e294f9-2022-4654-9dbd-d769d5ab029d","name":"getBankData","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[-1480,1280]},{"parameters":{},"id":"7f527dc7-37a4-460a-95c2-46ace0619308","name":"Start Actions","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[-1020,940]},{"parameters":{"mode":"runOnceForEachItem","jsCode":"if (\n  ($('getBankData').item.json.result.transactionType.type === '-' &&\n    $input.item.json.enableOutgoing) ||\n  ($('getBankData').item.json.result.transactionType.type === '+' &&\n    $input.item.json.enableIncoming)\n) {\n  const data = $('getBankData').first().json.result;\n\n  let message = [];\n\n  message.push(\n    `<b>${data.bankName.toUpperCase()}-${data.receiverAccount} (${\n      data.transactionType.type\n    }) ${data.transactionAmount.amountText}VND</b>\\n`,\n    `<b>Ng√É¬¢n h√É ng:</b> ${data.bankName.toUpperCase()}`,\n    `<b>S√°¬ª‚Äò t√É i kho√°¬∫¬£n:</b> ${data.receiverAccount}`,\n    `<b>S√°¬ª‚Äò d√Ü¬∞ thay √Ñ‚Äò√°¬ª‚Ä¢i:</b> ${data.transactionType.type} ${data.transactionAmount.amountText} VND`\n  );\n\n  // Add balance\n  if ($input.item.json.enableBalance) {\n    message.push(`<b>S√°¬ª‚Äò d√Ü¬∞ t√°¬∫¬°m t√É¬≠nh:</b> ${data.balance.amountText} VND`);\n  }\n\n  message.push(`<b>N√°¬ª‚Ñ¢i dung:</b>\\n ${data.transactionMessage}`);\n\n  // Check transaction ID\n  if (data.transactionId) {\n    message.push(`<b>M√É¬£ giao d√°¬ª‚Äπch:</b> ${data.transactionId}`);\n  }\n\n  message.push(`<b>Th√°¬ª¬ùi gian nh√°¬∫¬≠n:</b> ${data.receivedTime.text}`);\n\n  return {\n    json: {\n      isSend: true,\n      botToken: $input.item.json.botToken,\n      payload: {\n        chat_id: $input.item.json.chatId,\n        parse_mode: 'HTML',\n        text: message.join('\\n'),\n      },\n    },\n  };\n}\n\nreturn {\n  json: {\n    isSend: false,\n  },\n};\n"},"id":"12b16e1f-b70d-4143-9797-25661c109f22","name":"Create Telegram Message","type":"n8n-nodes-base.code","typeVersion":1,"position":[100,1440]},{"parameters":{"method":"POST","url":"=https://api.telegram.org/bot{{ $input.item.json.botToken }}/sendMessage ","sendBody":true,"specifyBody":"json","jsonBody":"={{ JSON.stringify($input.item.json.payload) }}","options":{}},"id":"0fcc3083-9908-419e-8acf-9d71cfd5e3a7","name":"Send to Telegram chat","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[560,1360]},{"parameters":{"values":{"string":[{"name":"appId","value":"set-app-id"},{"name":"appSecret","value":"set-app-secret"}]},"options":{}},"id":"ad8e923d-5648-4962-9311-0950f0398395","name":"Set Lark Configs","type":"n8n-nodes-base.set","typeVersion":2,"position":[-580,700]},{"parameters":{"values":{"string":[{"name":"customBotURL","value":"set-bot-url"}],"boolean":[{"name":"enableBalance","value":true},{"name":"enableOTP","value":true},{"name":"enableOutgoing","value":true},{"name":"enableIncoming","value":true}]},"options":{}},"id":"d72a7281-3587-4773-9128-25cd6ac904cb","name":"Set Lark Mess Config","type":"n8n-nodes-base.set","typeVersion":2,"position":[20,960]},{"parameters":{"values":{"string":[{"name":"baseId","value":"set-base-id"},{"name":"tableId","value":"set-table-id"}],"boolean":[{"name":"enableBalance","value":true},{"name":"enableOTP","value":true},{"name":"enableOutgoing","value":true},{"name":"enableIncoming","value":true}]},"options":{}},"id":"43eb81f9-a854-43ca-bef7-04977eae7f85","name":"Set Lark Base Config","type":"n8n-nodes-base.set","typeVersion":2,"position":[40,560]},{"parameters":{},"id":"75e517f1-c911-42d2-acc3-8a646942a32a","name":"Start Lark Actions","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[-740,700]},{"parameters":{},"id":"8a501a60-ce4b-44fa-8b29-661f15c11c44","name":"Start Lark Base","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[-180,560]},{"parameters":{},"id":"07f4fcd8-3c6c-42dc-9fcf-3b06fb249c4b","name":"Start Lark Mess","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[-200,960]},{"parameters":{},"id":"9244b142-3f8a-4319-b2ff-ce9051e02ba9","name":"Start Telegram Actions","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[-700,1360]},{"parameters":{"values":{"string":[{"name":"botToken","value":"set-bot-token"},{"name":"chatId","value":"set-chat-id"}],"boolean":[{"name":"enableBalance","value":true},{"name":"enableOTP","value":true},{"name":"enableOutgoing","value":true},{"name":"enableIncoming","value":true}]},"options":{}},"id":"75bd554f-6d25-442e-97f6-62005e616b96","name":"Set Telegram Config","type":"n8n-nodes-base.set","typeVersion":2,"position":[-500,1360]},{"parameters":{},"id":"035abbb9-d023-4cfc-a8fe-19bd9d6724fe","name":"Start Lark Base Actions","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[260,540]},{"parameters":{},"id":"22f3ac8e-e555-416d-a701-329036157630","name":"Start Lark Mess Actions","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[240,940]},{"parameters":{"mode":"runOnceForEachItem","jsCode":"const smsContent = $('Webhook').first().json.body;\n\n// create message card\nlet result = {\n  msg_type: 'text',\n  content: {\n    text: `T√°¬ª¬´: ${smsContent.from}\\n${smsContent.text.toString()}`,\n  },\n};\n\nreturn {\n  json: {\n    data: result,\n    customBotURL: $input.item.json.customBotURL,\n  },\n};\n"},"id":"c1903808-bfa8-4527-a03b-5a6cb0cfbbff","name":"Convert to Message Card for OTP","type":"n8n-nodes-base.code","typeVersion":1,"position":[660,840]},{"parameters":{},"id":"310f8929-0676-4e12-8111-13dc4fbc9a9d","name":"Start Telegram Mess Actions","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[-300,1360]},{"parameters":{"mode":"runOnceForEachItem","jsCode":"const smsContent = $('Webhook').first().json.body;\n\nlet message = [];\n\nmessage.push(\n  `<b>${smsContent.from.toUpperCase()}</b>\\n`,\n  `${smsContent.text.toString()}`\n);\n\nreturn {\n  json: {\n    botToken: $input.item.json.botToken,\n    payload: {\n      chat_id: $input.item.json.chatId,\n      parse_mode: 'HTML',\n      text: message.join('\\n'),\n    },\n  },\n};\n"},"id":"ec0f7157-3b11-4db9-bbd8-e664347eda2c","name":"Create Telegram Message for OTP","type":"n8n-nodes-base.code","typeVersion":1,"position":[100,1280]},{"parameters":{"conditions":{"boolean":[{"value1":"={{ $input.item.json.isSend }}","value2":true}]}},"id":"ed341278-c222-40ef-952a-89e7c0955b68","name":"ifSend","type":"n8n-nodes-base.if","typeVersion":1,"position":[860,1000]},{"parameters":{"conditions":{"boolean":[{"value1":"={{ $input.item.json.isSend }}","value2":true}]}},"id":"2eee82c9-2c72-456d-ace7-6ef5ea3ad215","name":"ifSend1","type":"n8n-nodes-base.if","typeVersion":1,"position":[820,600]},{"parameters":{"conditions":{"boolean":[{"value1":"={{ $input.item.json.isSend }}","value2":true}]}},"id":"e27c4145-6de2-4cbe-9623-afe4fcc85733","name":"ifSend2","type":"n8n-nodes-base.if","typeVersion":1,"position":[320,1440]},{"parameters":{"mode":"runOnceForEachItem","jsCode":"const smsContent = $('Webhook').first().json.body;\n\n  // Convert to Lark Base format\n  const records = [\n    {\n      fields: {\n        ID: smsContent.from,\n        Bank: smsContent.from,\n        'Transaction Type': 'OTP',\n        'Transaction Message': smsContent.text.toString(),\n        'Original Message': smsContent.text.toString(),\n        'Time received': smsContent.sentStamp,\n      },\n    },\n  ];\n\n  return {\n    json: {\n      records,\n      configs: {\n        baseId: $input.item.json.baseId,\n        tableId: $input.item.json.tableId,\n      },\n    },\n  };\n"},"id":"466040ad-0739-42fd-bfd2-67c9cb97d7a6","name":"Convert to Lark Base format OTP","type":"n8n-nodes-base.code","typeVersion":1,"position":[640,360]},{"parameters":{"conditions":{"string":[{"value1":"={{ $('Webhook').item.json.body.text }}","operation":"contains","value2":"OTP"}],"boolean":[{"value1":"={{ $input.item.json.enableOTP }}","value2":true}]}},"id":"de04eec1-0b3c-4ed8-89dd-0b6f59e0e1be","name":"ifOTPLarkBase","type":"n8n-nodes-base.if","typeVersion":1,"position":[440,540]},{"parameters":{"conditions":{"string":[{"value1":"={{ $('Webhook').item.json.body.text }}","operation":"contains","value2":"OTP"}],"boolean":[{"value1":"={{ $input.item.json.enableOTP }}","value2":true}]}},"id":"5392e95a-ec78-46c5-8a5e-62bc2f6c87fc","name":"ifOTPLarkMess","type":"n8n-nodes-base.if","typeVersion":1,"position":[400,940]},{"parameters":{"conditions":{"string":[{"value1":"={{ $('Webhook').item.json.body.text }}","operation":"contains","value2":"OTP"}],"boolean":[{"value1":"={{ $input.item.json.enableOTP }}","value2":true}]}},"id":"dbc5d368-6c20-4c25-a9b8-d88154871a2f","name":"ifOTPTelegram","type":"n8n-nodes-base.if","typeVersion":1,"position":[-120,1360]},{"parameters":{"url":"https://open.larksuite.com/anycross/trigger/callback/MGQ0Mzg1MDQ0OTQ5YmNkNzNlNWFmYzkyOTlhZDQ4OWJh","sendQuery":true,"queryParameters":{"parameters":[{"name":"originalMessage","value":"={{ $json[\"result\"][\"originalMessage\"] }}"}]},"options":{}},"id":"dbb60039-2b59-4e2c-8bd6-ef11d749d749","name":"HTTP Request","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[-1260,1280]}],"connections":{"Webhook":{"main":[[{"node":"getBankData","type":"main","index":0}]]},"Convert to Lark Message Card":{"main":[[{"node":"ifSend","type":"main","index":0}]]},"Get Lark tenant access token":{"main":[[{"node":"Start Lark Base","type":"main","index":0},{"node":"Start Lark Mess","type":"main","index":0}]]},"Convert to Lark Base format":{"main":[[{"node":"ifSend1","type":"main","index":0}]]},"ifBankSupport":{"main":[[{"node":"Start Actions","type":"main","index":0}]]},"getBankData":{"main":[[{"node":"HTTP Request","type":"main","index":0}]]},"Start Actions":{"main":[[{"node":"Start Telegram Actions","type":"main","index":0},{"node":"Start Lark Actions","type":"main","index":0}]]},"Create Telegram Message":{"main":[[{"node":"ifSend2","type":"main","index":0}]]},"Set Lark Configs":{"main":[[{"node":"Get Lark tenant access token","type":"main","index":0}]]},"Set Lark Mess Config":{"main":[[{"node":"Start Lark Mess Actions","type":"main","index":0}]]},"Set Lark Base Config":{"main":[[{"node":"Start Lark Base Actions","type":"main","index":0}]]},"Start Lark Actions":{"main":[[{"node":"Set Lark Configs","type":"main","index":0}]]},"Start Lark Base":{"main":[[{"node":"Set Lark Base Config","type":"main","index":0}]]},"Start Lark Mess":{"main":[[{"node":"Set Lark Mess Config","type":"main","index":0}]]},"Start Telegram Actions":{"main":[[{"node":"Set Telegram Config","type":"main","index":0}]]},"Set Telegram Config":{"main":[[{"node":"Start Telegram Mess Actions","type":"main","index":0}]]},"Start Lark Base Actions":{"main":[[{"node":"ifOTPLarkBase","type":"main","index":0}]]},"Start Lark Mess Actions":{"main":[[{"node":"ifOTPLarkMess","type":"main","index":0}]]},"Convert to Message Card for OTP":{"main":[[{"node":"[Lark] Send noti to group chat","type":"main","index":0}]]},"Start Telegram Mess Actions":{"main":[[{"node":"ifOTPTelegram","type":"main","index":0}]]},"Create Telegram Message for OTP":{"main":[[{"node":"Send to Telegram chat","type":"main","index":0}]]},"ifSend":{"main":[[{"node":"[Lark] Send noti to group chat","type":"main","index":0}]]},"ifSend1":{"main":[[{"node":"[SMS Log] Add records to Bitable","type":"main","index":0}]]},"ifSend2":{"main":[[{"node":"Send to Telegram chat","type":"main","index":0}]]},"Convert to Lark Base format OTP":{"main":[[{"node":"[SMS Log] Add records to Bitable","type":"main","index":0}]]},"ifOTPLarkBase":{"main":[[{"node":"Convert to Lark Base format OTP","type":"main","index":0}],[{"node":"Convert to Lark Base format","type":"main","index":0}]]},"ifOTPLarkMess":{"main":[[{"node":"Convert to Message Card for OTP","type":"main","index":0}],[{"node":"Convert to Lark Message Card","type":"main","index":0}]]},"ifOTPTelegram":{"main":[[{"node":"Create Telegram Message for OTP","type":"main","index":0}],[{"node":"Create Telegram Message","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{},"versionId":"2449e842-fc52-4bce-b2bd-7f8d1a2b86c5","triggerCount":1,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-07-22T16:34:40.838Z","updatedAt":"2023-07-22T16:34:40.838Z","id":"222","name":"G·ª≠i tin nh·∫Øn l√™n lark","active":false,"nodes":[{"parameters":{"httpMethod":"POST","path":"template-kdigi-bank-bot-api","options":{}},"id":"b4077ba7-a1a0-4d88-b135-5f017d65c9f0","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[-1420,840],"webhookId":"b459d9da-c462-43e0-880c-12b8d6304763"},{"parameters":{"mode":"runOnceForEachItem","jsCode":"if (\n  ($('getBankData').item.json.result.transactionType.type === '-' &&\n    $input.item.json.enableOutgoing) ||\n  ($('getBankData').item.json.result.transactionType.type === '+' &&\n    $input.item.json.enableIncoming)\n) {\n  const data = $('getBankData').first().json.result;\n\n  let elements = [];\n\n  elements.push({\n    tag: 'div',\n    fields: [\n      {\n        is_short: false,\n        text: {\n          tag: 'lark_md',\n          content: `**Ng√¢n h√†ng**: ${data.bankName.toUpperCase()}`,\n        },\n      },\n      {\n        is_short: false,\n        text: {\n          tag: 'lark_md',\n          content: `**S·ªë t√†i kho·∫£n**: ${data.receiverAccount}`,\n        },\n      },\n      {\n        is_short: false,\n        text: {\n          tag: 'lark_md',\n          content: `**S·ªë d∆∞ thay ƒë·ªïi:** ${data.transactionType.type} ${data.transactionAmount.amountText} VND`,\n        },\n      },\n      {\n        is_short: false,\n        text: {\n          tag: 'lark_md',\n          content: `**N·ªôi dung:** ${data.transactionMessage}`,\n        },\n      },\n    ],\n  });\n\n  // Append transaction ID if exist\n  if (data.transactionId) {\n    elements[0].fields.push({\n      is_short: false,\n      text: {\n        tag: 'lark_md',\n        content: `**M√£ giao d·ªãch:** ${data.transactionId}`,\n      },\n    });\n  }\n\n  // Append received time\n  elements[0].fields.push({\n    is_short: false,\n    text: {\n      tag: 'lark_md',\n      content: `**Th·ªùi gian nh·∫≠n:** ${data.receivedTime.text}`,\n    },\n  });\n\n  // Ki·ªÉm tra enableBalance n·∫øu true th√¨ th√™m ph·∫ßn t·ª≠ \"S·ªë d∆∞ t·∫°m t√≠nh\" v√†o m·∫£ng fields\n  if ($input.item.json.enableBalance) {\n    const balanceIndex = elements[0].fields.findIndex((field) =>\n      field?.text?.content?.includes('S·ªë d∆∞ thay ƒë·ªïi')\n    );\n    if (balanceIndex !== -1) {\n      elements[0].fields.splice(balanceIndex + 1, 0, {\n        is_short: false,\n        text: {\n          tag: 'lark_md',\n          content: `**S·ªë d∆∞ t·∫°m t√≠nh**: ${data.balance.amountText} VND`,\n        },\n      });\n    }\n  }\n\n  // create message card\n  let result = {\n    msg_type: 'interactive',\n    card: {\n      config: {\n        wide_screen_mode: true,\n      },\n      header: {\n        template: data.larkMessConfig?.cardColor ?? 'blue',\n        title: {\n          content: `${data.bankName.toUpperCase()}-${data.receiverAccount} (${\n            data.transactionType.type\n          }) ${data.transactionAmount.amountText}VND`,\n          tag: 'plain_text',\n        },\n      },\n      elements,\n    },\n  };\n\n  return {\n    json: {\n      isSend: true,\n      data: result,\n      customBotURL: $input.item.json.customBotURL,\n    },\n  };\n}\n\nreturn {\n  json: {\n    isSend: false,\n  },\n};\n"},"id":"99957003-c5f2-4523-b45a-763db83995c9","name":"Convert to Lark Message Card","type":"n8n-nodes-base.code","typeVersion":1,"position":[880,880]},{"parameters":{"method":"POST","url":"=https://open.larksuite.com/open-apis/auth/v3/tenant_access_token/internal/","sendBody":true,"specifyBody":"json","jsonBody":"={ \"app_id\" : \"{{ $input.item.json[\"appId\"] }}\", \"app_secret\" : \"{{ $input.item.json[\"appSecret\"] }}\" }","options":{}},"id":"dd6a2aa1-e60f-4454-97dc-b2993ae901d9","name":"Get Lark tenant access token","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[-180,580]},{"parameters":{"method":"POST","url":"={{ $input.item.json.customBotURL }}","sendBody":true,"specifyBody":"json","jsonBody":"={{ JSON.stringify($input.item.json.data)}}","options":{}},"id":"81407473-c288-4fc8-b36f-ca82e6669041","name":"[Lark] Send noti to group chat","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[1300,740]},{"parameters":{"mode":"runOnceForEachItem","jsCode":"if (\n  ($('getBankData').item.json.result.transactionType.type === '-' &&\n    $input.item.json.enableOutgoing) ||\n  ($('getBankData').item.json.result.transactionType.type === '+' &&\n    $input.item.json.enableIncoming)\n) {\n  const data = $('getBankData').first().json.result;\n\n  // Convert to Lark Base format\n  const records = [\n    {\n      fields: {\n        ID: data.bankName + '-' + data.receiverAccount,\n        Bank: data.bankName.toUpperCase(),\n        Account: data.receiverAccount,\n        'Transaction Type': data.transactionType.typeText,\n        Debit:\n          data.transactionType.type === '+'\n            ? data.transactionAmount.amount\n            : undefined,\n        Credit:\n          data.transactionType.type === '-'\n            ? data.transactionAmount.amount\n            : undefined,\n        'Transaction ID': data.transactionId,\n        'Transaction Message': data.transactionMessage,\n        'Original Message': data.originalMessage,\n        'Time received': data.receivedTime.timestamp,\n      },\n    },\n  ];\n\n  // Ki·ªÉm tra enableBalance n·∫øu true th√¨ th√™m ph·∫ßn t·ª≠ \"Balance\" v√†o m·∫£ng fields\n  if ($input.item.json.enableBalance) {\n    records[0].fields = {\n      ...records[0].fields,\n      Balance: data.balance.amount,\n    };\n  }\n\n  return {\n    json: {\n      isSend: true,\n      records,\n      configs: {\n        baseId: $input.item.json.baseId,\n        tableId: $input.item.json.tableId,\n      },\n    },\n  };\n}\n\nreturn {\n  json: {\n    isSend: false,\n  },\n};\n"},"id":"2f3bc467-881a-41fd-98dc-00e9b526c7b0","name":"Convert to Lark Base format","type":"n8n-nodes-base.code","typeVersion":1,"position":[860,480]},{"parameters":{"method":"POST","url":"=https://open.larksuite.com/open-apis/bitable/v1/apps/{{ $json[\"configs\"][\"baseId\"] }}/tables/{{  $json[\"configs\"][\"tableId\"]}}/records/batch_create","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $node[\"Get Lark tenant access token\"].json.tenant_access_token }}"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\"records\":{{ JSON.stringify($json[\"records\"]) }}}","options":{}},"id":"58262e93-d804-46f9-b6c4-492fc991dcdd","name":"[SMS Log] Add records to Bitable","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[1280,420]},{"parameters":{"conditions":{"boolean":[{"value1":"={{ $json.isBankSupport }}","value2":true}]}},"id":"198fd39f-c12b-4d67-a700-f939b9528182","name":"ifBankSupport","type":"n8n-nodes-base.if","typeVersion":1,"position":[-1000,840]},{"parameters":{"method":"POST","url":"https://app.n8n.vn/webhook/kdigi-bank-bot-process-data","sendBody":true,"specifyBody":"json","jsonBody":"={{ JSON.stringify($input.first().json.body) }}","options":{}},"id":"040dd638-1006-4885-b3ce-96bf8951831a","name":"getBankData","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[-1220,840]},{"parameters":{},"id":"5562ed1d-9aef-4b2c-b29e-d9e72115d49b","name":"Start Actions","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[-800,820]},{"parameters":{"mode":"runOnceForEachItem","jsCode":"if (\n  ($('getBankData').item.json.result.transactionType.type === '-' &&\n    $input.item.json.enableOutgoing) ||\n  ($('getBankData').item.json.result.transactionType.type === '+' &&\n    $input.item.json.enableIncoming)\n) {\n  const data = $('getBankData').first().json.result;\n\n  let message = [];\n\n  message.push(\n    `<b>${data.bankName.toUpperCase()}-${data.receiverAccount} (${\n      data.transactionType.type\n    }) ${data.transactionAmount.amountText}VND</b>\\n`,\n    `<b>Ng√¢n h√†ng:</b> ${data.bankName.toUpperCase()}`,\n    `<b>S·ªë t√†i kho·∫£n:</b> ${data.receiverAccount}`,\n    `<b>S·ªë d∆∞ thay ƒë·ªïi:</b> ${data.transactionType.type} ${data.transactionAmount.amountText} VND`\n  );\n\n  // Add balance\n  if ($input.item.json.enableBalance) {\n    message.push(`<b>S·ªë d∆∞ t·∫°m t√≠nh:</b> ${data.balance.amountText} VND`);\n  }\n\n  message.push(`<b>N·ªôi dung:</b>\\n ${data.transactionMessage}`);\n\n  // Check transaction ID\n  if (data.transactionId) {\n    message.push(`<b>M√£ giao d·ªãch:</b> ${data.transactionId}`);\n  }\n\n  message.push(`<b>Th·ªùi gian nh·∫≠n:</b> ${data.receivedTime.text}`);\n\n  return {\n    json: {\n      isSend: true,\n      botToken: $input.item.json.botToken,\n      payload: {\n        chat_id: $input.item.json.chatId,\n        parse_mode: 'HTML',\n        text: message.join('\\n'),\n      },\n    },\n  };\n}\n\nreturn {\n  json: {\n    isSend: false,\n  },\n};\n"},"id":"1429c208-89a5-4e2a-816e-5cd281bdb166","name":"Create Telegram Message","type":"n8n-nodes-base.code","typeVersion":1,"position":[320,1320]},{"parameters":{"method":"POST","url":"=https://api.telegram.org/bot{{ $input.item.json.botToken }}/sendMessage ","sendBody":true,"specifyBody":"json","jsonBody":"={{ JSON.stringify($input.item.json.payload) }}","options":{}},"id":"0244bd19-f93f-4459-9a49-12f4856b3dd5","name":"Send to Telegram chat","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[780,1240]},{"parameters":{"values":{"string":[{"name":"appId","value":"set-app-id"},{"name":"appSecret","value":"set-app-secret"}]},"options":{}},"id":"2c4703aa-f11e-433e-a6dc-81b060382e29","name":"Set Lark Configs","type":"n8n-nodes-base.set","typeVersion":2,"position":[-360,580]},{"parameters":{"values":{"string":[{"name":"customBotURL","value":"set-bot-url"}],"boolean":[{"name":"enableBalance","value":true},{"name":"enableOTP","value":true},{"name":"enableOutgoing","value":true},{"name":"enableIncoming","value":true}]},"options":{}},"id":"2782d335-5320-4df5-b576-df6155319540","name":"Set Lark Mess Config","type":"n8n-nodes-base.set","typeVersion":2,"position":[240,840]},{"parameters":{"values":{"string":[{"name":"baseId","value":"set-base-id"},{"name":"tableId","value":"set-table-id"}],"boolean":[{"name":"enableBalance","value":true},{"name":"enableOTP","value":true},{"name":"enableOutgoing","value":true},{"name":"enableIncoming","value":true}]},"options":{}},"id":"b1dc5dd1-ac34-4cf8-85c9-fad7259fdb47","name":"Set Lark Base Config","type":"n8n-nodes-base.set","typeVersion":2,"position":[260,440]},{"parameters":{},"id":"b75a3500-979d-4dd2-9e11-9a0b4dac2e88","name":"Start Lark Actions","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[-520,580]},{"parameters":{},"id":"25a6efca-f5db-4b3a-a7a2-f5d0b23d79cf","name":"Start Lark Base","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[40,440]},{"parameters":{},"id":"e1004bac-6e49-4ca7-82be-6a003331682b","name":"Start Lark Mess","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[20,840]},{"parameters":{},"id":"a5da4662-b4a5-42e4-a0b0-32f7b949d7a8","name":"Start Telegram Actions","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[-480,1240]},{"parameters":{"values":{"string":[{"name":"botToken","value":"set-bot-token"},{"name":"chatId","value":"set-chat-id"}],"boolean":[{"name":"enableBalance","value":true},{"name":"enableOTP","value":true},{"name":"enableOutgoing","value":true},{"name":"enableIncoming","value":true}]},"options":{}},"id":"7e07f83c-0620-4b30-97bb-e0d35a7ec2d8","name":"Set Telegram Config","type":"n8n-nodes-base.set","typeVersion":2,"position":[-280,1240]},{"parameters":{},"id":"f2d47c4c-0871-4b97-91e6-62487599101c","name":"Start Lark Base Actions","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[480,420]},{"parameters":{},"id":"8d05eac0-789a-40f5-916d-b210182908be","name":"Start Lark Mess Actions","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[460,820]},{"parameters":{"mode":"runOnceForEachItem","jsCode":"const smsContent = $('Webhook').first().json.body;\n\n// create message card\nlet result = {\n  msg_type: 'text',\n  content: {\n    text: `T·ª´: ${smsContent.from}\\n${smsContent.text.toString()}`,\n  },\n};\n\nreturn {\n  json: {\n    data: result,\n    customBotURL: $input.item.json.customBotURL,\n  },\n};\n"},"id":"634245e0-5cd9-4c79-b9ab-d5d8c8111246","name":"Convert to Message Card for OTP","type":"n8n-nodes-base.code","typeVersion":1,"position":[880,720]},{"parameters":{},"id":"4cdbdd85-f0dd-49aa-8f0c-f8c664329e5e","name":"Start Telegram Mess Actions","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[-80,1240]},{"parameters":{"mode":"runOnceForEachItem","jsCode":"const smsContent = $('Webhook').first().json.body;\n\nlet message = [];\n\nmessage.push(\n  `<b>${smsContent.from.toUpperCase()}</b>\\n`,\n  `${smsContent.text.toString()}`\n);\n\nreturn {\n  json: {\n    botToken: $input.item.json.botToken,\n    payload: {\n      chat_id: $input.item.json.chatId,\n      parse_mode: 'HTML',\n      text: message.join('\\n'),\n    },\n  },\n};\n"},"id":"a9745709-b424-4bf3-b006-98eff4c8a158","name":"Create Telegram Message for OTP","type":"n8n-nodes-base.code","typeVersion":1,"position":[320,1160]},{"parameters":{"conditions":{"boolean":[{"value1":"={{ $input.item.json.isSend }}","value2":true}]}},"id":"2dee86be-1712-4f73-a84f-aa09bea9da30","name":"ifSend","type":"n8n-nodes-base.if","typeVersion":1,"position":[1080,880]},{"parameters":{"conditions":{"boolean":[{"value1":"={{ $input.item.json.isSend }}","value2":true}]}},"id":"2770eeee-0a23-4bce-b30a-6df06a66691a","name":"ifSend1","type":"n8n-nodes-base.if","typeVersion":1,"position":[1040,480]},{"parameters":{"conditions":{"boolean":[{"value1":"={{ $input.item.json.isSend }}","value2":true}]}},"id":"fb311f07-431f-4444-8144-0cc10a282a95","name":"ifSend2","type":"n8n-nodes-base.if","typeVersion":1,"position":[540,1320]},{"parameters":{"mode":"runOnceForEachItem","jsCode":"const smsContent = $('Webhook').first().json.body;\n\n  // Convert to Lark Base format\n  const records = [\n    {\n      fields: {\n        ID: smsContent.from,\n        Bank: smsContent.from,\n        'Transaction Type': 'OTP',\n        'Transaction Message': smsContent.text.toString(),\n        'Original Message': smsContent.text.toString(),\n        'Time received': smsContent.sentStamp,\n      },\n    },\n  ];\n\n  return {\n    json: {\n      records,\n      configs: {\n        baseId: $input.item.json.baseId,\n        tableId: $input.item.json.tableId,\n      },\n    },\n  };\n"},"id":"aca00f12-7bd1-4fa0-a751-134283dd65ec","name":"Convert to Lark Base format OTP","type":"n8n-nodes-base.code","typeVersion":1,"position":[860,240]},{"parameters":{"conditions":{"string":[{"value1":"={{ $('Webhook').item.json.body.text }}","operation":"contains","value2":"OTP"}],"boolean":[{"value1":"={{ $input.item.json.enableOTP }}","value2":true}]}},"id":"02684e4f-966b-43e0-a2aa-c245f785867b","name":"ifOTPLarkBase","type":"n8n-nodes-base.if","typeVersion":1,"position":[660,420]},{"parameters":{"conditions":{"string":[{"value1":"={{ $('Webhook').item.json.body.text }}","operation":"contains","value2":"OTP"}],"boolean":[{"value1":"={{ $input.item.json.enableOTP }}","value2":true}]}},"id":"158f2f5d-2971-45b0-a0ab-af2ed908dc32","name":"ifOTPLarkMess","type":"n8n-nodes-base.if","typeVersion":1,"position":[620,820]},{"parameters":{"conditions":{"string":[{"value1":"={{ $('Webhook').item.json.body.text }}","operation":"contains","value2":"OTP"}],"boolean":[{"value1":"={{ $input.item.json.enableOTP }}","value2":true}]}},"id":"8019e149-89ab-44f3-b92b-644463e2347c","name":"ifOTPTelegram","type":"n8n-nodes-base.if","typeVersion":1,"position":[100,1240]}],"connections":{"Webhook":{"main":[[{"node":"getBankData","type":"main","index":0}]]},"Convert to Lark Message Card":{"main":[[{"node":"ifSend","type":"main","index":0}]]},"Get Lark tenant access token":{"main":[[{"node":"Start Lark Base","type":"main","index":0},{"node":"Start Lark Mess","type":"main","index":0}]]},"Convert to Lark Base format":{"main":[[{"node":"ifSend1","type":"main","index":0}]]},"ifBankSupport":{"main":[[{"node":"Start Actions","type":"main","index":0}]]},"getBankData":{"main":[[{"node":"ifBankSupport","type":"main","index":0}]]},"Start Actions":{"main":[[{"node":"Start Telegram Actions","type":"main","index":0},{"node":"Start Lark Actions","type":"main","index":0}]]},"Create Telegram Message":{"main":[[{"node":"ifSend2","type":"main","index":0}]]},"Set Lark Configs":{"main":[[{"node":"Get Lark tenant access token","type":"main","index":0}]]},"Set Lark Mess Config":{"main":[[{"node":"Start Lark Mess Actions","type":"main","index":0}]]},"Set Lark Base Config":{"main":[[{"node":"Start Lark Base Actions","type":"main","index":0}]]},"Start Lark Actions":{"main":[[{"node":"Set Lark Configs","type":"main","index":0}]]},"Start Lark Base":{"main":[[{"node":"Set Lark Base Config","type":"main","index":0}]]},"Start Lark Mess":{"main":[[{"node":"Set Lark Mess Config","type":"main","index":0}]]},"Start Telegram Actions":{"main":[[{"node":"Set Telegram Config","type":"main","index":0}]]},"Set Telegram Config":{"main":[[{"node":"Start Telegram Mess Actions","type":"main","index":0}]]},"Start Lark Base Actions":{"main":[[{"node":"ifOTPLarkBase","type":"main","index":0}]]},"Start Lark Mess Actions":{"main":[[{"node":"ifOTPLarkMess","type":"main","index":0}]]},"Convert to Message Card for OTP":{"main":[[{"node":"[Lark] Send noti to group chat","type":"main","index":0}]]},"Start Telegram Mess Actions":{"main":[[{"node":"ifOTPTelegram","type":"main","index":0}]]},"Create Telegram Message for OTP":{"main":[[{"node":"Send to Telegram chat","type":"main","index":0}]]},"ifSend":{"main":[[{"node":"[Lark] Send noti to group chat","type":"main","index":0}]]},"ifSend1":{"main":[[{"node":"[SMS Log] Add records to Bitable","type":"main","index":0}]]},"ifSend2":{"main":[[{"node":"Send to Telegram chat","type":"main","index":0}]]},"Convert to Lark Base format OTP":{"main":[[{"node":"[SMS Log] Add records to Bitable","type":"main","index":0}]]},"ifOTPLarkBase":{"main":[[{"node":"Convert to Lark Base format OTP","type":"main","index":0}],[{"node":"Convert to Lark Base format","type":"main","index":0}]]},"ifOTPLarkMess":{"main":[[{"node":"Convert to Message Card for OTP","type":"main","index":0}],[{"node":"Convert to Lark Message Card","type":"main","index":0}]]},"ifOTPTelegram":{"main":[[{"node":"Create Telegram Message for OTP","type":"main","index":0}],[{"node":"Create Telegram Message","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{},"versionId":"9478433e-07b0-47cb-a046-9246f1bb2b51","triggerCount":0,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-07-23T17:04:03.699Z","updatedAt":"2023-07-23T19:24:59.000Z","id":"223","name":"h·ªèi ti·ªÅn 39","active":true,"nodes":[{"parameters":{"httpMethod":"POST","path":"39-hoi-tien","responseMode":"responseNode","options":{"rawBody":true}},"id":"5cd358a3-e66e-4ef4-a130-198a1e7ef940","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[820,420],"webhookId":"25d7dd84-c0a1-42d3-bcb5-874829ea04d3","alwaysOutputData":false},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/auth/v3/app_access_token/internal","sendBody":true,"specifyBody":"json","jsonBody":"{   \"app_id\": \"cli_a438be409938d02f\",   \"app_secret\": \"JQVHt8heUABfGlVUDbqRLgBc45DHbBOe\" }","options":{}},"id":"1528b2ad-1eb0-4816-8f2a-4b08d26d51a3","name":"HTTP Request","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[1040,420]},{"parameters":{"url":"https://open.larksuite.com/open-apis/bitable/v1/apps/SPqfbutsYaKiFrsBIY9lwnaRgag/tables/tblQmskZJ3NI6KRV/records/rec6gUtGKK","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $json[\"tenant_access_token\"] }}"}]},"options":{"response":{"response":{"fullResponse":true}}}},"id":"5d536898-b10b-4ba4-9d36-81ef641d748b","name":"L·∫•y s·ªë ti·ªÅn","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[1260,420]},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/im/v1/messages","sendQuery":true,"queryParameters":{"parameters":[{"name":"receive_id_type","value":"chat_id"}]},"sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $('HTTP Request').item.json[\"tenant_access_token\"] }}"}]},"sendBody":true,"bodyParameters":{"parameters":[{"name":"content","value":"={\"text\":\"B√°o c√°o ƒë·∫°i ca, trong h√¥m nay t·ªïng em nh·∫≠n s·ªë ti·ªÅn: {{ $json[\"Today\"] }} ƒë\"}"},{"name":"msg_type","value":"text"},{"name":"receive_id","value":"oc_17c5813e5ca810e29817bcdb09b3c30a"}]},"options":{"response":{"response":{"fullResponse":true}}}},"id":"31b2ab47-3318-4292-858b-810bbdea95a0","name":"B·∫Øn chat","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[1920,420]},{"parameters":{"keepOnlySet":true,"values":{"number":[{"name":"Today","value":"={{ $json.body.data.record.fields['h√¥m nay'] }}"}]},"options":{}},"id":"0f455ee6-a60e-4798-a08b-029ec94fab0e","name":"Set","type":"n8n-nodes-base.set","typeVersion":2,"position":[1480,420]}],"connections":{"Webhook":{"main":[[{"node":"HTTP Request","type":"main","index":0}]]},"HTTP Request":{"main":[[{"node":"L·∫•y s·ªë ti·ªÅn","type":"main","index":0}]]},"L·∫•y s·ªë ti·ªÅn":{"main":[[{"node":"Set","type":"main","index":0}]]},"Set":{"main":[[{"node":"B·∫Øn chat","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{"Webhook":[{"json":{"headers":{"host":"app.n8n.vn","user-agent":"Make/production","content-length":"21","content-type":"application/json","traceparent":"00-00000000000000005997b461ff7d62a6-5997b461ff7d62a6-00","tracestate":"dd=t.dm:1;s:0","x-datadog-parent-id":"6455826923850130086","x-datadog-sampling-priority":"0","x-datadog-trace-id":"6455826923850130086","x-forwarded-for":"34.254.1.9","x-forwarded-host":"app.n8n.vn","x-forwarded-port":"443","x-forwarded-proto":"https","x-forwarded-server":"f2605f992776","x-real-ip":"34.254.1.9","accept-encoding":"gzip"},"params":{},"query":{},"body":{"text":"@_user_1 $"}}}]},"versionId":"e62b5e88-9cc2-4c10-b524-e220fa9c559b","triggerCount":1,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-07-24T17:04:51.553Z","updatedAt":"2023-07-24T17:09:42.000Z","id":"224","name":"TMHN - B√°o Ti·ªÅn - N8N 200723 copy","active":false,"nodes":[{"parameters":{"httpMethod":"POST","path":"tmhn-khac-baotien","options":{}},"id":"81ec55a2-ddf0-4c7d-974d-9c39eb2cfb50","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[-1980,880],"webhookId":"ce158a66-5c38-48eb-b550-a91152982572"},{"parameters":{"mode":"runOnceForEachItem","jsCode":"if (\n  ($('getBankData').item.json.result.transactionType.type === '-' &&\n    $input.item.json.enableOutgoing) ||\n  ($('getBankData').item.json.result.transactionType.type === '+' &&\n    $input.item.json.enableIncoming)\n) {\n  const data = $('getBankData').first().json.result;\n\n  let elements = [];\n\n  elements.push({\n    tag: 'div',\n    fields: [\n      {\n        is_short: false,\n        text: {\n          tag: 'lark_md',\n          content: `**Ng√¢n h√†ng**: ${data.bankName.toUpperCase()}`,\n        },\n      },\n      {\n        is_short: false,\n        text: {\n          tag: 'lark_md',\n          content: `**S·ªë t√†i kho·∫£n**: ${data.receiverAccount}`,\n        },\n      },\n      {\n        is_short: false,\n        text: {\n          tag: 'lark_md',\n          content: `**S·ªë d∆∞ thay ƒë·ªïi:** ${data.transactionType.type} ${data.transactionAmount.amountText} VND`,\n        },\n      },\n      {\n        is_short: false,\n        text: {\n          tag: 'lark_md',\n          content: `**N·ªôi dung:** ${data.transactionMessage}`,\n        },\n      },\n    ],\n  });\n\n  // Append transaction ID if exist\n  if (data.transactionId) {\n    elements[0].fields.push({\n      is_short: false,\n      text: {\n        tag: 'lark_md',\n        content: `**M√£ giao d·ªãch:** ${data.transactionId}`,\n      },\n    });\n  }\n\n  // Append received time\n  elements[0].fields.push({\n    is_short: false,\n    text: {\n      tag: 'lark_md',\n      content: `**Th·ªùi gian nh·∫≠n:** ${data.receivedTime.text}`,\n    },\n  });\n\n  // Ki·ªÉm tra enableBalance n·∫øu true th√¨ th√™m ph·∫ßn t·ª≠ \"S·ªë d∆∞ t·∫°m t√≠nh\" v√†o m·∫£ng fields\n  if ($input.item.json.enableBalance) {\n    const balanceIndex = elements[0].fields.findIndex((field) =>\n      field?.text?.content?.includes('S·ªë d∆∞ thay ƒë·ªïi')\n    );\n    if (balanceIndex !== -1) {\n      elements[0].fields.splice(balanceIndex + 1, 0, {\n        is_short: false,\n        text: {\n          tag: 'lark_md',\n          content: `**S·ªë d∆∞ t·∫°m t√≠nh**: ${data.balance.amountText} VND`,\n        },\n      });\n    }\n  }\n\n  // create message card\n  let result = {\n    msg_type: 'interactive',\n    card: {\n      config: {\n        wide_screen_mode: true,\n      },\n      header: {\n        template: data.larkMessConfig?.cardColor ?? 'blue',\n        title: {\n          content: `${data.bankName.toUpperCase()}-${data.receiverAccount} (${\n            data.transactionType.type\n          }) ${data.transactionAmount.amountText}VND`,\n          tag: 'plain_text',\n        },\n      },\n      elements,\n    },\n  };\n\n  return {\n    json: {\n      isSend: true,\n      data: result,\n      customBotURL: $input.item.json.customBotURL,\n    },\n  };\n}\n\nreturn {\n  json: {\n    isSend: false,\n  },\n};\n"},"id":"e7d44a39-9800-4125-aad7-501dfe8603c6","name":"Convert to Lark Message Card","type":"n8n-nodes-base.code","typeVersion":1,"position":[320,920]},{"parameters":{"method":"POST","url":"=https://open.larksuite.com/open-apis/auth/v3/tenant_access_token/internal/","sendBody":true,"specifyBody":"json","jsonBody":"={ \"app_id\" : \"{{ $input.item.json[\"appId\"] }}\", \"app_secret\" : \"{{ $input.item.json[\"appSecret\"] }}\" }","options":{}},"id":"1a873923-adfa-4a9c-83a4-f3c88982f4b8","name":"Get Lark tenant access token","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[-740,620]},{"parameters":{"method":"POST","url":"={{ $input.item.json.customBotURL }}","sendBody":true,"specifyBody":"json","jsonBody":"={{ JSON.stringify($input.item.json.data)}}","options":{}},"id":"0f9e9f43-646b-4618-b4dc-f781325a2208","name":"[Lark] Send noti to group chat","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[740,780]},{"parameters":{"mode":"runOnceForEachItem","jsCode":"if (\n  ($('getBankData').item.json.result.transactionType.type === '-' &&\n    $input.item.json.enableOutgoing) ||\n  ($('getBankData').item.json.result.transactionType.type === '+' &&\n    $input.item.json.enableIncoming)\n) {\n  const data = $('getBankData').first().json.result;\n\n  // Convert to Lark Base format\n  const records = [\n    {\n      fields: {\n        ID: data.bankName + '-' + data.receiverAccount,\n        Bank: data.bankName.toUpperCase(),\n        Account: data.receiverAccount,\n        'Transaction Type': data.transactionType.typeText,\n        Debit:\n          data.transactionType.type === '+'\n            ? data.transactionAmount.amount\n            : undefined,\n        Credit:\n          data.transactionType.type === '-'\n            ? data.transactionAmount.amount\n            : undefined,\n        'Transaction ID': data.transactionId,\n        'Transaction Message': data.transactionMessage,\n        'Original Message': data.originalMessage,\n        'Time received': data.receivedTime.timestamp,\n      },\n    },\n  ];\n\n  // Ki·ªÉm tra enableBalance n·∫øu true th√¨ th√™m ph·∫ßn t·ª≠ \"Balance\" v√†o m·∫£ng fields\n  if ($input.item.json.enableBalance) {\n    records[0].fields = {\n      ...records[0].fields,\n      Balance: data.balance.amount,\n    };\n  }\n\n  return {\n    json: {\n      isSend: true,\n      records,\n      configs: {\n        baseId: $input.item.json.baseId,\n        tableId: $input.item.json.tableId,\n      },\n    },\n  };\n}\n\nreturn {\n  json: {\n    isSend: false,\n  },\n};\n"},"id":"541ed3d8-f7c1-4959-88ce-ef45c69120e0","name":"Convert to Lark Base format","type":"n8n-nodes-base.code","typeVersion":1,"position":[300,520]},{"parameters":{"method":"POST","url":"=https://open.larksuite.com/open-apis/bitable/v1/apps/{{ $json[\"configs\"][\"baseId\"] }}/tables/{{  $json[\"configs\"][\"tableId\"]}}/records/batch_create","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $node[\"Get Lark tenant access token\"].json.tenant_access_token }}"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\"records\":{{ JSON.stringify($json[\"records\"]) }}}","options":{}},"id":"66a1121b-c5d3-48f3-ab8b-3e963b987d41","name":"[SMS Log] Add records to Bitable","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[720,460]},{"parameters":{"conditions":{"boolean":[{"value1":"={{ $json.isBankSupport }}","value2":true}]}},"id":"aad0c198-74bd-4097-b192-0095162b9757","name":"ifBankSupport","type":"n8n-nodes-base.if","typeVersion":1,"position":[-1560,880]},{"parameters":{"method":"POST","url":"https://app.n8n.vn/webhook/kdigi-bank-bot-process-data","sendBody":true,"specifyBody":"json","jsonBody":"={{ JSON.stringify($input.first().json.body) }}","options":{}},"id":"fafa0a8b-963c-43bb-bb84-f94d1ef1a104","name":"getBankData","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[-1780,880]},{"parameters":{},"id":"d83bd380-2a6d-47ab-af70-dcf7b39fe672","name":"Start Actions","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[-1360,860]},{"parameters":{"mode":"runOnceForEachItem","jsCode":"if (\n  ($('getBankData').item.json.result.transactionType.type === '-' &&\n    $input.item.json.enableOutgoing) ||\n  ($('getBankData').item.json.result.transactionType.type === '+' &&\n    $input.item.json.enableIncoming)\n) {\n  const data = $('getBankData').first().json.result;\n\n  let message = [];\n\n  message.push(\n    `<b>${data.bankName.toUpperCase()}-${data.receiverAccount} (${\n      data.transactionType.type\n    }) ${data.transactionAmount.amountText}VND</b>\\n`,\n    `<b>Ng√¢n h√†ng:</b> ${data.bankName.toUpperCase()}`,\n    `<b>S·ªë t√†i kho·∫£n:</b> ${data.receiverAccount}`,\n    `<b>S·ªë d∆∞ thay ƒë·ªïi:</b> ${data.transactionType.type} ${data.transactionAmount.amountText} VND`\n  );\n\n  // Add balance\n  if ($input.item.json.enableBalance) {\n    message.push(`<b>S·ªë d∆∞ t·∫°m t√≠nh:</b> ${data.balance.amountText} VND`);\n  }\n\n  message.push(`<b>N·ªôi dung:</b>\\n ${data.transactionMessage}`);\n\n  // Check transaction ID\n  if (data.transactionId) {\n    message.push(`<b>M√£ giao d·ªãch:</b> ${data.transactionId}`);\n  }\n\n  message.push(`<b>Th·ªùi gian nh·∫≠n:</b> ${data.receivedTime.text}`);\n\n  return {\n    json: {\n      isSend: true,\n      botToken: $input.item.json.botToken,\n      payload: {\n        chat_id: $input.item.json.chatId,\n        parse_mode: 'HTML',\n        text: message.join('\\n'),\n      },\n    },\n  };\n}\n\nreturn {\n  json: {\n    isSend: false,\n  },\n};\n"},"id":"2e0422d4-20c4-4e9b-8c2b-1531847dda9b","name":"Create Telegram Message","type":"n8n-nodes-base.code","typeVersion":1,"position":[-300,1700]},{"parameters":{"method":"POST","url":"=https://api.telegram.org/bot{{ $input.item.json.botToken }}/sendMessage ","sendBody":true,"specifyBody":"json","jsonBody":"={{ JSON.stringify($input.item.json.payload) }}","options":{}},"id":"7e55354b-370f-4f33-b485-9ec9a8199233","name":"Send to Telegram chat","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[160,1620]},{"parameters":{"values":{"string":[{"name":"appId","value":"cli_a433ff4a74f89009"},{"name":"appSecret","value":"LL8RUtLIixRrw3t5qLUkwcdBhbgOWpIr"}]},"options":{}},"id":"035aea27-e0dc-42d2-96ca-70de3f0cb887","name":"Set Lark Configs","type":"n8n-nodes-base.set","typeVersion":2,"position":[-920,620]},{"parameters":{"values":{"string":[{"name":"customBotURL","value":"https://open.larksuite.com/open-apis/bot/v2/hook/7e5bdd69-bf24-4ac7-8735-e200d7a5d3fb"}],"boolean":[{"name":"enableBalance","value":true},{"name":"enableOTP","value":true},{"name":"enableOutgoing","value":true},{"name":"enableIncoming","value":true}]},"options":{}},"id":"6c3df85c-f0df-4059-86f8-1eb09907dddc","name":"Set Lark Mess Config","type":"n8n-nodes-base.set","typeVersion":2,"position":[-320,880]},{"parameters":{"values":{"string":[{"name":"baseId","value":"LIx9b5n6wazCqns1euGuCOthsyh"},{"name":"tableId","value":"tblp9NOY84tf0znP"}],"boolean":[{"name":"enableBalance","value":true},{"name":"enableOTP","value":true},{"name":"enableOutgoing","value":true},{"name":"enableIncoming","value":true}]},"options":{}},"id":"e6abeb8e-bf63-4a17-aec0-53fd9a23cd78","name":"Set Lark Base Config","type":"n8n-nodes-base.set","typeVersion":2,"position":[-300,480]},{"parameters":{},"id":"a31a6f4f-b3b8-4054-9e8d-6fc1144b1170","name":"Start Lark Actions","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[-1080,620]},{"parameters":{},"id":"8609570e-ee8e-41f5-9203-c35d1de4ac4c","name":"Start Lark Base","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[-520,480]},{"parameters":{},"id":"f732886a-0dd8-49f1-86e2-35921ee44f54","name":"Start Lark Mess","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[-540,880]},{"parameters":{},"id":"6fd51954-65ca-4f40-8978-b2a62ad2cf44","name":"Start Telegram Actions","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[-1080,1620]},{"parameters":{"values":{"string":[{"name":"botToken","value":"set-bot-token"},{"name":"chatId","value":"set-chat-id"}],"boolean":[{"name":"enableBalance","value":true},{"name":"enableOTP","value":true},{"name":"enableOutgoing","value":true},{"name":"enableIncoming","value":true}]},"options":{}},"id":"1b30c1a1-8933-461f-83e3-50f0065b01ec","name":"Set Telegram Config","type":"n8n-nodes-base.set","typeVersion":2,"position":[-900,1620]},{"parameters":{},"id":"fdf90ba0-6a0d-4293-ac40-70c5ceb41c57","name":"Start Lark Base Actions","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[-80,460]},{"parameters":{},"id":"63eedca8-bb36-454b-bb5d-bca2e2d20dbd","name":"Start Lark Mess Actions","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[-100,860]},{"parameters":{"mode":"runOnceForEachItem","jsCode":"const smsContent = $('Webhook').first().json.body;\n\n// create message card\nlet result = {\n  msg_type: 'text',\n  content: {\n    text: `T·ª´: ${smsContent.from}\\n${smsContent.text.toString()}`,\n  },\n};\n\nreturn {\n  json: {\n    data: result,\n    customBotURL: $input.item.json.customBotURL,\n  },\n};\n"},"id":"769e1441-7ac1-4950-830f-c51e0a7c8a42","name":"Convert to Message Card for OTP","type":"n8n-nodes-base.code","typeVersion":1,"position":[320,760]},{"parameters":{},"id":"0d04dec2-8695-4a98-b3d0-c958c0301ab1","name":"Start Telegram Mess Actions","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[-700,1620]},{"parameters":{"mode":"runOnceForEachItem","jsCode":"const smsContent = $('Webhook').first().json.body;\n\nlet message = [];\n\nmessage.push(\n  `<b>${smsContent.from.toUpperCase()}</b>\\n`,\n  `${smsContent.text.toString()}`\n);\n\nreturn {\n  json: {\n    botToken: $input.item.json.botToken,\n    payload: {\n      chat_id: $input.item.json.chatId,\n      parse_mode: 'HTML',\n      text: message.join('\\n'),\n    },\n  },\n};\n"},"id":"6ed5d26b-5a81-4ae3-91fc-4ca985915d2b","name":"Create Telegram Message for OTP","type":"n8n-nodes-base.code","typeVersion":1,"position":[-180,1480]},{"parameters":{"conditions":{"boolean":[{"value1":"={{ $input.item.json.isSend }}","value2":true}]}},"id":"4ae9a662-0530-4273-a533-66ff456ec5e1","name":"ifSend","type":"n8n-nodes-base.if","typeVersion":1,"position":[520,920]},{"parameters":{"conditions":{"boolean":[{"value1":"={{ $input.item.json.isSend }}","value2":true}]}},"id":"052167ac-d7db-4217-9c54-72ebc426774b","name":"ifSend1","type":"n8n-nodes-base.if","typeVersion":1,"position":[480,520]},{"parameters":{"conditions":{"boolean":[{"value1":"={{ $input.item.json.isSend }}","value2":true}]}},"id":"e0b29467-5575-4ac2-a0e6-41bebda40a51","name":"ifSend2","type":"n8n-nodes-base.if","typeVersion":1,"position":[-80,1700]},{"parameters":{"mode":"runOnceForEachItem","jsCode":"const smsContent = $('Webhook').first().json.body;\n\n  // Convert to Lark Base format\n  const records = [\n    {\n      fields: {\n        ID: smsContent.from,\n        Bank: smsContent.from,\n        'Transaction Type': 'OTP',\n        'Transaction Message': smsContent.text.toString(),\n        'Original Message': smsContent.text.toString(),\n        'Time received': smsContent.sentStamp,\n      },\n    },\n  ];\n\n  return {\n    json: {\n      records,\n      configs: {\n        baseId: $input.item.json.baseId,\n        tableId: $input.item.json.tableId,\n      },\n    },\n  };\n"},"id":"de04c343-b79e-48af-aba0-4290d85c4886","name":"Convert to Lark Base format OTP","type":"n8n-nodes-base.code","typeVersion":1,"position":[300,280]},{"parameters":{"conditions":{"string":[{"value1":"={{ $('Webhook').item.json.body.text }}","operation":"contains","value2":"OTP"}],"boolean":[{"value1":"={{ $input.item.json.enableOTP }}","value2":true}]}},"id":"a00bd9a4-61ad-436f-8673-7bdc58343c1b","name":"ifOTPLarkBase","type":"n8n-nodes-base.if","typeVersion":1,"position":[100,460]},{"parameters":{"conditions":{"string":[{"value1":"={{ $('Webhook').item.json.body.text }}","operation":"contains","value2":"OTP"}],"boolean":[{"value1":"={{ $input.item.json.enableOTP }}","value2":true}]}},"id":"66aa7265-4f90-43d6-95ed-cff2a98c890c","name":"ifOTPLarkMess","type":"n8n-nodes-base.if","typeVersion":1,"position":[60,860]},{"parameters":{"conditions":{"string":[{"value1":"={{ $('Webhook').item.json.body.text }}","operation":"contains","value2":"OTP"}],"boolean":[{"value1":"={{ $input.item.json.enableOTP }}","value2":true}]}},"id":"f3ee23b6-0364-4a91-b367-e7a7923a42dd","name":"ifOTPTelegram","type":"n8n-nodes-base.if","typeVersion":1,"position":[-520,1620]},{"parameters":{"values":{"string":[{"name":"customBotURL","value":"https://open.larksuite.com/open-apis/bot/v2/hook/27387efd-c40b-44c1-9872-6983f4f687c9"}]},"options":{}},"id":"eb8d822e-f225-4f18-8da5-8bdaf9098c5e","name":"Set Lark Mess Config1","type":"n8n-nodes-base.set","typeVersion":2,"position":[-1080,1180]},{"parameters":{"method":"POST","url":"={{ $input.item.json.customBotURL }}","sendBody":true,"specifyBody":"json","jsonBody":"={{ JSON.stringify($input.item.json.data)}}","options":{}},"id":"a931be24-f042-44a9-ad64-a639b99d6376","name":"[Lark] Send noti to group chat1","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[-660,1180]},{"parameters":{"mode":"runOnceForEachItem","jsCode":"const smsContent = $('Webhook').first().json.body;\n\n// create message card\nlet result = {\n  msg_type: 'text',\n  content: {\n    text: `T·ª´: ${smsContent.from}\\nN·ªôi dung: \\n${smsContent.text.toString()}`,\n  },\n};\n\nreturn {\n  json: {\n    data: result,\n    customBotURL: $input.item.json.customBotURL,\n  },\n};\n"},"id":"7912d3fb-534a-45c9-b45c-612125997341","name":"Convert to Message Card","type":"n8n-nodes-base.code","typeVersion":1,"position":[-880,1180]}],"connections":{"Webhook":{"main":[[{"node":"getBankData","type":"main","index":0}]]},"Convert to Lark Message Card":{"main":[[{"node":"ifSend","type":"main","index":0}]]},"Get Lark tenant access token":{"main":[[{"node":"Start Lark Base","type":"main","index":0},{"node":"Start Lark Mess","type":"main","index":0}]]},"Convert to Lark Base format":{"main":[[{"node":"ifSend1","type":"main","index":0}]]},"ifBankSupport":{"main":[[{"node":"Start Actions","type":"main","index":0}],[{"node":"Set Lark Mess Config1","type":"main","index":0}]]},"getBankData":{"main":[[{"node":"ifBankSupport","type":"main","index":0}]]},"Create Telegram Message":{"main":[[{"node":"ifSend2","type":"main","index":0}]]},"Set Lark Configs":{"main":[[{"node":"Get Lark tenant access token","type":"main","index":0}]]},"Set Lark Mess Config":{"main":[[{"node":"Start Lark Mess Actions","type":"main","index":0}]]},"Set Lark Base Config":{"main":[[{"node":"Start Lark Base Actions","type":"main","index":0}]]},"Start Lark Actions":{"main":[[{"node":"Set Lark Configs","type":"main","index":0}]]},"Start Lark Base":{"main":[[{"node":"Set Lark Base Config","type":"main","index":0}]]},"Start Lark Mess":{"main":[[{"node":"Set Lark Mess Config","type":"main","index":0}]]},"Start Telegram Actions":{"main":[[{"node":"Set Telegram Config","type":"main","index":0}]]},"Set Telegram Config":{"main":[[{"node":"Start Telegram Mess Actions","type":"main","index":0}]]},"Start Lark Base Actions":{"main":[[{"node":"ifOTPLarkBase","type":"main","index":0}]]},"Start Lark Mess Actions":{"main":[[{"node":"ifOTPLarkMess","type":"main","index":0}]]},"Convert to Message Card for OTP":{"main":[[{"node":"[Lark] Send noti to group chat","type":"main","index":0}]]},"Start Telegram Mess Actions":{"main":[[{"node":"ifOTPTelegram","type":"main","index":0}]]},"Create Telegram Message for OTP":{"main":[[{"node":"Send to Telegram chat","type":"main","index":0}]]},"ifSend":{"main":[[{"node":"[Lark] Send noti to group chat","type":"main","index":0}]]},"ifSend1":{"main":[[{"node":"[SMS Log] Add records to Bitable","type":"main","index":0}]]},"ifSend2":{"main":[[{"node":"Send to Telegram chat","type":"main","index":0}]]},"Convert to Lark Base format OTP":{"main":[[{"node":"[SMS Log] Add records to Bitable","type":"main","index":0}]]},"ifOTPLarkBase":{"main":[[{"node":"Convert to Lark Base format OTP","type":"main","index":0}],[{"node":"Convert to Lark Base format","type":"main","index":0}]]},"ifOTPLarkMess":{"main":[[{"node":"Convert to Message Card for OTP","type":"main","index":0}],[{"node":"Convert to Lark Message Card","type":"main","index":0}]]},"ifOTPTelegram":{"main":[[{"node":"Create Telegram Message for OTP","type":"main","index":0}],[{"node":"Create Telegram Message","type":"main","index":0}]]},"Set Lark Mess Config1":{"main":[[{"node":"Convert to Message Card","type":"main","index":0}]]},"Start Actions":{"main":[[{"node":"Start Lark Actions","type":"main","index":0}]]},"Convert to Message Card":{"main":[[{"node":"[Lark] Send noti to group chat1","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{"Webhook":[{"json":{"headers":{"host":"app.n8n.vn","user-agent":"SMS Forwarder App","transfer-encoding":"chunked","accept-encoding":"gzip","content-type":"application/json; charset=utf-8","x-forwarded-for":"171.224.177.18","x-forwarded-host":"app.n8n.vn","x-forwarded-port":"443","x-forwarded-proto":"https","x-forwarded-server":"f2605f992776","x-real-ip":"171.224.177.18"},"params":{},"query":{},"body":{"from":"ABBank","text":"TK268xxx0922 tai BIDV +400,000,000VND vao 10:48 21/07/2023. So du:412,040,620VND. ND: TKThe :2207201008449, tai Agribank. hx tra xn3 -CTLNHIDI000005159896347-11","sentStamp":1689912578000,"receivedStamp":1689912580093,"sim":"sim2"}}}]},"versionId":"f6416368-9be8-4ec9-be52-5ede9b065921","triggerCount":1,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-07-25T04:47:47.383Z","updatedAt":"2023-07-25T11:06:19.000Z","id":"225","name":"SMS Bank NPTB","active":true,"nodes":[{"parameters":{"httpMethod":"POST","path":"nptb-webinar","options":{}},"id":"46da23be-d266-4427-bf6e-c69d4c063d04","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[820,400],"webhookId":"bdba9a38-1977-4c7b-8763-e738f8198a96"},{"parameters":{"method":"POST","url":"https://api.smax.bot/public/bots/613b2d63e82fb23b1a1a949b/send?api_id=64bfa31cdbb1536cc5f4a674&block_id=64bf8bc9ff0c4d089bda864d&access_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjYxM2IyZDYzZTgyZmIyM2IxYTFhOTQ5YiIsIm5hbWUiOiJUw6JtIFRyw60gTOG7sWMgLSBDb3B5IiwiaWF0IjoxNjMxMjY4MTk1LCJleHAiOjE5NDY2MjgxOTV9.44WRJetqqp_V7IfEshUi41qzXXEQU47N4n9a5XUVGqQ","sendBody":true,"bodyParameters":{"parameters":[{"name":"customer_email","value":"=test{{Math.floor(Math.random()*999)}}@tamtriluc.com"},{"name":"=message","value":"={{ $('Webhook').first().json.query.message }}"},{"name":"key","value":"NPTB"}]},"options":{}},"id":"2c73edab-bff7-47f4-bc80-304a910ba12d","name":"HTTP Request","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[1300,320]},{"parameters":{"conditions":{"string":[{"value1":"={{ $json.query.message }}","operation":"contains","value2":"NPTB"}]}},"id":"ec9bd9c7-8489-435a-aeaa-c8f9016e84d3","name":"IF NPTB","type":"n8n-nodes-base.if","typeVersion":1,"position":[1040,340]},{"parameters":{"method":"POST","url":"https://api.smax.bot/public/bots/613b2d63e82fb23b1a1a949b/send?api_id=64bfa31cdbb1536cc5f4a674&block_id=64bf8bc9ff0c4d089bda864d&access_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjYxM2IyZDYzZTgyZmIyM2IxYTFhOTQ5YiIsIm5hbWUiOiJUw6JtIFRyw60gTOG7sWMgLSBDb3B5IiwiaWF0IjoxNjMxMjY4MTk1LCJleHAiOjE5NDY2MjgxOTV9.44WRJetqqp_V7IfEshUi41qzXXEQU47N4n9a5XUVGqQ","sendBody":true,"bodyParameters":{"parameters":[{"name":"customer_email","value":"=test{{Math.floor(Math.random()*999)}}@tamtriluc.com"},{"name":"=message","value":"={{ $('Webhook').first().json.query.message }}"},{"name":"key","value":"DHCC"}]},"options":{}},"id":"a49d97a3-a974-44b3-9128-b9e4e0d4a2b4","name":"HTTP Request1","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[1300,520]},{"parameters":{"conditions":{"string":[{"value1":"={{ $json.query.message }}","operation":"contains","value2":"DHCC"}]}},"id":"e425fc39-3aed-4006-bc71-c928ffb71538","name":"IF DHCC","type":"n8n-nodes-base.if","typeVersion":1,"position":[1040,520]},{"parameters":{"conditions":{"string":[{"value1":"={{ $json.query.message }}","operation":"contains","value2":"TKTD"}]}},"id":"6209a89a-314f-4b87-a624-d6c0b0db5ae2","name":"IF TKTD","type":"n8n-nodes-base.if","typeVersion":1,"position":[1040,680]},{"parameters":{"method":"POST","url":"https://api.smax.bot/public/bots/613b2d63e82fb23b1a1a949b/send?api_id=64bfa31cdbb1536cc5f4a674&block_id=64bf8bc9ff0c4d089bda864d&access_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjYxM2IyZDYzZTgyZmIyM2IxYTFhOTQ5YiIsIm5hbWUiOiJUw6JtIFRyw60gTOG7sWMgLSBDb3B5IiwiaWF0IjoxNjMxMjY4MTk1LCJleHAiOjE5NDY2MjgxOTV9.44WRJetqqp_V7IfEshUi41qzXXEQU47N4n9a5XUVGqQ","sendBody":true,"bodyParameters":{"parameters":[{"name":"customer_email","value":"=test{{Math.floor(Math.random()*999)}}@tamtriluc.com"},{"name":"=message","value":"={{ $('Webhook').first().json.query.message }}"},{"name":"key","value":"TKTD"}]},"options":{}},"id":"bffda1c2-7587-4e27-ac36-65d573c577b2","name":"HTTP Request2","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[1300,700]},{"parameters":{"method":"POST","url":"https://api.smax.bot/public/bots/613b2d63e82fb23b1a1a949b/send?api_id=64bfa31cdbb1536cc5f4a674&block_id=64bf8bc9ff0c4d089bda864d&access_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjYxM2IyZDYzZTgyZmIyM2IxYTFhOTQ5YiIsIm5hbWUiOiJUw6JtIFRyw60gTOG7sWMgLSBDb3B5IiwiaWF0IjoxNjMxMjY4MTk1LCJleHAiOjE5NDY2MjgxOTV9.44WRJetqqp_V7IfEshUi41qzXXEQU47N4n9a5XUVGqQ","sendBody":true,"bodyParameters":{"parameters":[{"name":"customer_email","value":"=test{{Math.floor(Math.random()*999)}}@tamtriluc.com"},{"name":"=message","value":"={{ $('Webhook').first().json.query.message }}"},{"name":"key","value":"not"}]},"options":{}},"id":"adb74ed2-713e-4b01-8f92-7fdf7292c40f","name":"HTTP Request3","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[1300,880]},{"parameters":{"conditions":{"string":[{"value1":"={{ $json.query.message }}","operation":"notContains","value2":"TKTD"},{"value1":"={{ $json.query.message }}","operation":"notContains","value2":"NPTB"},{"value1":"={{ $json.query.message }}","operation":"notContains","value2":"DHCC"}]}},"id":"3c6f5da9-bf41-4a5f-988f-9fc8833e8a07","name":"IF not","type":"n8n-nodes-base.if","typeVersion":1,"position":[1040,880]}],"connections":{"Webhook":{"main":[[{"node":"IF NPTB","type":"main","index":0},{"node":"IF DHCC","type":"main","index":0},{"node":"IF TKTD","type":"main","index":0},{"node":"IF not","type":"main","index":0}]]},"IF NPTB":{"main":[[{"node":"HTTP Request","type":"main","index":0}]]},"IF DHCC":{"main":[[{"node":"HTTP Request1","type":"main","index":0}]]},"IF TKTD":{"main":[[{"node":"HTTP Request2","type":"main","index":0}]]},"IF not":{"main":[[{"node":"HTTP Request3","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{"Webhook":[{"json":{"headers":{"host":"app.n8n.vn","content-length":"0","accept":"*/*","content-type":"application/x-www-form-urlencoded","x-forwarded-for":"103.130.216.65","x-forwarded-host":"app.n8n.vn","x-forwarded-port":"443","x-forwarded-proto":"https","x-forwarded-server":"f2605f992776","x-real-ip":"103.130.216.65","accept-encoding":"gzip"},"params":{},"query":{"number":"Momo","message":"ACB: TK xxxxx-VND- + 5,168,000 luc 09:11 25/07/2023. So du 391,244,058. GD: MBVCB.3911323759.021536.NPTB 0907141461.CT tu 0181000558962 AAAA toi"},"body":{}},"pairedItem":{"item":0}}]},"versionId":"ecc04fb8-02e5-4959-bcf4-1e3ef6558182","triggerCount":1,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-07-25T07:20:09.226Z","updatedAt":"2023-07-25T07:20:09.226Z","id":"226","name":"ƒê∆°n gi·∫£n l√† 1 c√°i hook","active":false,"nodes":[],"connections":{},"settings":{},"staticData":null,"pinData":{},"versionId":"38736481-7b77-46cd-9940-bdc767174a5b","triggerCount":0,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-07-25T14:56:45.498Z","updatedAt":"2023-07-25T14:57:53.000Z","id":"227","name":"Order Digifox Noti","active":true,"nodes":[{"parameters":{"event":"order.created"},"id":"cae4c242-a8b2-4ddf-a091-8cf02d12736b","name":"WooCommerce Trigger","type":"n8n-nodes-base.wooCommerceTrigger","typeVersion":1,"position":[460,460],"webhookId":"c0151d91-8cbe-4534-b81e-ec56ff8b37a7","credentials":{"wooCommerceApi":{"id":"90","name":"Woo Digifox"}}},{"parameters":{"chatId":"@quangsocial","text":"C√≥ ƒë∆°n h√†ng nha!","additionalFields":{}},"id":"37d08c6b-237e-47d5-b828-241e9b73279c","name":"Telegram","type":"n8n-nodes-base.telegram","typeVersion":1,"position":[680,460],"credentials":{"telegramApi":{"id":"89","name":"Telegram OrderDigifoxBot"}}}],"connections":{"WooCommerce Trigger":{"main":[[{"node":"Telegram","type":"main","index":0}]]}},"settings":{},"staticData":{"node:WooCommerce Trigger":{"webhookId":24,"secret":"12f155d64332be9c8e0f54e1d25bd624"}},"pinData":{},"versionId":"4d23c7df-ff5c-496f-9430-42169ef4ba24","triggerCount":1,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-07-25T15:38:27.229Z","updatedAt":"2023-07-25T16:09:38.000Z","id":"228","name":"My workflow 28","active":false,"nodes":[{"parameters":{"formId":"Kih5mq6M"},"id":"b489cf5a-237c-4aea-a5db-390bc3fddb10","name":"Typeform Trigger","type":"n8n-nodes-base.typeformTrigger","typeVersion":1,"position":[400,280],"webhookId":"b83e1eb5-2925-4dd0-b042-06cf0d9b9231","credentials":{"typeformApi":{"id":"91","name":"Typeform account"}}},{"parameters":{"chatId":"-928394539","text":"={{ $json['Would you recommend working here to your friends?'] }}","additionalFields":{}},"id":"f161e09b-521f-439e-947e-c65325bb1ade","name":"Telegram","type":"n8n-nodes-base.telegram","typeVersion":1,"position":[620,280],"credentials":{"telegramApi":{"id":"89","name":"Telegram OrderDigifoxBot"}}}],"connections":{"Typeform Trigger":{"main":[[{"node":"Telegram","type":"main","index":0}]]}},"settings":{},"staticData":{"node:Typeform Trigger":{}},"pinData":{},"versionId":"1ffa0524-dfc1-4780-bf77-04c85ca4de78","triggerCount":1,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-07-26T02:16:33.865Z","updatedAt":"2023-07-26T03:32:31.000Z","id":"229","name":"My workflow 29","active":true,"nodes":[{"parameters":{"path":"webhook","options":{}},"id":"5904d80f-2beb-477a-b738-d86e282f838c","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[820,400],"webhookId":"a52cf08e-3186-4081-abd4-e710f3b6707d"},{"parameters":{"url":"https://open.larksuite.com/open-apis/auth/v3/app_access_token/internal","sendBody":true,"specifyBody":"json","jsonBody":"={ \n\"app_id\": \"cli_a44ac1807e38d02f\", \n\"app_secret\": \"AhxLjcjNXpQHCjRjIfzObektJklOiLkd\"\n}","options":{}},"id":"ee0f3a67-5b95-43c0-9924-024f3465b254","name":"HTTP Request","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[1040,400]},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/bitable/v1/apps/BrXcbT7C5aiuuBspT6Hlz8sLgMg/tables/tblPQGWs79hju7UK/records","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $jsonapp_access_token }}"}]},"sendBody":true,"specifyBody":"json","jsonBody":"=","options":{}},"id":"04dcef66-b821-48ee-86a2-195a7909a262","name":"HTTP Request1","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[1260,400]}],"connections":{"Webhook":{"main":[[{"node":"HTTP Request","type":"main","index":0}]]},"HTTP Request":{"main":[[{"node":"HTTP Request1","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{},"versionId":"619f7523-66de-417c-8889-888b65c5ae9d","triggerCount":1,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-07-26T07:18:17.026Z","updatedAt":"2023-07-26T07:38:40.000Z","id":"230","name":"Demo send email","active":false,"nodes":[{"parameters":{},"id":"f1e15c5f-f6cb-46c4-bf6e-bd46fd2b05c1","name":"When clicking \"Execute Workflow\"","type":"n8n-nodes-base.manualTrigger","typeVersion":1,"position":[720,500]},{"parameters":{"fromEmail":"DC Media <no-reply@dcmedia.vn>","toEmail":"={{ $input.first().json.receivers.join(',') }}","subject":"Test Email","emailFormat":"html","html":"<h1>ƒê√¢y l√† ti√™u ƒë·ªÅ</h1>\n<p>ƒê√¢y l√† n·ªôi dung email</p>","options":{}},"id":"5775de44-2199-4392-aaf0-db6b437a732e","name":"Send Email","type":"n8n-nodes-base.emailSend","typeVersion":2,"position":[1700,500],"credentials":{"smtp":{"id":"62","name":"SMTP no-reply@dcmedia.vn"}}},{"parameters":{"values":{"string":[{"name":"baseId","value":"KLDkb8aBiaaFVVsOBSEufPrss7e"},{"name":"tableId","value":"tblyIx26l98n67BE"}]},"options":{}},"id":"377536e3-c1a5-4050-88b8-a4f6cc29ff48","name":"Set Lark Base Info","type":"n8n-nodes-base.set","typeVersion":2,"position":[1100,500]},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/auth/v3/tenant_access_token/internal/","sendBody":true,"bodyParameters":{"parameters":[{"name":"app_id","value":"cli_a4054c355978d009"},{"name":"app_secret","value":"gIBdgOBBQVCQeRpQw1y7Zencd2sOqigf"}]},"options":{}},"id":"e90f4b6d-c214-4f96-91cf-86e23bb6376e","name":"get_access_token","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[900,500]},{"parameters":{"url":"=https://open.larksuite.com/open-apis/bitable/v1/apps/{{ $input.item.json.baseId }}/tables/{{ $input.item.json.tableId }}/records","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $('get_access_token').item.json.tenant_access_token }}"}]},"options":{}},"id":"9d401a02-929a-4609-a0de-605a4cd9cb38","name":"get_list_record","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[1320,500]},{"parameters":{"jsCode":"let records = $input.first().json.data.items\nlet receivers = records.map(record => record.fields.Email)\n\nreturn {\n  json :{\n    receivers\n  }\n}"},"id":"62e26f6c-e43d-457b-948f-b0d41e93a591","name":"Extract Emails","type":"n8n-nodes-base.code","typeVersion":1,"position":[1520,500]}],"connections":{"When clicking \"Execute Workflow\"":{"main":[[{"node":"get_access_token","type":"main","index":0}]]},"Set Lark Base Info":{"main":[[{"node":"get_list_record","type":"main","index":0}]]},"get_access_token":{"main":[[{"node":"Set Lark Base Info","type":"main","index":0}]]},"get_list_record":{"main":[[{"node":"Extract Emails","type":"main","index":0}]]},"Extract Emails":{"main":[[{"node":"Send Email","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{},"versionId":"bb856970-ba37-451d-b548-e58ff3e7a20f","triggerCount":0,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-07-26T07:28:56.893Z","updatedAt":"2023-07-26T07:53:45.000Z","id":"231","name":"L√™n ƒë∆°n 5PTB Webinar","active":true,"nodes":[{"parameters":{"path":"23250b40-9542-4d5c-b8b6-34e126262e86","responseMode":"responseNode","options":{}},"id":"888f9603-f2c6-44c0-a27f-feee04e067d9","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[820,400],"webhookId":"23250b40-9542-4d5c-b8b6-34e126262e86"},{"parameters":{"url":"=https://hitacamp.vn/wp-json/woo_smaxbot/create_order?secret=6688&name={{ $json.query.name }}&email={{ $json.query.email }}&phone={{ $json.query.phone }}&product={{ $json.query.product }}&coupon={{ $json.query.coupon }}","options":{}},"id":"24437b28-0c49-422a-a5ea-da2b51a2c4e1","name":"HTTP Request","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[1040,400]},{"parameters":{"amount":2,"unit":"seconds"},"id":"3c1548e9-9491-430d-93a6-d6bed3bd471a","name":"Wait","type":"n8n-nodes-base.wait","typeVersion":1,"position":[1260,400],"webhookId":"fc776efb-ada2-4024-b87a-ec04387f4137"},{"parameters":{"conditions":{"string":[{"value1":"={{ $json.set_attributes.order_id }}","operation":"isNotEmpty"}]}},"id":"b6d17e8d-8182-402c-8904-658458c10171","name":"IF","type":"n8n-nodes-base.if","typeVersion":1,"position":[1480,400]},{"parameters":{"url":"=https://hitacamp.vn/wp-json/woo_smaxbot/update_order?secret=6688&order_id={{ $json.set_attributes.order_id }}&status=completed","options":{"response":{"response":{"responseFormat":"text"}}}},"id":"a08d54ba-395b-4d9b-a532-9f4d453bbd57","name":"HTTP Request1","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[1700,400]},{"parameters":{"amount":5,"unit":"seconds"},"id":"72cd8fa3-470f-42d7-bcaa-e19166a11ce8","name":"Wait1","type":"n8n-nodes-base.wait","typeVersion":1,"position":[1460,660],"webhookId":"eb2eb58a-ebed-44f7-81a1-4fb6ac583280"},{"parameters":{"respondWith":"json","responseBody":"={ \"order_id\": \"{{ $('IF').item.json.set_attributes.order_id }}\" }","options":{"responseCode":200}},"id":"7b08d674-124e-4536-a699-e9a2625c3aac","name":"Respond to Webhook","type":"n8n-nodes-base.respondToWebhook","typeVersion":1,"position":[1920,400]}],"connections":{"Webhook":{"main":[[{"node":"HTTP Request","type":"main","index":0}]]},"HTTP Request":{"main":[[{"node":"Wait","type":"main","index":0}]]},"Wait":{"main":[[{"node":"IF","type":"main","index":0}]]},"IF":{"main":[[{"node":"HTTP Request1","type":"main","index":0}],[{"node":"Wait1","type":"main","index":0}]]},"Wait1":{"main":[[{"node":"HTTP Request","type":"main","index":0}]]},"HTTP Request1":{"main":[[{"node":"Respond to Webhook","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{"Webhook":[{"json":{"headers":{"host":"app.n8n.vn","user-agent":"axios/0.19.2","accept":"application/json, text/plain, */*","content-type":"application/json","x-forwarded-for":"34.87.3.106","x-forwarded-host":"app.n8n.vn","x-forwarded-port":"443","x-forwarded-proto":"https","x-forwarded-server":"f2605f992776","x-real-ip":"34.87.3.106","accept-encoding":"gzip"},"params":{},"query":{"secret":"6688","name":"Qu√¢n Test","email":"quanchatbot@gmail.com","phone":"0985767138","product":"24681","coupon":"giftwebinar"},"body":{}},"pairedItem":{"item":0}}],"HTTP Request":[{"json":{"set_attributes":{"messid":"","order_id":"27807","order_key":"wc_order_zQ9RN0r5J7oA1","order_total":"186000","order_total_discount":"0","order_status":"processing","first_name":"QuÔøΩn Test","last_name":"","order_email":"quanchatbot@gmail.com","order_phone":"0985767138","order_url":"https://hitacamp.vn/my-account/view-order/27807/","ref_id":"","ref_name":"","nguon":"","note":""}},"pairedItem":{"item":0}}]},"versionId":"f73e5abc-6951-4628-b75b-913045553c09","triggerCount":1,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-07-26T08:25:37.759Z","updatedAt":"2023-07-26T08:29:18.000Z","id":"232","name":"TMHN - B√°o Ti·ªÅn - N8N 200723 - edited th√™m c·ªôt","active":true,"nodes":[{"parameters":{"httpMethod":"POST","path":"tmhn-xn3-baotien","options":{}},"id":"361fcafc-bc7c-4c4b-a7dc-6567b969ee55","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[-1980,880],"webhookId":"e977831d-069f-4a85-9369-9d8f9292f719"},{"parameters":{"mode":"runOnceForEachItem","jsCode":"if (\n  ($('getBankData').item.json.result.transactionType.type === '-' &&\n    $input.item.json.enableOutgoing) ||\n  ($('getBankData').item.json.result.transactionType.type === '+' &&\n    $input.item.json.enableIncoming)\n) {\n  const data = $('getBankData').first().json.result;\n\n  let elements = [];\n\n  elements.push({\n    tag: 'div',\n    fields: [\n      {\n        is_short: false,\n        text: {\n          tag: 'lark_md',\n          content: `**Ng√¢n h√†ng**: ${data.bankName.toUpperCase()}`,\n        },\n      },\n      {\n        is_short: false,\n        text: {\n          tag: 'lark_md',\n          content: `**S·ªë t√†i kho·∫£n**: ${data.receiverAccount}`,\n        },\n      },\n      {\n        is_short: false,\n        text: {\n          tag: 'lark_md',\n          content: `**S·ªë d∆∞ thay ƒë·ªïi:** ${data.transactionType.type} ${data.transactionAmount.amountText} VND`,\n        },\n      },\n      {\n        is_short: false,\n        text: {\n          tag: 'lark_md',\n          content: `**N·ªôi dung:** ${data.transactionMessage}`,\n        },\n      },\n    ],\n  });\n\n  // Append transaction ID if exist\n  if (data.transactionId) {\n    elements[0].fields.push({\n      is_short: false,\n      text: {\n        tag: 'lark_md',\n        content: `**M√£ giao d·ªãch:** ${data.transactionId}`,\n      },\n    });\n  }\n\n  // Append received time\n  elements[0].fields.push({\n    is_short: false,\n    text: {\n      tag: 'lark_md',\n      content: `**Th·ªùi gian nh·∫≠n:** ${data.receivedTime.text}`,\n    },\n  });\n\n  // Ki·ªÉm tra enableBalance n·∫øu true th√¨ th√™m ph·∫ßn t·ª≠ \"S·ªë d∆∞ t·∫°m t√≠nh\" v√†o m·∫£ng fields\n  if ($input.item.json.enableBalance) {\n    const balanceIndex = elements[0].fields.findIndex((field) =>\n      field?.text?.content?.includes('S·ªë d∆∞ thay ƒë·ªïi')\n    );\n    if (balanceIndex !== -1) {\n      elements[0].fields.splice(balanceIndex + 1, 0, {\n        is_short: false,\n        text: {\n          tag: 'lark_md',\n          content: `**S·ªë d∆∞ t·∫°m t√≠nh**: ${data.balance.amountText} VND`,\n        },\n      });\n    }\n  }\n\n  // create message card\n  let result = {\n    msg_type: 'interactive',\n    card: {\n      config: {\n        wide_screen_mode: true,\n      },\n      header: {\n        template: data.larkMessConfig?.cardColor ?? 'blue',\n        title: {\n          content: `${data.bankName.toUpperCase()}-${data.receiverAccount} (${\n            data.transactionType.type\n          }) ${data.transactionAmount.amountText}VND`,\n          tag: 'plain_text',\n        },\n      },\n      elements,\n    },\n  };\n\n  return {\n    json: {\n      isSend: true,\n      data: result,\n      customBotURL: $input.item.json.customBotURL,\n    },\n  };\n}\n\nreturn {\n  json: {\n    isSend: false,\n  },\n};\n"},"id":"34781a73-b215-420e-ad98-14c084cbbee2","name":"Convert to Lark Message Card","type":"n8n-nodes-base.code","typeVersion":1,"position":[320,920]},{"parameters":{"method":"POST","url":"=https://open.larksuite.com/open-apis/auth/v3/tenant_access_token/internal/","sendBody":true,"specifyBody":"json","jsonBody":"={ \"app_id\" : \"{{ $input.item.json[\"appId\"] }}\", \"app_secret\" : \"{{ $input.item.json[\"appSecret\"] }}\" }","options":{}},"id":"1137fbee-cd43-49fe-9b9f-6e75d3e715df","name":"Get Lark tenant access token","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[-740,620]},{"parameters":{"method":"POST","url":"={{ $input.item.json.customBotURL }}","sendBody":true,"specifyBody":"json","jsonBody":"={{ JSON.stringify($input.item.json.data)}}","options":{}},"id":"08dc29d1-b18a-4311-a3c7-c8b1aa9ab191","name":"[Lark] Send noti to group chat","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[740,780]},{"parameters":{"mode":"runOnceForEachItem","jsCode":"if (\n  ($('getBankData').item.json.result.transactionType.type === '-' &&\n    $input.item.json.enableOutgoing) ||\n  ($('getBankData').item.json.result.transactionType.type === '+' &&\n    $input.item.json.enableIncoming)\n) {\n  const data = $('getBankData').first().json.result;\n\n  // Convert to Lark Base format\n  const records = [\n    {\n      fields: {\n        ID: data.bankName + '-' + data.receiverAccount,\n        Bank: data.bankName.toUpperCase(),\n        Account: data.receiverAccount,\n        'Transaction Type': data.transactionType.typeText,\n        Debit:\n          data.transactionType.type === '+'\n            ? data.transactionAmount.amount\n            : undefined,\n        Credit:\n          data.transactionType.type === '-'\n            ? data.transactionAmount.amount\n            : undefined,\n        'Transaction ID': data.transactionId,\n        'Transaction Message': data.transactionMessage,\n        'Original Message': data.originalMessage,\n        'Transaction Time': data.transactionTime.timestamp,\n        'Time received': data.receivedTime.timestamp,\n      },\n    },\n  ];\n\n  // Ki·ªÉm tra enableBalance n·∫øu true th√¨ th√™m ph·∫ßn t·ª≠ \"Balance\" v√†o m·∫£ng fields\n  if ($input.item.json.enableBalance) {\n    records[0].fields = {\n      ...records[0].fields,\n      Balance: data.balance.amount,\n    };\n  }\n\n  return {\n    json: {\n      isSend: true,\n      records,\n      configs: {\n        baseId: $input.item.json.baseId,\n        tableId: $input.item.json.tableId,\n      },\n    },\n  };\n}\n\nreturn {\n  json: {\n    isSend: false,\n  },\n};\n"},"id":"a4daac00-0b48-4253-bdbe-c3e6614cdbbe","name":"Convert to Lark Base format","type":"n8n-nodes-base.code","typeVersion":1,"position":[300,520]},{"parameters":{"method":"POST","url":"=https://open.larksuite.com/open-apis/bitable/v1/apps/{{ $json[\"configs\"][\"baseId\"] }}/tables/{{  $json[\"configs\"][\"tableId\"]}}/records/batch_create","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $node[\"Get Lark tenant access token\"].json.tenant_access_token }}"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\"records\":{{ JSON.stringify($json[\"records\"]) }}}","options":{}},"id":"824bccaa-5d6f-4788-9f8c-4b4f0a2405cb","name":"[SMS Log] Add records to Bitable","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[720,460]},{"parameters":{"conditions":{"boolean":[{"value1":"={{ $json.isBankSupport }}","value2":true}]}},"id":"50ac021c-948d-4692-bea1-98b1d43cb6ce","name":"ifBankSupport","type":"n8n-nodes-base.if","typeVersion":1,"position":[-1560,880]},{"parameters":{"method":"POST","url":"https://app.n8n.vn/webhook/kdigi-bank-bot-process-data","sendBody":true,"specifyBody":"json","jsonBody":"={{ JSON.stringify($input.first().json.body) }}","options":{}},"id":"16a9538f-7d20-4c33-a7d7-414cd72a3b37","name":"getBankData","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[-1780,880]},{"parameters":{},"id":"92a3ec2d-ece0-4aa7-989d-eac119c2be5f","name":"Start Actions","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[-1360,860]},{"parameters":{"mode":"runOnceForEachItem","jsCode":"if (\n  ($('getBankData').item.json.result.transactionType.type === '-' &&\n    $input.item.json.enableOutgoing) ||\n  ($('getBankData').item.json.result.transactionType.type === '+' &&\n    $input.item.json.enableIncoming)\n) {\n  const data = $('getBankData').first().json.result;\n\n  let message = [];\n\n  message.push(\n    `<b>${data.bankName.toUpperCase()}-${data.receiverAccount} (${\n      data.transactionType.type\n    }) ${data.transactionAmount.amountText}VND</b>\\n`,\n    `<b>Ng√¢n h√†ng:</b> ${data.bankName.toUpperCase()}`,\n    `<b>S·ªë t√†i kho·∫£n:</b> ${data.receiverAccount}`,\n    `<b>S·ªë d∆∞ thay ƒë·ªïi:</b> ${data.transactionType.type} ${data.transactionAmount.amountText} VND`\n  );\n\n  // Add balance\n  if ($input.item.json.enableBalance) {\n    message.push(`<b>S·ªë d∆∞ t·∫°m t√≠nh:</b> ${data.balance.amountText} VND`);\n  }\n\n  message.push(`<b>N·ªôi dung:</b>\\n ${data.transactionMessage}`);\n\n  // Check transaction ID\n  if (data.transactionId) {\n    message.push(`<b>M√£ giao d·ªãch:</b> ${data.transactionId}`);\n  }\n\n  message.push(`<b>Th·ªùi gian nh·∫≠n:</b> ${data.receivedTime.text}`);\n\n  return {\n    json: {\n      isSend: true,\n      botToken: $input.item.json.botToken,\n      payload: {\n        chat_id: $input.item.json.chatId,\n        parse_mode: 'HTML',\n        text: message.join('\\n'),\n      },\n    },\n  };\n}\n\nreturn {\n  json: {\n    isSend: false,\n  },\n};\n"},"id":"bc9f4b74-030a-48c6-982d-9382a8647da4","name":"Create Telegram Message","type":"n8n-nodes-base.code","typeVersion":1,"position":[-300,1700]},{"parameters":{"method":"POST","url":"=https://api.telegram.org/bot{{ $input.item.json.botToken }}/sendMessage ","sendBody":true,"specifyBody":"json","jsonBody":"={{ JSON.stringify($input.item.json.payload) }}","options":{}},"id":"682a78f8-83b3-4f9c-a11c-b3536ed727af","name":"Send to Telegram chat","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[160,1620]},{"parameters":{"values":{"string":[{"name":"appId","value":"cli_a433ff4a74f89009"},{"name":"appSecret","value":"LL8RUtLIixRrw3t5qLUkwcdBhbgOWpIr"}]},"options":{}},"id":"25d5394b-b866-4eff-b856-6913eb4513c5","name":"Set Lark Configs","type":"n8n-nodes-base.set","typeVersion":2,"position":[-920,620]},{"parameters":{"values":{"string":[{"name":"customBotURL","value":"https://open.larksuite.com/open-apis/bot/v2/hook/27387efd-c40b-44c1-9872-6983f4f687c9"}],"boolean":[{"name":"enableBalance","value":true},{"name":"enableOTP","value":true},{"name":"enableOutgoing","value":true},{"name":"enableIncoming","value":true}]},"options":{}},"id":"dbfbb90a-4b3f-4dc0-890e-85ffd5fe1c38","name":"Set Lark Mess Config","type":"n8n-nodes-base.set","typeVersion":2,"position":[-320,880]},{"parameters":{"values":{"string":[{"name":"baseId","value":"LIx9b5n6wazCqns1euGuCOthsyh"},{"name":"tableId","value":"tblK7k96kQfosl5C"}],"boolean":[{"name":"enableBalance","value":true},{"name":"enableOTP","value":true},{"name":"enableOutgoing","value":true},{"name":"enableIncoming","value":true}]},"options":{}},"id":"d5473b01-93ae-4a00-9391-249a78119525","name":"Set Lark Base Config","type":"n8n-nodes-base.set","typeVersion":2,"position":[-300,480]},{"parameters":{},"id":"f0e47158-fba0-4a21-95fc-40e32baec173","name":"Start Lark Actions","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[-1080,620]},{"parameters":{},"id":"e648ccf6-8fa0-4dce-aabe-1b5e7334a6a2","name":"Start Lark Base","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[-520,480]},{"parameters":{},"id":"84063918-0627-48ac-b429-2bad8bba74c8","name":"Start Lark Mess","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[-540,880]},{"parameters":{},"id":"37db66ea-6ebf-4941-a1e0-3c87f0923793","name":"Start Telegram Actions","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[-1080,1620]},{"parameters":{"values":{"string":[{"name":"botToken","value":"set-bot-token"},{"name":"chatId","value":"set-chat-id"}],"boolean":[{"name":"enableBalance","value":true},{"name":"enableOTP","value":true},{"name":"enableOutgoing","value":true},{"name":"enableIncoming","value":true}]},"options":{}},"id":"50c3af12-54d0-4a33-9580-d5663321ffd7","name":"Set Telegram Config","type":"n8n-nodes-base.set","typeVersion":2,"position":[-900,1620]},{"parameters":{},"id":"60ffc3f1-1748-4414-b47d-a69788a45c4b","name":"Start Lark Base Actions","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[-80,460]},{"parameters":{},"id":"8d5fb7d9-78f6-4241-bcab-f4e188a87543","name":"Start Lark Mess Actions","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[-100,860]},{"parameters":{"mode":"runOnceForEachItem","jsCode":"const smsContent = $('Webhook').first().json.body;\n\n// create message card\nlet result = {\n  msg_type: 'text',\n  content: {\n    text: `T·ª´: ${smsContent.from}\\n${smsContent.text.toString()}`,\n  },\n};\n\nreturn {\n  json: {\n    data: result,\n    customBotURL: $input.item.json.customBotURL,\n  },\n};\n"},"id":"01147015-0948-448f-ae25-38c467548f28","name":"Convert to Message Card for OTP","type":"n8n-nodes-base.code","typeVersion":1,"position":[320,760]},{"parameters":{},"id":"d0abe01b-38c9-45e5-a41b-1867245aea7b","name":"Start Telegram Mess Actions","type":"n8n-nodes-base.noOp","typeVersion":1,"position":[-700,1620]},{"parameters":{"mode":"runOnceForEachItem","jsCode":"const smsContent = $('Webhook').first().json.body;\n\nlet message = [];\n\nmessage.push(\n  `<b>${smsContent.from.toUpperCase()}</b>\\n`,\n  `${smsContent.text.toString()}`\n);\n\nreturn {\n  json: {\n    botToken: $input.item.json.botToken,\n    payload: {\n      chat_id: $input.item.json.chatId,\n      parse_mode: 'HTML',\n      text: message.join('\\n'),\n    },\n  },\n};\n"},"id":"b9010276-acb6-462a-aa87-08eba2f09db4","name":"Create Telegram Message for OTP","type":"n8n-nodes-base.code","typeVersion":1,"position":[-180,1480]},{"parameters":{"conditions":{"boolean":[{"value1":"={{ $input.item.json.isSend }}","value2":true}]}},"id":"6258af49-d696-419d-9a04-7e8b321eaabf","name":"ifSend","type":"n8n-nodes-base.if","typeVersion":1,"position":[520,920]},{"parameters":{"conditions":{"boolean":[{"value1":"={{ $input.item.json.isSend }}","value2":true}]}},"id":"b923bcf2-6cd8-46ca-8bde-7da37dc1eced","name":"ifSend1","type":"n8n-nodes-base.if","typeVersion":1,"position":[480,520]},{"parameters":{"conditions":{"boolean":[{"value1":"={{ $input.item.json.isSend }}","value2":true}]}},"id":"a3d10fe0-0f49-44ea-8686-565f35fc2b18","name":"ifSend2","type":"n8n-nodes-base.if","typeVersion":1,"position":[-80,1700]},{"parameters":{"mode":"runOnceForEachItem","jsCode":"const smsContent = $('Webhook').first().json.body;\n\n  // Convert to Lark Base format\n  const records = [\n    {\n      fields: {\n        ID: smsContent.from,\n        Bank: smsContent.from,\n        'Transaction Type': 'OTP',\n        'Transaction Message': smsContent.text.toString(),\n        'Original Message': smsContent.text.toString(),\n        'Time received': smsContent.sentStamp,\n      },\n    },\n  ];\n\n  return {\n    json: {\n      records,\n      configs: {\n        baseId: $input.item.json.baseId,\n        tableId: $input.item.json.tableId,\n      },\n    },\n  };\n"},"id":"b095e519-cda3-43da-8f5b-f145b6099f94","name":"Convert to Lark Base format OTP","type":"n8n-nodes-base.code","typeVersion":1,"position":[300,280]},{"parameters":{"conditions":{"string":[{"value1":"={{ $('Webhook').item.json.body.text }}","operation":"contains","value2":"OTP"}],"boolean":[{"value1":"={{ $input.item.json.enableOTP }}","value2":true}]}},"id":"eeb1ebc3-c26b-4310-b2ba-8d698c6bfba9","name":"ifOTPLarkBase","type":"n8n-nodes-base.if","typeVersion":1,"position":[100,460]},{"parameters":{"conditions":{"string":[{"value1":"={{ $('Webhook').item.json.body.text }}","operation":"contains","value2":"OTP"}],"boolean":[{"value1":"={{ $input.item.json.enableOTP }}","value2":true}]}},"id":"17345c4e-78bc-484d-8b35-e5dec6c299ce","name":"ifOTPLarkMess","type":"n8n-nodes-base.if","typeVersion":1,"position":[60,860]},{"parameters":{"conditions":{"string":[{"value1":"={{ $('Webhook').item.json.body.text }}","operation":"contains","value2":"OTP"}],"boolean":[{"value1":"={{ $input.item.json.enableOTP }}","value2":true}]}},"id":"6dbdce41-59b5-4a72-b7a5-029f182b11a0","name":"ifOTPTelegram","type":"n8n-nodes-base.if","typeVersion":1,"position":[-520,1620]},{"parameters":{"values":{"string":[{"name":"customBotURL","value":"https://open.larksuite.com/open-apis/bot/v2/hook/27387efd-c40b-44c1-9872-6983f4f687c9"}]},"options":{}},"id":"8f65afe4-443f-43e6-95e4-20e76ca2a12a","name":"Set Lark Mess Config1","type":"n8n-nodes-base.set","typeVersion":2,"position":[-1080,1180]},{"parameters":{"method":"POST","url":"={{ $input.item.json.customBotURL }}","sendBody":true,"specifyBody":"json","jsonBody":"={{ JSON.stringify($input.item.json.data)}}","options":{}},"id":"85bae90d-f7cf-4836-82dc-bdb70534f476","name":"[Lark] Send noti to group chat1","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[-660,1180]},{"parameters":{"mode":"runOnceForEachItem","jsCode":"const smsContent = $('Webhook').first().json.body;\n\n// create message card\nlet result = {\n  msg_type: 'text',\n  content: {\n    text: `T·ª´: ${smsContent.from}\\nN·ªôi dung: \\n${smsContent.text.toString()}`,\n  },\n};\n\nreturn {\n  json: {\n    data: result,\n    customBotURL: $input.item.json.customBotURL,\n  },\n};\n"},"id":"5c4fb89a-a8cd-4635-af24-d9c88da2b609","name":"Convert to Message Card","type":"n8n-nodes-base.code","typeVersion":1,"position":[-880,1180]}],"connections":{"Webhook":{"main":[[{"node":"getBankData","type":"main","index":0}]]},"Convert to Lark Message Card":{"main":[[{"node":"ifSend","type":"main","index":0}]]},"Get Lark tenant access token":{"main":[[{"node":"Start Lark Base","type":"main","index":0},{"node":"Start Lark Mess","type":"main","index":0}]]},"Convert to Lark Base format":{"main":[[{"node":"ifSend1","type":"main","index":0}]]},"ifBankSupport":{"main":[[{"node":"Start Actions","type":"main","index":0}],[{"node":"Set Lark Mess Config1","type":"main","index":0}]]},"getBankData":{"main":[[{"node":"ifBankSupport","type":"main","index":0}]]},"Create Telegram Message":{"main":[[{"node":"ifSend2","type":"main","index":0}]]},"Set Lark Configs":{"main":[[{"node":"Get Lark tenant access token","type":"main","index":0}]]},"Set Lark Mess Config":{"main":[[{"node":"Start Lark Mess Actions","type":"main","index":0}]]},"Set Lark Base Config":{"main":[[{"node":"Start Lark Base Actions","type":"main","index":0}]]},"Start Lark Actions":{"main":[[{"node":"Set Lark Configs","type":"main","index":0}]]},"Start Lark Base":{"main":[[{"node":"Set Lark Base Config","type":"main","index":0}]]},"Start Lark Mess":{"main":[[{"node":"Set Lark Mess Config","type":"main","index":0}]]},"Start Telegram Actions":{"main":[[{"node":"Set Telegram Config","type":"main","index":0}]]},"Set Telegram Config":{"main":[[{"node":"Start Telegram Mess Actions","type":"main","index":0}]]},"Start Lark Base Actions":{"main":[[{"node":"ifOTPLarkBase","type":"main","index":0}]]},"Start Lark Mess Actions":{"main":[[{"node":"ifOTPLarkMess","type":"main","index":0}]]},"Convert to Message Card for OTP":{"main":[[{"node":"[Lark] Send noti to group chat","type":"main","index":0}]]},"Start Telegram Mess Actions":{"main":[[{"node":"ifOTPTelegram","type":"main","index":0}]]},"Create Telegram Message for OTP":{"main":[[{"node":"Send to Telegram chat","type":"main","index":0}]]},"ifSend":{"main":[[{"node":"[Lark] Send noti to group chat","type":"main","index":0}]]},"ifSend1":{"main":[[{"node":"[SMS Log] Add records to Bitable","type":"main","index":0}]]},"ifSend2":{"main":[[{"node":"Send to Telegram chat","type":"main","index":0}]]},"Convert to Lark Base format OTP":{"main":[[{"node":"[SMS Log] Add records to Bitable","type":"main","index":0}]]},"ifOTPLarkBase":{"main":[[{"node":"Convert to Lark Base format OTP","type":"main","index":0}],[{"node":"Convert to Lark Base format","type":"main","index":0}]]},"ifOTPLarkMess":{"main":[[{"node":"Convert to Message Card for OTP","type":"main","index":0}],[{"node":"Convert to Lark Message Card","type":"main","index":0}]]},"ifOTPTelegram":{"main":[[{"node":"Create Telegram Message for OTP","type":"main","index":0}],[{"node":"Create Telegram Message","type":"main","index":0}]]},"Set Lark Mess Config1":{"main":[[{"node":"Convert to Message Card","type":"main","index":0}]]},"Start Actions":{"main":[[{"node":"Start Lark Actions","type":"main","index":0}]]},"Convert to Message Card":{"main":[[{"node":"[Lark] Send noti to group chat1","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{"Webhook":[{"json":{"headers":{"host":"app.n8n.vn","user-agent":"SMS Forwarder App","transfer-encoding":"chunked","accept-encoding":"gzip","content-type":"application/json; charset=utf-8","x-forwarded-for":"171.224.177.18","x-forwarded-host":"app.n8n.vn","x-forwarded-port":"443","x-forwarded-proto":"https","x-forwarded-server":"f2605f992776","x-real-ip":"171.224.177.18"},"params":{},"query":{},"body":{"from":"ABBank","text":"TK268xxx0922 tai BIDV +400,000,000VND vao 10:48 21/07/2023. So du:412,040,620VND. ND: TKThe :2207201008449, tai Agribank. hx tra xn3 -CTLNHIDI000005159896347-11","sentStamp":1689912578000,"receivedStamp":1689912580093,"sim":"sim2"}}}]},"versionId":"7d300e1f-113a-4f1b-b111-59ec5649be8a","triggerCount":1,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-07-27T13:18:11.155Z","updatedAt":"2023-07-27T13:26:13.000Z","id":"233","name":"A","active":true,"nodes":[{"parameters":{"httpMethod":"POST","path":"A","options":{"responseData":"Ch√∫ng t√¥i ƒë√£ nh·∫≠n th√¥ng tin. B·∫°n c√≥ th·ªÉ ƒë√≥ng c·ª≠a s·ªï n√†y!!"}},"id":"98c8199f-3ee0-4c99-8556-459bdd32769a","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[560,220],"webhookId":"824be3d2-4814-4514-a109-507ec73bf043"},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/auth/v3/app_access_token/internal/","sendBody":true,"specifyBody":"json","jsonBody":"={ \"app_id\" : \"{{ $('setData').item.json[\"appId\"] }}\",\n \"app_secret\" : \"{{ $('setData').item.json[\"appSecret\"] }}\" } ","options":{}},"id":"ef9973ce-9f96-466f-8896-14b0d2d19a44","name":"app_token","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[940,220]},{"parameters":{"values":{"string":[{"name":"appId","value":"cli_a43f02058738d0099"},{"name":"appSecret","value":"ayBQyWmXTY2f1Js58pU1XdVIDrzqYDA2"},{"name":"recordID","value":"={{ $json.query.recordID }}"},{"name":"OK","value":"OK"}]},"options":{}},"id":"c1ae61cb-9d4e-406b-8c5f-4792b7e4b85d","name":"setData","type":"n8n-nodes-base.set","typeVersion":2,"position":[780,220]},{"parameters":{"method":"PUT","url":"=https://open.larksuite.com/open-apis/bitable/v1/apps/SFdibrWjyaVvaNsqQxnugyp5sHg/tables/tblTTEfBCIGNY53A/records/{{ $('setData').item.json[\"recordID\"] }}\n\n","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $json[\"app_access_token\"] }}"}]},"sendBody":true,"specifyBody":"json","jsonBody":"{\"fields\" : {\"FB\":\"OK\"}}","options":{}},"id":"feb79064-db79-48e0-ac2e-347baebd986e","name":"Update record","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[1160,220]}],"connections":{"Webhook":{"main":[[{"node":"setData","type":"main","index":0}]]},"app_token":{"main":[[{"node":"Update record","type":"main","index":0}]]},"setData":{"main":[[{"node":"app_token","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{},"versionId":"c34b83f2-b85d-40f5-9d54-79eaaa0ae93c","triggerCount":1,"tags":[{"createdAt":"2023-07-27T13:18:08.568Z","updatedAt":"2023-07-27T13:18:08.568Z","id":"29","name":"Lark365"}]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-07-27T14:11:09.735Z","updatedAt":"2023-07-27T14:11:09.735Z","id":"234","name":"BuiDucHai: Send email Payslip","active":false,"nodes":[{"parameters":{"httpMethod":"POST","path":"medianet-send-payslip","options":{}},"id":"065349b3-69d6-432e-b6a8-77bbd547c1be","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[180,380],"webhookId":"dbb95871-fa83-4fad-a027-88bf6af93796"},{"parameters":{"fromEmail":"=HR - Media Net <payslip@media.net.vn>","toEmail":"={{ $('Webhook').item.json[\"query\"][\"email\"] }}","subject":"= [Media Net]B·∫£ng l∆∞∆°ng th√°ng {{ $('Webhook').item.json[\"query\"][\"month\"] }} - {{ $('Webhook').item.json[\"query\"][\"name\"] }}","html":"=<!DOCTYPE html>\n<html>\n  <head>\n    <title>B·∫£ng l∆∞∆°ng</title>\n    <style>\n      body {\n        background-color: #f5f5f5;\n        font-family: Arial, sans-serif;\n      }\n      h1 {\n        text-align: center;\n        margin-top: 2rem;\n        margin-bottom: 2rem;\n        color: #333;\n        text-shadow: 0 0 10px rgba(0, 0, 0, 0.1);\n      }\n      table {\n        border-collapse: collapse;\n        width: 100%;\n        margin: 0 auto;\n        margin-bottom: 1rem;\n        box-shadow: 0 0 20px rgba(0, 0, 0, 0.15);\n        background: linear-gradient(to bottom, #f2f2f2, #fff);\n      }\n      th,\n      td {\n        padding: 1rem;\n        border: 1px solid #ddd;\n        text-align: center;\n        color: #333;\n      }\n      tr:nth-child(even) {\n        background-color: #e0e0e0;\n      }\n      tr:nth-child(odd) {\n        background-color: #f5f5f5;\n      }\n      .logo {\n        display: block;\n        margin: 0 auto;\n        max-width: 200px;\n      }\n      .container {\n        text-align: center;\n      }\n    </style>\n </head>\n  <body>\n    <div class=\"container\">\n      <img src=\"https://media.net.vn/logo-ngang.png\" alt=\"Logo c√¥ng ty\" class=\"logo\">\n      <h1>B·∫£ng l∆∞∆°ng c·ªßa {{ $('Webhook').item.json[\"query\"][\"name\"] }}</h1>\n      <table>\n        <tbody>\n        {{ $('Code').item.json[\"htmlSalaryFix\"] }}\n        {{ $('Code').item.json[\"htmlSalaryBHXH\"] }}\n        {{ $('Code').item.json[\"htmlTraffic\"] }}\n        {{ $('Code').item.json[\"htmlMultiplier\"] }}\n        {{ $('Code').item.json[\"htmlSalaryKD\"] }}\n        {{ $('Code').item.json[\"htmlSalaryTN\"] }}\n        {{ $('Code').item.json[\"htmlOther\"] }}\n        {{ $('Code').item.json[\"htmlChuyenCan\"] }}\n        {{ $('Code').item.json[\"htmlNote\"] }}\n        {{ $('Code').item.json[\"htmlSalaryTotal\"] }}\n        </tbody>\n      </table>\n    </div>\n  </body>\n</html>","options":{}},"id":"5cf9057a-bee3-4344-8a15-1af837e5d4de","name":"Send Email1","type":"n8n-nodes-base.emailSend","typeVersion":1,"position":[560,380],"credentials":{"smtp":{"id":"57","name":"Media Net: Payslip"}}},{"parameters":{"mode":"runOnceForEachItem","jsCode":"// Add a new field called 'myNewField' to the JSON of the item\nconst config = { style: 'currency', currency: 'VND'}\n$input.item.json.htmlTraffic = \"\"\nif ($('Webhook').item.json.query.Traffic) {\n  $input.item.json.htmlTraffic = \"<tr><th>Traffic</th><td>\" + new Intl.NumberFormat('vi-VN').format($('Webhook').item.json.query.Traffic) + \"</td></tr>\"\n}\n$input.item.json.htmlMultiplier = \"\"\nif ($('Webhook').item.json.query.multiplier) {\n  $input.item.json.htmlMultiplier = \"<tr><th>H·ªá s·ªë</th><td>\" + $('Webhook').item.json.query.multiplier + \"</td></tr>\"\n}\n$input.item.json.htmlOther = \"\"\nif ($('Webhook').item.json.query.other) {\n  $input.item.json.htmlOther = \"<tr><th>Kh√°c</th><td>\" + new Intl.NumberFormat('vi-VN', config).format($('Webhook').item.json.query.other) + \"</td></tr>\"\n}\n$input.item.json.htmlSalaryKD = \"\"\nif ($('Webhook').item.json.query.salaryKD) {\n  $input.item.json.htmlSalaryKD = \"<tr><th>L∆∞∆°ng Kinh Doanh</th><td>\" + new Intl.NumberFormat('vi-VN', config).format($('Webhook').item.json.query.salaryKD.replaceAll(\"[\",\"\").replaceAll(\"]\",\"\")) + \"</td></tr>\"\n}\n$input.item.json.htmlSalaryTN = \"\"\nif ($('Webhook').item.json.query.salaryTN) {\n  $input.item.json.htmlSalaryTN = \"<tr><th>L∆∞∆°ng Tr√°ch Nhi·ªám</th><td>\" + new Intl.NumberFormat('vi-VN', config).format($('Webhook').item.json.query.salaryTN) + \"</td></tr>\"\n}\n$input.item.json.htmlSalaryBHXH = \"\"\nif ($('Webhook').item.json.query.BHXH) {\n  $input.item.json.htmlSalaryBHXH = \"<tr><th>BHXH</th><td>\" + new Intl.NumberFormat('vi-VN', config).format($('Webhook').item.json.query.BHXH) + \"</td></tr>\"\n}\n$input.item.json.htmlChuyenCan = \"\"\nif ($('Webhook').item.json.query.chuyencan) {\n  $input.item.json.htmlChuyenCan = \"<tr><th>Chuy√™n C·∫ßn</th><td>\" + new Intl.NumberFormat('vi-VN', config).format($('Webhook').item.json.query.chuyencan) + \"</td></tr>\"\n}\n$input.item.json.htmlNote = \"\"\nif ($('Webhook').item.json.query.chuyencan) {\n  $input.item.json.htmlNote = \"<tr><th>Ghi ch√∫</th><td>\" + $('Webhook').item.json.query.note + \"</td></tr>\"\n}\n\n$input.item.json.htmlSalaryFix = \"<tr><th>L∆∞∆°ng c∆° b·∫£n</th><td>\" + new Intl.NumberFormat('vi-VN', config).format($('Webhook').item.json.query.salaryFix) + \"</td></tr>\"\n$input.item.json.htmlSalaryTotal = \"<tr><th>T·ªïng l∆∞∆°ng th·ª±c nh·∫≠n</th><td>\" + new Intl.NumberFormat('vi-VN', config).format($('Webhook').item.json.query.salaryTotal.replaceAll(\"[\",\"\").replaceAll(\"]\",\"\")) + \"</td></tr>\"\n\n\n\nreturn $input.item;"},"id":"cb8a1aff-760c-485c-8994-77273c0ffde8","name":"Code","type":"n8n-nodes-base.code","typeVersion":1,"position":[360,380]}],"connections":{"Webhook":{"main":[[{"node":"Code","type":"main","index":0}]]},"Code":{"main":[[{"node":"Send Email1","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{},"versionId":"4fbe47c0-2349-4516-9d05-089253466c3a","triggerCount":1,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-07-27T14:45:04.731Z","updatedAt":"2023-07-27T14:45:04.731Z","id":"235","name":"BuiDucHai:X√°c nh·∫≠n l∆∞∆°ng","active":false,"nodes":[{"parameters":{"path":"5c260db9-5e27-4786-9bae-5f9b677f310d","options":{}},"id":"0ca6a437-2a68-4070-af88-7025d1881271","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[1200,600],"webhookId":"5c260db9-5e27-4786-9bae-5f9b677f310d"}],"connections":{},"settings":{},"staticData":null,"pinData":{},"versionId":"832a8e84-e01a-4d79-88f3-93e884d94bdf","triggerCount":0,"tags":[]},"pairedItem":{"item":0}},{"json":{"createdAt":"2023-07-27T15:11:20.963Z","updatedAt":"2023-07-27T15:11:57.000Z","id":"237","name":"Backup n8n workflows to Google Drive","active":true,"nodes":[{"parameters":{},"name":"On clicking 'execute'","type":"n8n-nodes-base.manualTrigger","position":[380,240],"typeVersion":1,"id":"2ae5c391-6d0d-4525-8987-55f83ebb0d1a"},{"parameters":{"mode":"mergeByIndex"},"name":"Merge","type":"n8n-nodes-base.merge","position":[1020,390],"typeVersion":1,"id":"c4655e3d-9067-4fda-867f-101216731bc7"},{"parameters":{"mode":"jsonToBinary","options":{"useRawData":false}},"name":"Move Binary Data","type":"n8n-nodes-base.moveBinaryData","position":[1320,390],"typeVersion":1,"id":"09a174b3-d3f5-44b4-91d8-af64989308f2"},{"parameters":{"functionCode":"return items[0].json.data.map(item => {\n  return {json: item}\n});"},"name":"Map","type":"n8n-nodes-base.function","position":[770,390],"typeVersion":1,"id":"f699de03-1e21-4b74-9458-4f87f57b3b3b"},{"parameters":{"authentication":"basicAuth","url":"=http://localhost:5678/rest/workflows/{{$node[\"Map\"].data[\"id\"]}}","options":{}},"name":"Get Workflow","type":"n8n-nodes-base.httpRequest","position":[890,530],"notesInFlow":false,"typeVersion":1,"id":"bc09d258-c584-4832-9aa2-6381af10347a","credentials":{"httpBasicAuth":{"id":"97","name":"khoilq"}},"notes":"Don't forget to add your credentials for your n8n instance in this Node. Use Basic Auth for this. "},{"parameters":{"authentication":"basicAuth","url":"http://localhost:5678/rest/workflows","options":{}},"name":"Get Workflow List","type":"n8n-nodes-base.httpRequest","position":[580,390],"typeVersion":1,"id":"5e20e442-d655-4de3-96f3-55e48ea8bedf","credentials":{"httpBasicAuth":{"id":"97","name":"khoilq"}},"notes":"Don't forget to add your credentials for your n8n instance in this Node. Use Basic Auth for this. "},{"parameters":{"functionCode":"item = item.data;\nreturn item;"},"name":"FunctionItem","type":"n8n-nodes-base.functionItem","position":[1170,390],"typeVersion":1,"id":"0cb53c27-4549-462e-b22e-58416801edef"},{"parameters":{"authentication":"oAuth2","binaryData":true,"name":"={{$node[\"Merge\"].data[\"name\"]}}.json","resolveData":true,"parents":["Delete this text and put id for folder you want to upload into in this field. The folder ID can be found by opening the folder in your browser and copying the portion after https://drive.google.com/drive/u/0/folders/"],"options":{}},"name":"Google Drive","type":"n8n-nodes-base.googleDrive","position":[1500,380],"typeVersion":1,"id":"c5ddfc0c-e8f5-4a68-aacb-30eccd648a84","credentials":{"googleDriveOAuth2Api":{"id":"94","name":"Google Drive: lekhoi456@gmail.com"}}},{"parameters":{"triggerTimes":{"item":[{"hour":2,"minute":30}]}},"name":"Run Daily at 2:30am","type":"n8n-nodes-base.cron","position":[390,390],"typeVersion":1,"id":"1b2072c1-fda3-4699-9621-0ee0920f6c6a"}],"connections":{"Map":{"main":[[{"node":"Get Workflow","type":"main","index":0},{"node":"Merge","type":"main","index":0}]]},"Merge":{"main":[[{"node":"FunctionItem","type":"main","index":0}]]},"FunctionItem":{"main":[[{"node":"Move Binary Data","type":"main","index":0}]]},"Get Workflow":{"main":[[{"node":"Merge","type":"main","index":1}]]},"Move Binary Data":{"main":[[{"node":"Google Drive","type":"main","index":0}]]},"Get Workflow List":{"main":[[{"node":"Map","type":"main","index":0}]]},"Run Daily at 2:30am":{"main":[[{"node":"Get Workflow List","type":"main","index":0}]]},"On clicking 'execute'":{"main":[[{"node":"Get Workflow List","type":"main","index":0}]]}},"settings":{"saveManualExecutions":true,"callerPolicy":"workflowsFromSameOwner"},"staticData":null,"pinData":{},"versionId":"945fbf05-fa95-489f-9e26-884ad2f07ff6","triggerCount":1,"tags":[]},"pairedItem":{"item":0}}]},"versionId":"0dca6a1f-ec99-4fc2-a0a1-95d7a9c78613","triggerCount":1,"tags":[]}