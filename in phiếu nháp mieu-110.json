{"createdAt":"2023-05-31T03:50:43.989Z","updatedAt":"2023-06-01T05:24:35.000Z","id":"110","name":"In phiếu nháp Mieu","active":true,"nodes":[{"parameters":{"jsCode":"// Truy cập body của request\nconst body = items[0].json.body;\n\n// Trích xuất các biến từ body\nconst SKUCha = body.SKUCha;\nconst MaRap = body.MaRap;\nconst MaVaiChinh = body.MaVaiChinh;\nconst TiLeSize = body.TiLeSize;\nconst DinhMuc = body.DinhMucVaiChinh;\nconst currentDate = new Date();\nconst month = currentDate.getMonth() + 1;\n\nlet htmlTables = '<p>Tháng: '\n  htmlTables +=`${month}</p><p>Mã rập: ${MaRap}</p><div class=\"table-wrapper\"><table><thead><tr><td colspan=\"2\">Vải chính: ${MaVaiChinh}</td><td>Định mức</td><td colspan=\"4\">Tỉ lệ Size</td></tr></thead><tbody><tr><td class=\"cot-1 bentrai\" colspan=\"2\">${SKUCha}</td><td class=\"cot-4\"></td><td class=\"cot-5\" colspan=\"4\">${TiLeSize}</td></tr><tr><td class=\"cot-1\">Vải lót</td><td class=\"cot-2\"></td><td colspan=\"5\" rowspan=\"3\"></td></tr><tr><td>Nút</td><td></td></tr><tr><td>Phụ liệu khác</td><td></td></tr></tbody></table></br></div>`;\n\n// Trả về JSON mới\nreturn {\n  htmlTables: htmlTables\n};\n"},"id":"0c3c682b-10ce-4f8b-ab82-d7be7fabb4ca","name":"Code","type":"n8n-nodes-base.code","typeVersion":1,"position":[220,360]},{"parameters":{"html":"<!DOCTYPE html>\n\n<html>\n<head>\n  <meta charset=\"UTF-8\" />\n  <title>Phiếu Nháp Mieu</title>\n</head>\n<body>\n  <div class=\"container\">\n    <h1><img src=\"https://theme.hstatic.net/200000561729/1000985167/14/logo.png?v=311\" width=\"18%\"/></h1>\n    <p>  Địa chỉ: 400/2 Lê Văn Sỹ, Q3 </p>\n    <p>  Tel: 0902.303.006 </p>\n    <h2 style=\"text-align:center;font-size:2em;font-weight:bold;\">Phiếu Nháp Mieu</h2>\n    <p>Tháng:</p>\n    {{ $node[\"Code\"].json[\"htmlTables\"] }}\n    \n  </div>\n</body>\n</html>\n\n<style>\n.container {\n  background-color: #ffffff;\n  /*text-align: center;*/\n  padding: 16px;\n  border-radius: 8px;\n}\n\nbody{\n  text-align:left;\n}\nh1 {\n  color: #ff6d5a;\n  font-size: 24px;\n  font-weight: bold;\n  padding: 8px;\n}\n\nh2 {\n  color: #909399;\n  font-size: 18px;\n  font-weight: bold;\n  padding: 8px;\n}\n.table-wrapper {\n    display: flex;\n    flex-direction: column;\n  }\n\n  .table-wrapper table {\n    width: 100%;\n    border-collapse: collapse;\n    font-family: Arial, sans-serif;\n    margin-bottom: 20px;\n  }\n\n  .table-wrapper th,\n  .table-wrapper td {\n    border: 1px solid #ddd;\n    padding: 8px;\n    text-align: center;\n  }\n\n  .table-wrapper th {\n    background-color: #f2f2f2;\n    font-weight: bold;\n  }\n\n  .table-wrapper tbody tr:nth-child(even) {\n    background-color: #f9f9f9;\n  }\n  .bentrai{\n    text-align: left;\n    font-weight:bold;\n  }\n  .cot-1{\n    width:20%;\n  }\n  .cot-2,.cot-3,.cot-4{\n    width:15%;\n  }\n  .cot-5{\n   width:30%; \n  }\n</style>"},"id":"a6798220-712c-41c0-abfd-4b3f6c525b1b","name":"HTML","type":"n8n-nodes-base.html","typeVersion":1,"position":[420,360]},{"parameters":{"method":"PUT","url":"=https://open.larksuite.com/open-apis/bitable/v1/apps/QncPb90v9azHZRsiBsMutNctsrY/tables/tbl6zFuG4NPzXdKv/records/{{ $node[\"NhanLinkDraftMieu\"].json[\"body\"][\"recordsID\"] }}","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $node[\"Tenant\"].json[\"body\"][\"tenant_access_token\"] }}"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={\"fields\":{\"Phiếu Draft PO\":{\"link\":\"{{ $json[\"url\"] }}\",\"text\":\"xem hình\"}}}","options":{"response":{"response":{"fullResponse":true}}}},"id":"77cd77ac-411b-4fc6-8577-d2960dfca3cc","name":"HTTP Request3","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[1240,360]},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/auth/v3/tenant_access_token/internal","sendBody":true,"bodyParameters":{"parameters":[{"name":"app_id","value":"cli_a4d6c704d9b85009"},{"name":"app_secret","value":"mY1fnsO5t2PvCRhKV6TxLfYuO5Iw57zh"}]},"options":{"response":{"response":{"fullResponse":true}}}},"id":"adb5e1a2-a4a7-4353-996f-a3eb5eaabb51","name":"Tenant","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[680,360]},{"parameters":{"method":"POST","url":"https://hcti.io/v1/image","sendHeaders":true,"headerParameters":{"parameters":[{"name":"authorization","value":"Basic NmZkMTA3YjUtYzIxYy00ZTU4LTk4OGItYzEyMzQ0MDIyYmEyOjcxNGFmYWUxLTkwYzEtNDEwNy05MDgxLWYwOThmNmQ1Y2ZmMg=="}]},"sendBody":true,"contentType":"form-urlencoded","bodyParameters":{"parameters":[{"name":"html","value":"={{ $node[\"HTML\"].json[\"html\"] }}"},{"name":"ms_delay","value":"1000"}]},"options":{}},"id":"b5145d4c-10ab-4d01-9bbf-db21c82b1409","name":"ImageCreate","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[1020,360]},{"parameters":{"httpMethod":"POST","path":"b89bc4bd-a37b-47a3-9f9f-8e2631d1ca97","options":{}},"id":"b2b84aa1-51bc-4bbb-8896-85472615b3fc","name":"NhanLinkDraftMieu","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[-100,360],"webhookId":"56947aeb-2b39-4279-a71d-6225fb684aaa"}],"connections":{"Code":{"main":[[{"node":"HTML","type":"main","index":0}]]},"HTML":{"main":[[{"node":"Tenant","type":"main","index":0}]]},"Tenant":{"main":[[{"node":"ImageCreate","type":"main","index":0}]]},"ImageCreate":{"main":[[{"node":"HTTP Request3","type":"main","index":0}]]},"NhanLinkDraftMieu":{"main":[[{"node":"Code","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{},"versionId":"ecc56e92-96ea-4f36-a290-75b97d3e5bdb","triggerCount":1,"tags":[]}