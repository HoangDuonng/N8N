{"createdAt":"2023-09-27T17:03:22.938Z","updatedAt":"2023-10-22T05:07:55.000Z","id":"554","name":"[TVH - Checkin] Create Lark Account & Send Information","active":true,"nodes":[{"parameters":{"httpMethod":"POST","path":"create-lark-account","options":{}},"id":"46bf44fe-3185-4bd1-82ec-f5ef27e912ab","name":"Webhook","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[420,280],"webhookId":"453ce0a9-7b80-4dc0-bd47-2fbc27f28ea8"},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/auth/v3/tenant_access_token/internal","sendBody":true,"bodyParameters":{"parameters":[{"name":"app_id","value":"cli_a59c3cab2879d010"},{"name":"app_secret","value":"2QjLBZWCdYZb6C316TYVBccENBb7EKiR"}]},"options":{}},"id":"ece611cf-e075-4e28-9110-043b382ab4a6","name":"tenant_access_token","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[840,280]},{"parameters":{"jsCode":"// const open_department_ids = [$('Webhook').item.json.body.open_department_ids];\nconst val = {\n  'name': $('Webhook').item.json.body.name,\n  'email': $('Webhook').item.json.body.email,\n  'mobile': '+84' + $('Webhook').item.json.body.mobile.slice(1),\n  'mobile_visible': true,\n  'job_title': $('Webhook').item.json.body.job_title,\n  'employee_type': Number($('Webhook').item.json.body.employee_type),\n  'gender': Number($('Webhook').item.json.body.gender),\n  'department_ids': [($('Webhook').item.json.body.department_id)],\n  'work_station': $('Webhook').item.json.body.work_station,\n  'join_time': Math.floor(new Date($('Webhook').item.json.body.join_time).getTime() / 1000)\n}\n\n\nreturn {\"fields\": val};"},"id":"47beb738-a992-4a00-93c6-5ecc6c3af4c1","name":"Code","type":"n8n-nodes-base.code","typeVersion":1,"position":[620,280]},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/contact/v3/users","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $json.tenant_access_token }}"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={{ $('Code').item.json.fields }}","options":{}},"id":"82a2c599-68d1-41c3-8d6c-b5059f60b966","name":"create_lark_user","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[1060,280]},{"parameters":{"fromEmail":"Thành Vinh Holdings < tuyendung@tvhs.asia>","toEmail":"={{ $('Webhook').item.json.body.email }}","subject":"[TVH] Thông báo Đăng nhập tài khoản nội bộ và form thông tin cá nhân","emailFormat":"html","html":"=<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\">\n<html xmlns=\"http://www.w3.org/1999/xhtml\">\n<head>\n<meta name=\"viewport\" content=\"width=device-width\" />\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\" />\n<title>Really Simple HTML Email Template</title>\n<style>\n/* ------------------------------------- \n\t\tGLOBAL \n------------------------------------- */\n* { \n\tmargin:0;\n\tpadding:0;\n\tfont-family: \"Helvetica Neue\", \"Helvetica\", Helvetica, Arial, sans-serif; \n\tfont-size: 100%;\n\tline-height: 1.6;\n}\n\nimg { \n\tmax-width: 100%; \n}\n\nbody {\n\t-webkit-font-smoothing:antialiased; \n\t-webkit-text-size-adjust:none; \n\twidth: 100%!important; \n\theight: 100%;\n}\n\n\n/* ------------------------------------- \n\t\tELEMENTS \n------------------------------------- */\na { \n\tcolor: #348eda;\n}\n\n.btn-primary{\n\ttext-decoration:none;\n\tcolor: #FFF;\n\tbackground-color: #348eda;\n\tborder:solid #348eda;\n\tborder-width:10px 20px;\n\tline-height:2;\n\tfont-weight:bold;\n\tmargin-right:10px;\n\ttext-align:center;\n\tcursor:pointer;\n\tdisplay: inline-block;\n\tborder-radius: 25px;\n}\n\n.btn-secondary {\n\ttext-decoration:none;\n\tcolor: #FFF;\n\tbackground-color: #aaa;\n\tborder:solid #aaa;\n\tborder-width:10px 20px;\n\tline-height:2;\n\tfont-weight:bold;\n\tmargin-right:10px;\n\ttext-align:center;\n\tcursor:pointer;\n\tdisplay: inline-block;\n\tborder-radius: 25px;\n}\n\n.last { \n\tmargin-bottom: 0;\n}\n\n.first{\n\tmargin-top: 0;\n}\n\n.padding{\n\tpadding:10px 0;\n}\n\n\n/* ------------------------------------- \n\t\tBODY \n------------------------------------- */\ntable.body-wrap { \n\twidth: 100%;\n\tpadding: 20px;\n}\n\ntable.body-wrap .container{\n\tborder: 1px solid #f0f0f0;\n}\n\n\n/* ------------------------------------- \n\t\tFOOTER \n------------------------------------- */\ntable.footer-wrap { \n\twidth: 100%;\t\n\tclear:both!important;\n}\n\n.footer-wrap .container p {\n\tfont-size:12px;\n\tcolor:#666;\n\t\n}\n\ntable.footer-wrap a{\n\tcolor: #999;\n}\n\n\n/* ------------------------------------- \n\t\tTYPOGRAPHY \n------------------------------------- */\nh1,h2,h3{\n\tfont-family: \"Helvetica Neue\", Helvetica, Arial, \"Lucida Grande\", sans-serif; line-height: 1.1; margin-bottom:15px; color:#000;\n\tmargin: 40px 0 10px;\n\tline-height: 1.2;\n\tfont-weight:200; \n}\n\nh1 {\n\tfont-size: 36px;\n}\nh2 {\n\tfont-size: 28px;\n\ttext-align:center;\n}\nh3 {\n\tfont-size: 22px;\n}\n\np, ul, ol { \n\tmargin-bottom: 10px; \n\tfont-weight: normal; \n\tfont-size:15px;\n}\n\nul li, ol li {\n\tmargin-left:5px;\n\tlist-style-position: inside;\n}\n\nstrong{\n\tfont-size:18px;\n\tfont-weight:normal;\n}\n\n/* --------------------------------------------------- \n\t\tRESPONSIVENESS\n\t\tNuke it from orbit. It's the only way to be sure. \n------------------------------------------------------ */\n\n/* Set a max-width, and make it display as block so it will automatically stretch to that width, but will also shrink down on a phone or something */\n.container {\n\tdisplay:block!important;\n\tmax-width:600px!important;\n\tmargin:0 auto!important; /* makes it centered */\n\tclear:both!important;\n}\n\n/* Set the padding on the td rather than the div for Outlook compatibility */\n.body-wrap .container{\n\tpadding:20px;\n}\n\n/* This should also be a block element, so that it will fill 100% of the .container */\n.content {\n\tmax-width:600px;\n\tmargin:0 auto;\n\tdisplay:block; \n}\n\n/* Let's make sure tables in the content area are 100% wide */\n.content table { \n\twidth: 100%; \n}\n\n.center{\n\ttext-align:center;\n}\n\n.logo{\n\tdisplay:inline-block;\n\twidth:399px;\n\theight:85px;\n\tmax-width:90%;\n}\n\n.footnote{\n\tfont-size:14px;\n\tcolor:#444;\n}\n\n@media all and (min-resolution: 192dpi), (-webkit-min-device-pixel-ratio: 2), (min--moz-device-pixel-ratio: 2), (-o-min-device-pixel-ratio: 2/1), (min-device-pixel-ratio: 2), (min-resolution: 2dppx){\n\t.logo{\n\t\tbackground-image:url(chartblocks@2x.png);\n\t\tbackground-size:100% auto;\n\t\tbackground-repeat:no-repeat;\n\t}\n\t.logo img{\n\t\tvisibility:hidden;\n\t}\n}\n\n</style>\n</head>\n \n<body bgcolor=\"#f6f6f6\">\n\n<!-- body -->\n<table class=\"body-wrap\">\n\t<tr>\n\t\t<td class=\"container\" bgcolor=\"#FFFFFF\">\n\t\t\t<div class=\"content\">\n\t\t\t<table>\n\t\t\t\t<tr>\n\t\t\t\t\t<td>\n\t\t\t\t\t\t<p>Dear {{ $(\"Webhook\").item.json.body.name }},\n\t\t\t\t\t\t<p><b>Thành Vinh Holdings</b> chào mừng bạn đã gia nhập công ty. Chúng tôi rất vui mừng và tự hào khi có bạn trở thành một phần của đội ngũ của chúng tôi.</p>\n                      <p>Để hoàn tất quá trình check-in, bạn vui lòng:\n<ul>\n<li><b>Tải phần mềm giao tiếp nội bộ Lark tại đây:</b> https://www.larksuite.com/vi_vn/download</li>\n<li><b>Đăng nhập Lark bằng số điện thoại</b> {{ $(\"Webhook\").item.json.mobile }}</li>\n</ul>\n</p>\n\n<p>Mọi thắc mắc về quá trình đăng nhập và điền form thông tin, bạn vui lòng liên hệ đến số điện thoại 0984856449 (Ms.Thanh) để được hỗ trợ.</p>\t\n\n\t\t\t\t\t\t<br>\n\t\t\t\t\t\t<p>Trân trọng!<br>\n                        <br> Phòng Nhân sự</p>\t\t\t\t\t\n\t\t\t\t\t\n\n\t\t\t\t\t\t\t\t\t\n\t\t</td>\n\t</tr>\n</table>\n<!-- /body -->\n\n</body>\n</html>","options":{}},"id":"a282072a-4625-40fe-a37c-3cb9b50bd5b0","name":"Send Email","type":"n8n-nodes-base.emailSend","typeVersion":2,"position":[1280,280],"credentials":{"smtp":{"id":"129","name":"SMTP TVHs"}}}],"connections":{"Webhook":{"main":[[{"node":"Code","type":"main","index":0}]]},"tenant_access_token":{"main":[[{"node":"create_lark_user","type":"main","index":0}]]},"Code":{"main":[[{"node":"tenant_access_token","type":"main","index":0}]]},"create_lark_user":{"main":[[{"node":"Send Email","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{},"versionId":"40708cee-4650-4e0d-9c73-91fde2bc9d5d","triggerCount":1,"tags":[]}