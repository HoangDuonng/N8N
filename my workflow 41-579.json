{"createdAt":"2023-11-21T13:35:32.155Z","updatedAt":"2023-11-21T14:11:28.000Z","id":"579","name":"My workflow 41","active":false,"nodes":[{"parameters":{"rule":{"interval":[{}]}},"id":"43029ecc-e252-429b-9e6f-26cd24ee059b","name":"Schedule Trigger1","type":"n8n-nodes-base.scheduleTrigger","typeVersion":1.1,"position":[1380,580]},{"parameters":{"documentId":{"__rl":true,"value":"1d-ch9pub1iCvEzvdWBFa9NznBVRmnAfgeSXrp6Z8C5Y","mode":"id"},"sheetName":{"__rl":true,"value":"102874219","mode":"id"},"options":{}},"id":"3b090ba9-b48b-4e2f-b748-b65ebb05ec6d","name":"Google Sheets1","type":"n8n-nodes-base.googleSheets","typeVersion":4,"position":[1600,580],"credentials":{"googleSheetsOAuth2Api":{"id":"139","name":"Google Sheets account 3"}}},{"parameters":{"jsCode":"// Loop over input items and add a new field called 'myNewField' to the JSON of each one\nconst input = $input.all();\nconst output = {records:[]};\nfor (const item of $input.all()){\n  const format_item = {\n    fields: {\n      \"Họ Tên\": item.json[\"Họ Tên\"],\n      \"Lương\": item.json[\"Lương\"] === '-' ? 0 : item.json[\"Lương\"],\n      \"Tiền thưởng\": item.json[\"Tiền thưởng\"] === '-' ? 0 : item.json[\"Tiền thưởng\"],\n      \"Chốt đơn\": item.json[\"Chốt đơn\"] === '-' ? 0 : item.json[\"Chốt đơn\"],\n      \"Tổng lương\": item.json[\"Tổng lương\"] === '-' ? 0 : item.json[\"Tổng lương\"],\n      \"Ghi chú\": item.json[\"Ghi chú\"] === '-' ? \"\" : item.json[\"Ghi chú\"]\n    }\n  }\n  output.records.push(format_item);\n}\nreturn {output: output};"},"id":"8d6e2e07-9d65-4892-ab92-bfd859e88ae9","name":"Code1","type":"n8n-nodes-base.code","typeVersion":1,"position":[1820,580]},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/auth/v3/tenant_access_token/internal","sendBody":true,"bodyParameters":{"parameters":[{"name":"app_id","value":"cli_a4f2f2539db8d02f"},{"name":"app_secret","value":"nnuHqN4YPTlQcGOduU0C6gpQtgpMkVNk"}]},"options":{}},"id":"be4165bc-6bf1-4983-af39-1d0103df7b90","name":"tenant_access_token1","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[2040,580]},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/bitable/v1/apps/TYteb8DQSaTPgssXZm5lci8Dgmg/tables/tbl9Uh4BJ3PY3nkJ/records/batch_create","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $json.tenant_access_token }}"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={{ $('Code1').item.json.output }}","options":{}},"id":"cef17221-9f67-492b-a37a-4e6c7cb23427","name":"HTTP Request1","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[2260,580]}],"connections":{"Schedule Trigger1":{"main":[[{"node":"Google Sheets1","type":"main","index":0}]]},"Google Sheets1":{"main":[[{"node":"Code1","type":"main","index":0}]]},"Code1":{"main":[[{"node":"tenant_access_token1","type":"main","index":0}]]},"tenant_access_token1":{"main":[[{"node":"HTTP Request1","type":"main","index":0}]]}},"settings":{},"staticData":null,"pinData":{},"versionId":"6e9ab78e-d025-4156-a128-17a01f657e90","triggerCount":0,"tags":[]}