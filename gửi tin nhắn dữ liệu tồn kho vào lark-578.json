{"createdAt":"2023-11-21T13:24:29.872Z","updatedAt":"2023-11-22T03:13:45.000Z","id":"578","name":"Gửi tin nhắn dữ liệu tồn kho vào Lark","active":false,"nodes":[{"parameters":{"rule":{"interval":[{"triggerAtHour":7}]}},"id":"97ed5b74-aa74-4399-920c-4a460887e52f","name":"Schedule Trigger1","type":"n8n-nodes-base.scheduleTrigger","typeVersion":1.1,"position":[800,360]},{"parameters":{"documentId":{"__rl":true,"value":"1kfET9iXm7RaHANOdJeV8UfkG9oLrZ5_gfJhO0exQq6Q","mode":"id"},"sheetName":{"__rl":true,"value":"0","mode":"id"},"options":{}},"id":"38d9982b-c5de-465d-8958-d596dca65010","name":"Google Sheets1","type":"n8n-nodes-base.googleSheets","typeVersion":4,"position":[1020,360],"credentials":{"googleSheetsOAuth2Api":{"id":"139","name":"Google Sheets account 3"}}},{"parameters":{"jsCode":"// Loop over input items and add a new field called 'myNewField' to the JSON of each one\nconst output = {\n  \"msg_type\": \"interactive\",\n  \"card\": {\n    \"config\": {\"wide_screen_mode\": true},\n    \"elements\": [\n      {\n        \"tag\": \"column_set\",\n        \"flex_mode\": \"none\",\n        \"background_style\": \"grey\",\n        \"columns\": [\n          {\n            \"tag\": \"column\",\n            \"width\": \"weighted\",\n            \"weight\": 1,\n            \"vertical_align\": \"top\",\n            \"elements\": [\n              {\n                \"tag\": \"markdown\",\n                \"content\": \"**Tên sản phẩm**\"\n              }\n            ]\n          },\n          {\n            \"tag\": \"column\",\n            \"width\": \"weighted\",\n            \"weight\": 1,\n            \"vertical_align\": \"top\",\n            \"elements\": [\n              {\n                \"tag\": \"markdown\",\n                \"content\": \"**Ngày tạo đơn**\"\n              }\n            ]\n          },\n          {\n            \"tag\": \"column\",\n            \"width\": \"weighted\",\n            \"weight\": 1,\n            \"vertical_align\": \"top\",\n            \"elements\": [\n              {\n                \"tag\": \"markdown\",\n                \"content\": \"**Số lượng**\"\n              }\n            ]\n          }\n        ]\n      }\n    ],\n    \"header\": {\n      \"template\": \"blue\",\n      \"title\": {\n        \"content\": \"Báo cáo đơn tồn\",\n        \"tag\": \"plain_text\"\n      }\n    }\n  }\n}\n\n\nfor (const item of $input.all()) {\n  let format_item = {\n      \"tag\": \"column_set\",\n      \"flex_mode\": \"none\",\n      \"background_style\": \"grey\",\n      \"columns\": [\n        {\n          \"tag\": \"column\",\n          \"width\": \"weighted\",\n          \"weight\": 1,\n          \"vertical_align\": \"top\",\n          \"elements\": [\n            {\n              \"tag\": \"div\",\n              \"text\": {\n                \"content\": item.json[\"Tên sản phẩm\"],\n                \"tag\": \"plain_text\"\n              }\n            }\n          ]\n        },\n        {\n          \"tag\": \"column\",\n          \"width\": \"weighted\",\n          \"weight\": 1,\n          \"vertical_align\": \"top\",\n          \"elements\": [\n            {\n              \"tag\": \"div\",\n              \"text\": {\n                \"content\": item.json[\"Ngày tạo đơn\"],\n                \"tag\": \"plain_text\"\n              }\n            }\n          ]\n        },\n        {\n          \"tag\": \"column\",\n          \"width\": \"weighted\",\n          \"weight\": 1,\n          \"vertical_align\": \"top\",\n          \"elements\": [\n            {\n              \"tag\": \"div\",\n              \"text\": {\n                \"content\": item.json[\"Số lượng\"].toLocaleString(),\n                \"tag\": \"plain_text\"\n              }\n            }\n          ]\n        }\n      ]\n    }\n  output['card']['elements'].push(format_item);\n}\n\n// return {'a': output['elements']};\nreturn {'card': output};"},"id":"f792fb23-c7ea-4769-a5d9-fbcbe4f732b7","name":"Code1","type":"n8n-nodes-base.code","typeVersion":1,"position":[1240,360]},{"parameters":{"method":"POST","url":"https://open.larksuite.com/open-apis/bot/v2/hook/cb0e3c9c-13af-494e-8337-9753472f18d3","sendBody":true,"specifyBody":"json","jsonBody":"={{$json.card}}","options":{}},"id":"f069112d-8929-4483-8f7b-fd6f42afe3b0","name":"HTTP Request1","type":"n8n-nodes-base.httpRequest","typeVersion":4.1,"position":[1460,360]}],"connections":{"Schedule Trigger1":{"main":[[{"node":"Google Sheets1","type":"main","index":0}]]},"Google Sheets1":{"main":[[{"node":"Code1","type":"main","index":0}]]},"Code1":{"main":[[{"node":"HTTP Request1","type":"main","index":0}]]}},"settings":{},"staticData":{"node:Schedule Trigger1":{"recurrencyRules":[]}},"pinData":{},"versionId":"55bb361f-604f-441b-a5f2-5f6abf4b4736","triggerCount":1,"tags":[]}